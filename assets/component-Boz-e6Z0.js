var w=Object.defineProperty;var b=(i,a,e)=>a in i?w(i,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[a]=e;var s=(i,a,e)=>b(i,typeof a!="symbol"?a+"":a,e);import{G as v,h as u,ae as y,a7 as x,M as m,aa as C}from"./initialize-6doIkexO.js";import{b7 as f,b8 as k,K as R,V as L,a as M,h as d,m as S,r as F,L as I,l as P,k as E,i as T,b9 as $,ba as H,_ as B,bb as z,b2 as _,a7 as A,ab as G,aa as O,a8 as V}from"./lazy-CXj0l6bG.js";function Q(i,a){const e=(Math.round(i[0]*100)/100).toLocaleString(a,{minimumFractionDigits:2}),t=(Math.round(i[1]*100)/100).toLocaleString(a,{minimumFractionDigits:2});return[e,t]}function p(i,a){return i[0]>=a[0]&&i[0]<=a[2]&&i[1]>=a[1]&&i[1]<=a[3]}function D(i,a,e){if(!a||p(i,a))return i;let[t,r]=f(i,e);return p([t,r],a)?[t,r]:(i.reverse(),[t,r]=f(i,e),p([t,r],a)?[t,r]:[])}function j(i){const a=(r,o)=>{const n=Math.floor(Math.abs(r)),l=Math.floor((Math.abs(r)-n)*60),h=Math.round((Math.abs(r)-n-l/60)*3600*100)/100;let c;return o?c=r>=0?"N":"S":c=r>=0?"E":"W",`${n}Â° ${l}' ${h}" ${c}`},e=i[1],t=i[0];return[a(t,!1),a(e,!0)]}function ee(i,a,e){let t=[];return a==="dms"?t=j(i):a==="decimal"&&(t=i.map(r=>r.toFixed(e))),t}class N extends k{constructor(e,t=!1){super(e);s(this,"parent");s(this,"fixedPosition");this.parent=e.parent,this.fixedPosition=t}openHandler(e){if(super.openHandler(e),this.fixedPosition&&e.target===this.parent){this.domElement.classList.add("fixedPosition"),this.domElement.getElementsByClassName("picker_arrow")[0].classList.add("fixedPosition"),this.domElement.style.position="fixed";const t=this.parent.getBoundingClientRect().left+this.parent.getBoundingClientRect().width,r=window.innerHeight-(this.parent.getBoundingClientRect().bottom-this.parent.getBoundingClientRect().height);this.domElement.style.left=`${t}px`,this.domElement.style.bottom=`${r}px`}}}const U="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='120'%20height='120'%20viewBox='0%200%20384%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20d='M215.7%20499.2C267%20435%20384%20279.4%20384%20192C384%2086%20298%200%20192%200S0%2086%200%20192c0%2087.4%20117%20243%20168.3%20307.2c12.3%2015.3%2035.1%2015.3%2047.4%200zM192%20128a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128z'/%3e%3c/svg%3e",W="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20576%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20d='M384%20476.1L192%20421.2V35.9L384%2090.8V476.1zm32-1.2V88.4L543.1%2037.5c15.8-6.3%2032.9%205.3%2032.9%2022.3V394.6c0%209.8-6%2018.6-15.1%2022.3L416%20474.8zM15.1%2095.1L160%2037.2V423.6L32.9%20474.5C17.1%20480.8%200%20469.2%200%20452.2V117.4c0-9.8%206-18.6%2015.1-22.3z'/%3e%3c/svg%3e",X="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20576%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20d='M264.5%205.2c14.9-6.9%2032.1-6.9%2047%200l218.6%20101c8.5%203.9%2013.9%2012.4%2013.9%2021.8s-5.4%2017.9-13.9%2021.8l-218.6%20101c-14.9%206.9-32.1%206.9-47%200L45.9%20149.8C37.4%20145.8%2032%20137.3%2032%20128s5.4-17.9%2013.9-21.8L264.5%205.2zM476.9%20209.6l53.2%2024.6c8.5%203.9%2013.9%2012.4%2013.9%2021.8s-5.4%2017.9-13.9%2021.8l-218.6%20101c-14.9%206.9-32.1%206.9-47%200L45.9%20277.8C37.4%20273.8%2032%20265.3%2032%20256s5.4-17.9%2013.9-21.8l53.2-24.6%20152%2070.2c23.4%2010.8%2050.4%2010.8%2073.8%200l152-70.2zm-152%20198.2l152-70.2%2053.2%2024.6c8.5%203.9%2013.9%2012.4%2013.9%2021.8s-5.4%2017.9-13.9%2021.8l-218.6%20101c-14.9%206.9-32.1%206.9-47%200L45.9%20405.8C37.4%20401.8%2032%20393.3%2032%20384s5.4-17.9%2013.9-21.8l53.2-24.6%20152%2070.2c23.4%2010.8%2050.4%2010.8%2073.8%200z'/%3e%3c/svg%3e",q="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20d='M416%20208c0%2045.9-14.9%2088.3-40%20122.7L502.6%20457.4c12.5%2012.5%2012.5%2032.8%200%2045.3s-32.8%2012.5-45.3%200L330.7%20376c-34.4%2025.2-76.8%2040-122.7%2040C93.1%20416%200%20322.9%200%20208S93.1%200%20208%200S416%2093.1%20416%20208zM208%20352a144%20144%200%201%200%200-288%20144%20144%200%201%200%200%20288z'/%3e%3c/svg%3e",K="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20576%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20d='M339.3%20367.1c27.3-3.9%2051.9-19.4%2067.2-42.9L568.2%2074.1c12.6-19.5%209.4-45.3-7.6-61.2S517.7-4.4%20499.1%209.6L262.4%20187.2c-24%2018-38.2%2046.1-38.4%2076.1L339.3%20367.1zm-19.6%2025.4l-116-104.4C143.9%20290.3%2096%20339.6%2096%20400c0%203.9%20.2%207.8%20.6%2011.6C98.4%20429.1%2086.4%20448%2068.8%20448H64c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032H208c61.9%200%20112-50.1%20112-112c0-2.5-.1-5-.2-7.5z'/%3e%3c/svg%3e";class te extends v{constructor(){super("search");s(this,"template",()=>u`<style>
*{font-family:Arial,sans-serif}.hidden{display:none!important}.gg-rotate90{transform:rotate(90deg)}.gg-rotate180{transform:rotate(180deg)}.gg-rotate270{transform:rotate(270deg)}img{filter:var(--svg-filter)}img.legend-image{filter:var(--svg-map-filter);background:var(--svg-legend-bkg)}div{scrollbar-width:thin}a{color:var(--link-color)}a:visited{color:var(--link-color)}@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes spin-wait{0%{transform:rotate(0)}7%{transform:rotate(360deg)}100%{transform:rotate(360deg)}}.gg-spin{animation-name:spin;animation-duration:2s;animation-iteration-count:infinite;animation-timing-function:linear}.gg-spin-wait{animation-name:spin-wait;animation-duration:10s;animation-iteration-count:infinite;animation-timing-function:linear}::-webkit-scrollbar{width:5px}::-webkit-scrollbar-thumb{background:#999}.gg-button,.gg-input,.gg-select,.gg-textarea{background-color:var(--bkg-color);color:var(--text-color);outline:0;border-radius:3px;border:var(--app-standard-border);display:inline-block;box-sizing:border-box;padding:0 0 0 .5rem;margin:0;cursor:pointer}.gg-label{background-color:var(--bkg-color);color:var(--text-color);border:none;display:inline-block;padding:0;margin:0}.gg-button,.gg-input,.gg-label,.gg-select{min-height:calc(var(--app-standard-height)/ 1.5);max-height:calc(var(--app-standard-height)/ 1.5);line-height:calc(var(--app-standard-height) / 1.5)}.gg-textarea{padding:.5rem;height:6rem}.gg-input{cursor:text}.gg-checkbox{accent-color:var(--text-color);width:1.2rem}.gg-range{accent-color:var(--text-color)}.gg-button{padding:0 .5rem}.gg-button.active{border:solid 1px var(--text-color-grad2);background-color:var(--text-color-grad2);color:var(--bkg-color)}.gg-button:disabled{background-color:#d3d3d3;color:grey;border:none;cursor:not-allowed}.gg-icon-button{border:none;background-color:transparent;display:flex;flex-direction:column;color:var(--text-color);padding:0;align-items:center;justify-content:center;cursor:pointer}.gg-big,.gg-big-withtext{min-width:var(--app-standard-height);min-height:var(--app-standard-height);max-height:var(--app-standard-height)}.gg-big img,.gg-big-withtext img{margin:0;width:calc(var(--app-standard-height) - 1.5rem)}.gg-big-withtext span{font-size:.9rem;font-variant:small-caps;padding:0 1rem}.gg-medium,.gg-medium-withtext{flex-direction:row;min-width:calc(var(--app-standard-height)/ 1.2);min-height:calc(var(--app-standard-height)/ 1.2);max-height:calc(var(--app-standard-height)/ 1.2)}.gg-medium img{margin:0;width:calc(var(--app-standard-height)/ 2.4)}.gg-medium-withtext img{margin-left:.5rem;width:calc(var(--app-standard-height)/ 2.4)}.gg-medium-withtext span{font-size:.9rem;padding:0 1rem;padding-left:.5rem}.gg-small,.gg-small-withtext{flex-direction:row;min-width:calc(var(--app-standard-height)/ 2);min-height:calc(var(--app-standard-height)/ 2);max-height:calc(var(--app-standard-height)/ 2)}.gg-small img{margin:0;width:calc(var(--app-standard-height)/ 3)}.gg-small-withtext img{margin-left:.5rem;width:calc(var(--app-standard-height)/ 3)}.gg-small-withtext span{font-size:.9rem;padding:0 .5rem;padding-left:.3rem}.gg-button:hover,.gg-icon-button:hover,.gg-input:hover,.gg-select:hover,.gg-textarea:hover{background-color:var(--bkg-color-grad1)}.gg-opacity{opacity:.5}.gg-opacity:hover{background-color:transparent;opacity:1}.gg-tabs{display:flex;justify-content:left;margin:.5rem auto 0;border-bottom:1px solid grey;cursor:pointer;height:2rem;align-items:end;gap:1rem;margin-bottom:1rem}.gg-tab{border:none;background:0 0;cursor:pointer;padding:.5rem;color:var(--text-color)}.gg-tab.active{border-bottom:solid 2px var(--text-color-grad2);font-weight:600}.girafe-button-big,.girafe-button-large,.girafe-button-small,.girafe-button-tiny{border:none;background-color:transparent;display:flex;flex-direction:column;color:var(--text-color)}.girafe-button-big:hover,.girafe-button-large:hover,.girafe-button-small:hover,.girafe-button-tiny:hover{background-color:var(--bkg-color-grad1);cursor:pointer}.girafe-button-big.dark,.girafe-button-large.dark,.girafe-button-small.dark,.girafe-button-tiny.dark{background-color:var(--bkg-color);filter:invert(1)}.girafe-button-big{width:var(--app-standard-height);height:var(--app-standard-height);align-items:center;padding:1rem}.girafe-button-big img{overflow:hidden}.girafe-button-large{flex-direction:row}.girafe-button-large img{margin:.3rem;height:2rem}.girafe-button-large span{line-height:2rem;height:2rem;margin:.3rem}.girafe-button-small{min-width:calc(var(--app-standard-height)/ 2);height:calc(var(--app-standard-height)/ 2);align-items:center;padding:.5rem}.girafe-button-small img{overflow:hidden}.girafe-button-small span{width:100%;text-align:left;overflow:hidden;text-overflow:ellipsis}.girafe-button-tiny{width:1rem;height:1rem;align-items:center;padding:0}.girafe-button-tiny img{overflow:hidden}
</style><style>
.hidden{display:none}#searchbox{background-color:var(--bkg-color);height:2.25rem;width:100%;display:flex;flex-direction:row;border:1px solid #cfd6dd;border-radius:4px}#search{font-size:1rem;outline:0;margin:0 0 0 .5rem;padding-left:.8rem;border:0;height:2.25rem;width:auto;flex:1 1 auto;-ms-flex:1 1 auto;-webkit-flex:1 1 auto;-webkit-appearance:none;background:0 0;color:var(--text-color)}.close-icon,.search-icon,.select-color-icon{width:14px;color:var(--text-color);padding:0 1rem}.close-button,.select-color-button{border:none;padding:0;background-color:transparent;cursor:pointer}#results{z-index:1000;margin-top:.1rem;margin-bottom:.5rem;position:absolute;top:3.5rem;width:36rem;max-height:31rem;background-color:var(--bkg-color);overflow-x:hidden;scrollbar-width:thin}.result,.title{display:inline-block;padding:.3rem 1rem;width:Calc(36rem - 2rem);line-height:1.3rem}.title{color:var(--text-color);font-weight:600;line-height:2.5rem;font-size:1.3rem;padding-top:1.5rem}.result{cursor:pointer;border:none;border-top:solid 1px #ccc;background:0 0;text-align:left;width:100%;color:var(--text-color)}.title img{margin-right:1rem;width:14px}.title span{text-transform:uppercase}.result.selected{background-color:#aaa!important;color:var(--text-color)}
</style>
<link rel="stylesheet" href="lib/vanilla-picker/vanilla-picker.csp.css" />
<link rel="stylesheet" href="styles/girafecolorpicker.css" />

<div id="searchbox">
  <input
    id="search"
    class="gg-input"
    length="20"
    maxlength="1000"
    autocomplete="off"
    autocorrect="off"
    i18n="Search"
    placeholder="Search..."
    oninput="${e=>this.doSearch(e)}"
    onfocusin="${()=>this.onFocusIn()}"
    onfocusout="${()=>this.onFocusOut()}"
    onkeydown="${e=>this.onKeyDown(e)}" />

  <img class="${this.allResults.length>0?"hidden":"search-icon"}" alt="search-icon" src="${this.searchIcon}" />
  <button class="${this.allResults.length>0?"close-button":"hidden"}" onclick="${()=>this.clearSearch(!0)}">
    <img class="close-icon" alt="close-icon" src="icons/close.svg" />
  </button>
  <button id="colorPickerBtn" class="${this.paintSearchResults?"select-color-button":"hidden"}">
    <img class="select-color-icon" alt="select-color-icon" src="${this.paintbrushIcon}" />
  </button>

  <div
    id="results"
    class="${Object.keys(this.groupedResults).length===0||this.forceHide?"hidden":""}"
    onmousemove="${()=>this.onMouseMove()}">
    ${Object.keys(this.groupedResults).map(e=>u`
    <div class="title">
      <img alt="result icon" src="${this.getIcon(e)}" />
      <span i18n="${e}"></span>
    </div>
    ${this.groupedResults[e].map(t=>{var r;return u`
    <button
      class="${t.selected?"result selected":"result"}"
      onmousedown="${()=>this.onMouseDown()}"
      onclick="${()=>this.onSelect(t)}"
      onmouseover="${()=>this.onMouseOver(t)}"
      onmouseleave="${()=>this.onMouseLeave()}">
      ${(r=t.properties)==null?void 0:r.label}
    </button>
    `})} `)}
  </div>
</div>
`);s(this,"searchIcon",q);s(this,"paintbrushIcon",K);s(this,"themesHelper");s(this,"layerManager");s(this,"map");s(this,"previewFeaturesCollection",new R);s(this,"previewTheme",null);s(this,"previewGeoLayer",null);s(this,"maxExtent");s(this,"ignoreBlur",!1);s(this,"groupedResults",{});s(this,"allResults",[]);s(this,"forceHide",!0);s(this,"searchTermPlaceholder","###SEARCHTERM###");s(this,"searchLangPlaceholder","###SEARCHLANG###");s(this,"COORD_REGEX",/^(\d+[.,]?\d*)\s*[,;/\s]\s*(\d+[.,]?\d*)$/);s(this,"focusedResultIndex",-1);s(this,"focusedResult",null);s(this,"selectedResult",null);s(this,"searchBox");s(this,"paintSearchResults");s(this,"defaultSearchStrokeColor");s(this,"defaultSearchFillColor");s(this,"abortController",new AbortController);this.themesHelper=y.getInstance(),this.layerManager=x.getInstance(),this.map=m.getInstance().getMap(),this.defaultSearchStrokeColor=this.configManager.Config.search.defaultStrokeColor,this.defaultSearchFillColor=this.configManager.Config.search.defaultFillColor,this.createPreviewLayer()}createPreviewLayer(){this.configManager.loadConfig().then(()=>{var e;this.paintSearchResults=this.configManager.Config.search.paintSearchResults,this.maxExtent=(e=this.configManager.Config.map.maxExtent)==null?void 0:e.split(",").map(Number),this.previewGeoLayer=new L({properties:{addToPrintedLayers:!0},source:new M({features:this.previewFeaturesCollection})}),this.updatePreviewLayerStyle(this.defaultSearchFillColor,this.defaultSearchStrokeColor),this.map.addLayer(this.previewGeoLayer),this.previewGeoLayer.setZIndex(1010),this.initColorPicker()})}onMouseDown(){this.ignoreBlur=!0}onFocusIn(){this.forceHide=!1,super.render()}onFocusOut(){this.ignoreBlur||(this.forceHide=!0,super.render()),this.ignoreBlur=!1}render(){var e;super.render(),this.searchBox=(e=this.shadowRoot)==null?void 0:e.getElementById("search")}connectedCallback(){this.loadConfig().then(()=>{this.render(),super.girafeTranslate()})}clearSearch(e=!1){e&&this.searchBox&&(this.searchBox.value=""),this.forceHide=!1,this.groupedResults={},this.allResults=[],this.clearPreview(),this.focusedResultIndex=-1,this.focusedResult=null,super.render()}async doSearch(e){this.abortController.abort();const t=new AbortController;this.abortController=t;const o=e.target.value.trim();if(this.clearSearch(),this.COORD_REGEX.test(o)){this.displayCoordinates(o);return}if(o.length>0){const n=this.configManager.Config.search.url.replace(this.searchTermPlaceholder,o).replace(this.searchLangPlaceholder,this.state.language);try{const h=await(await fetch(n,{signal:this.abortController.signal})).json();this.displayResults(h)}catch(l){if(l instanceof DOMException&&l.name==="AbortError"){console.debug("Multiple parallel search: previous request was aborted.");return}}}}displayCoordinates(e){const t=this.COORD_REGEX.exec(e),r=parseFloat(t[1].replace(",",".")),o=parseFloat(t[2].replace(",",".")),n=this.map.getView().getProjection().getCode(),[l,h]=D([r,o],this.maxExtent,n);if(!l||!h)return;const c={bbox:[l,h,l,h],geometry:{type:"Point",coordinates:[l,h]},properties:{label:`${r} ${o}`,layer_name:"recenter_map"}};this.allResults=[c],this.groupedResults.recenter_map=[c],super.render(),super.girafeTranslate()}displayResults(e){e.features.forEach(t=>{let r="Unknown layer type";t.properties&&(t.properties.layer_name?r=t.properties.layer_name:t.properties.actions[0].action==="add_theme"?r="add_theme":t.properties.actions[0].action==="add_group"?r="add_group":t.properties.actions[0].action==="add_layer"&&(r="add_layer"));let o;r in this.groupedResults?o=this.groupedResults[r]:(o=[],this.groupedResults[r]=o),o.push(t)}),this.allResults=Object.values(this.groupedResults).flatMap(t=>t),super.render(),super.girafeTranslate()}getIcon(e){switch(e){case"Group":return X;case"Layer":return W;default:return U}}onMouseOver(e){this.focusResult(e)}onMouseLeave(){this.selectedResult===null&&this.clearPreview()}focusResultFromIndex(){const e=this.allResults[this.focusedResultIndex];this.focusResult(e)}focusResult(e){this.clearPreview(),this.focusedResult&&(this.focusedResult.selected=!1),this.focusedResultIndex=this.allResults.findIndex(r=>r===e),this.focusedResult=this.allResults[this.focusedResultIndex],this.focusedResult.selected=!0,this.render(),this.preview(e),this.shadow.querySelectorAll(".result")[this.focusedResultIndex].scrollIntoView({block:"nearest"})}preview(e){var t,r;if(e.bbox&&this.configManager.Config.search.objectPreview)e.geometry&&(this.addFeatureToPreview(e.geometry),this.updatePreviewLayerStyle());else if(((t=e.properties)==null?void 0:t.actions[0].action)==="add_layer"&&this.configManager.Config.search.layerPreview){const o=this.themesHelper.findLayerByName((r=e.properties)==null?void 0:r.actions[0].data),n=this.getMinimalClonedThemeForLayer(o);this.isAlreadyPresent(n)||(n.order=0,n.isExpanded=!0,this.previewTheme=n,this.state.layers.layersList.push(n),this.layerManager.toggleGroupOrTheme(n,"on"))}}isAlreadyPresent(e){return this.state.layers.layersList.some(t=>t.id===e.id)}getMinimalClonedThemeForLayer(e){const t=this.getHierarchyFromLayer(e),o=t[0].clone();let n=o.children;for(let l=1;l<t.length;++l)this.removeOthers(n,t[l]),n[0].isExpanded=!0,n=n[0].children;return o}removeOthers(e,t){for(let r=e.length-1;r>=0;--r)e[r].id!==t.id&&e.splice(r,1)}getHierarchyFromLayer(e){if(e instanceof C)return[e];if(!e.parent)throw new Error("A group or a layer should always have a parent.");return[...this.getHierarchyFromLayer(e.parent),e]}addFeatureToPreview(e){switch(e.type){case"Point":{const t=new d(new T(e.coordinates));this.previewFeaturesCollection.push(t);return}case"MultiPoint":{const t=new d(new E(e.coordinates));this.previewFeaturesCollection.push(t);return}case"MultiLineString":{const t=new d(new P(e.coordinates));this.previewFeaturesCollection.push(t);return}case"LineString":{const t=new d(new I(e.coordinates));this.previewFeaturesCollection.push(t);return}case"Polygon":{const t=new d(new F(e.coordinates));this.previewFeaturesCollection.push(t);return}case"MultiPolygon":{const t=new d(new S(e.coordinates));this.previewFeaturesCollection.push(t);return}case"GeometryCollection":{e.geometries.forEach(t=>{this.addFeatureToPreview(t)});return}default:throw new Error("Geometry type of search result is not being supported.")}}clearPreview(){if(this.previewFeaturesCollection.clear(),this.previewTheme){this.layerManager.toggle(this.previewTheme,"off");const e=this.state.layers.layersList.findIndex(t=>{var r;return t.treeItemId===((r=this.previewTheme)==null?void 0:r.treeItemId)});e>=0?this.state.layers.layersList.splice(e,1):console.warn("Error while removing preview layer."),this.previewTheme=null}}onSelect(e){var t,r,o,n,l,h;if(this.selectedResult=e,this.ignoreBlur=!1,this.forceHide=!0,this.previewTheme=null,super.render(),e.bbox)this.zoomTo(e.bbox);else{let c;if(((t=e.properties)==null?void 0:t.actions[0].action)==="add_theme")c=this.themesHelper.findThemeByName((r=e.properties)==null?void 0:r.actions[0].data).clone();else if(((o=e.properties)==null?void 0:o.actions[0].action)==="add_group"){const g=this.themesHelper.findGroupByName((n=e.properties)==null?void 0:n.actions[0].data);c=this.getMinimalClonedThemeForLayer(g)}else if(((l=e.properties)==null?void 0:l.actions[0].action)==="add_layer"){const g=this.themesHelper.findLayerByName((h=e.properties)==null?void 0:h.actions[0].data);c=this.getMinimalClonedThemeForLayer(g)}else console.warn("Unsupported result type");c&&!this.isAlreadyPresent(c)&&(c.order=0,this.state.layers.layersList.push(c))}this.onFocusOut(),this.searchBox&&e.properties&&(this.searchBox.value=e.properties.label)}zoomTo(e){const t=Math.max($(e)*50/100,H(e)*50/100),r=B(e,t),o=this.configManager.Config.search.minResolution,n=this.map.getView().getResolution(),l=this.map.getView().calculateExtent();o&&(n>o?m.getInstance().zoomToExtent(r,o):z(l,e)||(this.state.position.center=_(e)))}onMouseMove(){var t;const e=(t=this.shadowRoot)==null?void 0:t.querySelectorAll(".result");for(const r of e)r.classList.remove("active"),r.style.removeProperty("background-color")}onKeyDown(e){e.key==="Escape"?this.clearSearch(!0):this.forceHide?e.key==="Enter"&&this.onFocusIn():this.forceHide||this.navigateToResult(e)}navigateToResult(e){switch(e.key){case"ArrowDown":this.focusedResultIndex<this.allResults.length-1&&(this.focusedResultIndex+=1,this.focusResultFromIndex());break;case"ArrowUp":this.focusedResultIndex>0&&(this.focusedResultIndex-=1,this.focusResultFromIndex());break;case"Enter":this.focusedResultIndex>=0&&this.onSelect(this.allResults[this.focusedResultIndex]);break}}initColorPicker(){var t;super.render();const e=(t=this.shadowRoot)==null?void 0:t.getElementById("colorPickerBtn");if(e){const r=new N({parent:e,color:this.configManager.Config.search.defaultStrokeColor,popup:"right"});r.onChange=o=>{const n=[o.rgba[0],o.rgba[1],o.rgba[2],o.rgba[3]/2];this.updatePreviewLayerStyle(n,o.hex)}}}updatePreviewLayerStyle(e,t){this.defaultColorHasChanged()&&(this.defaultSearchFillColor=this.configManager.Config.search.defaultFillColor,this.defaultSearchStrokeColor=this.configManager.Config.search.defaultStrokeColor),e??(e=this.defaultSearchFillColor),t??(t=this.defaultSearchStrokeColor),this.previewGeoLayer.setStyle(new A({stroke:new G({color:t,width:this.configManager.Config.search.defaultStrokeWidth}),fill:new O({color:e}),image:new V({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",src:this.getColoredPinIcon(t),scale:.3})}))}defaultColorHasChanged(){return this.defaultSearchFillColor!==this.configManager.Config.search.defaultFillColor||this.defaultSearchStrokeColor!==this.configManager.Config.search.defaultStrokeColor}getColoredPinIcon(e){const t=`<svg xmlns="http://www.w3.org/2000/svg" 
                      width="120" 
                      height="120" 
                      style="fill: ${e};" 
                      viewBox="0 0 384 512">
                    <path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 
                             307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/>
                 </svg>`;return"data:image/svg+xml;utf8,"+encodeURIComponent(t)}}export{N as G,te as S,Q as f,ee as p};
//# sourceMappingURL=component-Boz-e6Z0.js.map
