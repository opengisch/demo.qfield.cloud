var Qv=Object.defineProperty;var ew=(s,e,t)=>e in s?Qv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var U=(s,e,t)=>ew(s,typeof e!="symbol"?e+"":e,t);var Dt="top",li="bottom",hi="right",kt="left",Nc="auto",Xo=[Dt,li,hi,kt],yr="start",xo="end",tw="clippingParents",lm="viewport",jr="popper",iw="reference",Of=Xo.reduce(function(s,e){return s.concat([e+"-"+yr,e+"-"+xo])},[]),hm=[].concat(Xo,[Nc]).reduce(function(s,e){return s.concat([e,e+"-"+yr,e+"-"+xo])},[]),nw="beforeRead",sw="read",rw="afterRead",ow="beforeMain",aw="main",lw="afterMain",hw="beforeWrite",uw="write",cw="afterWrite",dw=[nw,sw,rw,ow,aw,lw,hw,uw,cw];function Bi(s){return s?(s.nodeName||"").toLowerCase():null}function $t(s){if(s==null)return window;if(s.toString()!=="[object Window]"){var e=s.ownerDocument;return e&&e.defaultView||window}return s}function Rs(s){var e=$t(s).Element;return s instanceof e||s instanceof Element}function oi(s){var e=$t(s).HTMLElement;return s instanceof e||s instanceof HTMLElement}function zc(s){if(typeof ShadowRoot>"u")return!1;var e=$t(s).ShadowRoot;return s instanceof e||s instanceof ShadowRoot}function fw(s){var e=s.state;Object.keys(e.elements).forEach(function(t){var i=e.styles[t]||{},n=e.attributes[t]||{},r=e.elements[t];!oi(r)||!Bi(r)||(Object.assign(r.style,i),Object.keys(n).forEach(function(o){var a=n[o];a===!1?r.removeAttribute(o):r.setAttribute(o,a===!0?"":a)}))})}function gw(s){var e=s.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(i){var n=e.elements[i],r=e.attributes[i]||{},o=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:t[i]),a=o.reduce(function(l,h){return l[h]="",l},{});!oi(n)||!Bi(n)||(Object.assign(n.style,a),Object.keys(r).forEach(function(l){n.removeAttribute(l)}))})}}const um={name:"applyStyles",enabled:!0,phase:"write",fn:fw,effect:gw,requires:["computeStyles"]};function Ni(s){return s.split("-")[0]}var ws=Math.max,el=Math.min,vr=Math.round;function _u(){var s=navigator.userAgentData;return s!=null&&s.brands&&Array.isArray(s.brands)?s.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function cm(){return!/^((?!chrome|android).)*safari/i.test(_u())}function wr(s,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var i=s.getBoundingClientRect(),n=1,r=1;e&&oi(s)&&(n=s.offsetWidth>0&&vr(i.width)/s.offsetWidth||1,r=s.offsetHeight>0&&vr(i.height)/s.offsetHeight||1);var o=Rs(s)?$t(s):window,a=o.visualViewport,l=!cm()&&t,h=(i.left+(l&&a?a.offsetLeft:0))/n,u=(i.top+(l&&a?a.offsetTop:0))/r,c=i.width/n,d=i.height/r;return{width:c,height:d,top:u,right:h+c,bottom:u+d,left:h,x:h,y:u}}function Gc(s){var e=wr(s),t=s.offsetWidth,i=s.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:s.offsetLeft,y:s.offsetTop,width:t,height:i}}function dm(s,e){var t=e.getRootNode&&e.getRootNode();if(s.contains(e))return!0;if(t&&zc(t)){var i=e;do{if(i&&s.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function wn(s){return $t(s).getComputedStyle(s)}function pw(s){return["table","td","th"].indexOf(Bi(s))>=0}function es(s){return((Rs(s)?s.ownerDocument:s.document)||window.document).documentElement}function Hl(s){return Bi(s)==="html"?s:s.assignedSlot||s.parentNode||(zc(s)?s.host:null)||es(s)}function Ff(s){return!oi(s)||wn(s).position==="fixed"?null:s.offsetParent}function mw(s){var e=/firefox/i.test(_u()),t=/Trident/i.test(_u());if(t&&oi(s)){var i=wn(s);if(i.position==="fixed")return null}var n=Hl(s);for(zc(n)&&(n=n.host);oi(n)&&["html","body"].indexOf(Bi(n))<0;){var r=wn(n);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return n;n=n.parentNode}return null}function $o(s){for(var e=$t(s),t=Ff(s);t&&pw(t)&&wn(t).position==="static";)t=Ff(t);return t&&(Bi(t)==="html"||Bi(t)==="body"&&wn(t).position==="static")?e:t||mw(s)||e}function Hc(s){return["top","bottom"].indexOf(s)>=0?"x":"y"}function co(s,e,t){return ws(s,el(e,t))}function bw(s,e,t){var i=co(s,e,t);return i>t?t:i}function fm(){return{top:0,right:0,bottom:0,left:0}}function gm(s){return Object.assign({},fm(),s)}function pm(s,e){return e.reduce(function(t,i){return t[i]=s,t},{})}var yw=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,gm(typeof e!="number"?e:pm(e,Xo))};function vw(s){var e,t=s.state,i=s.name,n=s.options,r=t.elements.arrow,o=t.modifiersData.popperOffsets,a=Ni(t.placement),l=Hc(a),h=[kt,hi].indexOf(a)>=0,u=h?"height":"width";if(!(!r||!o)){var c=yw(n.padding,t),d=Gc(r),f=l==="y"?Dt:kt,g=l==="y"?li:hi,p=t.rects.reference[u]+t.rects.reference[l]-o[l]-t.rects.popper[u],y=o[l]-t.rects.reference[l],b=$o(r),v=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,_=p/2-y/2,m=c[f],E=v-d[u]-c[g],C=v/2-d[u]/2+_,x=co(m,C,E),w=l;t.modifiersData[i]=(e={},e[w]=x,e.centerOffset=x-C,e)}}function ww(s){var e=s.state,t=s.options,i=t.element,n=i===void 0?"[data-popper-arrow]":i;n!=null&&(typeof n=="string"&&(n=e.elements.popper.querySelector(n),!n)||dm(e.elements.popper,n)&&(e.elements.arrow=n))}const _w={name:"arrow",enabled:!0,phase:"main",fn:vw,effect:ww,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function _r(s){return s.split("-")[1]}var Ew={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Cw(s,e){var t=s.x,i=s.y,n=e.devicePixelRatio||1;return{x:vr(t*n)/n||0,y:vr(i*n)/n||0}}function Df(s){var e,t=s.popper,i=s.popperRect,n=s.placement,r=s.variation,o=s.offsets,a=s.position,l=s.gpuAcceleration,h=s.adaptive,u=s.roundOffsets,c=s.isFixed,d=o.x,f=d===void 0?0:d,g=o.y,p=g===void 0?0:g,y=typeof u=="function"?u({x:f,y:p}):{x:f,y:p};f=y.x,p=y.y;var b=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),_=kt,m=Dt,E=window;if(h){var C=$o(t),x="clientHeight",w="clientWidth";if(C===$t(t)&&(C=es(t),wn(C).position!=="static"&&a==="absolute"&&(x="scrollHeight",w="scrollWidth")),C=C,n===Dt||(n===kt||n===hi)&&r===xo){m=li;var R=c&&C===E&&E.visualViewport?E.visualViewport.height:C[x];p-=R-i.height,p*=l?1:-1}if(n===kt||(n===Dt||n===li)&&r===xo){_=hi;var I=c&&C===E&&E.visualViewport?E.visualViewport.width:C[w];f-=I-i.width,f*=l?1:-1}}var T=Object.assign({position:a},h&&Ew),A=u===!0?Cw({x:f,y:p},$t(t)):{x:f,y:p};if(f=A.x,p=A.y,l){var F;return Object.assign({},T,(F={},F[m]=v?"0":"",F[_]=b?"0":"",F.transform=(E.devicePixelRatio||1)<=1?"translate("+f+"px, "+p+"px)":"translate3d("+f+"px, "+p+"px, 0)",F))}return Object.assign({},T,(e={},e[m]=v?p+"px":"",e[_]=b?f+"px":"",e.transform="",e))}function xw(s){var e=s.state,t=s.options,i=t.gpuAcceleration,n=i===void 0?!0:i,r=t.adaptive,o=r===void 0?!0:r,a=t.roundOffsets,l=a===void 0?!0:a,h={placement:Ni(e.placement),variation:_r(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Df(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Df(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Rw={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:xw,data:{}};var ba={passive:!0};function Sw(s){var e=s.state,t=s.instance,i=s.options,n=i.scroll,r=n===void 0?!0:n,o=i.resize,a=o===void 0?!0:o,l=$t(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&h.forEach(function(u){u.addEventListener("scroll",t.update,ba)}),a&&l.addEventListener("resize",t.update,ba),function(){r&&h.forEach(function(u){u.removeEventListener("scroll",t.update,ba)}),a&&l.removeEventListener("resize",t.update,ba)}}const Tw={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Sw,data:{}};var Mw={left:"right",right:"left",bottom:"top",top:"bottom"};function Wa(s){return s.replace(/left|right|bottom|top/g,function(e){return Mw[e]})}var Lw={start:"end",end:"start"};function kf(s){return s.replace(/start|end/g,function(e){return Lw[e]})}function Bc(s){var e=$t(s),t=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:t,scrollTop:i}}function Vc(s){return wr(es(s)).left+Bc(s).scrollLeft}function Aw(s,e){var t=$t(s),i=es(s),n=t.visualViewport,r=i.clientWidth,o=i.clientHeight,a=0,l=0;if(n){r=n.width,o=n.height;var h=cm();(h||!h&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:r,height:o,x:a+Vc(s),y:l}}function Pw(s){var e,t=es(s),i=Bc(s),n=(e=s.ownerDocument)==null?void 0:e.body,r=ws(t.scrollWidth,t.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=ws(t.scrollHeight,t.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),a=-i.scrollLeft+Vc(s),l=-i.scrollTop;return wn(n||t).direction==="rtl"&&(a+=ws(t.clientWidth,n?n.clientWidth:0)-r),{width:r,height:o,x:a,y:l}}function Wc(s){var e=wn(s),t=e.overflow,i=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+n+i)}function mm(s){return["html","body","#document"].indexOf(Bi(s))>=0?s.ownerDocument.body:oi(s)&&Wc(s)?s:mm(Hl(s))}function fo(s,e){var t;e===void 0&&(e=[]);var i=mm(s),n=i===((t=s.ownerDocument)==null?void 0:t.body),r=$t(i),o=n?[r].concat(r.visualViewport||[],Wc(i)?i:[]):i,a=e.concat(o);return n?a:a.concat(fo(Hl(o)))}function Eu(s){return Object.assign({},s,{left:s.x,top:s.y,right:s.x+s.width,bottom:s.y+s.height})}function Iw(s,e){var t=wr(s,!1,e==="fixed");return t.top=t.top+s.clientTop,t.left=t.left+s.clientLeft,t.bottom=t.top+s.clientHeight,t.right=t.left+s.clientWidth,t.width=s.clientWidth,t.height=s.clientHeight,t.x=t.left,t.y=t.top,t}function Nf(s,e,t){return e===lm?Eu(Aw(s,t)):Rs(e)?Iw(e,t):Eu(Pw(es(s)))}function Ow(s){var e=fo(Hl(s)),t=["absolute","fixed"].indexOf(wn(s).position)>=0,i=t&&oi(s)?$o(s):s;return Rs(i)?e.filter(function(n){return Rs(n)&&dm(n,i)&&Bi(n)!=="body"}):[]}function Fw(s,e,t,i){var n=e==="clippingParents"?Ow(s):[].concat(e),r=[].concat(n,[t]),o=r[0],a=r.reduce(function(l,h){var u=Nf(s,h,i);return l.top=ws(u.top,l.top),l.right=el(u.right,l.right),l.bottom=el(u.bottom,l.bottom),l.left=ws(u.left,l.left),l},Nf(s,o,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function bm(s){var e=s.reference,t=s.element,i=s.placement,n=i?Ni(i):null,r=i?_r(i):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(n){case Dt:l={x:o,y:e.y-t.height};break;case li:l={x:o,y:e.y+e.height};break;case hi:l={x:e.x+e.width,y:a};break;case kt:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var h=n?Hc(n):null;if(h!=null){var u=h==="y"?"height":"width";switch(r){case yr:l[h]=l[h]-(e[u]/2-t[u]/2);break;case xo:l[h]=l[h]+(e[u]/2-t[u]/2);break}}return l}function Ro(s,e){e===void 0&&(e={});var t=e,i=t.placement,n=i===void 0?s.placement:i,r=t.strategy,o=r===void 0?s.strategy:r,a=t.boundary,l=a===void 0?tw:a,h=t.rootBoundary,u=h===void 0?lm:h,c=t.elementContext,d=c===void 0?jr:c,f=t.altBoundary,g=f===void 0?!1:f,p=t.padding,y=p===void 0?0:p,b=gm(typeof y!="number"?y:pm(y,Xo)),v=d===jr?iw:jr,_=s.rects.popper,m=s.elements[g?v:d],E=Fw(Rs(m)?m:m.contextElement||es(s.elements.popper),l,u,o),C=wr(s.elements.reference),x=bm({reference:C,element:_,strategy:"absolute",placement:n}),w=Eu(Object.assign({},_,x)),R=d===jr?w:C,I={top:E.top-R.top+b.top,bottom:R.bottom-E.bottom+b.bottom,left:E.left-R.left+b.left,right:R.right-E.right+b.right},T=s.modifiersData.offset;if(d===jr&&T){var A=T[n];Object.keys(I).forEach(function(F){var S=[hi,li].indexOf(F)>=0?1:-1,O=[Dt,li].indexOf(F)>=0?"y":"x";I[F]+=A[O]*S})}return I}function Dw(s,e){e===void 0&&(e={});var t=e,i=t.placement,n=t.boundary,r=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,h=l===void 0?hm:l,u=_r(i),c=u?a?Of:Of.filter(function(g){return _r(g)===u}):Xo,d=c.filter(function(g){return h.indexOf(g)>=0});d.length===0&&(d=c);var f=d.reduce(function(g,p){return g[p]=Ro(s,{placement:p,boundary:n,rootBoundary:r,padding:o})[Ni(p)],g},{});return Object.keys(f).sort(function(g,p){return f[g]-f[p]})}function kw(s){if(Ni(s)===Nc)return[];var e=Wa(s);return[kf(s),e,kf(e)]}function Nw(s){var e=s.state,t=s.options,i=s.name;if(!e.modifiersData[i]._skip){for(var n=t.mainAxis,r=n===void 0?!0:n,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,h=t.padding,u=t.boundary,c=t.rootBoundary,d=t.altBoundary,f=t.flipVariations,g=f===void 0?!0:f,p=t.allowedAutoPlacements,y=e.options.placement,b=Ni(y),v=b===y,_=l||(v||!g?[Wa(y)]:kw(y)),m=[y].concat(_).reduce(function(z,me){return z.concat(Ni(me)===Nc?Dw(e,{placement:me,boundary:u,rootBoundary:c,padding:h,flipVariations:g,allowedAutoPlacements:p}):me)},[]),E=e.rects.reference,C=e.rects.popper,x=new Map,w=!0,R=m[0],I=0;I<m.length;I++){var T=m[I],A=Ni(T),F=_r(T)===yr,S=[Dt,li].indexOf(A)>=0,O=S?"width":"height",M=Ro(e,{placement:T,boundary:u,rootBoundary:c,altBoundary:d,padding:h}),D=S?F?hi:kt:F?li:Dt;E[O]>C[O]&&(D=Wa(D));var H=Wa(D),j=[];if(r&&j.push(M[A]<=0),a&&j.push(M[D]<=0,M[H]<=0),j.every(function(z){return z})){R=T,w=!1;break}x.set(T,j)}if(w)for(var V=g?3:1,Y=function(me){var ye=m.find(function(ve){var Ae=x.get(ve);if(Ae)return Ae.slice(0,me).every(function(Xe){return Xe})});if(ye)return R=ye,"break"},K=V;K>0;K--){var Ee=Y(K);if(Ee==="break")break}e.placement!==R&&(e.modifiersData[i]._skip=!0,e.placement=R,e.reset=!0)}}const zw={name:"flip",enabled:!0,phase:"main",fn:Nw,requiresIfExists:["offset"],data:{_skip:!1}};function zf(s,e,t){return t===void 0&&(t={x:0,y:0}),{top:s.top-e.height-t.y,right:s.right-e.width+t.x,bottom:s.bottom-e.height+t.y,left:s.left-e.width-t.x}}function Gf(s){return[Dt,hi,li,kt].some(function(e){return s[e]>=0})}function Gw(s){var e=s.state,t=s.name,i=e.rects.reference,n=e.rects.popper,r=e.modifiersData.preventOverflow,o=Ro(e,{elementContext:"reference"}),a=Ro(e,{altBoundary:!0}),l=zf(o,i),h=zf(a,n,r),u=Gf(l),c=Gf(h);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:h,isReferenceHidden:u,hasPopperEscaped:c},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":c})}const Hw={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Gw};function Bw(s,e,t){var i=Ni(s),n=[kt,Dt].indexOf(i)>=0?-1:1,r=typeof t=="function"?t(Object.assign({},e,{placement:s})):t,o=r[0],a=r[1];return o=o||0,a=(a||0)*n,[kt,hi].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}function Vw(s){var e=s.state,t=s.options,i=s.name,n=t.offset,r=n===void 0?[0,0]:n,o=hm.reduce(function(u,c){return u[c]=Bw(c,e.rects,r),u},{}),a=o[e.placement],l=a.x,h=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=h),e.modifiersData[i]=o}const Ww={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Vw};function Uw(s){var e=s.state,t=s.name;e.modifiersData[t]=bm({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const jw={name:"popperOffsets",enabled:!0,phase:"read",fn:Uw,data:{}};function Yw(s){return s==="x"?"y":"x"}function Xw(s){var e=s.state,t=s.options,i=s.name,n=t.mainAxis,r=n===void 0?!0:n,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,h=t.rootBoundary,u=t.altBoundary,c=t.padding,d=t.tether,f=d===void 0?!0:d,g=t.tetherOffset,p=g===void 0?0:g,y=Ro(e,{boundary:l,rootBoundary:h,padding:c,altBoundary:u}),b=Ni(e.placement),v=_r(e.placement),_=!v,m=Hc(b),E=Yw(m),C=e.modifiersData.popperOffsets,x=e.rects.reference,w=e.rects.popper,R=typeof p=="function"?p(Object.assign({},e.rects,{placement:e.placement})):p,I=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),T=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,A={x:0,y:0};if(C){if(r){var F,S=m==="y"?Dt:kt,O=m==="y"?li:hi,M=m==="y"?"height":"width",D=C[m],H=D+y[S],j=D-y[O],V=f?-w[M]/2:0,Y=v===yr?x[M]:w[M],K=v===yr?-w[M]:-x[M],Ee=e.elements.arrow,z=f&&Ee?Gc(Ee):{width:0,height:0},me=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:fm(),ye=me[S],ve=me[O],Ae=co(0,x[M],z[M]),Xe=_?x[M]/2-V-Ae-ye-I.mainAxis:Y-Ae-ye-I.mainAxis,Ue=_?-x[M]/2+V+Ae+ve+I.mainAxis:K+Ae+ve+I.mainAxis,mt=e.elements.arrow&&$o(e.elements.arrow),Mi=mt?m==="y"?mt.clientTop||0:mt.clientLeft||0:0,Li=(F=T==null?void 0:T[m])!=null?F:0,Sn=D+Xe-Li-Mi,Ai=D+Ue-Li,Bt=co(f?el(H,Sn):H,D,f?ws(j,Ai):j);C[m]=Bt,A[m]=Bt-D}if(a){var Qe,bt=m==="x"?Dt:kt,fi=m==="x"?li:hi,ht=C[E],xt=E==="y"?"height":"width",Vt=ht+y[bt],Rt=ht-y[fi],qt=[Dt,kt].indexOf(b)!==-1,Ge=(Qe=T==null?void 0:T[E])!=null?Qe:0,Tn=qt?Vt:ht-x[xt]-w[xt]-Ge+I.altAxis,Mn=qt?ht+x[xt]+w[xt]-Ge-I.altAxis:Rt,$i=f&&qt?bw(Tn,ht,Mn):co(f?Tn:Vt,ht,f?Mn:Rt);C[E]=$i,A[E]=$i-ht}e.modifiersData[i]=A}}const $w={name:"preventOverflow",enabled:!0,phase:"main",fn:Xw,requiresIfExists:["offset"]};function Kw(s){return{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}}function Zw(s){return s===$t(s)||!oi(s)?Bc(s):Kw(s)}function qw(s){var e=s.getBoundingClientRect(),t=vr(e.width)/s.offsetWidth||1,i=vr(e.height)/s.offsetHeight||1;return t!==1||i!==1}function Jw(s,e,t){t===void 0&&(t=!1);var i=oi(e),n=oi(e)&&qw(e),r=es(e),o=wr(s,n,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!t)&&((Bi(e)!=="body"||Wc(r))&&(a=Zw(e)),oi(e)?(l=wr(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):r&&(l.x=Vc(r))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Qw(s){var e=new Map,t=new Set,i=[];s.forEach(function(r){e.set(r.name,r)});function n(r){t.add(r.name);var o=[].concat(r.requires||[],r.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&n(l)}}),i.push(r)}return s.forEach(function(r){t.has(r.name)||n(r)}),i}function e0(s){var e=Qw(s);return dw.reduce(function(t,i){return t.concat(e.filter(function(n){return n.phase===i}))},[])}function t0(s){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(s())})})),e}}function i0(s){var e=s.reduce(function(t,i){var n=t[i.name];return t[i.name]=n?Object.assign({},n,i,{options:Object.assign({},n.options,i.options),data:Object.assign({},n.data,i.data)}):i,t},{});return Object.keys(e).map(function(t){return e[t]})}var Hf={placement:"bottom",modifiers:[],strategy:"absolute"};function Bf(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function n0(s){s===void 0&&(s={});var e=s,t=e.defaultModifiers,i=t===void 0?[]:t,n=e.defaultOptions,r=n===void 0?Hf:n;return function(a,l,h){h===void 0&&(h=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Hf,r),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},c=[],d=!1,f={state:u,setOptions:function(b){var v=typeof b=="function"?b(u.options):b;p(),u.options=Object.assign({},r,u.options,v),u.scrollParents={reference:Rs(a)?fo(a):a.contextElement?fo(a.contextElement):[],popper:fo(l)};var _=e0(i0([].concat(i,u.options.modifiers)));return u.orderedModifiers=_.filter(function(m){return m.enabled}),g(),f.update()},forceUpdate:function(){if(!d){var b=u.elements,v=b.reference,_=b.popper;if(Bf(v,_)){u.rects={reference:Jw(v,$o(_),u.options.strategy==="fixed"),popper:Gc(_)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(I){return u.modifiersData[I.name]=Object.assign({},I.data)});for(var m=0;m<u.orderedModifiers.length;m++){if(u.reset===!0){u.reset=!1,m=-1;continue}var E=u.orderedModifiers[m],C=E.fn,x=E.options,w=x===void 0?{}:x,R=E.name;typeof C=="function"&&(u=C({state:u,options:w,name:R,instance:f})||u)}}}},update:t0(function(){return new Promise(function(y){f.forceUpdate(),y(u)})}),destroy:function(){p(),d=!0}};if(!Bf(a,l))return f;f.setOptions(h).then(function(y){!d&&h.onFirstUpdate&&h.onFirstUpdate(y)});function g(){u.orderedModifiers.forEach(function(y){var b=y.name,v=y.options,_=v===void 0?{}:v,m=y.effect;if(typeof m=="function"){var E=m({state:u,name:b,instance:f,options:_}),C=function(){};c.push(E||C)}})}function p(){c.forEach(function(y){return y()}),c=[]}return f}}var s0=[Tw,jw,Rw,um,Ww,zw,$w,_w,Hw],r0=n0({defaultModifiers:s0}),o0="tippy-box",ym="tippy-content",a0="tippy-backdrop",vm="tippy-arrow",wm="tippy-svg-arrow",ls={passive:!0,capture:!0},_m=function(){return document.body};function Lh(s,e,t){if(Array.isArray(s)){var i=s[e];return i??(Array.isArray(t)?t[e]:t)}return s}function Uc(s,e){var t={}.toString.call(s);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function Em(s,e){return typeof s=="function"?s.apply(void 0,e):s}function Vf(s,e){if(e===0)return s;var t;return function(i){clearTimeout(t),t=setTimeout(function(){s(i)},e)}}function l0(s){return s.split(/\s+/).filter(Boolean)}function Qs(s){return[].concat(s)}function Wf(s,e){s.indexOf(e)===-1&&s.push(e)}function h0(s){return s.filter(function(e,t){return s.indexOf(e)===t})}function u0(s){return s.split("-")[0]}function tl(s){return[].slice.call(s)}function Uf(s){return Object.keys(s).reduce(function(e,t){return s[t]!==void 0&&(e[t]=s[t]),e},{})}function go(){return document.createElement("div")}function Bl(s){return["Element","Fragment"].some(function(e){return Uc(s,e)})}function c0(s){return Uc(s,"NodeList")}function d0(s){return Uc(s,"MouseEvent")}function f0(s){return!!(s&&s._tippy&&s._tippy.reference===s)}function g0(s){return Bl(s)?[s]:c0(s)?tl(s):Array.isArray(s)?s:tl(document.querySelectorAll(s))}function Ah(s,e){s.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function jf(s,e){s.forEach(function(t){t&&t.setAttribute("data-state",e)})}function p0(s){var e,t=Qs(s),i=t[0];return i!=null&&(e=i.ownerDocument)!=null&&e.body?i.ownerDocument:document}function m0(s,e){var t=e.clientX,i=e.clientY;return s.every(function(n){var r=n.popperRect,o=n.popperState,a=n.props,l=a.interactiveBorder,h=u0(o.placement),u=o.modifiersData.offset;if(!u)return!0;var c=h==="bottom"?u.top.y:0,d=h==="top"?u.bottom.y:0,f=h==="right"?u.left.x:0,g=h==="left"?u.right.x:0,p=r.top-i+c>l,y=i-r.bottom-d>l,b=r.left-t+f>l,v=t-r.right-g>l;return p||y||b||v})}function Ph(s,e,t){var i=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(n){s[i](n,t)})}function Yf(s,e){for(var t=e;t;){var i;if(s.contains(t))return!0;t=t.getRootNode==null||(i=t.getRootNode())==null?void 0:i.host}return!1}var Ii={isTouch:!1},Xf=0;function b0(){Ii.isTouch||(Ii.isTouch=!0,window.performance&&document.addEventListener("mousemove",Cm))}function Cm(){var s=performance.now();s-Xf<20&&(Ii.isTouch=!1,document.removeEventListener("mousemove",Cm)),Xf=s}function y0(){var s=document.activeElement;if(f0(s)){var e=s._tippy;s.blur&&!e.state.isVisible&&s.blur()}}function v0(){document.addEventListener("touchstart",b0,ls),window.addEventListener("blur",y0)}var w0=typeof window<"u"&&typeof document<"u",_0=w0?!!window.msCrypto:!1,E0={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},C0={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},vi=Object.assign({appendTo:_m,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},E0,C0),x0=Object.keys(vi),R0=function(e){var t=Object.keys(e);t.forEach(function(i){vi[i]=e[i]})};function xm(s){var e=s.plugins||[],t=e.reduce(function(i,n){var r=n.name,o=n.defaultValue;if(r){var a;i[r]=s[r]!==void 0?s[r]:(a=vi[r])!=null?a:o}return i},{});return Object.assign({},s,t)}function S0(s,e){var t=e?Object.keys(xm(Object.assign({},vi,{plugins:e}))):x0,i=t.reduce(function(n,r){var o=(s.getAttribute("data-tippy-"+r)||"").trim();if(!o)return n;if(r==="content")n[r]=o;else try{n[r]=JSON.parse(o)}catch{n[r]=o}return n},{});return i}function $f(s,e){var t=Object.assign({},e,{content:Em(e.content,[s])},e.ignoreAttributes?{}:S0(s,e.plugins));return t.aria=Object.assign({},vi.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var T0=function(){return"innerHTML"};function Cu(s,e){s[T0()]=e}function Kf(s){var e=go();return s===!0?e.className=vm:(e.className=wm,Bl(s)?e.appendChild(s):Cu(e,s)),e}function Zf(s,e){Bl(e.content)?(Cu(s,""),s.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Cu(s,e.content):s.textContent=e.content)}function xu(s){var e=s.firstElementChild,t=tl(e.children);return{box:e,content:t.find(function(i){return i.classList.contains(ym)}),arrow:t.find(function(i){return i.classList.contains(vm)||i.classList.contains(wm)}),backdrop:t.find(function(i){return i.classList.contains(a0)})}}function Rm(s){var e=go(),t=go();t.className=o0,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var i=go();i.className=ym,i.setAttribute("data-state","hidden"),Zf(i,s.props),e.appendChild(t),t.appendChild(i),n(s.props,s.props);function n(r,o){var a=xu(e),l=a.box,h=a.content,u=a.arrow;o.theme?l.setAttribute("data-theme",o.theme):l.removeAttribute("data-theme"),typeof o.animation=="string"?l.setAttribute("data-animation",o.animation):l.removeAttribute("data-animation"),o.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?l.setAttribute("role",o.role):l.removeAttribute("role"),(r.content!==o.content||r.allowHTML!==o.allowHTML)&&Zf(h,s.props),o.arrow?u?r.arrow!==o.arrow&&(l.removeChild(u),l.appendChild(Kf(o.arrow))):l.appendChild(Kf(o.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:n}}Rm.$$tippy=!0;var M0=1,ya=[],Ih=[];function L0(s,e){var t=$f(s,Object.assign({},vi,xm(Uf(e)))),i,n,r,o=!1,a=!1,l=!1,h=!1,u,c,d,f=[],g=Vf(Sn,t.interactiveDebounce),p,y=M0++,b=null,v=h0(t.plugins),_={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},m={id:y,reference:s,popper:go(),popperInstance:b,props:t,state:_,plugins:v,clearDelayTimeouts:Tn,setProps:Mn,setContent:$i,show:Bs,hide:Mh,hideWithInteractivity:pa,enable:qt,disable:Ge,unmount:ma,destroy:Ur};if(!t.render)return m;var E=t.render(m),C=E.popper,x=E.onUpdate;C.setAttribute("data-tippy-root",""),C.id="tippy-"+m.id,m.popper=C,s._tippy=m,C._tippy=m;var w=v.map(function(k){return k.fn(m)}),R=s.hasAttribute("aria-expanded");return mt(),V(),D(),H("onCreate",[m]),t.showOnCreate&&Vt(),C.addEventListener("mouseenter",function(){m.props.interactive&&m.state.isVisible&&m.clearDelayTimeouts()}),C.addEventListener("mouseleave",function(){m.props.interactive&&m.props.trigger.indexOf("mouseenter")>=0&&S().addEventListener("mousemove",g)}),m;function I(){var k=m.props.touch;return Array.isArray(k)?k:[k,0]}function T(){return I()[0]==="hold"}function A(){var k;return!!((k=m.props.render)!=null&&k.$$tippy)}function F(){return p||s}function S(){var k=F().parentNode;return k?p0(k):document}function O(){return xu(C)}function M(k){return m.state.isMounted&&!m.state.isVisible||Ii.isTouch||u&&u.type==="focus"?0:Lh(m.props.delay,k?0:1,vi.delay)}function D(k){k===void 0&&(k=!1),C.style.pointerEvents=m.props.interactive&&!k?"":"none",C.style.zIndex=""+m.props.zIndex}function H(k,J,oe){if(oe===void 0&&(oe=!0),w.forEach(function(we){we[k]&&we[k].apply(we,J)}),oe){var Me;(Me=m.props)[k].apply(Me,J)}}function j(){var k=m.props.aria;if(k.content){var J="aria-"+k.content,oe=C.id,Me=Qs(m.props.triggerTarget||s);Me.forEach(function(we){var et=we.getAttribute(J);if(m.state.isVisible)we.setAttribute(J,et?et+" "+oe:oe);else{var ut=et&&et.replace(oe,"").trim();ut?we.setAttribute(J,ut):we.removeAttribute(J)}})}}function V(){if(!(R||!m.props.aria.expanded)){var k=Qs(m.props.triggerTarget||s);k.forEach(function(J){m.props.interactive?J.setAttribute("aria-expanded",m.state.isVisible&&J===F()?"true":"false"):J.removeAttribute("aria-expanded")})}}function Y(){S().removeEventListener("mousemove",g),ya=ya.filter(function(k){return k!==g})}function K(k){if(!(Ii.isTouch&&(l||k.type==="mousedown"))){var J=k.composedPath&&k.composedPath()[0]||k.target;if(!(m.props.interactive&&Yf(C,J))){if(Qs(m.props.triggerTarget||s).some(function(oe){return Yf(oe,J)})){if(Ii.isTouch||m.state.isVisible&&m.props.trigger.indexOf("click")>=0)return}else H("onClickOutside",[m,k]);m.props.hideOnClick===!0&&(m.clearDelayTimeouts(),m.hide(),a=!0,setTimeout(function(){a=!1}),m.state.isMounted||ye())}}}function Ee(){l=!0}function z(){l=!1}function me(){var k=S();k.addEventListener("mousedown",K,!0),k.addEventListener("touchend",K,ls),k.addEventListener("touchstart",z,ls),k.addEventListener("touchmove",Ee,ls)}function ye(){var k=S();k.removeEventListener("mousedown",K,!0),k.removeEventListener("touchend",K,ls),k.removeEventListener("touchstart",z,ls),k.removeEventListener("touchmove",Ee,ls)}function ve(k,J){Xe(k,function(){!m.state.isVisible&&C.parentNode&&C.parentNode.contains(C)&&J()})}function Ae(k,J){Xe(k,J)}function Xe(k,J){var oe=O().box;function Me(we){we.target===oe&&(Ph(oe,"remove",Me),J())}if(k===0)return J();Ph(oe,"remove",c),Ph(oe,"add",Me),c=Me}function Ue(k,J,oe){oe===void 0&&(oe=!1);var Me=Qs(m.props.triggerTarget||s);Me.forEach(function(we){we.addEventListener(k,J,oe),f.push({node:we,eventType:k,handler:J,options:oe})})}function mt(){T()&&(Ue("touchstart",Li,{passive:!0}),Ue("touchend",Ai,{passive:!0})),l0(m.props.trigger).forEach(function(k){if(k!=="manual")switch(Ue(k,Li),k){case"mouseenter":Ue("mouseleave",Ai);break;case"focus":Ue(_0?"focusout":"blur",Bt);break;case"focusin":Ue("focusout",Bt);break}})}function Mi(){f.forEach(function(k){var J=k.node,oe=k.eventType,Me=k.handler,we=k.options;J.removeEventListener(oe,Me,we)}),f=[]}function Li(k){var J,oe=!1;if(!(!m.state.isEnabled||Qe(k)||a)){var Me=((J=u)==null?void 0:J.type)==="focus";u=k,p=k.currentTarget,V(),!m.state.isVisible&&d0(k)&&ya.forEach(function(we){return we(k)}),k.type==="click"&&(m.props.trigger.indexOf("mouseenter")<0||o)&&m.props.hideOnClick!==!1&&m.state.isVisible?oe=!0:Vt(k),k.type==="click"&&(o=!oe),oe&&!Me&&Rt(k)}}function Sn(k){var J=k.target,oe=F().contains(J)||C.contains(J);if(!(k.type==="mousemove"&&oe)){var Me=xt().concat(C).map(function(we){var et,ut=we._tippy,Jt=(et=ut.popperInstance)==null?void 0:et.state;return Jt?{popperRect:we.getBoundingClientRect(),popperState:Jt,props:t}:null}).filter(Boolean);m0(Me,k)&&(Y(),Rt(k))}}function Ai(k){var J=Qe(k)||m.props.trigger.indexOf("click")>=0&&o;if(!J){if(m.props.interactive){m.hideWithInteractivity(k);return}Rt(k)}}function Bt(k){m.props.trigger.indexOf("focusin")<0&&k.target!==F()||m.props.interactive&&k.relatedTarget&&C.contains(k.relatedTarget)||Rt(k)}function Qe(k){return Ii.isTouch?T()!==k.type.indexOf("touch")>=0:!1}function bt(){fi();var k=m.props,J=k.popperOptions,oe=k.placement,Me=k.offset,we=k.getReferenceClientRect,et=k.moveTransition,ut=A()?xu(C).arrow:null,Jt=we?{getBoundingClientRect:we,contextElement:we.contextElement||F()}:s,Ln={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(rs){var Ze=rs.state;if(A()){var Ki=O(),ct=Ki.box;["placement","reference-hidden","escaped"].forEach(function(yt){yt==="placement"?ct.setAttribute("data-placement",Ze.placement):Ze.attributes.popper["data-popper-"+yt]?ct.setAttribute("data-"+yt,""):ct.removeAttribute("data-"+yt)}),Ze.attributes.popper={}}}},Wt=[{name:"offset",options:{offset:Me}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!et}},Ln];A()&&ut&&Wt.push({name:"arrow",options:{element:ut,padding:3}}),Wt.push.apply(Wt,(J==null?void 0:J.modifiers)||[]),m.popperInstance=r0(Jt,C,Object.assign({},J,{placement:oe,onFirstUpdate:d,modifiers:Wt}))}function fi(){m.popperInstance&&(m.popperInstance.destroy(),m.popperInstance=null)}function ht(){var k=m.props.appendTo,J,oe=F();m.props.interactive&&k===_m||k==="parent"?J=oe.parentNode:J=Em(k,[oe]),J.contains(C)||J.appendChild(C),m.state.isMounted=!0,bt()}function xt(){return tl(C.querySelectorAll("[data-tippy-root]"))}function Vt(k){m.clearDelayTimeouts(),k&&H("onTrigger",[m,k]),me();var J=M(!0),oe=I(),Me=oe[0],we=oe[1];Ii.isTouch&&Me==="hold"&&we&&(J=we),J?i=setTimeout(function(){m.show()},J):m.show()}function Rt(k){if(m.clearDelayTimeouts(),H("onUntrigger",[m,k]),!m.state.isVisible){ye();return}if(!(m.props.trigger.indexOf("mouseenter")>=0&&m.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(k.type)>=0&&o)){var J=M(!1);J?n=setTimeout(function(){m.state.isVisible&&m.hide()},J):r=requestAnimationFrame(function(){m.hide()})}}function qt(){m.state.isEnabled=!0}function Ge(){m.hide(),m.state.isEnabled=!1}function Tn(){clearTimeout(i),clearTimeout(n),cancelAnimationFrame(r)}function Mn(k){if(!m.state.isDestroyed){H("onBeforeUpdate",[m,k]),Mi();var J=m.props,oe=$f(s,Object.assign({},J,Uf(k),{ignoreAttributes:!0}));m.props=oe,mt(),J.interactiveDebounce!==oe.interactiveDebounce&&(Y(),g=Vf(Sn,oe.interactiveDebounce)),J.triggerTarget&&!oe.triggerTarget?Qs(J.triggerTarget).forEach(function(Me){Me.removeAttribute("aria-expanded")}):oe.triggerTarget&&s.removeAttribute("aria-expanded"),V(),D(),x&&x(J,oe),m.popperInstance&&(bt(),xt().forEach(function(Me){requestAnimationFrame(Me._tippy.popperInstance.forceUpdate)})),H("onAfterUpdate",[m,k])}}function $i(k){m.setProps({content:k})}function Bs(){var k=m.state.isVisible,J=m.state.isDestroyed,oe=!m.state.isEnabled,Me=Ii.isTouch&&!m.props.touch,we=Lh(m.props.duration,0,vi.duration);if(!(k||J||oe||Me)&&!F().hasAttribute("disabled")&&(H("onShow",[m],!1),m.props.onShow(m)!==!1)){if(m.state.isVisible=!0,A()&&(C.style.visibility="visible"),D(),me(),m.state.isMounted||(C.style.transition="none"),A()){var et=O(),ut=et.box,Jt=et.content;Ah([ut,Jt],0)}d=function(){var Wt;if(!(!m.state.isVisible||h)){if(h=!0,C.offsetHeight,C.style.transition=m.props.moveTransition,A()&&m.props.animation){var Vs=O(),rs=Vs.box,Ze=Vs.content;Ah([rs,Ze],we),jf([rs,Ze],"visible")}j(),V(),Wf(Ih,m),(Wt=m.popperInstance)==null||Wt.forceUpdate(),H("onMount",[m]),m.props.animation&&A()&&Ae(we,function(){m.state.isShown=!0,H("onShown",[m])})}},ht()}}function Mh(){var k=!m.state.isVisible,J=m.state.isDestroyed,oe=!m.state.isEnabled,Me=Lh(m.props.duration,1,vi.duration);if(!(k||J||oe)&&(H("onHide",[m],!1),m.props.onHide(m)!==!1)){if(m.state.isVisible=!1,m.state.isShown=!1,h=!1,o=!1,A()&&(C.style.visibility="hidden"),Y(),ye(),D(!0),A()){var we=O(),et=we.box,ut=we.content;m.props.animation&&(Ah([et,ut],Me),jf([et,ut],"hidden"))}j(),V(),m.props.animation?A()&&ve(Me,m.unmount):m.unmount()}}function pa(k){S().addEventListener("mousemove",g),Wf(ya,g),g(k)}function ma(){m.state.isVisible&&m.hide(),m.state.isMounted&&(fi(),xt().forEach(function(k){k._tippy.unmount()}),C.parentNode&&C.parentNode.removeChild(C),Ih=Ih.filter(function(k){return k!==m}),m.state.isMounted=!1,H("onHidden",[m]))}function Ur(){m.state.isDestroyed||(m.clearDelayTimeouts(),m.unmount(),Mi(),delete s._tippy,m.state.isDestroyed=!0,H("onDestroy",[m]))}}function Vl(s,e){e===void 0&&(e={});var t=vi.plugins.concat(e.plugins||[]);v0();var i=Object.assign({},e,{plugins:t}),n=g0(s),r=n.reduce(function(o,a){var l=a&&L0(a,i);return l&&o.push(l),o},[]);return Bl(s)?r[0]:r}Vl.defaultProps=vi;Vl.setDefaultProps=R0;Vl.currentInput=Ii;Object.assign({},um,{effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow)}});Vl.setDefaultProps({render:Rm});class ji{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const Er={PROPERTYCHANGE:"propertychange"};class Wl{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function A0(s,e,t){let i,n;t=t||zi;let r=0,o=s.length,a=!1;for(;r<o;)i=r+(o-r>>1),n=+t(s[i],e),n<0?r=i+1:(o=i,a=!n);return a?r:~r}function zi(s,e){return s>e?1:s<e?-1:0}function jD(s,e){return s<e?1:s>e?-1:0}function Ul(s,e,t){if(s[0]<=e)return 0;const i=s.length;if(e<=s[i-1])return i-1;if(typeof t=="function"){for(let n=1;n<i;++n){const r=s[n];if(r===e)return n;if(r<e)return t(e,s[n-1],r)>0?n-1:n}return i-1}if(t>0){for(let n=1;n<i;++n)if(s[n]<e)return n-1;return i-1}if(t<0){for(let n=1;n<i;++n)if(s[n]<=e)return n;return i-1}for(let n=1;n<i;++n){if(s[n]==e)return n;if(s[n]<e)return s[n-1]-e<e-s[n]?n-1:n}return i-1}function P0(s,e,t){for(;e<t;){const i=s[e];s[e]=s[t],s[t]=i,++e,--t}}function Re(s,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let n=0;n<i;n++)s[s.length]=t[n]}function ts(s,e){const t=s.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(s[i]!==e[i])return!1;return!0}function I0(s,e,t){const i=e||zi;return s.every(function(n,r){if(r===0)return!0;const o=i(s[r-1],n);return!(o>0||o===0)})}function So(){return!0}function Ko(){return!1}function Cr(){}function Sm(s){let e,t,i;return function(){const n=Array.prototype.slice.call(arguments);return(!t||this!==i||!ts(n,t))&&(i=this,t=n,e=s.apply(this,arguments)),e}}function Tm(s){function e(){let t;try{t=s()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Zo(s){for(const e in s)delete s[e]}function Ss(s){let e;for(e in s)return!1;return!e}class qo extends Wl{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),n=i[e]||(i[e]=[]);n.includes(t)||n.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const r=t?new ji(e):e;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let h=0,u=n.length;h<u;++h)if("handleEvent"in n[h]?l=n[h].handleEvent(r):l=n[h].call(this,r),l===!1||r.propagationStopped){l=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,Cr);delete o[i]}return l}disposeInternal(){this.listeners_&&Zo(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const n=i.indexOf(t);n!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[n]=Cr,++this.pendingRemovals_[e]):(i.splice(n,1),i.length===0&&delete this.listeners_[e]))}}const ce={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Ce(s,e,t,i,n){if(n){const o=t;t=function(){s.removeEventListener(e,t),o.apply(i??this,arguments)}}else i&&i!==s&&(t=t.bind(i));const r={target:s,type:e,listener:t};return s.addEventListener(e,t),r}function il(s,e,t,i){return Ce(s,e,t,i,!0)}function Ie(s){s&&s.target&&(s.target.removeEventListener(s.type,s.listener),Zo(s))}class Jo extends qo{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ce.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ce(this,e[r],t);return n}return Ce(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const n=e.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=il(this,e[r],t)}else i=il(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)O0(i);else if(Array.isArray(e))for(let n=0,r=e.length;n<r;++n)this.removeEventListener(e[n],t);else this.removeEventListener(e,t)}}Jo.prototype.on;Jo.prototype.once;Jo.prototype.un;function O0(s){if(Array.isArray(s))for(let e=0,t=s.length;e<t;++e)Ie(s[e]);else Ie(s)}function ne(){throw new Error("Unimplemented abstract method.")}let F0=0;function ge(s){return s.ol_uid||(s.ol_uid=String(++F0))}class qf extends ji{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class Ri extends Jo{constructor(e){super(),this.on,this.once,this.un,ge(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new qf(i,e,t)),i=Er.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new qf(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const n=this.values_||(this.values_={});if(i)n[e]=t;else{const r=n[e];n[e]=t,r!==t&&this.notify(e,r)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],Ss(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const Mt={ADD:"add",REMOVE:"remove"},Jf={LENGTH:"length"};class va extends ji{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Oi extends Ri{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let i=0,n=this.array_.length;i<n;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,n=t.length;i<n;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(Jf.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new va(Mt.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,n=t.length;i<n;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new va(Mt.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const n=this.array_[e];this.array_[e]=t,this.dispatchEvent(new va(Mt.REMOVE,n,e)),this.dispatchEvent(new va(Mt.ADD,t,e))}updateLength_(){this.set(Jf.LENGTH,this.array_.length)}assertUnique_(e,t){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function be(s,e){if(!s)throw new Error(e)}class di extends Ri{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new di(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ie(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Ce(e,ce.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?D0(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function D0(s){if(typeof s=="function")return s;let e;return Array.isArray(s)?e=s:(be(typeof s.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[s]),function(){return e}}const jc=new Array(6);function Xt(){return[1,0,0,1,0,0]}function Qf(s){return jl(s,1,0,0,1,0,0)}function Qo(s,e){const t=s[0],i=s[1],n=s[2],r=s[3],o=s[4],a=s[5],l=e[0],h=e[1],u=e[2],c=e[3],d=e[4],f=e[5];return s[0]=t*l+n*h,s[1]=i*l+r*h,s[2]=t*u+n*c,s[3]=i*u+r*c,s[4]=t*d+n*f+o,s[5]=i*d+r*f+a,s}function jl(s,e,t,i,n,r,o){return s[0]=e,s[1]=t,s[2]=i,s[3]=n,s[4]=r,s[5]=o,s}function k0(s,e){return s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[3],s[4]=e[4],s[5]=e[5],s}function $e(s,e){const t=e[0],i=e[1];return e[0]=s[0]*t+s[2]*i+s[4],e[1]=s[1]*t+s[3]*i+s[5],e}function YD(s,e){const t=Math.cos(e),i=Math.sin(e);return Qo(s,jl(jc,t,i,-i,t,0,0))}function Ua(s,e,t){return Qo(s,jl(jc,e,0,0,t,0,0))}function N0(s,e,t){return Qo(s,jl(jc,1,0,0,1,e,t))}function Vi(s,e,t,i,n,r,o,a){const l=Math.sin(r),h=Math.cos(r);return s[0]=i*h,s[1]=n*l,s[2]=-i*l,s[3]=n*h,s[4]=o*i*h-a*i*l+e,s[5]=o*n*l+a*n*h+t,s}function Mm(s,e){const t=z0(e);be(t!==0,"Transformation matrix cannot be inverted");const i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5];return s[0]=o/t,s[1]=-n/t,s[2]=-r/t,s[3]=i/t,s[4]=(r*l-o*a)/t,s[5]=-(i*l-n*a)/t,s}function z0(s){return s[0]*s[3]-s[1]*s[2]}const eg=[1e6,1e6,1e6,1e6,2,2];function G0(s){return"matrix("+s.map((t,i)=>Math.round(t*eg[i])/eg[i]).join(", ")+")"}const tt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function To(s){const e=Kt();for(let t=0,i=s.length;t<i;++t)po(e,s[t]);return e}function H0(s,e,t){const i=Math.min.apply(null,s),n=Math.min.apply(null,e),r=Math.max.apply(null,s),o=Math.max.apply(null,e);return ui(i,n,r,o,t)}function Ts(s,e,t){return t?(t[0]=s[0]-e,t[1]=s[1]-e,t[2]=s[2]+e,t[3]=s[3]+e,t):[s[0]-e,s[1]-e,s[2]+e,s[3]+e]}function Lm(s,e){return e?(e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e):s.slice()}function Ds(s,e,t){let i,n;return e<s[0]?i=s[0]-e:s[2]<e?i=e-s[2]:i=0,t<s[1]?n=s[1]-t:s[3]<t?n=t-s[3]:n=0,i*i+n*n}function Ms(s,e){return Yc(s,e[0],e[1])}function ii(s,e){return s[0]<=e[0]&&e[2]<=s[2]&&s[1]<=e[1]&&e[3]<=s[3]}function Yc(s,e,t){return s[0]<=e&&e<=s[2]&&s[1]<=t&&t<=s[3]}function Ru(s,e){const t=s[0],i=s[1],n=s[2],r=s[3],o=e[0],a=e[1];let l=tt.UNKNOWN;return o<t?l=l|tt.LEFT:o>n&&(l=l|tt.RIGHT),a<i?l=l|tt.BELOW:a>r&&(l=l|tt.ABOVE),l===tt.UNKNOWN&&(l=tt.INTERSECTING),l}function Kt(){return[1/0,1/0,-1/0,-1/0]}function ui(s,e,t,i,n){return n?(n[0]=s,n[1]=e,n[2]=t,n[3]=i,n):[s,e,t,i]}function Fr(s){return ui(1/0,1/0,-1/0,-1/0,s)}function Am(s,e){const t=s[0],i=s[1];return ui(t,i,t,i,e)}function Xc(s,e,t,i,n){const r=Fr(n);return Im(r,s,e,t,i)}function Ls(s,e){return s[0]==e[0]&&s[2]==e[2]&&s[1]==e[1]&&s[3]==e[3]}function Pm(s,e){return e[0]<s[0]&&(s[0]=e[0]),e[2]>s[2]&&(s[2]=e[2]),e[1]<s[1]&&(s[1]=e[1]),e[3]>s[3]&&(s[3]=e[3]),s}function po(s,e){e[0]<s[0]&&(s[0]=e[0]),e[0]>s[2]&&(s[2]=e[0]),e[1]<s[1]&&(s[1]=e[1]),e[1]>s[3]&&(s[3]=e[1])}function Im(s,e,t,i,n){for(;t<i;t+=n)B0(s,e[t],e[t+1]);return s}function B0(s,e,t){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}function $c(s,e){let t;return t=e(Yl(s)),t||(t=e(Xl(s)),t)||(t=e($l(s)),t)||(t=e(is(s)),t)?t:!1}function Mo(s){let e=0;return ks(s)||(e=_e(s)*Ke(s)),e}function Yl(s){return[s[0],s[1]]}function Xl(s){return[s[2],s[1]]}function Wi(s){return[(s[0]+s[2])/2,(s[1]+s[3])/2]}function V0(s,e){let t;if(e==="bottom-left")t=Yl(s);else if(e==="bottom-right")t=Xl(s);else if(e==="top-left")t=is(s);else if(e==="top-right")t=$l(s);else throw new Error("Invalid corner");return t}function Lo(s,e,t,i,n){const[r,o,a,l,h,u,c,d]=W0(s,e,t,i);return ui(Math.min(r,a,h,c),Math.min(o,l,u,d),Math.max(r,a,h,c),Math.max(o,l,u,d),n)}function W0(s,e,t,i){const n=e*i[0]/2,r=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),l=n*o,h=n*a,u=r*o,c=r*a,d=s[0],f=s[1];return[d-l+c,f-h-u,d-l-c,f-h+u,d+l-c,f+h+u,d+l+c,f+h-u,d-l+c,f-h-u]}function Ke(s){return s[3]-s[1]}function Ot(s,e,t){const i=t||Kt();return je(s,e)?(s[0]>e[0]?i[0]=s[0]:i[0]=e[0],s[1]>e[1]?i[1]=s[1]:i[1]=e[1],s[2]<e[2]?i[2]=s[2]:i[2]=e[2],s[3]<e[3]?i[3]=s[3]:i[3]=e[3]):Fr(i),i}function is(s){return[s[0],s[3]]}function $l(s){return[s[2],s[3]]}function _e(s){return s[2]-s[0]}function je(s,e){return s[0]<=e[2]&&s[2]>=e[0]&&s[1]<=e[3]&&s[3]>=e[1]}function ks(s){return s[2]<s[0]||s[3]<s[1]}function U0(s,e){return e?(e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e):s}function j0(s,e,t){let i=!1;const n=Ru(s,e),r=Ru(s,t);if(n===tt.INTERSECTING||r===tt.INTERSECTING)i=!0;else{const o=s[0],a=s[1],l=s[2],h=s[3],u=e[0],c=e[1],d=t[0],f=t[1],g=(f-c)/(d-u);let p,y;r&tt.ABOVE&&!(n&tt.ABOVE)&&(p=d-(f-h)/g,i=p>=o&&p<=l),!i&&r&tt.RIGHT&&!(n&tt.RIGHT)&&(y=f-(d-l)*g,i=y>=a&&y<=h),!i&&r&tt.BELOW&&!(n&tt.BELOW)&&(p=d-(f-a)/g,i=p>=o&&p<=l),!i&&r&tt.LEFT&&!(n&tt.LEFT)&&(y=f-(d-o)*g,i=y>=a&&y<=h)}return i}function Y0(s,e,t,i){if(ks(s))return Fr(t);let n=[];n=[s[0],s[1],s[2],s[1],s[2],s[3],s[0],s[3]],e(n,n,2);const r=[],o=[];for(let a=0,l=n.length;a<l;a+=2)r.push(n[a]),o.push(n[a+1]);return H0(r,o,t)}function Om(s,e){const t=e.getExtent(),i=Wi(s);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const n=_e(t),o=Math.floor((i[0]-t[0])/n)*n;s[0]-=o,s[2]-=o}return s}function Kc(s,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(s[0])||!isFinite(s[2]))return[[i[0],s[1],i[2],s[3]]];Om(s,e);const n=_e(i);if(_e(s)>n&&!t)return[[i[0],s[1],i[2],s[3]]];if(s[0]<i[0])return[[s[0]+n,s[1],i[2],s[3]],[i[0],s[1],s[2],s[3]]];if(s[2]>i[2])return[[s[0],s[1],i[2],s[3]],[i[0],s[1],s[2]-n,s[3]]]}return[s]}const X0={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function XD(s){return X0[s]}const Ao={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Zc{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ao[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const ea=6378137,sr=Math.PI*ea,$0=[-sr,-sr,sr,sr],K0=[-180,-85,180,85],wa=ea*Math.log(Math.tan(Math.PI/2));class Ws extends Zc{constructor(e){super({code:e,units:"m",extent:$0,global:!0,worldExtent:K0,getPointResolution:function(t,i){return t/Math.cosh(i[1]/ea)}})}}const tg=[new Ws("EPSG:3857"),new Ws("EPSG:102100"),new Ws("EPSG:102113"),new Ws("EPSG:900913"),new Ws("http://www.opengis.net/def/crs/EPSG/0/3857"),new Ws("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Z0(s,e,t,i){const n=s.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=s.slice():e=new Array(n));for(let r=0;r<n;r+=i){e[r]=sr*s[r]/180;let o=ea*Math.log(Math.tan(Math.PI*(+s[r+1]+90)/360));o>wa?o=wa:o<-wa&&(o=-wa),e[r+1]=o}return e}function q0(s,e,t,i){const n=s.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=s.slice():e=new Array(n));for(let r=0;r<n;r+=i)e[r]=180*s[r]/sr,e[r+1]=360*Math.atan(Math.exp(s[r+1]/ea))/Math.PI-90;return e}const J0=6378137,ig=[-180,-90,180,90],Q0=Math.PI*J0/180;class os extends Zc{constructor(e,t){super({code:e,units:"degrees",extent:ig,axisOrientation:t,global:!0,metersPerUnit:Q0,worldExtent:ig})}}const ng=[new os("CRS:84"),new os("EPSG:4326","neu"),new os("urn:ogc:def:crs:OGC:1.3:CRS84"),new os("urn:ogc:def:crs:OGC:2:84"),new os("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new os("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new os("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Su={};function e_(s){return Su[s]||Su[s.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function t_(s,e){Su[s]=e}let fr={};function xr(s,e,t){const i=s.getCode(),n=e.getCode();i in fr||(fr[i]={}),fr[i][n]=t}function i_(s,e){let t;return s in fr&&e in fr[s]&&(t=fr[s][e]),t}function ze(s,e,t){return Math.min(Math.max(s,e),t)}function n_(s,e,t,i,n,r){const o=n-t,a=r-i;if(o!==0||a!==0){const l=((s-t)*o+(e-i)*a)/(o*o+a*a);l>1?(t=n,i=r):l>0&&(t+=o*l,i+=a*l)}return _s(s,e,t,i)}function _s(s,e,t,i){const n=t-s,r=i-e;return n*n+r*r}function s_(s){const e=s.length;for(let i=0;i<e;i++){let n=i,r=Math.abs(s[i][i]);for(let a=i+1;a<e;a++){const l=Math.abs(s[a][i]);l>r&&(r=l,n=a)}if(r===0)return null;const o=s[n];s[n]=s[i],s[i]=o;for(let a=i+1;a<e;a++){const l=-s[a][i]/s[i][i];for(let h=i;h<e+1;h++)i==h?s[a][h]=0:s[a][h]+=l*s[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=s[i][e]/s[i][i];for(let n=i-1;n>=0;n--)s[n][e]-=s[n][i]*t[i]}return t}function Tu(s){return s*180/Math.PI}function Gi(s){return s*Math.PI/180}function Zn(s,e){const t=s%e;return t*e<0?t+e:t}function jt(s,e,t){return s+t*(e-s)}function Kl(s,e){const t=Math.pow(10,e);return Math.round(s*t)/t}function sg(s,e){return Math.round(Kl(s,e))}function rr(s,e){return Math.floor(Kl(s,e))}function Un(s,e){return Math.ceil(Kl(s,e))}function Yr(s,e,t){const i=t!==void 0?s.toFixed(t):""+s;let n=i.indexOf(".");return n=n===-1?i.length:n,n>e?i:new Array(1+e-n).join("0")+i}function qc(s,e){const t=(""+s).split("."),i=(""+e).split(".");for(let n=0;n<Math.max(t.length,i.length);n++){const r=parseInt(t[n]||"0",10),o=parseInt(i[n]||"0",10);if(r>o)return 1;if(o>r)return-1}return 0}function r_(s,e){return s[0]+=+e[0],s[1]+=+e[1],s}function $D(s,e){const t=e.getRadius(),i=e.getCenter(),n=i[0],r=i[1],o=s[0],a=s[1];let l=o-n;const h=a-r;l===0&&h===0&&(l=1);const u=Math.sqrt(l*l+h*h),c=n+t*l/u,d=r+t*h/u;return[c,d]}function o_(s,e){const t=s[0],i=s[1],n=e[0],r=e[1],o=n[0],a=n[1],l=r[0],h=r[1],u=l-o,c=h-a,d=u===0&&c===0?0:(u*(t-o)+c*(i-a))/(u*u+c*c||0);let f,g;return d<=0?(f=o,g=a):d>=1?(f=l,g=h):(f=o+d*u,g=a+d*c),[f,g]}function nl(s,e){let t=!0;for(let i=s.length-1;i>=0;--i)if(s[i]!=e[i]){t=!1;break}return t}function Jc(s,e){const t=Math.cos(e),i=Math.sin(e),n=s[0]*t-s[1]*i,r=s[1]*t+s[0]*i;return s[0]=n,s[1]=r,s}function a_(s,e){return s[0]*=e,s[1]*=e,s}function Fm(s,e){const t=s[0]-e[0],i=s[1]-e[1];return t*t+i*i}function KD(s,e){return Math.sqrt(Fm(s,e))}function ZD(s,e){return Fm(s,o_(s,e))}function Qc(s,e){if(e.canWrapX()){const t=_e(e.getExtent()),i=Dm(s,e,t);i&&(s[0]-=i*t)}return s}function Dm(s,e,t){const i=e.getExtent();let n=0;return e.canWrapX()&&(s[0]<i[0]||s[0]>i[2])&&(t=t||_e(i),n=Math.floor((s[0]-i[0])/t)),n}const ed=63710088e-1;function rg(s,e,t){t=t||ed;const i=Gi(s[1]),n=Gi(e[1]),r=(n-i)/2,o=Gi(e[0]-s[0])/2,a=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(n);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function _a(s,e){let t=0;const i=s.length;let n=s[i-1][0],r=s[i-1][1];for(let o=0;o<i;o++){const a=s[o][0],l=s[o][1];t+=Gi(a-n)*(2+Math.sin(Gi(r))+Math.sin(Gi(l))),n=a,r=l}return t*e*e/2}function l_(s,e){e=e||{};const t=e.radius||ed,i=e.projection||"EPSG:3857",n=s.getType();n!=="GeometryCollection"&&(s=s.clone().transform(i,"EPSG:4326"));let r=0,o,a,l,h,u,c;switch(n){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":{for(o=s.getCoordinates(),r=Math.abs(_a(o[0],t)),l=1,h=o.length;l<h;++l)r-=Math.abs(_a(o[l],t));break}case"MultiPolygon":{for(o=s.getCoordinates(),l=0,h=o.length;l<h;++l)for(a=o[l],r+=Math.abs(_a(a[0],t)),u=1,c=a.length;u<c;++u)r-=Math.abs(_a(a[u],t));break}case"GeometryCollection":{const d=s.getGeometries();for(l=0,h=d.length;l<h;++l)r+=l_(d[l],e);break}default:throw new Error("Unsupported geometry type: "+n)}return r}function h_(s,e,t,i){i=i||ed;const n=Gi(s[1]),r=Gi(s[0]),o=e/i,a=Math.asin(Math.sin(n)*Math.cos(o)+Math.cos(n)*Math.sin(o)*Math.cos(t)),l=r+Math.atan2(Math.sin(t)*Math.sin(o)*Math.cos(n),Math.cos(o)-Math.sin(n)*Math.sin(a));return[Tu(l),Tu(a)]}function km(...s){console.warn(...s)}function qD(...s){console.error(...s)}let Mu=!0;function Nm(s){Mu=!1}function td(s,e){if(e!==void 0){for(let t=0,i=s.length;t<i;++t)e[t]=s[t];e=e}else e=s.slice();return e}function zm(s,e){if(e!==void 0&&s!==e){for(let t=0,i=s.length;t<i;++t)e[t]=s[t];s=e}return s}function u_(s){t_(s.getCode(),s),xr(s,s,td)}function c_(s){s.forEach(u_)}function he(s){return typeof s=="string"?e_(s):s||null}function og(s,e,t,i){s=he(s);let n;const r=s.getPointResolutionFunc();if(r){if(n=r(e,t),i&&i!==s.getUnits()){const o=s.getMetersPerUnit();o&&(n=n*o/Ao[i])}}else{const o=s.getUnits();if(o=="degrees"&&!i||i=="degrees")n=e;else{const a=Zl(s,he("EPSG:4326"));if(a===zm&&o!=="degrees")n=e*s.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=a(h,h,2);const u=rg(h.slice(0,2),h.slice(2,4)),c=rg(h.slice(4,6),h.slice(6,8));n=(u+c)/2}const l=i?Ao[i]:s.getMetersPerUnit();l!==void 0&&(n/=l)}}return n}function ag(s){c_(s),s.forEach(function(e){s.forEach(function(t){e!==t&&xr(e,t,td)})})}function d_(s,e,t,i){s.forEach(function(n){e.forEach(function(r){xr(n,r,t),xr(r,n,i)})})}function id(s,e){return s?typeof s=="string"?he(s):s:he(e)}function lg(s){return function(e,t,i,n){const r=e.length;i=i!==void 0?i:2,n=n??i,t=t!==void 0?t:new Array(r);for(let o=0;o<r;o+=n){const a=s(e.slice(o,o+i)),l=a.length;for(let h=0,u=n;h<u;++h)t[o+h]=h>=l?e[o+h]:a[h]}return t}}function JD(s,e,t,i){const n=he(s),r=he(e);xr(n,r,lg(t)),xr(r,n,lg(i))}function QD(s,e){return Nm(),ql(s,"EPSG:4326",e!==void 0?e:"EPSG:3857")}function gn(s,e){if(s===e)return!0;const t=s.getUnits()===e.getUnits();return(s.getCode()===e.getCode()||Zl(s,e)===td)&&t}function Zl(s,e){const t=s.getCode(),i=e.getCode();let n=i_(t,i);return n||(n=zm),n}function Rr(s,e){const t=he(s),i=he(e);return Zl(t,i)}function ql(s,e,t){return Rr(e,t)(s,void 0,s.length)}function Gm(s,e,t,i){const n=Rr(e,t);return Y0(s,n,void 0)}let f_=null;function g_(){return f_}function Lu(s,e){return s}function nn(s,e){return Mu&&!nl(s,[0,0])&&s[0]>=-180&&s[0]<=180&&s[1]>=-90&&s[1]<=90&&(Mu=!1,km("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),s}function nd(s,e){return s}function Fi(s,e){return s}function ek(s,e,t){return function(i){let n,r;if(s.canWrapX()){const o=s.getExtent(),a=_e(o);i=i.slice(0),r=Dm(i,s,a),r&&(i[0]=i[0]-r*a),i[0]=ze(i[0],o[0],o[2]),i[1]=ze(i[1],o[1],o[3]),n=t(i)}else n=t(i);return r&&e.canWrapX()&&(n[0]+=r*_e(e.getExtent())),n}}function p_(){ag(tg),ag(ng),d_(ng,tg,Z0,q0)}p_();function qn(s,e,t,i,n,r,o){r=r||[],o=o||2;let a=0;for(let l=e;l<t;l+=i){const h=s[l],u=s[l+1];r[a++]=n[0]*h+n[2]*u+n[4],r[a++]=n[1]*h+n[3]*u+n[5];for(let c=2;c<o;c++)r[a++]=s[l+c]}return r&&r.length!=a&&(r.length=a),r}function sd(s,e,t,i,n,r,o){o=o||[];const a=Math.cos(n),l=Math.sin(n),h=r[0],u=r[1];let c=0;for(let d=e;d<t;d+=i){const f=s[d]-h,g=s[d+1]-u;o[c++]=h+f*a-g*l,o[c++]=u+f*l+g*a;for(let p=d+2;p<d+i;++p)o[c++]=s[p]}return o&&o.length!=c&&(o.length=c),o}function m_(s,e,t,i,n,r,o,a){a=a||[];const l=o[0],h=o[1];let u=0;for(let c=e;c<t;c+=i){const d=s[c]-l,f=s[c+1]-h;a[u++]=l+n*d,a[u++]=h+r*f;for(let g=c+2;g<c+i;++g)a[u++]=s[g]}return a&&a.length!=u&&(a.length=u),a}function b_(s,e,t,i,n,r,o){o=o||[];let a=0;for(let l=e;l<t;l+=i){o[a++]=s[l]+n,o[a++]=s[l+1]+r;for(let h=l+2;h<l+i;++h)o[a++]=s[h]}return o&&o.length!=a&&(o.length=a),o}const hg=Xt();class rd extends Ri{constructor(){super(),this.extent_=Kt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Sm((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return ne()}closestPointXY(e,t,i,n){return ne()}containsXY(e,t){const i=this.getClosestPoint([e,t]);return i[0]===e&&i[1]===t}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return ne()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Fr(t),this.extentRevision_=this.getRevision()}return U0(this.extent_,e)}rotate(e,t){ne()}scale(e,t,i){ne()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return ne()}getType(){return ne()}applyTransform(e){ne()}intersectsExtent(e){return ne()}translate(e,t){ne()}transform(e,t){const i=he(e),n=i.getUnits()=="tile-pixels"?function(r,o,a){const l=i.getExtent(),h=i.getWorldExtent(),u=Ke(h)/Ke(l);return Vi(hg,h[0],h[3],u,-u,0,0,0),qn(r,0,r.length,a,hg,o),Rr(i,t)(r,o,a)}:Rr(i,t);return this.applyTransform(n),this}}class ns extends rd{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Xc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return ne()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=ug(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){ne()}setLayout(e,t,i){let n;if(e)n=ug(e);else{for(let r=0;r<i;++r){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}n=t.length,e=Ns(n)}this.layout=e,this.stride=n}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const n=this.getStride();sd(i,0,i.length,n,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=Wi(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();m_(n,0,n.length,r,e,t,i,n),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const n=this.getStride();b_(i,0,i.length,n,e,t,i),this.changed()}}}function Ns(s){let e;return s==2?e="XY":s==3?e="XYZ":s==4&&(e="XYZM"),e}function ug(s){let e;return s=="XY"?e=2:s=="XYZ"||s=="XYM"?e=3:s=="XYZM"&&(e=4),e}function y_(s,e,t){const i=s.getFlatCoordinates();if(!i)return null;const n=s.getStride();return qn(i,0,i.length,n,e,t)}function cg(s,e,t,i,n,r,o){const a=s[e],l=s[e+1],h=s[t]-a,u=s[t+1]-l;let c;if(h===0&&u===0)c=e;else{const d=((n-a)*h+(r-l)*u)/(h*h+u*u);if(d>1)c=t;else if(d>0){for(let f=0;f<i;++f)o[f]=jt(s[e+f],s[t+f],d);o.length=i;return}else c=e}for(let d=0;d<i;++d)o[d]=s[c+d];o.length=i}function od(s,e,t,i,n){let r=s[e],o=s[e+1];for(e+=i;e<t;e+=i){const a=s[e],l=s[e+1],h=_s(r,o,a,l);h>n&&(n=h),r=a,o=l}return n}function ad(s,e,t,i,n){for(let r=0,o=t.length;r<o;++r){const a=t[r];n=od(s,e,a,i,n),e=a}return n}function v_(s,e,t,i,n){for(let r=0,o=t.length;r<o;++r){const a=t[r];n=ad(s,e,a,i,n),e=a[a.length-1]}return n}function ld(s,e,t,i,n,r,o,a,l,h,u){if(e==t)return h;let c,d;if(n===0){if(d=_s(o,a,s[e],s[e+1]),d<h){for(c=0;c<i;++c)l[c]=s[e+c];return l.length=i,d}return h}u=u||[NaN,NaN];let f=e+i;for(;f<t;)if(cg(s,f-i,f,i,o,a,u),d=_s(o,a,u[0],u[1]),d<h){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(h))/n|0,1);if(r&&(cg(s,t-i,e,i,o,a,u),d=_s(o,a,u[0],u[1]),d<h)){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i}return h}function hd(s,e,t,i,n,r,o,a,l,h,u){u=u||[NaN,NaN];for(let c=0,d=t.length;c<d;++c){const f=t[c];h=ld(s,e,f,i,n,r,o,a,l,h,u),e=f}return h}function w_(s,e,t,i,n,r,o,a,l,h,u){u=u||[NaN,NaN];for(let c=0,d=t.length;c<d;++c){const f=t[c];h=hd(s,e,f,i,n,r,o,a,l,h,u),e=f[f.length-1]}return h}function Hm(s,e,t,i){for(let n=0,r=t.length;n<r;++n)s[e++]=t[n];return e}function Jl(s,e,t,i){for(let n=0,r=t.length;n<r;++n){const o=t[n];for(let a=0;a<i;++a)s[e++]=o[a]}return e}function ta(s,e,t,i,n){n=n||[];let r=0;for(let o=0,a=t.length;o<a;++o){const l=Jl(s,e,t[o],i);n[r++]=l,e=l}return n.length=r,n}function Bm(s,e,t,i,n){n=n||[];let r=0;for(let o=0,a=t.length;o<a;++o){const l=ta(s,e,t[o],i,n[r]);l.length===0&&(l[0]=e),n[r++]=l,e=l[l.length-1]}return n.length=r,n}function Ql(s,e,t,i,n,r,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)r[o++]=s[e],r[o++]=s[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[e,t-i];let u=0;for(;h.length>0;){const c=h.pop(),d=h.pop();let f=0;const g=s[d],p=s[d+1],y=s[c],b=s[c+1];for(let v=d+i;v<c;v+=i){const _=s[v],m=s[v+1],E=n_(_,m,g,p,y,b);E>f&&(u=v,f=E)}f>n&&(l[(u-e)/i]=1,d+i<u&&h.push(d,u),u+i<c&&h.push(u,c))}for(let c=0;c<a;++c)l[c]&&(r[o++]=s[e+c*i],r[o++]=s[e+c*i+1]);return o}function Vm(s,e,t,i,n,r,o,a){for(let l=0,h=t.length;l<h;++l){const u=t[l];o=Ql(s,e,u,i,n,r,o),a.push(o),e=u}return o}function hs(s,e){return e*Math.round(s/e)}function __(s,e,t,i,n,r,o){if(e==t)return o;let a=hs(s[e],n),l=hs(s[e+1],n);e+=i,r[o++]=a,r[o++]=l;let h,u;do if(h=hs(s[e],n),u=hs(s[e+1],n),e+=i,e==t)return r[o++]=h,r[o++]=u,o;while(h==a&&u==l);for(;e<t;){const c=hs(s[e],n),d=hs(s[e+1],n);if(e+=i,c==h&&d==u)continue;const f=h-a,g=u-l,p=c-a,y=d-l;if(f*y==g*p&&(f<0&&p<f||f==p||f>0&&p>f)&&(g<0&&y<g||g==y||g>0&&y>g)){h=c,u=d;continue}r[o++]=h,r[o++]=u,a=h,l=u,h=c,u=d}return r[o++]=h,r[o++]=u,o}function ud(s,e,t,i,n,r,o,a){for(let l=0,h=t.length;l<h;++l){const u=t[l];o=__(s,e,u,i,n,r,o),a.push(o),e=u}return o}function E_(s,e,t,i,n,r,o,a){for(let l=0,h=t.length;l<h;++l){const u=t[l],c=[];o=ud(s,e,u,i,n,r,o,c),a.push(c),e=u[u.length-1]}return o}function jn(s,e,t,i,n){n=n!==void 0?n:[];let r=0;for(let o=e;o<t;o+=i)n[r++]=s.slice(o,o+i);return n.length=r,n}function Po(s,e,t,i,n){n=n!==void 0?n:[];let r=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];n[r++]=jn(s,e,l,i,n[r]),e=l}return n.length=r,n}function Au(s,e,t,i,n){n=n!==void 0?n:[];let r=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];n[r++]=l.length===1&&l[0]===e?[]:Po(s,e,l,i,n[r]),e=l[l.length-1]}return n.length=r,n}function Wm(s,e,t,i){let n=0;const r=s[t-i],o=s[t-i+1];let a=0,l=0;for(;e<t;e+=i){const h=s[e]-r,u=s[e+1]-o;n+=l*h-a*u,a=h,l=u}return n/2}function Um(s,e,t,i){let n=0;for(let r=0,o=t.length;r<o;++r){const a=t[r];n+=Wm(s,e,a,i),e=a}return n}function C_(s,e,t,i){let n=0;for(let r=0,o=t.length;r<o;++r){const a=t[r];n+=Um(s,e,a,i),e=a[a.length-1]}return n}class Sr extends ns{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Sr(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,n){return n<Ds(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(od(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ld(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,n))}getArea(){return Wm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Ql(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Sr(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Jl(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ei extends ns{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new Ei(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,n){const r=this.flatCoordinates,o=_s(e,t,r[0],r[1]);if(o<n){const a=this.stride;for(let l=0;l<a;++l)i[l]=r[l];return i.length=a,o}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Am(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Yc(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hm(this.flatCoordinates,0,e,this.stride),this.changed()}}function x_(s,e,t,i,n){return!$c(n,function(o){return!ps(s,e,t,i,o[0],o[1])})}function ps(s,e,t,i,n,r){let o=0,a=s[t-i],l=s[t-i+1];for(;e<t;e+=i){const h=s[e],u=s[e+1];l<=r?u>r&&(h-a)*(r-l)-(n-a)*(u-l)>0&&o++:u<=r&&(h-a)*(r-l)-(n-a)*(u-l)<0&&o--,a=h,l=u}return o!==0}function cd(s,e,t,i,n,r){if(t.length===0||!ps(s,e,t[0],i,n,r))return!1;for(let o=1,a=t.length;o<a;++o)if(ps(s,t[o-1],t[o],i,n,r))return!1;return!0}function R_(s,e,t,i,n,r){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const l=t[o];if(cd(s,e,l,i,n,r))return!0;e=l[l.length-1]}return!1}function dd(s,e,t,i,n,r,o){let a,l,h,u,c,d,f;const g=n[r+1],p=[];for(let v=0,_=t.length;v<_;++v){const m=t[v];for(u=s[m-i],d=s[m-i+1],a=e;a<m;a+=i)c=s[a],f=s[a+1],(g<=d&&f<=g||d<=g&&g<=f)&&(h=(g-d)/(f-d)*(c-u)+u,p.push(h)),u=c,d=f}let y=NaN,b=-1/0;for(p.sort(zi),u=p[0],a=1,l=p.length;a<l;++a){c=p[a];const v=Math.abs(c-u);v>b&&(h=(u+c)/2,cd(s,e,t,i,h,g)&&(y=h,b=v)),u=c}return isNaN(y)&&(y=n[r]),o?(o.push(y,g,b),o):[y,g,b]}function jm(s,e,t,i,n){let r=[];for(let o=0,a=t.length;o<a;++o){const l=t[o];r=dd(s,e,l,i,n,2*o,r),e=l[l.length-1]}return r}function Ym(s,e,t,i,n){let r;for(e+=i;e<t;e+=i)if(r=n(s.slice(e-i,e),s.slice(e,e+i)),r)return r;return!1}function eh(s,e,t,i,n){const r=Im(Kt(),s,e,t,i);return je(n,r)?ii(n,r)||r[0]>=n[0]&&r[2]<=n[2]||r[1]>=n[1]&&r[3]<=n[3]?!0:Ym(s,e,t,i,function(o,a){return j0(n,o,a)}):!1}function S_(s,e,t,i,n){for(let r=0,o=t.length;r<o;++r){if(eh(s,e,t[r],i,n))return!0;e=t[r]}return!1}function Xm(s,e,t,i,n){return!!(eh(s,e,t,i,n)||ps(s,e,t,i,n[0],n[1])||ps(s,e,t,i,n[0],n[3])||ps(s,e,t,i,n[2],n[1])||ps(s,e,t,i,n[2],n[3]))}function $m(s,e,t,i,n){if(!Xm(s,e,t[0],i,n))return!1;if(t.length===1)return!0;for(let r=1,o=t.length;r<o;++r)if(x_(s,t[r-1],t[r],i,n)&&!eh(s,t[r-1],t[r],i,n))return!1;return!0}function T_(s,e,t,i,n){for(let r=0,o=t.length;r<o;++r){const a=t[r];if($m(s,e,a,i,n))return!0;e=a[a.length-1]}return!1}function M_(s,e,t,i){for(;e<t-i;){for(let n=0;n<i;++n){const r=s[e+n];s[e+n]=s[t-i+n],s[t-i+n]=r}e+=i,t-=i}}function fd(s,e,t,i){let n=0,r=s[t-i],o=s[t-i+1];for(;e<t;e+=i){const a=s[e],l=s[e+1];n+=(a-r)*(l+o),r=a,o=l}return n===0?void 0:n>0}function gd(s,e,t,i,n){n=n!==void 0?n:!1;for(let r=0,o=t.length;r<o;++r){const a=t[r],l=fd(s,e,a,i);if(r===0){if(n&&l||!n&&!l)return!1}else if(n&&!l||!n&&l)return!1;e=a}return!0}function Km(s,e,t,i,n){for(let r=0,o=t.length;r<o;++r){const a=t[r];if(!gd(s,e,a,i,n))return!1;a.length&&(e=a[a.length-1])}return!0}function sl(s,e,t,i,n){n=n!==void 0?n:!1;for(let r=0,o=t.length;r<o;++r){const a=t[r],l=fd(s,e,a,i);(r===0?n&&l||!n&&!l:n&&!l||!n&&l)&&M_(s,e,a,i),e=a}return e}function Pu(s,e,t,i,n){for(let r=0,o=t.length;r<o;++r)e=sl(s,e,t[r],i,n);return e}function Zm(s,e){const t=[];let i=0,n=0,r;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=fd(s,i,l,2);if(r===void 0&&(r=h),h===r)t.push(e.slice(n,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[n])}n=o+1,i=l}return t}class pt extends ns{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Re(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new pt(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,n){return n<Ds(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ad(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hd(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,n))}containsXY(e,t){return cd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Um(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),sl(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Po(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Wi(this.getExtent());this.flatInteriorPoint_=dd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Ei(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Sr(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],h=new Sr(t.slice(r,l),e);n.push(h),r=l}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;gd(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=sl(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=ud(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new pt(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return $m(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=ta(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function tk(s,e,t,i){t=t||32;const n=[];for(let r=0;r<t;++r)Re(n,h_(s,e,2*Math.PI*r/t,i));return n.push(n[0],n[1]),new pt(n,"XY",[n.length])}function dg(s){if(ks(s))throw new Error("Cannot create polygon from empty extent");const e=s[0],t=s[1],i=s[2],n=s[3],r=[e,t,e,n,i,n,i,t,e,t];return new pt(r,"XY",[r.length])}function L_(s,e,t){e=e||32;const i=s.getStride(),n=s.getLayout(),r=s.getCenter(),o=i*(e+1),a=new Array(o);for(let u=0;u<o;u+=i){a[u]=0,a[u+1]=0;for(let c=2;c<i;c++)a[u+c]=r[c]}const l=[a.length],h=new pt(a,n,l);return A_(h,r,s.getRadius(),t),h}function A_(s,e,t,i){const n=s.getFlatCoordinates(),r=s.getStride(),o=n.length/r-1,a=i||0;for(let l=0;l<=o;++l){const h=l*r,u=a+Zn(l,o)*2*Math.PI/o;n[h]=e[0]+t*Math.cos(u),n[h+1]=e[1]+t*Math.sin(u)}s.changed()}const ni={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},q={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Io={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var nt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};nt.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};nt.max=nt.whitepoint[2].D65;nt.rgb=function(s,e){e=e||nt.whitepoint[2].E;var t=s[0]/e[0],i=s[1]/e[1],n=s[2]/e[2],r,o,a;return r=t*3.240969941904521+i*-1.537383177570093+n*-.498610760293,o=t*-.96924363628087+i*1.87596750150772+n*.041555057407175,a=t*.055630079696993+i*-.20397695888897+n*1.056971514242878,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=r*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,r=Math.min(Math.max(0,r),1),o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),[r*255,o*255,a*255]};Io.xyz=function(s,e){var t=s[0]/255,i=s[1]/255,n=s[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var r=t*.41239079926595+i*.35758433938387+n*.18048078840183,o=t*.21263900587151+i*.71516867876775+n*.072192315360733,a=t*.019330818715591+i*.11919477979462+n*.95053215224966;return e=e||nt.whitepoint[2].E,[r*e[0],o*e[1],a*e[2]]};const pd={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(s,e,t){var i,n,r,o,a,l,h,u,c,d,f,g,p;if(r=s[0],o=s[1],a=s[2],r===0)return[0,0,0];var y=.0011070564598794539;return e=e||"D65",t=t||2,c=nt.whitepoint[t][e][0],d=nt.whitepoint[t][e][1],f=nt.whitepoint[t][e][2],g=4*c/(c+15*d+3*f),p=9*d/(c+15*d+3*f),i=o/(13*r)+g||0,n=a/(13*r)+p||0,h=r>8?d*Math.pow((r+16)/116,3):d*r*y,l=h*9*i/(4*n)||0,u=h*(12-3*i-20*n)/(4*n)||0,[l,h,u]}};nt.luv=function(s,e,t){var i,n,r,o,a,l,h,u,c,d,f,g,p,y=.008856451679035631,b=903.2962962962961;e=e||"D65",t=t||2,c=nt.whitepoint[t][e][0],d=nt.whitepoint[t][e][1],f=nt.whitepoint[t][e][2],g=4*c/(c+15*d+3*f),p=9*d/(c+15*d+3*f),l=s[0],h=s[1],u=s[2],i=4*l/(l+15*h+3*u)||0,n=9*h/(l+15*h+3*u)||0;var v=h/d;return r=v<=y?b*v:116*Math.pow(v,1/3)-16,o=13*r*(i-g),a=13*r*(n-p),[r,o,a]};var qm={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(s){var e=s[0],t=s[1],i=s[2],n,r,o;return o=i/360*2*Math.PI,n=t*Math.cos(o),r=t*Math.sin(o),[e,n,r]},xyz:function(s){return pd.xyz(qm.luv(s))}};pd.lchuv=function(s){var e=s[0],t=s[1],i=s[2],n=Math.sqrt(t*t+i*i),r=Math.atan2(i,t),o=r*360/2/Math.PI;return o<0&&(o+=360),[e,n,o]};nt.lchuv=function(s){return pd.lchuv(nt.luv(s))};const fg={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var gg={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function P_(s){var u,c;var e,t=[],i=1,n;if(typeof s=="number")return{space:"rgb",values:[s>>>16,(s&65280)>>>8,s&255],alpha:1};if(typeof s=="number")return{space:"rgb",values:[s>>>16,(s&65280)>>>8,s&255],alpha:1};if(s=String(s).toLowerCase(),fg[s])t=fg[s].slice(),n="rgb";else if(s==="transparent")i=0,n="rgb",t=[0,0,0];else if(s[0]==="#"){var r=s.slice(1),o=r.length,a=o<=4;i=1,a?(t=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],o===4&&(i=parseInt(r[3]+r[3],16)/255)):(t=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],o===8&&(i=parseInt(r[6]+r[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),n="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(s)){var l=e[1];n=l.replace(/a$/,"");var h=n==="cmyk"?4:n==="gray"?1:3;t=e[2].trim().split(/\s*[,\/]\s*|\s+/),n==="color"&&(n=t.shift()),t=t.map(function(d,f){if(d[d.length-1]==="%")return d=parseFloat(d)/100,f===3?d:n==="rgb"?d*255:n[0]==="h"||n[0]==="l"&&!f?d*100:n==="lab"?d*125:n==="lch"?f<2?d*150:d*360:n[0]==="o"&&!f?d:n==="oklab"?d*.4:n==="oklch"?f<2?d*.4:d*360:d;if(n[f]==="h"||f===2&&n[n.length-1]==="h"){if(gg[d]!==void 0)return gg[d];if(d.endsWith("deg"))return parseFloat(d);if(d.endsWith("turn"))return parseFloat(d)*360;if(d.endsWith("grad"))return parseFloat(d)*360/400;if(d.endsWith("rad"))return parseFloat(d)*180/Math.PI}return d==="none"?0:parseFloat(d)}),i=t.length>h?t.pop():1}else/[0-9](?:\s|\/|,)/.test(s)&&(t=s.match(/([0-9]+)/g).map(function(d){return parseFloat(d)}),n=((c=(u=s.match(/([a-z])/ig))==null?void 0:u.join(""))==null?void 0:c.toLowerCase())||"rgb");return{space:n,values:t,alpha:i}}const Oh={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(s){var e=s[0]/360,t=s[1]/100,i=s[2]/100,n,r,o,a,l,h=0;if(t===0)return l=i*255,[l,l,l];for(r=i<.5?i*(1+t):i+t-i*t,n=2*i-r,a=[0,0,0];h<3;)o=e+1/3*-(h-1),o<0?o++:o>1&&o--,l=6*o<1?n+(r-n)*6*o:2*o<1?r:3*o<2?n+(r-n)*(2/3-o)*6:n,a[h++]=l*255;return a}};Io.hsl=function(s){var e=s[0]/255,t=s[1]/255,i=s[2]/255,n=Math.min(e,t,i),r=Math.max(e,t,i),o=r-n,a,l,h;return r===n?a=0:e===r?a=(t-i)/o:t===r?a=2+(i-e)/o:i===r&&(a=4+(e-t)/o),a=Math.min(a*60,360),a<0&&(a+=360),h=(n+r)/2,r===n?l=0:h<=.5?l=o/(r+n):l=o/(2-r-n),[a,l*100,h*100]};function I_(s){Array.isArray(s)&&s.raw&&(s=String.raw(...arguments)),s instanceof Number&&(s=+s);var e,t=P_(s);if(!t.space)return[];const i=t.space[0]==="h"?Oh.min:Io.min,n=t.space[0]==="h"?Oh.max:Io.max;return e=Array(3),e[0]=Math.min(Math.max(t.values[0],i[0]),n[0]),e[1]=Math.min(Math.max(t.values[1],i[1]),n[1]),e[2]=Math.min(Math.max(t.values[2],i[2]),n[2]),t.space[0]==="h"&&(e=Oh.rgb(e)),e.push(Math.min(Math.max(t.alpha,0),1)),e}const md=[NaN,NaN,NaN,0];function O_(s){return typeof s=="string"?s:yd(s)}const F_=1024,Xr={};let Fh=0;function D_(s){if(s.length===4)return s;const e=s.slice();return e[3]=1,e}function pg(s){const e=nt.lchuv(Io.xyz(s));return e[3]=s[3],e}function k_(s){const e=nt.rgb(qm.xyz(s));return e[3]=s[3],e}function bd(s){if(s==="none")return md;if(Xr.hasOwnProperty(s))return Xr[s];if(Fh>=F_){let t=0;for(const i in Xr)t++&3||(delete Xr[i],--Fh)}const e=I_(s);if(e.length!==4)throw new Error('failed to parse "'+s+'" as color');for(const t of e)if(isNaN(t))throw new Error('failed to parse "'+s+'" as color');return Jm(e),Xr[s]=e,++Fh,e}function pn(s){return Array.isArray(s)?s:bd(s)}function Jm(s){return s[0]=ze(s[0]+.5|0,0,255),s[1]=ze(s[1]+.5|0,0,255),s[2]=ze(s[2]+.5|0,0,255),s[3]=ze(s[3],0,1),s}function yd(s){let e=s[0];e!=(e|0)&&(e=e+.5|0);let t=s[1];t!=(t|0)&&(t=t+.5|0);let i=s[2];i!=(i|0)&&(i=i+.5|0);const n=s[3]===void 0?1:Math.round(s[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+n+")"}const Jn=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",N_=Jn.includes("firefox"),z_=Jn.includes("safari")&&!Jn.includes("chrom"),ik=z_&&(Jn.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Jn)),G_=Jn.includes("webkit")&&!Jn.includes("edge"),vd=Jn.includes("macintosh"),wd=typeof devicePixelRatio<"u"?devicePixelRatio:1,Qm=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,_d=typeof Image<"u"&&Image.prototype.decode,H_=typeof createImageBitmap=="function",eb=function(){let s=!1;try{const e=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return s}();function We(s,e,t,i){let n;return t&&t.length?n=t.shift():Qm?n=new OffscreenCanvas(s||300,e||300):n=document.createElement("canvas"),s&&(n.width=s),e&&(n.height=e),n.getContext("2d",i)}let Dh;function rl(){return Dh||(Dh=We(1,1)),Dh}function As(s){const e=s.canvas;e.width=1,e.height=1,s.clearRect(0,0,1,1)}function B_(s){let e=s.offsetWidth;const t=getComputedStyle(s);return e+=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10),e}function V_(s){let e=s.offsetHeight;const t=getComputedStyle(s);return e+=parseInt(t.marginTop,10)+parseInt(t.marginBottom,10),e}function mg(s,e){const t=e.parentNode;t&&t.replaceChild(s,e)}function tb(s){for(;s.lastChild;)s.lastChild.remove()}function W_(s,e){const t=s.childNodes;for(let i=0;;++i){const n=t[i],r=e[i];if(!n&&!r)break;if(n!==r){if(!n){s.appendChild(r);continue}if(!r){s.removeChild(n),--i;continue}s.insertBefore(r,n)}}}class ib extends qo{constructor(e,t,i,n){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof n=="function"?q.IDLE:n,this.image_=null,this.loader=typeof n=="function"?n:null}changed(){this.dispatchEvent(ce.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==q.IDLE&&this.loader){this.state=q.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;Tm(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=q.LOADED}).catch(i=>{this.state=q.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function U_(s,e,t){const i=s;let n=!0,r=!1,o=!1;const a=[il(i,ce.LOAD,function(){o=!0,r||e()})];return i.src&&_d?(r=!0,i.decode().then(function(){n&&e()}).catch(function(l){n&&(o?e():t())})):a.push(il(i,ce.ERROR,t)),function(){n=!1,a.forEach(Ie)}}function j_(s,e){return new Promise((t,i)=>{function n(){o(),t(s)}function r(){o(),i(new Error("Image load error"))}function o(){s.removeEventListener("load",n),s.removeEventListener("error",r)}s.addEventListener("load",n),s.addEventListener("error",r)})}function nb(s,e){return e&&(s.src=e),s.src&&_d?new Promise((t,i)=>s.decode().then(()=>t(s)).catch(n=>s.complete&&s.width?t(s):i(n))):j_(s)}function sb(s,e){return e&&(s.src=e),s.src&&_d&&H_?s.decode().then(()=>createImageBitmap(s)).catch(t=>{if(s.complete&&s.width)return s;throw t}):nb(s)}class Y_{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];!(e++&3)&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const n=kh(e,t,i);return n in this.cache_?this.cache_[n]:null}getPattern(e,t,i){const n=kh(e,t,i);return n in this.patternCache_?this.patternCache_[n]:null}set(e,t,i,n,r){const o=kh(e,t,i),a=o in this.cache_;this.cache_[o]=n,r&&(n.getImageState()===q.IDLE&&n.load(),n.getImageState()===q.LOADING?n.ready().then(()=>{this.patternCache_[o]=rl().createPattern(n.getImage(1),"repeat")}):this.patternCache_[o]=rl().createPattern(n.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function kh(s,e,t){const i=t?pn(t):"null";return e+":"+s+":"+i}const Di=new Y_;let $r=null;class X_ extends qo{constructor(e,t,i,n,r){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=n===void 0?q.IDLE:n,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===q.LOADED){$r||($r=We(1,1,void 0,{willReadFrequently:!0})),$r.drawImage(this.image_,0,0);try{$r.getImageData(0,0,1,1),this.tainted_=!1}catch{$r=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ce.CHANGE)}handleImageError_(){this.imageState_=q.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=q.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=We(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===q.IDLE){this.image_||this.initializeImage_(),this.imageState_=q.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&nb(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==q.LOADED)return;const t=this.image_,i=We(Math.ceil(t.width*e),Math.ceil(t.height*e)),n=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=O_(this.color_),i.fillRect(0,0,n.width/e,n.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=n}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===q.LOADED||this.imageState_===q.ERROR)e();else{const t=()=>{(this.imageState_===q.LOADED||this.imageState_===q.ERROR)&&(this.removeEventListener(ce.CHANGE,t),e())};this.addEventListener(ce.CHANGE,t)}})),this.ready_}}function Ed(s,e,t,i,n,r){let o=e===void 0?void 0:Di.get(e,t,n);return o||(o=new X_(s,s&&"src"in s?s.src||void 0:e,t,i,n),Di.set(e,t,n,o,r)),r&&o&&!Di.getPattern(e,t,n)&&Di.set(e,t,n,o,r),o}class Ui{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ui({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Ed(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===q.IDLE&&t.load(),t.getImageState()===q.LOADING&&(this.patternImage_=t)}this.color_=e}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function ol(s,e,t,i,n,r,o){let a,l;const h=(t-e)/i;if(h===1)a=e;else if(h===2)a=e,l=n;else if(h!==0){let u=s[e],c=s[e+1],d=0;const f=[0];for(let y=e+i;y<t;y+=i){const b=s[y],v=s[y+1];d+=Math.sqrt((b-u)*(b-u)+(v-c)*(v-c)),f.push(d),u=b,c=v}const g=n*d,p=A0(f,g);p<0?(l=(g-f[-p-2])/(f[-p-1]-f[-p-2]),a=e+(-p-2)*i):a=e+p*i}o=o>1?o:2,r=r||new Array(o);for(let u=0;u<o;++u)r[u]=a===void 0?NaN:l===void 0?s[a+u]:jt(s[a+u],s[a+i+u],l);return r}function Iu(s,e,t,i,n,r){if(t==e)return null;let o;if(n<s[e+i-1])return r?(o=s.slice(e,e+i),o[i-1]=n,o):null;if(s[t-1]<n)return r?(o=s.slice(t-i,t),o[i-1]=n,o):null;if(n==s[e+i-1])return s.slice(e,e+i);let a=e/i,l=t/i;for(;a<l;){const d=a+l>>1;n<s[(d+1)*i-1]?l=d:a=d+1}const h=s[a*i-1];if(n==h)return s.slice((a-1)*i,(a-1)*i+i);const u=s[(a+1)*i-1],c=(n-h)/(u-h);o=[];for(let d=0;d<i-1;++d)o.push(jt(s[(a-1)*i+d],s[a*i+d],c));return o.push(n),o}function $_(s,e,t,i,n,r,o){if(o)return Iu(s,e,t[t.length-1],i,n,r);let a;if(n<s[i-1])return r?(a=s.slice(0,i),a[i-1]=n,a):null;if(s[s.length-1]<n)return r?(a=s.slice(s.length-i),a[i-1]=n,a):null;for(let l=0,h=t.length;l<h;++l){const u=t[l];if(e!=u){if(n<s[e+i-1])return null;if(n<=s[u-1])return Iu(s,e,u,i,n,!1);e=u}}return null}function rb(s,e,t,i){let n=s[e],r=s[e+1],o=0;for(let a=e+i;a<t;a+=i){const l=s[a],h=s[a+1];o+=Math.sqrt((l-n)*(l-n)+(h-r)*(h-r)),n=l,r=h}return o}class zt extends ns{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Re(this.flatCoordinates,e),this.changed()}clone(){const e=new zt(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,n){return n<Ds(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(od(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ld(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,n))}forEachSegment(e){return Ym(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,Iu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return ol(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return rb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Ql(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new zt(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return eh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Jl(this.flatCoordinates,0,e,this.stride),this.changed()}}class wi{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new wi({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function bg(s){return s[0]>0&&s[1]>0}function K_(s,e,t){return t===void 0&&(t=[0,0]),t[0]=s[0]*e+.5|0,t[1]=s[1]*e+.5|0,t}function gt(s,e){return Array.isArray(s)?s:(e===void 0?e=[s,s]:(e[0]=s,e[1]=s),e)}class th{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=gt(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new th({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return ne()}getImage(e){return ne()}getHitDetectionImage(){return ne()}getPixelRatio(e){return 1}getImageState(){return ne()}getImageSize(){return ne()}getOrigin(){return ne()}getSize(){return ne()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=gt(e)}listenImageChange(e){ne()}load(){ne()}unlistenImageChange(e){ne()}ready(){return Promise.resolve()}}function ki(s){return s?Array.isArray(s)?yd(s):typeof s=="object"&&"src"in s?Z_(s):s:null}function Z_(s){if(!s.offset||!s.size)return Di.getPattern(s.src,"anonymous",s.color);const e=s.src+":"+s.offset,t=Di.getPattern(e,void 0,s.color);if(t)return t;const i=Di.get(s.src,"anonymous",null);if(i.getImageState()!==q.LOADED)return null;const n=We(s.size[0],s.size[1]);return n.drawImage(i.getImage(1),s.offset[0],s.offset[1],s.size[0],s.size[1],0,0,s.size[0],s.size[1]),Ed(n.canvas,e,void 0,q.LOADED,s.color,!0),Di.getPattern(e,void 0,s.color)}const Ea="ol-hidden",q_="ol-selectable",ih="ol-unselectable",Cd="ol-control",yg="ol-collapsed",J_=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),vg=["style","variant","weight","size","lineHeight","family"],xd=function(s){const e=s.match(J_);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,n=vg.length;i<n;++i){const r=e[i+1];r!==void 0&&(t[vg[i]]=r)}return t.families=t.family.split(/,\s?/),t},ob="10px sans-serif",Lt="#000",Tr="round",mn=[],bn=0,Mr="round",Oo=10,Fo="#000",Do="center",al="middle",ms=[0,0,0,0],ko=1,sn=new Ri;let er=null,Ou;const Fu={},Q_=function(){const e="32px ",t=["monospace","serif"],i=t.length,n="wmytzilWMYTZIL@#/&?$%10";let r,o;function a(h,u,c){let d=!0;for(let f=0;f<i;++f){const g=t[f];if(o=ll(h+" "+u+" "+e+g,n),c!=g){const p=ll(h+" "+u+" "+e+c+","+g,n);d=d&&p!=o}}return!!d}function l(){let h=!0;const u=sn.getKeys();for(let c=0,d=u.length;c<d;++c){const f=u[c];if(sn.get(f)<100){const[g,p,y]=f.split(`
`);a(g,p,y)?(Zo(Fu),er=null,Ou=void 0,sn.set(f,100)):(sn.set(f,sn.get(f)+1,!0),h=!1)}}h&&(clearInterval(r),r=void 0)}return function(h){const u=xd(h);if(!u)return;const c=u.families;for(let d=0,f=c.length;d<f;++d){const g=c[d],p=u.style+`
`+u.weight+`
`+g;sn.get(p)===void 0&&(sn.set(p,100,!0),a(u.style,u.weight,g)||(sn.set(p,0,!0),r===void 0&&(r=setInterval(l,32))))}}}(),eE=function(){let s;return function(e){let t=Fu[e];if(t==null){if(Qm){const i=xd(e),n=ab(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else s||(s=document.createElement("div"),s.innerHTML="M",s.style.minHeight="0",s.style.maxHeight="none",s.style.height="auto",s.style.padding="0",s.style.border="none",s.style.position="absolute",s.style.display="block",s.style.left="-99999px"),s.style.font=e,document.body.appendChild(s),t=s.offsetHeight,document.body.removeChild(s);Fu[e]=t}return t}}();function ab(s,e){return er||(er=We(1,1)),s!=Ou&&(er.font=s,Ou=er.font),er.measureText(e)}function ll(s,e){return ab(s,e).width}function wg(s,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((n,r)=>Math.max(n,ll(s,r)),0);return t[e]=i,i}function tE(s,e){const t=[],i=[],n=[];let r=0,o=0,a=0,l=0;for(let h=0,u=e.length;h<=u;h+=2){const c=e[h];if(c===`
`||h===u){r=Math.max(r,o),n.push(o),o=0,a+=l,l=0;continue}const d=e[h+1]||s.font,f=ll(d,c);t.push(f),o+=f;const g=eE(d);i.push(g),l=Math.max(l,g)}return{width:r,height:a,widths:t,heights:i,lineWidths:n}}function iE(s,e,t,i,n,r,o,a,l,h,u){s.save(),t!==1&&(s.globalAlpha===void 0?s.globalAlpha=c=>c.globalAlpha*=t:s.globalAlpha*=t),e&&s.transform.apply(s,e),i.contextInstructions?(s.translate(l,h),s.scale(u[0],u[1]),nE(i,s)):u[0]<0||u[1]<0?(s.translate(l,h),s.scale(u[0],u[1]),s.drawImage(i,n,r,o,a,0,0,o,a)):s.drawImage(i,n,r,o,a,l,h,o*u[0],a*u[1]),s.restore()}function nE(s,e){const t=s.contextInstructions;for(let i=0,n=t.length;i<n;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class nh extends th{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?q.LOADING:q.LOADED,this.imageState_===q.LOADING&&this.ready().then(()=>this.imageState_=q.LOADED),this.render()}clone(){const e=this.getScale(),t=new nh({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){let t=this.canvases_[e];if(!t){const i=this.renderOptions_,n=We(i.size*e,i.size*e);this.draw_(i,n,e),t=n.canvas,this.canvases_[e]=t}return t}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let n=this.radius,r=this.radius2_===void 0?n:this.radius2_;if(n<r){const C=n;n=r,r=C}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=r*Math.sin(a),h=Math.sqrt(r*r-l*l),u=n-h,c=Math.sqrt(l*l+u*u),d=c/l;if(e==="miter"&&d<=i)return d*t;const f=t/2/d,g=t/2*(u/c),y=Math.sqrt((n+f)*(n+f)+g*g)-n;if(this.radius2_===void 0||e==="bevel")return y*2;const b=n*Math.sin(a),v=Math.sqrt(n*n-b*b),_=r-v,E=Math.sqrt(b*b+_*_)/b;if(E<=i){const C=E*t/2-r-n;return 2*Math.max(y,C)}return y*2}createRenderOptions(){let e=Tr,t=Mr,i=0,n=null,r=0,o,a=0;this.stroke_&&(o=ki(this.stroke_.getColor()??Fo),a=this.stroke_.getWidth()??ko,n=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??Mr,e=this.stroke_.getLineCap()??Tr,i=this.stroke_.getMiterLimit()??Oo);const l=this.calculateLineJoinSize_(t,a,i),h=Math.max(this.radius,this.radius2_||0),u=Math.ceil(2*h+l);return{strokeStyle:o,strokeWidth:a,size:u,lineCap:e,lineDash:n,lineDashOffset:r,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let n=this.fill_.getColor();n===null&&(n=Lt),t.fillStyle=ki(n),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),n=0;typeof i=="string"&&(i=pn(i)),i===null?n=1:Array.isArray(i)&&(n=i.length===4?i[3]:1),n===0&&(t=We(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const n=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const l=r+a*o,h=a%2===0?i:n;e.lineTo(h*Math.cos(l),h*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Lt,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Dr extends nh{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Dr({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class st{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=_g,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new st({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=_g,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function sE(s){let e;if(typeof s=="function")e=s;else{let t;Array.isArray(s)?t=s:(be(typeof s.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[s]),e=function(){return t}}return e}let Nh=null;function lb(s,e){if(!Nh){const t=new Ui({color:"rgba(255,255,255,0.4)"}),i=new wi({color:"#3399CC",width:1.25});Nh=[new st({image:new Dr({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return Nh}function nk(){const s={},e=[255,255,255,1],t=[0,153,255,1],i=3;return s.Polygon=[new st({fill:new Ui({color:[255,255,255,.5]})})],s.MultiPolygon=s.Polygon,s.LineString=[new st({stroke:new wi({color:e,width:i+2})}),new st({stroke:new wi({color:t,width:i})})],s.MultiLineString=s.LineString,s.Circle=s.Polygon.concat(s.LineString),s.Point=[new st({image:new Dr({radius:i*2,fill:new Ui({color:t}),stroke:new wi({color:e,width:i/2})}),zIndex:1/0})],s.MultiPoint=s.Point,s.GeometryCollection=s.Polygon.concat(s.LineString,s.Point),s}function _g(s){return s.getGeometry()}const rE="#333";class ia{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=gt(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ui({color:rE}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ia({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=gt(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Pe={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class hb extends Ri{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Pe.OPACITY]=e.opacity!==void 0?e.opacity:1,be(typeof t[Pe.OPACITY]=="number","Layer opacity must be a number"),t[Pe.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Pe.Z_INDEX]=e.zIndex,t[Pe.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Pe.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Pe.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Pe.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=ze(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return ne()}getLayerStatesArray(e){return ne()}getExtent(){return this.get(Pe.EXTENT)}getMaxResolution(){return this.get(Pe.MAX_RESOLUTION)}getMinResolution(){return this.get(Pe.MIN_RESOLUTION)}getMinZoom(){return this.get(Pe.MIN_ZOOM)}getMaxZoom(){return this.get(Pe.MAX_ZOOM)}getOpacity(){return this.get(Pe.OPACITY)}getSourceState(){return ne()}getVisible(){return this.get(Pe.VISIBLE)}getZIndex(){return this.get(Pe.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Pe.EXTENT,e)}setMaxResolution(e){this.set(Pe.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Pe.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Pe.MAX_ZOOM,e)}setMinZoom(e){this.set(Pe.MIN_ZOOM,e)}setOpacity(e){be(typeof e=="number","Layer opacity must be a number"),this.set(Pe.OPACITY,e)}setVisible(e){this.set(Pe.VISIBLE,e)}setZIndex(e){this.set(Pe.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Ne={ANIMATING:0,INTERACTING:1},gi={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},oE=42,Rd=256;function Eg(s,e,t){return function(i,n,r,o,a){if(!i)return;if(!n&&!e)return i;const l=e?0:r[0]*n,h=e?0:r[1]*n,u=a?a[0]:0,c=a?a[1]:0;let d=s[0]+l/2+u,f=s[2]-l/2+u,g=s[1]+h/2+c,p=s[3]-h/2+c;d>f&&(d=(f+d)/2,f=d),g>p&&(g=(p+g)/2,p=g);let y=ze(i[0],d,f),b=ze(i[1],g,p);if(o&&t&&n){const v=30*n;y+=-v*Math.log(1+Math.max(0,d-i[0])/v)+v*Math.log(1+Math.max(0,i[0]-f)/v),b+=-v*Math.log(1+Math.max(0,g-i[1])/v)+v*Math.log(1+Math.max(0,i[1]-p)/v)}return[y,b]}}function aE(s){return s}function Sd(s,e,t,i){const n=_e(e)/t[0],r=Ke(e)/t[1];return i?Math.min(s,Math.max(n,r)):Math.min(s,Math.min(n,r))}function Td(s,e,t){let i=Math.min(s,e);const n=50;return i*=Math.log(1+n*Math.max(0,s/e-1))/n+1,t&&(i=Math.max(i,t),i/=Math.log(1+n*Math.max(0,t/s-1))/n+1),ze(i,t/2,e*2)}function lE(s,e,t,i){return e=e!==void 0?e:!0,function(n,r,o,a){if(n!==void 0){const l=s[0],h=s[s.length-1],u=t?Sd(l,t,o,i):l;if(a)return e?Td(n,u,h):ze(n,h,u);const c=Math.min(u,n),d=Math.floor(Ul(s,c,r));return s[d]>u&&d<s.length-1?s[d+1]:s[d]}}}function hE(s,e,t,i,n,r){return i=i!==void 0?i:!0,t=t!==void 0?t:0,function(o,a,l,h){if(o!==void 0){const u=n?Sd(e,n,l,r):e;if(h)return i?Td(o,u,t):ze(o,t,u);const c=1e-9,d=Math.ceil(Math.log(e/u)/Math.log(s)-c),f=-a*(.5-c)+.5,g=Math.min(u,o),p=Math.floor(Math.log(e/g)/Math.log(s)+f),y=Math.max(d,p),b=e/Math.pow(s,y);return ze(b,t,u)}}}function Cg(s,e,t,i,n){return t=t!==void 0?t:!0,function(r,o,a,l){if(r!==void 0){const h=i?Sd(s,i,a,n):s;return!t||!l?ze(r,e,h):Td(r,h,e)}}}function Md(s){if(s!==void 0)return 0}function xg(s){if(s!==void 0)return s}function uE(s){const e=2*Math.PI/s;return function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function cE(s){const e=Gi(5);return function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t}}function ub(s){return Math.pow(s,3)}function kr(s){return 1-ub(1-s)}function dE(s){return 3*s*s-2*s*s*s}function fE(s){return s}const zh=0;class cn extends Ri{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=id(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Nm(),e.center&&(e.center=nn(e.center,this.projection_)),e.extent&&(e.extent=Fi(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in gi)delete t[a];this.setProperties(t,!0);const i=pE(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const n=gE(e),r=i.constraint,o=mE(e);this.constraints_={center:n,resolution:r,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const n=e||[0,0,0,0];t=t||[0,0,0,0];const r=this.getResolution(),o=r/2*(n[3]-t[3]+t[1]-n[1]),a=r/2*(n[0]-t[0]+t[2]-n[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let n=arguments[i];n.center&&(n=Object.assign({},n),n.center=nn(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=nn(n.anchor,this.getProjection())),t[i]=n}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let n=0;for(;n<t&&!this.isDef();++n){const u=arguments[n];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(n===t){i&&Ca(i,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const h=[];for(;n<t;++n){const u=arguments[n],c={start:r,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||dE,callback:i};if(u.center&&(c.sourceCenter=o,c.targetCenter=u.center.slice(),o=c.targetCenter),u.zoom!==void 0?(c.sourceResolution=a,c.targetResolution=this.getResolutionForZoom(u.zoom),a=c.targetResolution):u.resolution&&(c.sourceResolution=a,c.targetResolution=u.resolution,a=c.targetResolution),u.rotation!==void 0){c.sourceRotation=l;const d=Zn(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=l+d,l=c.targetRotation}bE(c)?c.complete=!0:r+=c.duration,h.push(c)}this.animations_.push(h),this.setHint(Ne.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ne.ANIMATING]>0}getInteracting(){return this.hints_[Ne.INTERACTING]>0}cancelAnimations(){this.setHint(Ne.ANIMATING,-this.hints_[Ne.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const n=this.animations_[t];if(n[0].callback&&Ca(n[0].callback,!1),!e)for(let r=0,o=n.length;r<o;++r){const a=n[r];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(l.complete)continue;const h=e-l.start;let u=l.duration>0?h/l.duration:1;u>=1?(l.complete=!0,u=1):r=!1;const c=l.easing(u);if(l.sourceCenter){const d=l.sourceCenter[0],f=l.sourceCenter[1],g=l.targetCenter[0],p=l.targetCenter[1];this.nextCenter_=l.targetCenter;const y=d+c*(g-d),b=f+c*(p-f);this.targetCenter_=[y,b]}if(l.sourceResolution&&l.targetResolution){const d=c===1?l.targetResolution:l.sourceResolution+c*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=c===1?Zn(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+c*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(r){this.animations_[i]=null,this.setHint(Ne.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=n[0].callback;o&&Ca(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const n=this.getCenterInternal();return n!==void 0&&(i=[n[0]-t[0],n[1]-t[1]],Jc(i,e-this.getRotation()),r_(i,t)),i}calculateCenterZoom(e,t){let i;const n=this.getCenterInternal(),r=this.getResolution();if(n!==void 0&&r!==void 0){const o=t[0]-e*(t[0]-n[0])/r,a=t[1]-e*(t[1]-n[1])/r;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],n=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(n*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(n*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Lu(e,this.getProjection())}getCenterInternal(){return this.get(gi.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return nd(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();be(t,"The view center is not defined");const i=this.getResolution();be(i!==void 0,"The view resolution is not defined");const n=this.getRotation();return be(n!==void 0,"The view rotation is not defined"),Lo(t,i,n,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(gi.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Fi(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=_e(e)/t[0],n=Ke(e)/t[1];return Math.max(i,n)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(t/i)/Math.log(e);return function(r){return t/Math.pow(e,r*n)}}getRotation(){return this.get(gi.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/t;return function(o){return Math.log(i/o)/t/r}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();n=Gh(n,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],t,i)}return{center:n.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,n;if(this.resolutions_){const r=Ul(this.resolutions_,e,1);t=r,i=this.resolutions_[r],r==this.resolutions_.length-1?n=2:n=i/this.resolutions_[r+1]}else i=this.maxResolution_,n=this.zoomFactor_;return t+Math.log(i/e)/Math.log(n)}getResolutionForZoom(e){var t;if((t=this.resolutions_)!=null&&t.length){if(this.resolutions_.length===1)return this.resolutions_[0];const i=ze(Math.floor(e),0,this.resolutions_.length-2),n=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(n,ze(e-i,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(be(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){be(!ks(e),"Cannot fit empty extent provided as `geometry`");const n=Fi(e,this.getProjection());i=dg(n)}else if(e.getType()==="Circle"){const n=Fi(e.getExtent(),this.getProjection());i=dg(n),i.rotate(this.getRotation(),Wi(n))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),n=Math.sin(-t),r=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,h=-1/0,u=-1/0;for(let c=0,d=r.length;c<d;c+=o){const f=r[c]*i-r[c+1]*n,g=r[c]*n+r[c+1]*i;a=Math.min(a,f),l=Math.min(l,g),h=Math.max(h,f),u=Math.max(u,g)}return[a,l,h,u]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const n=t.padding!==void 0?t.padding:[0,0,0,0],r=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,r?0:1);const h=this.getRotation(),u=Math.sin(h),c=Math.cos(h),d=Wi(a);d[0]+=(n[1]-n[3])/2*l,d[1]+=(n[0]-n[2])/2*l;const f=d[0]*c-d[1]*u,g=d[1]*c+d[0]*u,p=this.getConstrainedCenter([f,g],l),y=t.callback?t.callback:Cr;t.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:t.duration,easing:t.easing},y):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),Ca(y,!0))}centerOn(e,t,i){this.centerOnInternal(nn(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(Gh(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,n){let r;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),l=Gh(e,n,[a[0]/2+o[3],a[1]/2+o[0]],t,i);r=[e[0]-l[0],e[1]-l[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Lu(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&nn(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*e,0,n,i);t&&(this.targetCenter_=this.calculateCenterZoom(r,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=nn(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(n,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&nn(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,r,i),a=this.constraints_.center(this.targetCenter_,o,r,i,this.calculateCenterShift(this.targetCenter_,o,n,r));this.get(gi.ROTATION)!==n&&this.set(gi.ROTATION,n),this.get(gi.RESOLUTION)!==o&&(this.set(gi.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(gi.CENTER)||!nl(this.get(gi.CENTER),a))&&this.set(gi.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const n=t||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,n,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,r,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=l,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==r||!this.getCenterInternal()||!nl(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:l,resolution:a,duration:e,easing:kr,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ne.INTERACTING,1)}endInteraction(e,t,i){i=i&&nn(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Ne.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Ca(s,e){setTimeout(function(){s(e)},0)}function gE(s){if(s.extent!==void 0){const t=s.smoothExtentConstraint!==void 0?s.smoothExtentConstraint:!0;return Eg(s.extent,s.constrainOnlyCenter,t)}const e=id(s.projection,"EPSG:3857");if(s.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Eg(t,!1,!1)}return aE}function pE(s){let e,t,i,o=s.minZoom!==void 0?s.minZoom:zh,a=s.maxZoom!==void 0?s.maxZoom:28;const l=s.zoomFactor!==void 0?s.zoomFactor:2,h=s.multiWorld!==void 0?s.multiWorld:!1,u=s.smoothResolutionConstraint!==void 0?s.smoothResolutionConstraint:!0,c=s.showFullExtent!==void 0?s.showFullExtent:!1,d=id(s.projection,"EPSG:3857"),f=d.getExtent();let g=s.constrainOnlyCenter,p=s.extent;if(!h&&!p&&d.isGlobal()&&(g=!1,p=f),s.resolutions!==void 0){const y=s.resolutions;t=y[o],i=y[a]!==void 0?y[a]:y[y.length-1],s.constrainResolution?e=lE(y,u,!g&&p,c):e=Cg(t,i,u,!g&&p,c)}else{const b=(f?Math.max(_e(f),Ke(f)):360*Ao.degrees/d.getMetersPerUnit())/Rd/Math.pow(2,zh),v=b/Math.pow(2,28-zh);t=s.maxResolution,t!==void 0?o=0:t=b/Math.pow(l,o),i=s.minResolution,i===void 0&&(s.maxZoom!==void 0?s.maxResolution!==void 0?i=t/Math.pow(l,a):i=b/Math.pow(l,a):i=v),a=o+Math.floor(Math.log(t/i)/Math.log(l)),i=t/Math.pow(l,a-o),s.constrainResolution?e=hE(l,t,i,u,!g&&p,c):e=Cg(t,i,u,!g&&p,c)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:l}}function mE(s){if(s.enableRotation!==void 0?s.enableRotation:!0){const t=s.constrainRotation;return t===void 0||t===!0?cE():t===!1?xg:typeof t=="number"?uE(t):xg}return Md}function bE(s){return!(s.sourceCenter&&s.targetCenter&&!nl(s.sourceCenter,s.targetCenter)||s.sourceResolution!==s.targetResolution||s.sourceRotation!==s.targetRotation)}function Gh(s,e,t,i,n){const r=Math.cos(-n);let o=Math.sin(-n),a=s[0]*r-s[1]*o,l=s[1]*r+s[0]*o;a+=(e[0]/2-t[0])*i,l+=(t[1]-e[1]/2)*i,o=-o;const h=a*r-l*o,u=l*r+a*o;return[h,u]}class na extends hb{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Pe.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Pe.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ie(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Ce(e,ce.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof cn?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let n;t.layerStatesArray?n=t.layerStatesArray.find(o=>o.layer===this):n=this.getLayerState();const r=this.getExtent();return Ld(n,t.viewState)&&(!r||je(r,t.extent))}getAttributions(e){var r;if(!this.isVisible(e))return[];const t=(r=this.getSource())==null?void 0:r.getAttributions();if(!t)return[];const i=e instanceof cn?e.getViewStateAndExtent():e;let n=t(i);return Array.isArray(n)||(n=[n]),n}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Pe.MAP,e)}getMapInternal(){return this.get(Pe.MAP)}setMap(e){this.mapPrecomposeKey_&&(Ie(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Ie(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Ce(e,ni.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Ce(this,ce.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);be(!t.some(n=>n.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(Pe.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function Ld(s,e){if(!s.visible)return!1;const t=e.resolution;if(t<s.minResolution||t>=s.maxResolution)return!1;const i=e.zoom;return i>s.minZoom&&i<=s.maxZoom}function cb(s,e,t=0,i=s.length-1,n=yE){for(;i>t;){if(i-t>600){const l=i-t+1,h=e-t+1,u=Math.log(l),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(l-c)/l)*(h-l/2<0?-1:1),f=Math.max(t,Math.floor(e-h*c/l+d)),g=Math.min(i,Math.floor(e+(l-h)*c/l+d));cb(s,e,f,g,n)}const r=s[e];let o=t,a=i;for(Kr(s,t,e),n(s[i],r)>0&&Kr(s,t,i);o<a;){for(Kr(s,o,a),o++,a--;n(s[o],r)<0;)o++;for(;n(s[a],r)>0;)a--}n(s[t],r)===0?Kr(s,t,a):(a++,Kr(s,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function Kr(s,e,t){const i=s[e];s[e]=s[t],s[t]=i}function yE(s,e){return s<e?-1:s>e?1:0}let db=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Ra(e,t))return i;const n=this.toBBox,r=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],l=t.leaf?n(a):a;Ra(e,l)&&(t.leaf?i.push(a):Bh(e,l)?this._all(a,i):r.push(a))}t=r.pop()}return i}collides(e){let t=this.data;if(!Ra(e,t))return!1;const i=[];for(;t;){for(let n=0;n<t.children.length;n++){const r=t.children[n],o=t.leaf?this.toBBox(r):r;if(Ra(e,o)){if(t.leaf||Bh(e,o))return!0;i.push(r)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=tr([]),this}remove(e,t){if(!e)return this;let i=this.data;const n=this.toBBox(e),r=[],o=[];let a,l,h;for(;i||r.length;){if(i||(i=r.pop(),l=r[r.length-1],a=o.pop(),h=!0),i.leaf){const u=vE(e,i.children,t);if(u!==-1)return i.children.splice(u,1),r.push(i),this._condense(r),this}!h&&!i.leaf&&Bh(i,n)?(r.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,n){const r=i-t+1;let o=this._maxEntries,a;if(r<=o)return a=tr(e.slice(t,i+1)),Us(a,this.toBBox),a;n||(n=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,n-1))),a=tr([]),a.leaf=!1,a.height=n;const l=Math.ceil(r/o),h=l*Math.ceil(Math.sqrt(o));Rg(e,t,i,h,this.compareMinX);for(let u=t;u<=i;u+=h){const c=Math.min(u+h-1,i);Rg(e,u,c,l,this.compareMinY);for(let d=u;d<=c;d+=l){const f=Math.min(d+l-1,c);a.children.push(this._build(e,d,f,n-1))}}return Us(a,this.toBBox),a}_chooseSubtree(e,t,i,n){for(;n.push(t),!(t.leaf||n.length-1===i);){let r=1/0,o=1/0,a;for(let l=0;l<t.children.length;l++){const h=t.children[l],u=Hh(h),c=EE(e,h)-u;c<o?(o=c,r=u<r?u:r,a=h):c===o&&u<r&&(r=u,a=h)}t=a||t.children[0]}return t}_insert(e,t,i){const n=i?e:this.toBBox(e),r=[],o=this._chooseSubtree(n,this.data,t,r);for(o.children.push(e),no(o,n);t>=0&&r[t].children.length>this._maxEntries;)this._split(r,t),t--;this._adjustParentBBoxes(n,r,t)}_split(e,t){const i=e[t],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);const o=this._chooseSplitIndex(i,r,n),a=tr(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,Us(i,this.toBBox),Us(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=tr([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Us(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let n,r=1/0,o=1/0;for(let a=t;a<=i-t;a++){const l=io(e,0,a,this.toBBox),h=io(e,a,i,this.toBBox),u=CE(l,h),c=Hh(l)+Hh(h);u<r?(r=u,n=a,o=c<o?c:o):u===r&&c<o&&(o=c,n=a)}return n||i-t}_chooseSplitAxis(e,t,i){const n=e.leaf?this.compareMinX:wE,r=e.leaf?this.compareMinY:_E,o=this._allDistMargin(e,t,i,n),a=this._allDistMargin(e,t,i,r);o<a&&e.children.sort(n)}_allDistMargin(e,t,i,n){e.children.sort(n);const r=this.toBBox,o=io(e,0,t,r),a=io(e,i-t,i,r);let l=xa(o)+xa(a);for(let h=t;h<i-t;h++){const u=e.children[h];no(o,e.leaf?r(u):u),l+=xa(o)}for(let h=i-t-1;h>=t;h--){const u=e.children[h];no(a,e.leaf?r(u):u),l+=xa(a)}return l}_adjustParentBBoxes(e,t,i){for(let n=i;n>=0;n--)no(t[n],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():Us(e[t],this.toBBox)}};function vE(s,e,t){if(!t)return e.indexOf(s);for(let i=0;i<e.length;i++)if(t(s,e[i]))return i;return-1}function Us(s,e){io(s,0,s.children.length,e,s)}function io(s,e,t,i,n){n||(n=tr(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let r=e;r<t;r++){const o=s.children[r];no(n,s.leaf?i(o):o)}return n}function no(s,e){return s.minX=Math.min(s.minX,e.minX),s.minY=Math.min(s.minY,e.minY),s.maxX=Math.max(s.maxX,e.maxX),s.maxY=Math.max(s.maxY,e.maxY),s}function wE(s,e){return s.minX-e.minX}function _E(s,e){return s.minY-e.minY}function Hh(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function xa(s){return s.maxX-s.minX+(s.maxY-s.minY)}function EE(s,e){return(Math.max(e.maxX,s.maxX)-Math.min(e.minX,s.minX))*(Math.max(e.maxY,s.maxY)-Math.min(e.minY,s.minY))}function CE(s,e){const t=Math.max(s.minX,e.minX),i=Math.max(s.minY,e.minY),n=Math.min(s.maxX,e.maxX),r=Math.min(s.maxY,e.maxY);return Math.max(0,n-t)*Math.max(0,r-i)}function Bh(s,e){return s.minX<=e.minX&&s.minY<=e.minY&&e.maxX<=s.maxX&&e.maxY<=s.maxY}function Ra(s,e){return e.minX<=s.maxX&&e.minY<=s.maxY&&e.maxX>=s.minX&&e.maxY>=s.minY}function tr(s){return{children:s,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Rg(s,e,t,i,n){const r=[e,t];for(;r.length;){if(t=r.pop(),e=r.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;cb(s,o,e,t,n),r.push(e,o,o,t)}}function Sg(s,e,t,i){return t!==void 0&&i!==void 0?[t/s,i/e]:t!==void 0?t/s:i!==void 0?i/e:1}class zs extends th{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,n=e.scale!==void 0?e.scale:1,r=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:n,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:r,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;be(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||ge(o)),be(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),be(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=q.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?q.LOADED:q.IDLE:l=q.LOADING:l=q.LOADED),this.color_=e.color!==void 0?pn(e.color):null,this.iconImage_=Ed(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,u;if(e.size)[h,u]=e.size;else{const c=this.getImage(1);if(c.width&&c.height)h=c.width,u=c.height;else if(c instanceof HTMLImageElement){this.initialOptions_=e;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(Sg(f[0],f[1],e.width,e.height))};this.listenImageChange(d);return}}h!==void 0&&this.setScale(Sg(h,u,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new zs({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const n=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!n)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=n[0]),this.anchorYUnits_=="fraction"&&(e[1]*=n[1])}if(this.anchorOrigin_!="top-left"){if(!n)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+n[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+n[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==q.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==q.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(ce.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(ce.CHANGE,e)}ready(){return this.iconImage_.ready()}}let Gs=0;const wt=1<<Gs++,xe=1<<Gs++,At=1<<Gs++,bi=1<<Gs++,Ps=1<<Gs++,so=1<<Gs++,Sa=Math.pow(2,Gs)-1,Ad={[wt]:"boolean",[xe]:"number",[At]:"string",[bi]:"color",[Ps]:"number[]",[so]:"size"},xE=Object.keys(Ad).map(Number).sort(zi);function RE(s){return s in Ad}function ro(s){const e=[];for(const t of xE)oo(s,t)&&e.push(Ad[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function oo(s,e){return(s&e)===e}function An(s,e){return s===e}class qe{constructor(e,t){if(!RE(e))throw new Error(`literal expressions must have a specific type, got ${ro(e)}`);this.type=e,this.value=t}}class SE{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function fb(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1}}function rt(s,e,t){switch(typeof s){case"boolean":{if(An(e,At))return new qe(At,s?"true":"false");if(!oo(e,wt))throw new Error(`got a boolean, but expected ${ro(e)}`);return new qe(wt,s)}case"number":{if(An(e,so))return new qe(so,gt(s));if(An(e,wt))return new qe(wt,!!s);if(An(e,At))return new qe(At,s.toString());if(!oo(e,xe))throw new Error(`got a number, but expected ${ro(e)}`);return new qe(xe,s)}case"string":{if(An(e,bi))return new qe(bi,bd(s));if(An(e,wt))return new qe(wt,!!s);if(!oo(e,At))throw new Error(`got a string, but expected ${ro(e)}`);return new qe(At,s)}}if(!Array.isArray(s))throw new Error("expression must be an array or a primitive value");if(s.length===0)throw new Error("empty expression");if(typeof s[0]=="string")return NE(s,e,t);for(const i of s)if(typeof i!="number")throw new Error("expected an array of numbers");if(An(e,so)){if(s.length!==2)throw new Error(`expected an array of two values for a size, got ${s.length}`);return new qe(so,s)}if(An(e,bi)){if(s.length===3)return new qe(bi,[...s,1]);if(s.length===4)return new qe(bi,s);throw new Error(`expected an array of 3 or 4 values for a color, got ${s.length}`)}if(!oo(e,Ps))throw new Error(`got an array of numbers, but expected ${ro(e)}`);return new qe(Ps,s)}const N={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},TE={[N.Get]:ue(de(1,1/0),Tg),[N.Var]:ue(de(1,1),ME),[N.Has]:ue(de(1,1/0),Tg),[N.Id]:ue(LE,js),[N.Concat]:ue(de(2,1/0),Le(At)),[N.GeometryType]:ue(AE,js),[N.LineMetric]:ue(js),[N.Resolution]:ue(js),[N.Zoom]:ue(js),[N.Time]:ue(js),[N.Any]:ue(de(2,1/0),Le(wt)),[N.All]:ue(de(2,1/0),Le(wt)),[N.Not]:ue(de(1,1),Le(wt)),[N.Equal]:ue(de(2,2),Le(Sa)),[N.NotEqual]:ue(de(2,2),Le(Sa)),[N.GreaterThan]:ue(de(2,2),Le(xe)),[N.GreaterThanOrEqualTo]:ue(de(2,2),Le(xe)),[N.LessThan]:ue(de(2,2),Le(xe)),[N.LessThanOrEqualTo]:ue(de(2,2),Le(xe)),[N.Multiply]:ue(de(2,1/0),Mg),[N.Coalesce]:ue(de(2,1/0),Mg),[N.Divide]:ue(de(2,2),Le(xe)),[N.Add]:ue(de(2,1/0),Le(xe)),[N.Subtract]:ue(de(2,2),Le(xe)),[N.Clamp]:ue(de(3,3),Le(xe)),[N.Mod]:ue(de(2,2),Le(xe)),[N.Pow]:ue(de(2,2),Le(xe)),[N.Abs]:ue(de(1,1),Le(xe)),[N.Floor]:ue(de(1,1),Le(xe)),[N.Ceil]:ue(de(1,1),Le(xe)),[N.Round]:ue(de(1,1),Le(xe)),[N.Sin]:ue(de(1,1),Le(xe)),[N.Cos]:ue(de(1,1),Le(xe)),[N.Atan]:ue(de(1,2),Le(xe)),[N.Sqrt]:ue(de(1,1),Le(xe)),[N.Match]:ue(de(4,1/0),Lg,IE),[N.Between]:ue(de(3,3),Le(xe)),[N.Interpolate]:ue(de(6,1/0),Lg,OE),[N.Case]:ue(de(3,1/0),PE,FE),[N.In]:ue(de(2,2),DE),[N.Number]:ue(de(1,1/0),Le(Sa)),[N.String]:ue(de(1,1/0),Le(Sa)),[N.Array]:ue(de(1,1/0),Le(xe)),[N.Color]:ue(de(1,4),Le(xe)),[N.Band]:ue(de(1,3),Le(xe)),[N.Palette]:ue(de(2,2),kE),[N.ToString]:ue(de(1,1),Le(wt|xe|At|bi))};function Tg(s,e,t){const i=s.length-1,n=new Array(i);for(let r=0;r<i;++r){const o=s[r+1];switch(typeof o){case"number":{n[r]=new qe(xe,o);break}case"string":{n[r]=new qe(At,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}r===0&&t.properties.add(String(o))}return n}function ME(s,e,t){const i=s[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new qe(At,i)]}function LE(s,e,t){t.featureId=!0}function AE(s,e,t){t.geometryType=!0}function js(s,e,t){const i=s[0];if(s.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function de(s,e){return function(t,i,n){const r=t[0],o=t.length-1;if(s===e){if(o!==s){const a=s===1?"":"s";throw new Error(`expected ${s} argument${a} for ${r}, got ${o}`)}}else if(o<s||o>e){const a=e===1/0?`${s} or more`:`${s} to ${e}`;throw new Error(`expected ${a} arguments for ${r}, got ${o}`)}}}function Mg(s,e,t){const i=s.length-1,n=new Array(i);for(let r=0;r<i;++r){const o=rt(s[r+1],e,t);n[r]=o}return n}function Le(s){return function(e,t,i){const n=e.length-1,r=new Array(n);for(let o=0;o<n;++o){const a=rt(e[o+1],s,i);r[o]=a}return r}}function PE(s,e,t){const i=s[0],n=s.length-1;if(n%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${n} instead`)}function Lg(s,e,t){const i=s[0],n=s.length-1;if(n%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${n} instead`)}function IE(s,e,t){const i=s.length-1,n=At|xe|wt,r=rt(s[1],n,t),o=rt(s[s.length-1],e,t),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const h=rt(s[l+2],r.type,t);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+1} of match expression: ${h.message}`)}try{const h=rt(s[l+3],o.type,t);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+2} of match expression: ${h.message}`)}}return[r,...a,o]}function OE(s,e,t){const i=s[1];let n;switch(i[0]){case"linear":n=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);n=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const r=new qe(xe,n);let o;try{o=rt(s[2],xe,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(s.length-3);for(let l=0;l<a.length;l+=2){try{const h=rt(s[l+3],xe,t);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${h.message}`)}try{const h=rt(s[l+4],e,t);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${h.message}`)}}return[r,o,...a]}function FE(s,e,t){const i=rt(s[s.length-1],e,t),n=new Array(s.length-1);for(let r=0;r<n.length-1;r+=2){try{const o=rt(s[r+1],wt,t);n[r]=o}catch(o){throw new Error(`failed to parse argument ${r} of case expression: ${o.message}`)}try{const o=rt(s[r+2],i.type,t);n[r+1]=o}catch(o){throw new Error(`failed to parse argument ${r+1} of case expression: ${o.message}`)}}return n[n.length-1]=i,n}function DE(s,e,t){let i=s[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let n;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],n=At}else n=xe;const r=new Array(i.length);for(let a=0;a<r.length;a++)try{const l=rt(i[a],n,t);r[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[rt(s[1],n,t),...r]}function kE(s,e,t){let i;try{i=rt(s[1],xe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const n=s[2];if(!Array.isArray(n))throw new Error("the second argument of palette must be an array");const r=new Array(n.length);for(let o=0;o<r.length;o++){let a;try{a=rt(n[o],bi,t)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof qe))throw new Error(`the palette color at index ${o} must be a literal value`);r[o]=a}return[i,...r]}function ue(...s){return function(e,t,i){const n=e[0];let r;for(let o=0;o<s.length;o++){const a=s[o](e,t,i);if(o==s.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");r=a}}return new SE(t,n,...r)}}function NE(s,e,t){const i=s[0],n=TE[i];if(!n)throw new Error(`unknown operator: ${i}`);return n(s,e,t)}function gb(s){if(!s)return"";const e=s.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return gb(s.getGeometries()[0]);default:return""}}function pb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function xn(s,e,t){const i=rt(s,e,t);return Ci(i)}function Ci(s,e){if(s instanceof qe){if(s.type===bi&&typeof s.value=="string"){const i=bd(s.value);return function(){return i}}return function(){return s.value}}const t=s.operator;switch(t){case N.Number:case N.String:case N.Coalesce:return zE(s);case N.Get:case N.Var:case N.Has:return GE(s);case N.Id:return i=>i.featureId;case N.GeometryType:return i=>i.geometryType;case N.Concat:{const i=s.args.map(n=>Ci(n));return n=>"".concat(...i.map(r=>r(n).toString()))}case N.Resolution:return i=>i.resolution;case N.Any:case N.All:case N.Between:case N.In:case N.Not:return BE(s);case N.Equal:case N.NotEqual:case N.LessThan:case N.LessThanOrEqualTo:case N.GreaterThan:case N.GreaterThanOrEqualTo:return HE(s);case N.Multiply:case N.Divide:case N.Add:case N.Subtract:case N.Clamp:case N.Mod:case N.Pow:case N.Abs:case N.Floor:case N.Ceil:case N.Round:case N.Sin:case N.Cos:case N.Atan:case N.Sqrt:return VE(s);case N.Case:return WE(s);case N.Match:return UE(s);case N.Interpolate:return jE(s);case N.ToString:return YE(s);default:throw new Error(`Unsupported operator ${t}`)}}function zE(s,e){const t=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ci(s.args[r]);switch(t){case N.Coalesce:return r=>{for(let o=0;o<i;++o){const a=n[o](r);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case N.Number:case N.String:return r=>{for(let o=0;o<i;++o){const a=n[o](r);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function GE(s,e){const i=s.args[0].value;switch(s.operator){case N.Get:return n=>{const r=s.args;let o=n.properties[i];for(let a=1,l=r.length;a<l;++a){const u=r[a].value;o=o[u]}return o};case N.Var:return n=>n.variables[i];case N.Has:return n=>{const r=s.args;if(!(i in n.properties))return!1;let o=n.properties[i];for(let a=1,l=r.length;a<l;++a){const u=r[a].value;if(!o||!Object.hasOwn(o,u))return!1;o=o[u]}return!0};default:throw new Error(`Unsupported accessor operator ${s.operator}`)}}function HE(s,e){const t=s.operator,i=Ci(s.args[0]),n=Ci(s.args[1]);switch(t){case N.Equal:return r=>i(r)===n(r);case N.NotEqual:return r=>i(r)!==n(r);case N.LessThan:return r=>i(r)<n(r);case N.LessThanOrEqualTo:return r=>i(r)<=n(r);case N.GreaterThan:return r=>i(r)>n(r);case N.GreaterThanOrEqualTo:return r=>i(r)>=n(r);default:throw new Error(`Unsupported comparison operator ${t}`)}}function BE(s,e){const t=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ci(s.args[r]);switch(t){case N.Any:return r=>{for(let o=0;o<i;++o)if(n[o](r))return!0;return!1};case N.All:return r=>{for(let o=0;o<i;++o)if(!n[o](r))return!1;return!0};case N.Between:return r=>{const o=n[0](r),a=n[1](r),l=n[2](r);return o>=a&&o<=l};case N.In:return r=>{const o=n[0](r);for(let a=1;a<i;++a)if(o===n[a](r))return!0;return!1};case N.Not:return r=>!n[0](r);default:throw new Error(`Unsupported logical operator ${t}`)}}function VE(s,e){const t=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ci(s.args[r]);switch(t){case N.Multiply:return r=>{let o=1;for(let a=0;a<i;++a)o*=n[a](r);return o};case N.Divide:return r=>n[0](r)/n[1](r);case N.Add:return r=>{let o=0;for(let a=0;a<i;++a)o+=n[a](r);return o};case N.Subtract:return r=>n[0](r)-n[1](r);case N.Clamp:return r=>{const o=n[0](r),a=n[1](r);if(o<a)return a;const l=n[2](r);return o>l?l:o};case N.Mod:return r=>n[0](r)%n[1](r);case N.Pow:return r=>Math.pow(n[0](r),n[1](r));case N.Abs:return r=>Math.abs(n[0](r));case N.Floor:return r=>Math.floor(n[0](r));case N.Ceil:return r=>Math.ceil(n[0](r));case N.Round:return r=>Math.round(n[0](r));case N.Sin:return r=>Math.sin(n[0](r));case N.Cos:return r=>Math.cos(n[0](r));case N.Atan:return i===2?r=>Math.atan2(n[0](r),n[1](r)):r=>Math.atan(n[0](r));case N.Sqrt:return r=>Math.sqrt(n[0](r));default:throw new Error(`Unsupported numeric operator ${t}`)}}function WE(s,e){const t=s.args.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=Ci(s.args[n]);return n=>{for(let r=0;r<t-1;r+=2)if(i[r](n))return i[r+1](n);return i[t-1](n)}}function UE(s,e){const t=s.args.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=Ci(s.args[n]);return n=>{const r=i[0](n);for(let o=1;o<t;o+=2)if(r===i[o](n))return i[o+1](n);return i[t-1](n)}}function jE(s,e){const t=s.args.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=Ci(s.args[n]);return n=>{const r=i[0](n),o=i[1](n);let a,l;for(let h=2;h<t;h+=2){const u=i[h](n);let c=i[h+1](n);const d=Array.isArray(c);if(d&&(c=D_(c)),u>=o)return h===2?c:d?XE(r,o,a,l,u,c):ao(r,o,a,l,u,c);a=u,l=c}return l}}function YE(s,e){const t=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ci(s.args[r]);switch(t){case N.ToString:return r=>{const o=n[0](r);return s.args[0].type===bi?yd(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function ao(s,e,t,i,n,r){const o=n-t;if(o===0)return i;const a=e-t,l=s===1?a/o:(Math.pow(s,a)-1)/(Math.pow(s,o)-1);return i+l*(r-i)}function XE(s,e,t,i,n,r){if(n-t===0)return i;const a=pg(i),l=pg(r);let h=l[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const u=[ao(s,e,t,a[0],n,l[0]),ao(s,e,t,a[1],n,l[1]),a[2]+ao(s,e,t,0,n,h),ao(s,e,t,i[3],n,r[3])];return Jm(k_(u))}function $E(s){return!0}function KE(s){const e=fb(),t=ZE(s,e),i=pb();return function(n,r){if(i.properties=n.getPropertiesInternal(),i.resolution=r,e.featureId){const o=n.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=gb(n.getGeometry())),t(i)}}function Ag(s){const e=fb(),t=s.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Du(s[o],e);const n=pb(),r=new Array(t);return function(o,a){if(n.properties=o.getPropertiesInternal(),n.resolution=a,e.featureId){const h=o.getId();h!==void 0?n.featureId=h:n.featureId=null}let l=0;for(let h=0;h<t;++h){const u=i[h](n);u&&(r[l]=u,l+=1)}return r.length=l,r}}function ZE(s,e){const t=s.length,i=new Array(t);for(let n=0;n<t;++n){const r=s[n],o="filter"in r?xn(r.filter,wt,e):$E;let a;if(Array.isArray(r.style)){const l=r.style.length;a=new Array(l);for(let h=0;h<l;++h)a[h]=Du(r.style[h],e)}else a=[Du(r.style,e)];i[n]={filter:o,styles:a}}return function(n){const r=[];let o=!1;for(let a=0;a<t;++a){const l=i[a].filter;if(l(n)&&!(s[a].else&&o)){o=!0;for(const h of i[a].styles){const u=h(n);u&&r.push(u)}}}return r}}function Du(s,e){const t=No(s,"",e),i=zo(s,"",e),n=qE(s,e),r=JE(s,e),o=It(s,"z-index",e);if(!t&&!i&&!n&&!r&&!Ss(s))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(s));const a=new st;return function(l){let h=!0;if(t){const u=t(l);u&&(h=!1),a.setFill(u)}if(i){const u=i(l);u&&(h=!1),a.setStroke(u)}if(n){const u=n(l);u&&(h=!1),a.setText(u)}if(r){const u=r(l);u&&(h=!1),a.setImage(u)}return o&&a.setZIndex(o(l)),h?null:a}}function No(s,e,t){let i;if(e+"fill-pattern-src"in s)i=iC(s,e+"fill-",t);else{if(s[e+"fill-color"]==="none")return r=>null;i=Pd(s,e+"fill-color",t)}if(!i)return null;const n=new Ui;return function(r){const o=i(r);return o===md?null:(n.setColor(o),n)}}function zo(s,e,t){const i=It(s,e+"stroke-width",t),n=Pd(s,e+"stroke-color",t);if(!i&&!n)return null;const r=hn(s,e+"stroke-line-cap",t),o=hn(s,e+"stroke-line-join",t),a=mb(s,e+"stroke-line-dash",t),l=It(s,e+"stroke-line-dash-offset",t),h=It(s,e+"stroke-miter-limit",t),u=new wi;return function(c){if(n){const d=n(c);if(d===md)return null;u.setColor(d)}if(i&&u.setWidth(i(c)),r){const d=r(c);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(d)}if(o){const d=o(c);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(d)}return a&&u.setLineDash(a(c)),l&&u.setLineDashOffset(l(c)),h&&u.setMiterLimit(h(c)),u}}function qE(s,e){const t="text-",i=hn(s,t+"value",e);if(!i)return null;const n=No(s,t,e),r=No(s,t+"background-",e),o=zo(s,t,e),a=zo(s,t+"background-",e),l=hn(s,t+"font",e),h=It(s,t+"max-angle",e),u=It(s,t+"offset-x",e),c=It(s,t+"offset-y",e),d=Go(s,t+"overflow",e),f=hn(s,t+"placement",e),g=It(s,t+"repeat",e),p=sh(s,t+"scale",e),y=Go(s,t+"rotate-with-view",e),b=It(s,t+"rotation",e),v=hn(s,t+"align",e),_=hn(s,t+"justify",e),m=hn(s,t+"baseline",e),E=mb(s,t+"padding",e),C=rh(s,t+"declutter-mode"),x=new ia({declutterMode:C});return function(w){if(x.setText(i(w)),n&&x.setFill(n(w)),r&&x.setBackgroundFill(r(w)),o&&x.setStroke(o(w)),a&&x.setBackgroundStroke(a(w)),l&&x.setFont(l(w)),h&&x.setMaxAngle(h(w)),u&&x.setOffsetX(u(w)),c&&x.setOffsetY(c(w)),d&&x.setOverflow(d(w)),f){const R=f(w);if(R!=="point"&&R!=="line")throw new Error("Expected point or line for text-placement");x.setPlacement(R)}if(g&&x.setRepeat(g(w)),p&&x.setScale(p(w)),y&&x.setRotateWithView(y(w)),b&&x.setRotation(b(w)),v){const R=v(w);if(R!=="left"&&R!=="center"&&R!=="right"&&R!=="end"&&R!=="start")throw new Error("Expected left, right, center, start, or end for text-align");x.setTextAlign(R)}if(_){const R=_(w);if(R!=="left"&&R!=="right"&&R!=="center")throw new Error("Expected left, right, or center for text-justify");x.setJustify(R)}if(m){const R=m(w);if(R!=="bottom"&&R!=="top"&&R!=="middle"&&R!=="alphabetic"&&R!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");x.setTextBaseline(R)}return E&&x.setPadding(E(w)),x}}function JE(s,e){return"icon-src"in s?QE(s,e):"shape-points"in s?eC(s,e):"circle-radius"in s?tC(s,e):null}function QE(s,e){const t="icon-",i=t+"src",n=bb(s[i],i),r=hl(s,t+"anchor",e),o=sh(s,t+"scale",e),a=It(s,t+"opacity",e),l=hl(s,t+"displacement",e),h=It(s,t+"rotation",e),u=Go(s,t+"rotate-with-view",e),c=Ig(s,t+"anchor-origin"),d=Og(s,t+"anchor-x-units"),f=Og(s,t+"anchor-y-units"),g=oC(s,t+"color"),p=sC(s,t+"cross-origin"),y=rC(s,t+"offset"),b=Ig(s,t+"offset-origin"),v=ul(s,t+"width"),_=ul(s,t+"height"),m=nC(s,t+"size"),E=rh(s,t+"declutter-mode"),C=new zs({src:n,anchorOrigin:c,anchorXUnits:d,anchorYUnits:f,color:g,crossOrigin:p,offset:y,offsetOrigin:b,height:_,width:v,size:m,declutterMode:E});return function(x){return a&&C.setOpacity(a(x)),l&&C.setDisplacement(l(x)),h&&C.setRotation(h(x)),u&&C.setRotateWithView(u(x)),o&&C.setScale(o(x)),r&&C.setAnchor(r(x)),C}}function eC(s,e){const t="shape-",i=t+"points",n=t+"radius",r=ku(s[i],i),o=ku(s[n],n),a=No(s,t,e),l=zo(s,t,e),h=sh(s,t+"scale",e),u=hl(s,t+"displacement",e),c=It(s,t+"rotation",e),d=Go(s,t+"rotate-with-view",e),f=ul(s,t+"radius2"),g=ul(s,t+"angle"),p=rh(s,t+"declutter-mode"),y=new nh({points:r,radius:o,radius2:f,angle:g,declutterMode:p});return function(b){return a&&y.setFill(a(b)),l&&y.setStroke(l(b)),u&&y.setDisplacement(u(b)),c&&y.setRotation(c(b)),d&&y.setRotateWithView(d(b)),h&&y.setScale(h(b)),y}}function tC(s,e){const t="circle-",i=No(s,t,e),n=zo(s,t,e),r=It(s,t+"radius",e),o=sh(s,t+"scale",e),a=hl(s,t+"displacement",e),l=It(s,t+"rotation",e),h=Go(s,t+"rotate-with-view",e),u=rh(s,t+"declutter-mode"),c=new Dr({radius:5,declutterMode:u});return function(d){return r&&c.setRadius(r(d)),i&&c.setFill(i(d)),n&&c.setStroke(n(d)),a&&c.setDisplacement(a(d)),l&&c.setRotation(l(d)),h&&c.setRotateWithView(h(d)),o&&c.setScale(o(d)),c}}function It(s,e,t){if(!(e in s))return;const i=xn(s[e],xe,t);return function(n){return ku(i(n),e)}}function hn(s,e,t){if(!(e in s))return null;const i=xn(s[e],At,t);return function(n){return bb(i(n),e)}}function iC(s,e,t){const i=hn(s,e+"pattern-src",t),n=Pg(s,e+"pattern-offset",t),r=Pg(s,e+"pattern-size",t),o=Pd(s,e+"color",t);return function(a){return{src:i(a),offset:n&&n(a),size:r&&r(a),color:o&&o(a)}}}function Go(s,e,t){if(!(e in s))return null;const i=xn(s[e],wt,t);return function(n){const r=i(n);if(typeof r!="boolean")throw new Error(`Expected a boolean for ${e}`);return r}}function Pd(s,e,t){if(!(e in s))return null;const i=xn(s[e],bi,t);return function(n){return yb(i(n),e)}}function mb(s,e,t){if(!(e in s))return null;const i=xn(s[e],Ps,t);return function(n){return sa(i(n),e)}}function hl(s,e,t){if(!(e in s))return null;const i=xn(s[e],Ps,t);return function(n){const r=sa(i(n),e);if(r.length!==2)throw new Error(`Expected two numbers for ${e}`);return r}}function Pg(s,e,t){if(!(e in s))return null;const i=xn(s[e],Ps,t);return function(n){return vb(i(n),e)}}function sh(s,e,t){if(!(e in s))return null;const i=xn(s[e],Ps|xe,t);return function(n){return aC(i(n),e)}}function ul(s,e){const t=s[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function nC(s,e){const t=s[e];if(t!==void 0){if(typeof t=="number")return gt(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function sC(s,e){const t=s[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function Ig(s,e){const t=s[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function Og(s,e){const t=s[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function rC(s,e){const t=s[e];if(t!==void 0)return sa(t,e)}function rh(s,e){const t=s[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function oC(s,e){const t=s[e];if(t!==void 0)return yb(t,e)}function sa(s,e){if(!Array.isArray(s))throw new Error(`Expected an array for ${e}`);const t=s.length;for(let i=0;i<t;++i)if(typeof s[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return s}function bb(s,e){if(typeof s!="string")throw new Error(`Expected a string for ${e}`);return s}function ku(s,e){if(typeof s!="number")throw new Error(`Expected a number for ${e}`);return s}function yb(s,e){if(typeof s=="string")return s;const t=sa(s,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function vb(s,e){const t=sa(s,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function aC(s,e){return typeof s=="number"?s:vb(s,e)}const Fg={RENDER_ORDER:"renderOrder"};class Id extends na{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Fg.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new db(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(Fg.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?lb:e;const t=lC(e);this.styleFunction_=e===null?void 0:sE(t),this.changed()}}function lC(s){if(s===void 0)return lb;if(!s)return null;if(typeof s=="function"||s instanceof st)return s;if(!Array.isArray(s))return Ag([s]);if(s.length===0)return[];const e=s.length,t=s[0];if(t instanceof st){const n=new Array(e);for(let r=0;r<e;++r){const o=s[r];if(!(o instanceof st))throw new Error("Expected a list of style instances");n[r]=o}return n}if("style"in t){const n=new Array(e);for(let r=0;r<e;++r){const o=s[r];if(!("style"in o))throw new Error("Expected a list of rules with a style property");n[r]=o}return KE(n)}return Ag(s)}const se={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ta=[se.FILL],Yn=[se.STROKE],bs=[se.BEGIN_PATH],Dg=[se.CLOSE_PATH];class wb{drawCustom(e,t,i,n,r){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}class ra extends wb{constructor(e,t,i,n){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,l=e.length;a<l;a+=t)n[0]=e[a],n[1]=e[a+1],Ms(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}appendFlatLineCoordinates(e,t,i,n,r,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(t+=n);let u=e[t],c=e[t+1];const d=this.tmpCoordinate_;let f=!0,g,p,y;for(g=t+n;g<i;g+=n)d[0]=e[g],d[1]=e[g+1],y=Ru(h,d),y!==p?(f&&(a[l++]=u,a[l++]=c,f=!1),a[l++]=d[0],a[l++]=d[1]):y===tt.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,u=d[0],c=d[1],p=y;return(r&&f||g===t+n)&&(a[l++]=u,a[l++]=c),l}drawCustomCoordinates_(e,t,i,n,r){for(let o=0,a=i.length;o<a;++o){const l=i[o],h=this.appendFlatLineCoordinates(e,t,l,n,!1,!1);r.push(h),t=l}return t}drawCustom(e,t,i,n,r){this.beginGeometry(e,t,r);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let h,u,c,d,f;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),d=[];const g=e.getEndss();f=0;for(let p=0,y=g.length;p<y;++p){const b=[];f=this.drawCustomCoordinates_(h,f,g[p],a,b),d.push(b)}this.instructions.push([se.CUSTOM,l,d,e,i,Au,r]),this.hitDetectionInstructions.push([se.CUSTOM,l,d,e,n||i,Au,r]);break;case"Polygon":case"MultiLineString":c=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),f=this.drawCustomCoordinates_(h,0,e.getEnds(),a,c),this.instructions.push([se.CUSTOM,l,c,e,i,Po,r]),this.hitDetectionInstructions.push([se.CUSTOM,l,c,e,n||i,Po,r]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([se.CUSTOM,l,u,e,i,jn,r]),this.hitDetectionInstructions.push([se.CUSTOM,l,u,e,n||i,jn,r]);break;case"MultiPoint":h=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(h,a),u>l&&(this.instructions.push([se.CUSTOM,l,u,e,i,jn,r]),this.hitDetectionInstructions.push([se.CUSTOM,l,u,e,n||i,jn,r]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),u=this.coordinates.length,this.instructions.push([se.CUSTOM,l,u,e,i,void 0,r]),this.hitDetectionInstructions.push([se.CUSTOM,l,u,e,n||i,void 0,r]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[se.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[se.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let n,r,o=-1;for(t=0;t<i;++t)n=e[t],r=n[0],r==se.END_GEOMETRY?o=t:r==se.BEGIN_GEOMETRY&&(n[2]=t,P0(this.hitDetectionInstructions,o,t),o=-1)}setFillStrokeStyle(e,t){const i=this.state;if(e){const n=e.getColor();i.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,i.fillStyle=ki(n||Lt)}else i.fillStyle=void 0;if(t){const n=t.getColor();i.strokeStyle=ki(n||Fo);const r=t.getLineCap();i.lineCap=r!==void 0?r:Tr;const o=t.getLineDash();i.lineDash=o?o.slice():mn;const a=t.getLineDashOffset();i.lineDashOffset=a||bn;const l=t.getLineJoin();i.lineJoin=l!==void 0?l:Mr;const h=t.getWidth();i.lineWidth=h!==void 0?h:ko;const u=t.getMiterLimit();i.miterLimit=u!==void 0?u:Oo,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(e){const t=e.fillStyle,i=[se.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[se.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,this.applyPixelRatio(e.lineDash),e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,n=e.lineCap,r=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=n||r!=e.currentLineDash&&!ts(e.currentLineDash,r)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=h)&&(i!==void 0&&t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=n,e.currentLineDash=r,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[se.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Lm(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Ts(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class hC extends ra{constructor(e,t,i,n){super(e,t,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!Ms(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const n=e.getFlatCoordinates(),r=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(n,r);this.instructions.push([se.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([se.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const n=e.getFlatCoordinates(),r=[];for(let l=0,h=n.length;l<h;l+=e.getStride())(!this.maxExtent||Ms(this.maxExtent,n.slice(l,l+2)))&&r.push(n[l],n[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,2);this.instructions.push([se.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([se.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),n=e.getSize(),r=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=e.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=n[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class uC extends ra{constructor(e,t,i,n){super(e,t,i,n)}drawFlatCoordinates_(e,t,i,n){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,n,!1,!1),a=[se.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([se.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,mn,bn],bs);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Yn),this.endGeometry(t)}drawMultiLineString(e,t,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([se.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,mn,bn],bs);const a=e.getEnds(),l=e.getFlatCoordinates(),h=e.getStride();let u=0;for(let c=0,d=a.length;c<d;++c)u=this.drawFlatCoordinates_(l,u,a[c],h);this.hitDetectionInstructions.push(Yn),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Yn),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Yn),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(bs)}}class kg extends ra{constructor(e,t,i,n){super(e,t,i,n)}drawFlatCoordinatess_(e,t,i,n){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,l=i.length;this.instructions.push(bs),this.hitDetectionInstructions.push(bs);for(let h=0;h<l;++h){const u=i[h],c=this.coordinates.length,d=this.appendFlatLineCoordinates(e,t,u,n,!0,!a),f=[se.MOVE_TO_LINE_TO,c,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(Dg),this.hitDetectionInstructions.push(Dg)),t=u}return o&&(this.instructions.push(Ta),this.hitDetectionInstructions.push(Ta)),a&&(this.instructions.push(Yn),this.hitDetectionInstructions.push(Yn)),t}drawCircle(e,t,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([se.SET_FILL_STYLE,Lt]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([se.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,mn,bn]);const a=e.getFlatCoordinates(),l=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const u=[se.CIRCLE,h];this.instructions.push(bs,u),this.hitDetectionInstructions.push(bs,u),n.fillStyle!==void 0&&(this.instructions.push(Ta),this.hitDetectionInstructions.push(Ta)),n.strokeStyle!==void 0&&(this.instructions.push(Yn),this.hitDetectionInstructions.push(Yn)),this.endGeometry(t)}drawPolygon(e,t,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([se.SET_FILL_STYLE,Lt]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([se.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,mn,bn]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(l,0,a,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([se.SET_FILL_STYLE,Lt]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([se.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,mn,bn]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),h=e.getStride();let u=0;for(let c=0,d=a.length;c<d;++c)u=this.drawFlatCoordinatess_(l,u,a[c],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,n=t.length;i<n;++i)t[i]=hs(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;e.fillStyle!==void 0&&this.updateFillStyle(e,this.createFill),e.strokeStyle!==void 0&&this.updateStrokeStyle(e,this.applyStroke)}}function cC(s,e,t,i,n){const r=[];let o=t,a=0,l=e.slice(t,2);for(;a<s&&o+n<i;){const[h,u]=l.slice(-2),c=e[o+n],d=e[o+n+1],f=Math.sqrt((c-h)*(c-h)+(d-u)*(d-u));if(a+=f,a>=s){const g=(s-a+f)/f,p=jt(h,c,g),y=jt(u,d,g);l.push(p,y),r.push(l),l=[p,y],a==s&&(o+=n),a=0}else if(a<s)l.push(e[o+n],e[o+n+1]),o+=n;else{const g=f-a,p=jt(h,c,g/f),y=jt(u,d,g/f);l.push(p,y),r.push(l),l=[p,y],a=0,o+=n}}return a>0&&r.push(l),r}function dC(s,e,t,i,n){let r=t,o=t,a=0,l=0,h=t,u,c,d,f,g,p,y,b,v,_;for(c=t;c<i;c+=n){const m=e[c],E=e[c+1];g!==void 0&&(v=m-g,_=E-p,f=Math.sqrt(v*v+_*_),y!==void 0&&(l+=d,u=Math.acos((y*v+b*_)/(d*f)),u>s&&(l>a&&(a=l,r=h,o=c),l=0,h=c-n)),d=f,y=v,b=_),g=m,p=E}return l+=f,l>a?[h,c]:[r,o]}const cl={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class fC extends ra{constructor(e,t,i,n){super(e,t,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Lt]={fillStyle:Lt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const n=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!n&&!r)return;const a=this.coordinates;let l=a.length;const h=e.getType();let u=null,c=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!je(this.maxExtent,e.getExtent()))return;let d;if(u=e.getFlatCoordinates(),h=="LineString")d=[u.length];else if(h=="MultiLineString")d=e.getEnds();else if(h=="Polygon")d=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const y=e.getEndss();d=[];for(let b=0,v=y.length;b<v;++b)d.push(y[b][0])}this.beginGeometry(e,t,i);const f=o.repeat,g=f?void 0:o.textAlign;let p=0;for(let y=0,b=d.length;y<b;++y){let v;f?v=cC(f*this.resolution,u,p,d[y],c):v=[u.slice(p,d[y])];for(let _=0,m=v.length;_<m;++_){const E=v[_];let C=0,x=E.length;if(g==null){const R=dC(o.maxAngle,E,0,E.length,2);C=R[0],x=R[1]}for(let R=C;R<x;R+=c)a.push(E[R],E[R+1]);const w=a.length;p=d[y],this.drawChars_(l,w),l=w}}this.endGeometry(t)}else{let d=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),c=2;break;case"Polygon":u=e.getFlatInteriorPoint(),o.overflow||d.push(u[2]/this.resolution),c=3;break;case"MultiPolygon":const v=e.getFlatInteriorPoints();u=[];for(let _=0,m=v.length;_<m;_+=3)o.overflow||d.push(v[_+2]/this.resolution),u.push(v[_],v[_+1]);if(u.length===0)return;c=2;break}const f=this.appendFlatPointCoordinates(u,c);if(f===l)return;if(d&&(f-l)/2!==u.length/c){let v=l/2;d=d.filter((_,m)=>{const E=a[(v+m)*2]===u[m*c]&&a[(v+m)*2+1]===u[m*c+1];return E||--v,E})}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(e,t,i);let g=o.padding;if(g!=ms&&(o.scale[0]<0||o.scale[1]<0)){let v=o.padding[0],_=o.padding[1],m=o.padding[2],E=o.padding[3];o.scale[0]<0&&(_=-_,E=-E),o.scale[1]<0&&(v=-v,m=-m),g=[v,_,m,E]}const p=this.pixelRatio;this.instructions.push([se.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,g==ms?ms:g.map(function(v){return v*p}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const y=1/p,b=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=Lt,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([se.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[y,y],NaN,this.declutterMode_,this.declutterImageWithText_,g,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Lt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),o.backgroundFill&&(this.state.fillStyle=b,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,n=this.strokeKey_;e&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:t.font,textAlign:t.textAlign||Do,justify:t.justify,textBaseline:t.textBaseline||al,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=cl[n.textBaseline],u=this.textOffsetY_*l,c=this.text_,d=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([se.DRAW_CHARS,e,t,h,n.overflow,a,n.maxAngle,l,u,r,d*l,c,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([se.DRAW_CHARS,e,t,h,n.overflow,a&&Lt,n.maxAngle,l,u,r,d*l,c,o,1/l,this.declutterMode_])}setTextStyle(e,t){let i,n,r;if(!e)this.text_="";else{const o=e.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=ki(o.getColor()||Lt)):(n=null,this.textFillState_=n);const a=e.getStroke();if(!a)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const g=a.getLineDash(),p=a.getLineDashOffset(),y=a.getWidth(),b=a.getMiterLimit();r.lineCap=a.getLineCap()||Tr,r.lineDash=g?g.slice():mn,r.lineDashOffset=p===void 0?bn:p,r.lineJoin=a.getLineJoin()||Mr,r.lineWidth=y===void 0?ko:y,r.miterLimit=b===void 0?Oo:b,r.strokeStyle=ki(a.getColor()||Fo)}i=this.textState_;const l=e.getFont()||ob;Q_(l);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=l,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||al,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||ms,i.scale=h===void 0?[1,1]:h;const u=e.getOffsetX(),c=e.getOffsetY(),d=e.getRotateWithView(),f=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=c===void 0?0:c,this.textRotateWithView_=d===void 0?!1:d,this.textRotation_=f===void 0?0:f,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:ge(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?typeof n.fillStyle=="string"?n.fillStyle:"|"+ge(n.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const gC={Circle:kg,Default:ra,Image:hC,LineString:uC,Polygon:kg,Text:fC};class _b{constructor(e,t,i,n){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const n in i){const r=i[n].finish();e[t][n]=r}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let r=n[t];if(r===void 0){const o=gC[t];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[t]=r}return r}}const pC=5;class mC extends Jo{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=pC}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return ne()}getData(e){return null}prepareFrame(e){return ne()}renderFrame(e,t){return ne()}forEachFeatureAtCoordinate(e,t,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===q.LOADED||t.getState()===q.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=q.LOADED&&t!=q.ERROR&&e.addEventListener(ce.CHANGE,this.boundHandleImageChange_),t==q.IDLE&&(e.load(),t=e.getState()),t==q.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class Eb extends ji{constructor(e,t,i,n){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=n}}class Od{constructor(){U(this,"pushMethodArgs_",(...e)=>(this.instructions_[this.zIndex+this.offset_].push(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(rl(),{get:(e,t)=>{if(typeof rl()[t]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t),this.pushMethodArgs_},set:(e,t,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t,i),!0)})}pushFunction(e){this.instructions_[this.zIndex+this.offset_].push(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,n=t.length;i<n;++i){const r=t[i];if(typeof r=="function"){r(e);continue}const o=t[++i];if(typeof e[r]=="function")e[r](...o);else{if(typeof o=="function"){e[r]=o(e);continue}e[r]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Ng=[];let ir=null;function bC(){ir=We(1,1,void 0,{willReadFrequently:!0})}class Fd extends mC{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Xt(),this.pixelTransform=Xt(),this.inversePixelTransform=Xt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){ir||bC(),ir.clearRect(0,0,1,1);let n;try{ir.drawImage(e,t,i,1,1,0,0,1,1),n=ir.getImageData(0,0,1,1).data}catch{return ir=null,null}return n}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const n=this.getLayer().getClassName();let r,o;if(e&&e.className===n&&(!i||e&&e.style.backgroundColor&&ts(pn(e.style.backgroundColor),pn(i)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=n;let a=r.style;a.position="absolute",a.width="100%",a.height="100%",o=We();const l=o.canvas;r.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const n=is(i),r=$l(i),o=Xl(i),a=Yl(i);$e(t.coordinateToPixelTransform,n),$e(t.coordinateToPixelTransform,r),$e(t.coordinateToPixelTransform,o),$e(t.coordinateToPixelTransform,a);const l=this.inversePixelTransform;$e(l,n),$e(l,r),$e(l,o),$e(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,n=e.viewState.resolution,r=e.viewState.rotation,o=e.pixelRatio,a=Math.round(_e(i)/n*o),l=Math.round(Ke(i)/n*o);Vi(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,r,-a/2,-l/2),Mm(this.inversePixelTransform,this.pixelTransform);const h=G0(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const u=this.context.canvas;u.width!=a||u.height!=l?(u.width=a,u.height=l):this.context.clearRect(0,0,a,l),h!==u.style.transform&&(u.style.transform=h)}}dispatchRenderEvent_(e,t,i){const n=this.getLayer();if(n.hasListener(e)){const r=new Eb(e,this.inversePixelTransform,i,t);n.dispatchEvent(r)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(ni.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(ni.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Od),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(ni.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(ni.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,n,r,o,a){const l=r/2,h=o/2,u=n/t,c=-u,d=-e[0]+a,f=-e[1];return Vi(this.tempTransform,l,h,u,c,-i,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function yC(s,e,t,i,n,r,o,a,l,h,u,c){let d=s[e],f=s[e+1],g=0,p=0,y=0,b=0;function v(){g=d,p=f,e+=i,d=s[e],f=s[e+1],b+=y,y=Math.sqrt((d-g)*(d-g)+(f-p)*(f-p))}do v();while(e<t-i&&b+y<r);let _=y===0?0:(r-b)/y;const m=jt(g,d,_),E=jt(p,f,_),C=e-i,x=b,w=r+a*l(h,n,u);for(;e<t-i&&b+y<w;)v();_=y===0?0:(w-b)/y;const R=jt(g,d,_),I=jt(p,f,_);let T;if(c){const M=[m,E,R,I];sd(M,0,4,2,c,M,M),T=M[0]>M[2]}else T=m>R;const A=Math.PI,F=[],S=C+i===e;e=C,y=0,b=x,d=s[e],f=s[e+1];let O;if(S){v(),O=Math.atan2(f-p,d-g),T&&(O+=O>0?-A:A);const M=(R+m)/2,D=(I+E)/2;return F[0]=[M,D,(w-r)/2,O,n],F}n=n.replace(/\n/g," ");for(let M=0,D=n.length;M<D;){v();let H=Math.atan2(f-p,d-g);if(T&&(H+=H>0?-A:A),O!==void 0){let z=H-O;if(z+=z>A?-2*A:z<-A?2*A:0,Math.abs(z)>o)return null}O=H;const j=M;let V=0;for(;M<D;++M){const z=T?D-M-1:M,me=a*l(h,n[z],u);if(e+i<t&&b+y<r+V+me/2)break;V+=me}if(M===j)continue;const Y=T?n.substring(D-j,D-M):n.substring(j,M);_=y===0?0:(r+V/2-b)/y;const K=jt(g,d,_),Ee=jt(p,f,_);F.push([K,Ee,V/2,H,Y]),r+=V}return F}const Ys=Kt(),Pn=[],Qi=[],en=[],In=[];function zg(s){return s[3].declutterBox}const Gg=new RegExp("[-----]");function Vh(s,e){return e==="start"?e=Gg.test(s)?"right":"left":e==="end"&&(e=Gg.test(s)?"left":"right"),cl[e]}function vC(s,e,t){return t>0&&s.push(`
`,""),s.push(e,""),s}class wC{constructor(e,t,i,n,r){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=Xt(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new Od:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,n){const r=e+t+i+n;if(this.labels_[r])return this.labels_[r];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[t],h=this.pixelRatio,u=[l.scale[0]*h,l.scale[1]*h],c=l.justify?cl[l.justify]:Vh(Array.isArray(e)?e[0]:e,l.textAlign||Do),d=n&&o.lineWidth?o.lineWidth:0,f=Array.isArray(e)?e:String(e).split(`
`).reduce(vC,[]),{width:g,height:p,widths:y,heights:b,lineWidths:v}=tE(l,f),_=g+d,m=[],E=(_+2)*u[0],C=(p+d)*u[1],x={width:E<0?Math.floor(E):Math.ceil(E),height:C<0?Math.floor(C):Math.ceil(C),contextInstructions:m};(u[0]!=1||u[1]!=1)&&m.push("scale",u),n&&(m.push("strokeStyle",o.strokeStyle),m.push("lineWidth",d),m.push("lineCap",o.lineCap),m.push("lineJoin",o.lineJoin),m.push("miterLimit",o.miterLimit),m.push("setLineDash",[o.lineDash]),m.push("lineDashOffset",o.lineDashOffset)),i&&m.push("fillStyle",a.fillStyle),m.push("textBaseline","middle"),m.push("textAlign","center");const w=.5-c;let R=c*_+w*d;const I=[],T=[];let A=0,F=0,S=0,O=0,M;for(let D=0,H=f.length;D<H;D+=2){const j=f[D];if(j===`
`){F+=A,A=0,R=c*_+w*d,++O;continue}const V=f[D+1]||l.font;V!==M&&(n&&I.push("font",V),i&&T.push("font",V),M=V),A=Math.max(A,b[S]);const Y=[j,R+w*y[S]+c*(y[S]-v[O]),.5*(d+A)+F];R+=y[S],n&&I.push("strokeText",Y),i&&T.push("fillText",Y),++S}return Array.prototype.push.apply(m,I),Array.prototype.push.apply(m,T),this.labels_[r]=x,x}replayTextBackground_(e,t,i,n,r,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,n,r,o,a,l,h,u,c,d,f,g,p,y){a*=d[0],l*=d[1];let b=i-a,v=n-l;const _=r+h>e?e-h:r,m=o+u>t?t-u:o,E=g[3]+_*d[0]+g[1],C=g[0]+m*d[1]+g[2],x=b-g[3],w=v-g[0];(p||c!==0)&&(Pn[0]=x,In[0]=x,Pn[1]=w,Qi[1]=w,Qi[0]=x+E,en[0]=Qi[0],en[1]=w+C,In[1]=en[1]);let R;return c!==0?(R=Vi(Xt(),i,n,1,1,c,-i,-n),$e(R,Pn),$e(R,Qi),$e(R,en),$e(R,In),ui(Math.min(Pn[0],Qi[0],en[0],In[0]),Math.min(Pn[1],Qi[1],en[1],In[1]),Math.max(Pn[0],Qi[0],en[0],In[0]),Math.max(Pn[1],Qi[1],en[1],In[1]),Ys)):ui(Math.min(x,x+E),Math.min(w,w+C),Math.max(x,x+E),Math.max(w,w+C),Ys),f&&(b=Math.round(b),v=Math.round(v)),{drawImageX:b,drawImageY:v,drawImageW:_,drawImageH:m,originX:h,originY:u,declutterBox:{minX:Ys[0],minY:Ys[1],maxX:Ys[2],maxY:Ys[3],value:y},canvasTransform:R,scale:d}}replayImageOrLabel_(e,t,i,n,r,o,a){const l=!!(o||a),h=n.declutterBox,u=a?a[2]*n.scale[0]/2:0;return h.minX-u<=t[0]&&h.maxX+u>=0&&h.minY-u<=t[1]&&h.maxY+u>=0&&(l&&this.replayTextBackground_(e,Pn,Qi,en,In,o,a),iE(e,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=$e(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;e.save(),e.translate(i[0]%n,i[1]%n),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}drawLabelWithPointPlacement_(e,t,i,n){const r=this.textStates[t],o=this.createLabel(e,t,n,i),a=this.strokeStates[i],l=this.pixelRatio,h=Vh(Array.isArray(e)?e[0]:e,r.textAlign||Do),u=cl[r.textBaseline||al],c=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*r.scale[0],f=h*d+2*(.5-h)*c,g=u*o.height/l+2*(.5-u)*c;return{label:o,anchorX:f,anchorY:g}}execute_(e,t,i,n,r,o,a,l){const h=this.zIndexContext_;let u;this.pixelCoordinates_&&ts(i,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=qn(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),k0(this.renderedTransform_,i));let c=0;const d=n.length;let f=0,g,p,y,b,v,_,m,E,C,x,w,R,I,T=0,A=0,F=null,S=null;const O=this.coordinateCache_,M=this.viewRotation_,D=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,H={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:M},j=this.instructions!=n||this.overlaps?0:200;let V,Y,K,Ee;for(;c<d;){const z=n[c];switch(z[0]){case se.BEGIN_GEOMETRY:V=z[1],Ee=z[3],V.getGeometry()?a!==void 0&&!je(a,Ee.getExtent())?c=z[2]+1:++c:c=z[2],h&&(h.zIndex=z[4]);break;case se.BEGIN_PATH:T>j&&(this.fill_(e),T=0),A>j&&(e.stroke(),A=0),!T&&!A&&(e.beginPath(),v=NaN,_=NaN),++c;break;case se.CIRCLE:f=z[1];const ye=u[f],ve=u[f+1],Ae=u[f+2],Xe=u[f+3],Ue=Ae-ye,mt=Xe-ve,Mi=Math.sqrt(Ue*Ue+mt*mt);e.moveTo(ye+Mi,ve),e.arc(ye,ve,Mi,0,2*Math.PI,!0),++c;break;case se.CLOSE_PATH:e.closePath(),++c;break;case se.CUSTOM:f=z[1],g=z[2];const Li=z[3],Sn=z[4],Ai=z[5];H.geometry=Li,H.feature=V,c in O||(O[c]=[]);const Bt=O[c];Ai?Ai(u,f,g,2,Bt):(Bt[0]=u[f],Bt[1]=u[f+1],Bt.length=2),h&&(h.zIndex=z[6]),Sn(Bt,H),++c;break;case se.DRAW_IMAGE:f=z[1],g=z[2],C=z[3],p=z[4],y=z[5];let Qe=z[6];const bt=z[7],fi=z[8],ht=z[9],xt=z[10];let Vt=z[11];const Rt=z[12];let qt=z[13];b=z[14]||"declutter";const Ge=z[15];if(!C&&z.length>=20){x=z[19],w=z[20],R=z[21],I=z[22];const Ze=this.drawLabelWithPointPlacement_(x,w,R,I);C=Ze.label,z[3]=C;const Ki=z[23];p=(Ze.anchorX-Ki)*this.pixelRatio,z[4]=p;const ct=z[24];y=(Ze.anchorY-ct)*this.pixelRatio,z[5]=y,Qe=C.height,z[6]=Qe,qt=C.width,z[13]=qt}let Tn;z.length>25&&(Tn=z[25]);let Mn,$i,Bs;z.length>17?(Mn=z[16],$i=z[17],Bs=z[18]):(Mn=ms,$i=!1,Bs=!1),xt&&D?Vt+=M:!xt&&!D&&(Vt-=M);let Mh=0;for(;f<g;f+=2){if(Tn&&Tn[Mh++]<qt/this.pixelRatio)continue;const Ze=this.calculateImageOrLabelDimensions_(C.width,C.height,u[f],u[f+1],qt,Qe,p,y,fi,ht,Vt,Rt,r,Mn,$i||Bs,V),Ki=[e,t,C,Ze,bt,$i?F:null,Bs?S:null];if(l){let ct,yt,Qt;if(Ge){const Ve=g-f;if(!Ge[Ve]){Ge[Ve]={args:Ki,declutterMode:b};continue}const vt=Ge[Ve];ct=vt.args,yt=vt.declutterMode,delete Ge[Ve],Qt=zg(ct)}let Zi,qi;if(ct&&(yt!=="declutter"||!l.collides(Qt))&&(Zi=!0),(b!=="declutter"||!l.collides(Ze.declutterBox))&&(qi=!0),yt==="declutter"&&b==="declutter"){const Ve=Zi&&qi;Zi=Ve,qi=Ve}Zi&&(yt!=="none"&&l.insert(Qt),this.replayImageOrLabel_.apply(this,ct)),qi&&(b!=="none"&&l.insert(Ze.declutterBox),this.replayImageOrLabel_.apply(this,Ki))}else this.replayImageOrLabel_.apply(this,Ki)}++c;break;case se.DRAW_CHARS:const pa=z[1],ma=z[2],Ur=z[3],k=z[4];I=z[5];const J=z[6],oe=z[7],Me=z[8];R=z[9];const we=z[10];x=z[11],w=z[12];const et=[z[13],z[13]];b=z[14]||"declutter";const ut=this.textStates[w],Jt=ut.font,Ln=[ut.scale[0]*oe,ut.scale[1]*oe];let Wt;Jt in this.widths_?Wt=this.widths_[Jt]:(Wt={},this.widths_[Jt]=Wt);const Vs=rb(u,pa,ma,2),rs=Math.abs(Ln[0])*wg(Jt,x,Wt);if(k||rs<=Vs){const Ze=this.textStates[w].textAlign,Ki=(Vs-rs)*Vh(x,Ze),ct=yC(u,pa,ma,2,x,Ki,J,Math.abs(Ln[0]),wg,Jt,Wt,D?0:this.viewRotation_);e:if(ct){const yt=[];let Qt,Zi,qi,Ve,vt;if(R)for(Qt=0,Zi=ct.length;Qt<Zi;++Qt){vt=ct[Qt],qi=vt[4],Ve=this.createLabel(qi,w,"",R),p=vt[2]+(Ln[0]<0?-we:we),y=Ur*Ve.height+(.5-Ur)*2*we*Ln[1]/Ln[0]-Me;const Ji=this.calculateImageOrLabelDimensions_(Ve.width,Ve.height,vt[0],vt[1],Ve.width,Ve.height,p,y,0,0,vt[3],et,!1,ms,!1,V);if(l&&b==="declutter"&&l.collides(Ji.declutterBox))break e;yt.push([e,t,Ve,Ji,1,null,null])}if(I)for(Qt=0,Zi=ct.length;Qt<Zi;++Qt){vt=ct[Qt],qi=vt[4],Ve=this.createLabel(qi,w,I,""),p=vt[2],y=Ur*Ve.height-Me;const Ji=this.calculateImageOrLabelDimensions_(Ve.width,Ve.height,vt[0],vt[1],Ve.width,Ve.height,p,y,0,0,vt[3],et,!1,ms,!1,V);if(l&&b==="declutter"&&l.collides(Ji.declutterBox))break e;yt.push([e,t,Ve,Ji,1,null,null])}l&&b!=="none"&&l.load(yt.map(zg));for(let Ji=0,Jv=yt.length;Ji<Jv;++Ji)this.replayImageOrLabel_.apply(this,yt[Ji])}}++c;break;case se.END_GEOMETRY:if(o!==void 0){V=z[1];const Ze=o(V,Ee,b);if(Ze)return Ze}++c;break;case se.FILL:j?T++:this.fill_(e),++c;break;case se.MOVE_TO_LINE_TO:for(f=z[1],g=z[2],Y=u[f],K=u[f+1],e.moveTo(Y,K),v=Y+.5|0,_=K+.5|0,f+=2;f<g;f+=2)Y=u[f],K=u[f+1],m=Y+.5|0,E=K+.5|0,(f==g-2||m!==v||E!==_)&&(e.lineTo(Y,K),v=m,_=E);++c;break;case se.SET_FILL_STYLE:F=z,this.alignAndScaleFill_=z[2],T&&(this.fill_(e),T=0,A&&(e.stroke(),A=0)),e.fillStyle=z[1],++c;break;case se.SET_STROKE_STYLE:S=z,A&&(e.stroke(),A=0),this.setStrokeStyle_(e,z),++c;break;case se.STROKE:j?A++:e.stroke(),++c;break;default:++c;break}}T&&this.fill_(e),A&&e.stroke()}execute(e,t,i,n,r,o){this.viewRotation_=n,this.execute_(e,t,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(e,t,i,n,r){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,n,r)}}const or=["Polygon","Circle","LineString","Image","Text","Default"],dl=["Image","Text"],_C=or.filter(s=>!dl.includes(s));class Cb{constructor(e,t,i,n,r,o,a){this.maxExtent_=e,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Xt(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let n=this.executorsByZIndex_[i];n===void 0&&(n={},this.executorsByZIndex_[i]=n);const r=e[i];for(const o in r){const a=r[o];n[o]=new wC(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let n=0,r=e.length;n<r;++n)if(e[n]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,n,r,o){n=Math.round(n);const a=n*2+1,l=Vi(this.hitDetectionTransform_,n+.5,n+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=We(a,a,void 0,{willReadFrequently:!0}));const u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):h||u.clearRect(0,0,a,a);let c;this.renderBuffer_!==void 0&&(c=Kt(),po(c,e),Ts(c,t*(this.renderBuffer_+n),c));const d=EC(n);let f;function g(E,C,x){const w=u.getImageData(0,0,a,a).data;for(let R=0,I=d.length;R<I;R++)if(w[d[R]]>0){if(!o||x==="none"||f!=="Image"&&f!=="Text"||o.includes(E)){const T=(d[R]-3)/4,A=n-T%a,F=n-(T/a|0),S=r(E,C,A*A+F*F);if(S)return S}u.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(zi);let y,b,v,_,m;for(y=p.length-1;y>=0;--y){const E=p[y].toString();for(v=this.executorsByZIndex_[E],b=or.length-1;b>=0;--b)if(f=or[b],_=v[f],_!==void 0&&(m=_.executeHitDetection(u,l,i,g,c),m))return m}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],n=t[1],r=t[2],o=t[3],a=[i,n,i,o,r,o,r,n];return qn(a,0,8,2,e,a),a}isEmpty(){return Ss(this.executorsByZIndex_)}execute(e,t,i,n,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(zi),o=o||or;const h=or.length;let u,c,d,f,g;for(a&&l.reverse(),u=0,c=l.length;u<c;++u){const p=l[u].toString();for(g=this.executorsByZIndex_[p],d=0,f=o.length;d<f;++d){const y=o[d],b=g[y];if(b!==void 0){const v=a===null?void 0:b.getZIndexContext(),_=v?v.getContext():e,m=this.maxExtent_&&y!=="Image"&&y!=="Text";if(m&&(_.save(),this.clip(_,i)),!v||y==="Text"||y==="Image"?b.execute(_,t,i,n,r,a):v.pushFunction(E=>b.execute(E,t,i,n,r,a)),m&&_.restore(),v){v.offset();const E=l[u]*h+d;this.deferredZIndexContexts_[E]||(this.deferredZIndexContexts_[E]=[]),this.deferredZIndexContexts_[E].push(v)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(zi);for(let i=0,n=t.length;i<n;++i)e[t[i]].forEach(r=>{r.draw(this.renderedContext_),r.clear()}),e[t[i]].length=0}}const Wh={};function EC(s){if(Wh[s]!==void 0)return Wh[s];const e=s*2+1,t=s*s,i=new Array(t+1);for(let r=0;r<=s;++r)for(let o=0;o<=s;++o){const a=r*r+o*o;if(a>t)break;let l=i[a];l||(l=[],i[a]=l),l.push(((s+r)*e+(s+o))*4+3),r>0&&l.push(((s-r)*e+(s+o))*4+3),o>0&&(l.push(((s+r)*e+(s-o))*4+3),r>0&&l.push(((s-r)*e+(s-o))*4+3))}const n=[];for(let r=0,o=i.length;r<o;++r)i[r]&&n.push(...i[r]);return Wh[s]=n,n}class Dd extends wb{constructor(e,t,i,n,r,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=n,this.transformRotation_=n?Kl(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Xt()}drawImages_(e,t,i,n){if(!this.image_)return;const r=qn(e,t,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let u=0,c=r.length;u<c;u+=2){const d=r[u]-this.imageAnchorX_,f=r[u+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=d+this.imageAnchorX_,p=f+this.imageAnchorY_;Vi(a,g,p,1,1,h,-g,-p),o.save(),o.transform.apply(o,a),o.translate(g,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,t,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=qn(e,t,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=n){const l=r[t]+this.textOffsetX_,h=r[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,h),this.textFillState_&&o.fillText(this.text_,l,h))}}moveToLineTo_(e,t,i,n,r){const o=this.context_,a=qn(e,t,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;r&&(l-=2);for(let h=2;h<l;h+=2)o.lineTo(a[h],a[h+1]);return r&&o.closePath(),i}drawRings_(e,t,i,n){for(let r=0,o=i.length;r<o;++r)t=this.moveToLineTo_(e,t,i[r],n,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!je(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=y_(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],n=t[3]-t[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(t[0],t[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,n=t.length;i<n;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!je(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(je(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=e.getFlatCoordinates();let r=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let l=0,h=o.length;l<h;++l)r=this.moveToLineTo_(n,r,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!je(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!je(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let n=0;const r=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,l=r.length;a<l;++a){const h=r[a];n=this.drawRings_(i,n,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),ts(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,n=e.textAlign?e.textAlign:Do;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=n&&(i.textAlign=n,t.textAlign=n),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=n,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:n,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:ki(i||Lt)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),n=t.getLineCap(),r=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),h=t.getMiterLimit(),u=r||mn;this.strokeState_={lineCap:n!==void 0?n:Tr,lineDash:this.pixelRatio_===1?u:u.map(c=>c*this.pixelRatio_),lineDashOffset:(o||bn)*this.pixelRatio_,lineJoin:a!==void 0?a:Mr,lineWidth:(l!==void 0?l:ko)*this.pixelRatio_,miterLimit:h!==void 0?h:Oo,strokeStyle:ki(i||Fo)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),n=e.getAnchor(),r=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const f=t.getColor();this.textFillState_={fillStyle:ki(f||Lt)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const f=i.getColor(),g=i.getLineCap(),p=i.getLineDash(),y=i.getLineDashOffset(),b=i.getLineJoin(),v=i.getWidth(),_=i.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:Tr,lineDash:p||mn,lineDashOffset:y||bn,lineJoin:b!==void 0?b:Mr,lineWidth:v!==void 0?v:ko,miterLimit:_!==void 0?_:Oo,strokeStyle:ki(f||Fo)}}const n=e.getFont(),r=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),h=e.getScaleArray(),u=e.getText(),c=e.getTextAlign(),d=e.getTextBaseline();this.textState_={font:n!==void 0?n:ob,textAlign:c!==void 0?c:Do,textBaseline:d!==void 0?d:al},this.text_=u!==void 0?Array.isArray(u)?u.reduce((f,g,p)=>f+=p%2?" ":g,""):u:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const Yt=.5;function xb(s,e,t,i,n,r,o,a,l){const h=l?nd(n):n,u=s[0]*Yt,c=s[1]*Yt,d=We(u,c);d.imageSmoothingEnabled=!1;const f=d.canvas,g=new Dd(d,Yt,n,null,o,a,l?Zl(g_(),l):null),p=t.length,y=Math.floor((256*256*256-1)/p),b={};for(let _=1;_<=p;++_){const m=t[_-1],E=m.getStyleFunction()||i;if(!E)continue;let C=E(m,r);if(!C)continue;Array.isArray(C)||(C=[C]);const w=(_*y).toString(16).padStart(7,"#00000");for(let R=0,I=C.length;R<I;++R){const T=C[R],A=T.getGeometryFunction()(m);if(!A||!je(h,A.getExtent()))continue;const F=T.clone(),S=F.getFill();S&&S.setColor(w);const O=F.getStroke();O&&(O.setColor(w),O.setLineDash(null)),F.setText(void 0);const M=T.getImage();if(M){const V=M.getImageSize();if(!V)continue;const Y=We(V[0],V[1],void 0,{alpha:!1}),K=Y.canvas;Y.fillStyle=w,Y.fillRect(0,0,K.width,K.height),F.setImage(new zs({img:K,anchor:M.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:M.getOrigin(),opacity:1,size:M.getSize(),scale:M.getScale(),rotation:M.getRotation(),rotateWithView:M.getRotateWithView()}))}const D=F.getZIndex()||0;let H=b[D];H||(H={},b[D]=H,H.Polygon=[],H.Circle=[],H.LineString=[],H.Point=[]);const j=A.getType();if(j==="GeometryCollection"){const V=A.getGeometriesArrayRecursive();for(let Y=0,K=V.length;Y<K;++Y){const Ee=V[Y];H[Ee.getType().replace("Multi","")].push(Ee,F)}}else H[j.replace("Multi","")].push(A,F)}}const v=Object.keys(b).map(Number).sort(zi);for(let _=0,m=v.length;_<m;++_){const E=b[v[_]];for(const C in E){const x=E[C];for(let w=0,R=x.length;w<R;w+=2){g.setStyle(x[w+1]);for(let I=0,T=e.length;I<T;++I)g.setTransform(e[I]),g.drawGeometry(x[w])}}}return d.getImageData(0,0,f.width,f.height)}function Rb(s,e,t){const i=[];if(t){const n=Math.floor(Math.round(s[0])*Yt),r=Math.floor(Math.round(s[1])*Yt),o=(ze(n,0,t.width-1)+ze(r,0,t.height-1)*t.width)*4,a=t.data[o],l=t.data[o+1],u=t.data[o+2]+256*(l+256*a),c=Math.floor((256*256*256-1)/e.length);u&&u%c===0&&i.push(e[u/c-1])}return i}const CC=.5,Sb={Point:PC,LineString:MC,Polygon:OC,MultiPoint:IC,MultiLineString:LC,MultiPolygon:AC,GeometryCollection:TC,Circle:RC};function xC(s,e){return parseInt(ge(s),10)-parseInt(ge(e),10)}function fl(s,e){const t=Tb(s,e);return t*t}function Tb(s,e){return CC*s/e}function RC(s,e,t,i,n){const r=t.getFill(),o=t.getStroke();if(r||o){const l=s.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(r,o),l.drawCircle(e,i,n)}const a=t.getText();if(a&&a.getText()){const l=s.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function gl(s,e,t,i,n,r,o,a){const l=[],h=t.getImage();if(h){let d=!0;const f=h.getImageState();f==q.LOADED||f==q.ERROR?d=!1:f==q.IDLE&&h.load(),d&&l.push(h.ready())}const u=t.getFill();u&&u.loading()&&l.push(u.ready());const c=l.length>0;return c&&Promise.all(l).then(()=>n(null)),SC(s,e,t,i,r,o,a),c}function SC(s,e,t,i,n,r,o){const a=t.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(i,n);if(t.getRenderer())Mb(s,l,t,e,o);else{const u=Sb[l.getType()];u(s,l,t,e,o,r)}}function Mb(s,e,t,i,n){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)Mb(s,o[a],t,i,n);return}s.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),n)}function TC(s,e,t,i,n,r){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const h=Sb[o[a].getType()];h(s,o[a],t,i,n,r)}}function MC(s,e,t,i,n){const r=t.getStroke();if(r){const a=s.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawLineString(e,i,n)}const o=t.getText();if(o&&o.getText()){const a=s.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,n)}}function LC(s,e,t,i,n){const r=t.getStroke();if(r){const a=s.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawMultiLineString(e,i,n)}const o=t.getText();if(o&&o.getText()){const a=s.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,n)}}function AC(s,e,t,i,n){const r=t.getFill(),o=t.getStroke();if(o||r){const l=s.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawMultiPolygon(e,i,n)}const a=t.getText();if(a&&a.getText()){const l=s.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,n)}}function PC(s,e,t,i,n,r){const o=t.getImage(),a=t.getText(),l=a&&a.getText(),h=r&&o&&l?{}:void 0;if(o){if(o.getImageState()!=q.LOADED)return;const u=s.getBuilder(t.getZIndex(),"Image");u.setImageStyle(o,h),u.drawPoint(e,i,n)}if(l){const u=s.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a,h),u.drawText(e,i,n)}}function IC(s,e,t,i,n,r){const o=t.getImage(),a=o&&o.getOpacity()!==0,l=t.getText(),h=l&&l.getText(),u=r&&a&&h?{}:void 0;if(a){if(o.getImageState()!=q.LOADED)return;const c=s.getBuilder(t.getZIndex(),"Image");c.setImageStyle(o,u),c.drawMultiPoint(e,i,n)}if(h){const c=s.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l,u),c.drawText(e,i,n)}}function OC(s,e,t,i,n){const r=t.getFill(),o=t.getStroke();if(r||o){const l=s.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawPolygon(e,i,n)}const a=t.getText();if(a&&a.getText()){const l=s.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,n)}}class FC extends Fd{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Kt(),this.wrappedRenderedExtent_=Kt(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const n=t.extent,r=t.viewState,o=r.center,a=r.resolution,l=r.projection,h=r.rotation,u=l.getExtent(),c=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=t.pixelRatio,g=t.viewHints,p=!(g[Ne.ANIMATING]||g[Ne.INTERACTING]),y=this.context,b=Math.round(_e(n)/a*f),v=Math.round(Ke(n)/a*f),_=c.getWrapX()&&l.canWrapX(),m=_?_e(u):null,E=_?Math.ceil((n[2]-u[2])/m)+1:1;let C=_?Math.floor((n[0]-u[0])/m):0;do{let x=this.getRenderTransform(o,a,0,f,b,v,C*m);t.declutter&&(x=x.slice(0)),e.execute(y,[y.canvas.width,y.canvas.height],x,h,p,i===void 0?or:i?dl:_C,i?d&&t.declutter[d]:void 0)}while(++C<E)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=We(this.context.canvas.width,this.context.canvas.height,Ng))}resetDrawContext_(){if(this.opacity_!==1){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,As(this.context),Ng.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const n=e.viewState;this.prepareContainer(e,t);const r=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(ni.PRERENDER)||this.getLayer().hasListener(ni.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(r,e),n.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=Fi(i.extent);a=je(l,e.extent),this.clipped_=a&&!ii(l,e.extent),this.clipped_&&this.clipUnrotated(r,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&r.restore(),this.postRender(r,e),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),n=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),u=[],c=i[0]*Yt,d=i[1]*Yt;u.push(this.getRenderTransform(n,r,o,Yt,c,d,0).slice());const f=h.getSource(),g=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!ii(g,l)){let p=l[0];const y=_e(g);let b=0,v;for(;p<g[0];)--b,v=y*b,u.push(this.getRenderTransform(n,r,o,Yt,c,d,v).slice()),p+=y;for(b=0,p=l[2];p>g[2];)++b,v=y*b,u.push(this.getRenderTransform(n,r,o,Yt,c,d,v).slice()),p-=y}this.hitDetectionImageData_=xb(i,u,this.renderedFeatures_,h.getStyleFunction(),l,r,o,fl(r,this.renderedPixelRatio_),null)}t(Rb(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,n,r){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),h={},u=function(g,p,y){const b=ge(g),v=h[b];if(v){if(v!==!0&&y<v.distanceSq){if(y===0)return h[b]=!0,r.splice(r.lastIndexOf(v),1),n(g,l,p);v.geometry=p,v.distanceSq=y}}else{if(y===0)return h[b]=!0,n(g,l,p);r.push(h[b]={feature:g,layer:l,geometry:p,distanceSq:y,callback:n})}};let c;const d=[this.replayGroup_],f=this.getLayer().getDeclutter();return d.some(g=>c=g.forEachFeatureAtCoordinate(e,o,a,i,u,f&&t.declutter[f]?t.declutter[f].all().map(p=>p.value):null)),c}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const n=e.viewHints[Ne.ANIMATING],r=e.viewHints[Ne.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,h=e.viewState,u=h.projection,c=h.resolution,d=e.pixelRatio,f=t.getRevision(),g=t.getRenderBuffer();let p=t.getRenderOrder();p===void 0&&(p=xC);const y=h.center.slice(),b=Ts(l,g*c),v=b.slice(),_=[b.slice()],m=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!ii(m,e.extent)){const S=_e(m),O=Math.max(_e(b)/2,S);b[0]=m[0]-O,b[2]=m[2]+O,Qc(y,u);const M=Om(_[0],u);M[0]<m[0]&&M[2]<m[2]?_.push([M[0]+S,M[1],M[2]+S,M[3]]):M[0]>m[0]&&M[2]>m[2]&&_.push([M[0]-S,M[1],M[2]-S,M[3]])}if(this.ready&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!e.declutter&&ii(this.wrappedRenderedExtent_,b))return ts(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=y,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const E=new _b(Tb(c,d),b,c,d);let C;for(let S=0,O=_.length;S<O;++S)i.loadFeatures(_[S],c,u);const x=fl(c,d);let w=!0;const R=(S,O)=>{let M;const D=S.getStyleFunction()||t.getStyleFunction();if(D&&(M=D(S,c)),M){const H=this.renderFeature(S,x,M,E,C,this.getLayer().getDeclutter(),O);w=w&&!H}},I=nd(b),T=i.getFeaturesInExtent(I);p&&T.sort(p);for(let S=0,O=T.length;S<O;++S)R(T[S],S);this.renderedFeatures_=T,this.ready=w;const A=E.finish(),F=new Cb(b,c,d,i.getOverlaps(),A,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=v,this.wrappedRenderedExtent_=b,this.renderedCenter_=y,this.renderedProjection_=u,this.renderedPixelRatio_=d,this.replayGroup_=F,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,n,r,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let h=0,u=i.length;h<u;++h)l=gl(n,e,i[h],t,this.boundHandleStyleImageChange_,r,o,a)||l;else l=gl(n,e,i,t,this.boundHandleStyleImageChange_,r,o,a);return l}}class rk extends Id{constructor(e){super(e)}createRenderer(){return new FC(this)}}class Hg{constructor(e){this.rbush_=new db(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[ge(t)]=i}load(e,t){const i=new Array(t.length);for(let n=0,r=t.length;n<r;n++){const o=e[n],a=t[n],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=l,this.items_[ge(a)]=l}this.rbush_.load(i)}remove(e){const t=ge(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[ge(t)],n=[i.minX,i.minY,i.maxX,i.maxY];Ls(n,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(n){return n.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let n=0,r=e.length;n<r;n++)if(i=t(e[n]),i)return i;return i}isEmpty(){return Ss(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ui(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class kd extends ns{constructor(e,t,i){super(),i!==void 0&&t===void 0?this.setFlatCoordinates(i,e):(t=t||0,this.setCenterAndRadius(e,t,i))}clone(){const e=new kd(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,n){const r=this.flatCoordinates,o=e-r[0],a=t-r[1],l=o*o+a*a;if(l<n){if(l===0)for(let h=0;h<this.stride;++h)i[h]=r[h];else{const h=this.getRadius()/Math.sqrt(l);i[0]=r[0]+h*o,i[1]=r[1]+h*a;for(let u=2;u<this.stride;++u)i[u]=r[u]}return i.length=this.stride,l}return n}containsXY(e,t){const i=this.flatCoordinates,n=e-i[0],r=t-i[1];return n*n+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,i=t[this.stride]-t[0];return ui(t[0]-i,t[1]-i,t[0]+i,t[1]+i,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(je(e,t)){const i=this.getCenter();return e[0]<=i[0]&&e[2]>=i[0]||e[1]<=i[1]&&e[3]>=i[1]?!0:$c(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,i=this.flatCoordinates[t]-this.flatCoordinates[0],n=e.slice();n[t]=n[0]+i;for(let r=1;r<t;++r)n[t+r]=e[r];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(e,t,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let r=Hm(n,0,e,this.stride);n[r++]=n[0]+t;for(let o=1,a=this.stride;o<a;++o)n[r++]=n[o];n.length=r,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const i=this.getCenter(),n=this.getStride();this.setCenter(sd(i,0,i.length,n,e,t,i)),this.changed()}}kd.prototype.transform;class _i extends rd{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ie),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,i=e.length;t<i;++t)this.changeEventsKeys_.push(Ce(e[t],ce.CHANGE,this.changed,this))}clone(){const e=new _i(Uh(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,i,n){if(n<Ds(this.getExtent(),e,t))return n;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)n=r[o].closestPointXY(e,t,i,n);return n}containsXY(e,t){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(e,t))return!0;return!1}computeExtent(e){Fr(e);const t=this.geometries_;for(let i=0,n=t.length;i<n;++i)Pm(e,t[i].getExtent());return e}getGeometries(){return Uh(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let i=0,n=t.length;i<n;++i)t[i].getType()===this.getType()?e=e.concat(t[i].getGeometriesArrayRecursive()):e.push(t[i]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],i=this.geometries_;let n=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],l=a.getSimplifiedGeometry(e);t.push(l),l!==a&&(n=!0)}return n?new _i(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let i=0,n=t.length;i<n;++i)if(t[i].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(e,t);this.changed()}scale(e,t,i){i||(i=Wi(this.getExtent()));const n=this.geometries_;for(let r=0,o=n.length;r<o;++r)n[r].scale(e,t,i);this.changed()}setGeometries(e){this.setGeometriesArray(Uh(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let i=0,n=t.length;i<n;++i)t[i].applyTransform(e);this.changed()}translate(e,t){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Uh(s){return s.map(e=>e.clone())}class xi extends ns{constructor(e,t,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&i)this.setFlatCoordinates(t,e),this.ends_=i;else{const n=e,r=[],o=[];for(let l=0,h=n.length;l<h;++l){const u=n[l];Re(r,u.getFlatCoordinates()),o.push(r.length)}const a=n.length===0?this.getLayout():n[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(e){Re(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new xi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,n){return n<Ds(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ad(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hd(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,i,n))}getCoordinateAtM(e,t,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,i=i!==void 0?i:!1,$_(this.flatCoordinates,0,this.ends_,this.stride,e,t,i))}getCoordinates(){return Po(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new zt(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,i=this.layout,n=[];let r=0;for(let o=0,a=t.length;o<a;++o){const l=t[o],h=new zt(e.slice(r,l),i);n.push(h),r=l}return n}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let o=0,a=n.length;o<a;++o){const l=n[o],h=ol(t,i,l,r,.5);Re(e,h),i=l}return e}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=Vm(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,i),new xi(t,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(e){return S_(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=ta(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class ss extends ns{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Re(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new ss(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,n){if(n<Ds(this.getExtent(),e,t))return n;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const h=_s(e,t,r[a],r[a+1]);if(h<n){n=h;for(let u=0;u<o;++u)i[u]=r[a+u];i.length=o}}return n}getCoordinates(){return jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new Ei(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,i=this.stride,n=[];for(let r=0,o=e.length;r<o;r+=i){const a=new Ei(e.slice(r,r+i),t);n.push(a)}return n}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,i=this.stride;for(let n=0,r=t.length;n<r;n+=i){const o=t[n],a=t[n+1];if(Yc(e,o,a))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Jl(this.flatCoordinates,0,e,this.stride),this.changed()}}function Lb(s,e,t,i){const n=[];let r=Kt();for(let o=0,a=t.length;o<a;++o){const l=t[o];r=Xc(s,e,l[0],i),n.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=l[l.length-1]}return n}class _n extends ns{constructor(e,t,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){const n=e,r=[],o=[];for(let a=0,l=n.length;a<l;++a){const h=n[a],u=r.length,c=h.getEnds();for(let d=0,f=c.length;d<f;++d)c[d]+=u;Re(r,h.getFlatCoordinates()),o.push(c)}t=n.length===0?this.getLayout():n[0].getLayout(),e=r,i=o}t!==void 0&&i?(this.setFlatCoordinates(t,e),this.endss_=i):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;Re(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let n=0,r=t.length;n<r;++n)t[n]+=i}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let n=0;n<e;++n)t[n]=this.endss_[n].slice();const i=new _n(this.flatCoordinates.slice(),this.layout,t);return i.applyProperties(this),i}closestPointXY(e,t,i,n){return n<Ds(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(v_(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),w_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,i,n))}containsXY(e,t){return R_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return C_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Pu(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,Au(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=Lb(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=jm(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ss(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Km(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Pu(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=E_(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,i),new _n(t,"XY",i)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const r=this.endss_[e-1];t=r[r.length-1]}const i=this.endss_[e].slice(),n=i[i.length-1];if(t!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=t;return new pt(this.flatCoordinates.slice(t,n),this.layout,i)}getPolygons(){const e=this.layout,t=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),h=l[l.length-1];if(r!==0)for(let c=0,d=l.length;c<d;++c)l[c]-=r;const u=new pt(t.slice(r,h),e,l);n.push(u),r=h}return n}getType(){return"MultiPolygon"}intersectsExtent(e){return T_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Bm(this.flatCoordinates,0,e,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const n=i[i.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}}const Bg=Xt();class _t{constructor(e,t,i,n,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=r,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Am(this.flatCoordinates_):Xc(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Wi(this.getExtent());this.flatInteriorPoints_=dd(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Zm(this.flatCoordinates_,this.ends_),t=Lb(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=jm(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ol(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let n=0,r=i.length;n<r;++n){const o=i[n],a=ol(e,t,o,2,.5);Re(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=he(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const n=Ke(i)/Ke(t);Vi(Bg,i[0],i[3],n,-n,0,0,0),qn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Bg,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new _t(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Sm((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=Ql(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=Vm(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,n);break;case"Polygon":n=[],i.length=ud(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,n);break}return n&&(this.simplifiedGeometry_=new _t(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}_t.prototype.getFlatCoordinates=_t.prototype.getOrientedFlatCoordinates;class Nd extends Ri{constructor(e){super(),this.projection=he(e.projection),this.attributions_=Vg(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,n){t.viewResolver=i,t.viewRejector=n})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=Vg(e),this.changed()}setState(e){this.state_=e,this.changed()}}function Vg(s){return s?typeof s=="function"?s:(Array.isArray(s)||(s=[s]),e=>s):null}const ei={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function DC(s,e){return[[-1/0,-1/0,1/0,1/0]]}function ok(s,e){return[s]}let kC=!1;function NC(s,e,t,i,n,r,o){const a=new XMLHttpRequest;a.open("GET",typeof s=="function"?s(t,i,n):s,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=kC,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const h=e.getType();try{let u;h=="text"||h=="json"?u=a.responseText:h=="xml"?u=a.responseXML||a.responseText:h=="arraybuffer"&&(u=a.response),u?r(e.readFeatures(u,{extent:t,featureProjection:n}),e.readProjection(u)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Wg(s,e){return function(t,i,n,r,o){const a=this;NC(s,e,t,i,n,function(l,h){a.addFeatures(l),r!==void 0&&r(l)},o||Cr)}}class On extends ji{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class zC extends Nd{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Cr,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(be(this.format_,"`format` must be set when `url` is set"),this.loader_=Wg(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:DC;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new Hg:null,this.loadedExtentsRtree_=new Hg,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,n;Array.isArray(e.features)?n=e.features:e.features&&(i=e.features,n=i.getArray()),!t&&i===void 0&&(i=new Oi(n)),n!==void 0&&this.addFeaturesInternal(n),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=ge(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new On(ei.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof _t||(this.featureChangeKeys_[e]=[Ce(t,ce.CHANGE,this.handleFeatureChange_,this),Ce(t,Er.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const n=String(t.getId());if(!(n in this.idIndex_))this.idIndex_[n]=t;else if(t instanceof _t){const r=this.idIndex_[n];r instanceof _t?Array.isArray(r)?r.push(t):this.idIndex_[n]=[r,t]:i=!1}else i=!1}return i&&(be(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],n=[];for(let r=0,o=e.length;r<o;r++){const a=e[r],l=ge(a);this.addToIndex_(l,a)&&i.push(a)}for(let r=0,o=i.length;r<o;r++){const a=i[r],l=ge(a);this.setupChangeEvents_(l,a);const h=a.getGeometry();if(h){const u=h.getExtent();t.push(u),n.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,n),this.hasListener(ei.ADDFEATURE))for(let r=0,o=i.length;r<o;r++)this.dispatchEvent(new On(ei.ADDFEATURE,i[r]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ei.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(ei.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Mt.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Mt.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Ie);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=n=>{this.removeFeatureInternal(n)};this.featuresRtree_.forEach(i);for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new On(ei.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(n){const r=n.getGeometry();if(r instanceof _t||r.intersectsCoordinate(e))return t(n)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const n=i.getGeometry();if(n instanceof _t||n.intersectsExtent(e)){const r=t(i);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Ss(this.nullGeometryFeatures_)||Re(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const n=Kc(e,t);return[].concat(...n.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],n=e[1];let r=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||So,this.featuresRtree_.forEachInExtent(l,function(h){if(t(h)){const u=h.getGeometry(),c=a;if(a=u instanceof _t?0:u.closestPointXY(i,n,o,a),a<c){r=h;const d=Math.sqrt(a);l[0]=i-d,l[1]=n-d,l[2]=i+d,l[3]=n+d}}}),r}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=ge(t),n=t.getGeometry();if(!n)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const r=t.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new On(ei.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:ge(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Ss(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const n=this.loadedExtentsRtree_,r=this.strategy_(e,t,i);for(let o=0,a=r.length;o<a;++o){const l=r[o];n.forEachInExtent(l,function(u){return ii(u.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new On(ei.FEATURESLOADSTART)),this.loader_.call(this,l,t,i,u=>{--this.loadingExtentsCount_,this.dispatchEvent(new On(ei.FEATURESLOADEND,void 0,u))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new On(ei.FEATURESLOADERROR))}),n.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_;let i;t.forEachInExtent(e,function(n){if(Ls(n.extent,e))return i=n,!0}),i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,n=e.length;i<n;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=ge(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e);const i=this.featureChangeKeys_[t];i==null||i.forEach(Ie),delete this.featureChangeKeys_[t];const n=e.getId();if(n!==void 0){const r=n.toString(),o=this.idIndex_[r];o===e?delete this.idIndex_[r]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[r]=o[0]))}return delete this.uidIndex_[t],this.hasListener(ei.REMOVEFEATURE)&&this.dispatchEvent(new On(ei.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){be(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(Wg(e,this.format_))}}function ak(s,e){const t=s.canvas;e=e||{};const i=e.pixelRatio||wd,n=e.size;n&&(t.width=n[0]*i,t.height=n[1]*i,t.style.width=n[0]+"px",t.style.height=n[1]+"px");const r=[0,0,t.width,t.height],o=Ua(Xt(),i,i);return new Dd(s,i,r,o,0)}function lk(s){if(!(s.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");const e=s.inversePixelTransform[0],t=s.inversePixelTransform[1],i=Math.sqrt(e*e+t*t),n=s.frameState,r=Qo(s.inversePixelTransform.slice(),n.coordinateToPixelTransform),o=fl(n.viewState.resolution,i);let a;return new Dd(s.context,i,n.extent,r,n.viewState.rotation,o,a)}function hk(s,e){return $e(s.inversePixelTransform,e.slice(0))}const X={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class oa extends qo{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(ce.CHANGE)}release(){this.state===X.ERROR&&this.setState(X.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==X.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}load(){ne()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const n=t-i+1e3/60;return n>=this.transition_?1:ub(n/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}class Ab extends oa{constructor(e,t,i,n,r,o){super(e,t,o),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,n!==null&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(e){this.image_=e,this.state=X.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=X.ERROR,this.unlistenImage_(),this.image_=GC(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=X.LOADED:this.state=X.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==X.ERROR&&(this.state=X.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==X.IDLE&&(this.state=X.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=U_(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function GC(){const s=We(1,1);return s.fillStyle="rgba(0,0,0,0)",s.fillRect(0,0,1,1),s.canvas}class HC{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const n=this.points_[t+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class BC extends Wl{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){ne()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;Vi(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Mm(n,i)}forEachFeatureAtCoordinate(e,t,i,n,r,o,a,l){let h;const u=t.viewState;function c(m,E,C,x){return r.call(o,E,m?C:null,x)}const d=u.projection,f=Qc(e.slice(),d),g=[[0,0]];if(d.canWrapX()&&n){const m=d.getExtent(),E=_e(m);g.push([-E,0],[E,0])}const p=t.layerStatesArray,y=p.length,b=[],v=[];for(let m=0;m<g.length;m++)for(let E=y-1;E>=0;--E){const C=p[E],x=C.layer;if(x.hasRenderer()&&Ld(C,u)&&a.call(l,x)){const w=x.getRenderer(),R=x.getSource();if(w&&R){const I=R.getWrapX()?f:e,T=c.bind(null,C.managed);v[0]=I[0]+g[m][0],v[1]=I[1]+g[m][1],h=w.forEachFeatureAtCoordinate(v,t,i,T,b)}if(h)return h}}if(b.length===0)return;const _=1/b.length;return b.forEach((m,E)=>m.distanceSq+=E*_),b.sort((m,E)=>m.distanceSq-E.distanceSq),b.some(m=>h=m.callback(m.feature,m.layer,m.geometry)),h}hasFeatureAtCoordinate(e,t,i,n,r,o){return this.forEachFeatureAtCoordinate(e,t,i,n,So,this,r,o)!==void 0}getMap(){return this.map_}renderFrame(e){ne()}scheduleExpireIconCache(e){Di.canExpireCache()&&e.postRenderFunctions.push(VC)}}function VC(s,e){Di.expire()}class WC extends BC{constructor(e){super(e),this.fontChangeListenerKey_=Ce(sn,Er.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=ih+" ol-layers";const i=e.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const n=new Eb(e,void 0,t);i.dispatchEvent(n)}}disposeInternal(){Ie(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(ni.PRECOMPOSE,e);const t=e.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);t.some(a=>a.layer instanceof Id&&a.layer.getDeclutter())&&(e.declutter={});const n=e.viewState;this.children_.length=0;const r=[];let o=null;for(let a=0,l=t.length;a<l;++a){const h=t[a];e.layerIndex=a;const u=h.layer,c=u.getSourceState();if(!Ld(h,n)||c!="ready"&&c!="undefined"){u.unrender();continue}const d=u.render(e,o);d&&(d!==o&&(this.children_.push(d),o=d),r.push(h))}this.declutter(e,r),W_(this.element_,this.children_),this.dispatchRenderEvent(ni.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const n=t[i],r=n.layer;r.getDeclutter()&&r.renderDeclutter(e,n)}t.forEach(i=>i.layer.renderDeferred(e))}}}class Nn extends ji{constructor(e,t){super(e),this.layer=t}}const jh={LAYERS:"layers"};class Nr extends hb{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(jh.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Oi(i.slice(),{unique:!0}):be(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Oi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ie),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Ce(e,Mt.ADD,this.handleLayersAdd_,this),Ce(e,Mt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Ie);Zo(this.listenerKeys_);const t=e.getArray();for(let i=0,n=t.length;i<n;i++){const r=t[i];this.registerLayerListeners_(r),this.dispatchEvent(new Nn("addlayer",r))}this.changed()}registerLayerListeners_(e){const t=[Ce(e,Er.PROPERTYCHANGE,this.handleLayerChange_,this),Ce(e,ce.CHANGE,this.handleLayerChange_,this)];e instanceof Nr&&t.push(Ce(e,"addlayer",this.handleLayerGroupAdd_,this),Ce(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[ge(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Nn("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Nn("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Nn("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=ge(t);this.listenerKeys_[i].forEach(Ie),delete this.listenerKeys_[i],this.dispatchEvent(new Nn("removelayer",t)),this.changed()}getLayers(){return this.get(jh.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let n=0,r=i.length;n<r;++n)this.dispatchEvent(new Nn("removelayer",i[n]))}this.set(jh.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const n=this.getLayerState();let r=n.zIndex;!e&&n.zIndex===void 0&&(r=0);for(let o=i,a=t.length;o<a;o++){const l=t[o];l.opacity*=n.opacity,l.visible=l.visible&&n.visible,l.maxResolution=Math.min(l.maxResolution,n.maxResolution),l.minResolution=Math.max(l.minResolution,n.minResolution),l.minZoom=Math.max(l.minZoom,n.minZoom),l.maxZoom=Math.min(l.maxZoom,n.maxZoom),n.extent!==void 0&&(l.extent!==void 0?l.extent=Ot(l.extent,n.extent):l.extent=n.extent),l.zIndex===void 0&&(l.zIndex=r)}return t}getSourceState(){return"ready"}}class nr extends ji{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Dn extends nr{constructor(e,t,i,n,r,o){super(e,t,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=n!==void 0?n:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const He={SINGLECLICK:"singleclick",CLICK:ce.CLICK,DBLCLICK:ce.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Nu={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class UC extends qo{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=Ce(i,Nu.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Ce(i,Nu.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ce.TOUCHMOVE,this.boundHandleTouchMove_,eb?{passive:!1}:!1)}emulateClick_(e){let t=new Dn(He.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Dn(He.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Dn(He.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==He.POINTERUP||t.type==He.POINTERCANCEL){delete this.trackedTouches_[i];for(const n in this.trackedTouches_)if(this.trackedTouches_[n].target!==t.target){delete this.trackedTouches_[n];break}}else(t.type==He.POINTERDOWN||t.type==He.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Dn(He.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ie),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Dn(He.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Ce(i,He.POINTERMOVE,this.handlePointerMove_,this),Ce(i,He.POINTERUP,this.handlePointerUp_,this),Ce(this.element_,He.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(Ce(this.element_.getRootNode(),He.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Dn(He.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Dn(He.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ie(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ce.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ie(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ie),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const rn={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ft={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},pl=1/0;class jC{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Zo(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(e){be(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=pl?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,n=t.length,r=t[e],o=i[e],a=e;for(;e<n>>1;){const l=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),u=h<n&&i[h]<i[l]?h:l;t[e]=t[u],i[e]=i[u],e=u}t[e]=r,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,n=this.priorities_,r=i[t],o=n[t];for(;t>e;){const a=this.getParentIndex_(t);if(n[a]>o)i[t]=i[a],n[t]=n[a],t=a;else break}i[t]=r,n[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let n=0;const r=t.length;let o,a,l;for(a=0;a<r;++a)o=t[a],l=e(o),l==pl?delete this.queuedElements_[this.keyFunction_(o)]:(i[n]=l,t[n++]=o);t.length=n,i.length=n,this.heapify_()}}class YC extends jC{constructor(e,t){super(function(i){return e.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(ce.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===X.LOADED||i===X.ERROR||i===X.EMPTY){i!==X.ERROR&&t.removeEventListener(ce.CHANGE,this.boundHandleTileChange_);const n=t.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const n=this.dequeue()[0],r=n.getKey();n.getState()===X.IDLE&&!(r in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++i,n.load())}}}function XC(s,e,t,i,n){if(!s||!(t in s.wantedTiles)||!s.wantedTiles[t][e.getKey()])return pl;const r=s.viewState.center,o=i[0]-r[0],a=i[1]-r[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n}class zd extends Ri{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var t;this.map_&&((t=this.element)==null||t.remove());for(let i=0,n=this.listenerKeys.length;i<n;++i)Ie(this.listenerKeys[i]);this.listenerKeys.length=0,this.map_=e,e&&((this.target_??e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Cr&&this.listenerKeys.push(Ce(e,rn.POSTRENDER,this.render,this)),e.render())}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class $C extends zd{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",n=e.expandClassName!==void 0?e.expandClassName:t+"-expand",r=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=n):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(ce.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+ih+" "+Cd+(this.collapsed_&&this.collapsible_?" "+yg:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=h,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(n=>n.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(n=>i.add(n)):i.add(this.attributions_)),!this.overrideCollapsible_){const n=!t.some(r=>{var o;return((o=r.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(n)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(n=>Tm(()=>n))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!ts(t,this.renderedAttributions_)){tb(this.ulElement_);for(let n=0,r=t.length;n<r;++n){const o=document.createElement("li");o.innerHTML=t[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(yg),this.collapsed_?mg(this.collapseLabel_,this.label_):mg(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class KC extends zd{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",n=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(ce.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+ih+" "+Cd,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ea)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:kr}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const n="rotate("+i+"rad)";if(this.autoHide_){const r=this.element.classList.contains(Ea);!r&&i===0?this.element.classList.add(Ea):r&&i!==0&&this.element.classList.remove(Ea)}this.label_.style.transform=n}this.rotation_=i}}class ZC extends zd{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,n=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",r=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=n,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof o=="string"?document.createTextNode(o):o),u.addEventListener(ce.CLICK,this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=h,c.appendChild(typeof a=="string"?document.createTextNode(a):a),c.addEventListener(ce.CLICK,this.handleClick_.bind(this,-i),!1);const d=t+" "+ih+" "+Cd,f=this.element;f.className=d,f.appendChild(u),f.appendChild(c),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const n=i.getZoom();if(n!==void 0){const r=i.getConstrainedZoom(n+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:r,duration:this.duration_,easing:kr})):i.setZoom(r)}}}function qC(s){s=s||{};const e=new Oi;return(s.zoom!==void 0?s.zoom:!0)&&e.push(new ZC(s.zoomOptions)),(s.rotate!==void 0?s.rotate:!0)&&e.push(new KC(s.rotateOptions)),(s.attribution!==void 0?s.attribution:!0)&&e.push(new $C(s.attributionOptions)),e}const Ug={ACTIVE:"active"};let aa=class extends Ri{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Ug.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(Ug.ACTIVE,e)}setMap(e){this.map_=e}};function JC(s,e,t){const i=s.getCenterInternal();if(i){const n=[i[0]+e[0],i[1]+e[1]];s.animateInternal({duration:t!==void 0?t:250,easing:fE,center:s.getConstrainedCenter(n)})}}function Gd(s,e,t,i){const n=s.getZoom();if(n===void 0)return;const r=s.getConstrainedZoom(n+e),o=s.getResolutionForZoom(r);s.getAnimating()&&s.cancelAnimations(),s.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:kr})}class QC extends aa{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==He.DBLCLICK){const i=e.originalEvent,n=e.map,r=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=n.getView();Gd(a,o,r,this.duration_),i.preventDefault(),t=!0}return!t}}class la extends aa{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==He.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==He.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==He.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==He.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Hd(s){const e=s.length;let t=0,i=0;for(let n=0;n<e;n++)t+=s[n].clientX,i+=s[n].clientY;return{clientX:t/e,clientY:i/e}}function zu(s){const e=arguments;return function(t){let i=!0;for(let n=0,r=e.length;n<r&&(i=i&&e[n](t),!!i);++n);return i}}const ck=function(s){const e=s.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},ex=function(s){const e=s.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},tx=function(s){const e=s.map.getTargetElement(),t=e.getRootNode(),i=s.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},Pb=function(s){const e=s.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?tx(s):!0},ix=So,Ib=function(s){const e=s.originalEvent;return e.button==0&&!(G_&&vd&&e.ctrlKey)},dk=Ko,fk=function(s){return s.type==He.SINGLECLICK},Ob=function(s){const e=s.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},gk=function(s){const e=s.originalEvent;return!e.altKey&&(vd?e.metaKey:e.ctrlKey)&&!e.shiftKey},nx=function(s){const e=s.originalEvent;return vd?e.metaKey:e.ctrlKey},sx=function(s){const e=s.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Fb=function(s){const e=s.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},Yh=function(s){const e=s.originalEvent;return be(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.pointerType=="mouse"},rx=function(s){const e=s.originalEvent;return be(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&e.button===0};class ox extends la{constructor(e){super({stopDown:Ko}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:zu(Ob,rx);this.condition_=e.onFocusOnly?zu(Pb,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,n=t.getEventPixel(Hd(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const r=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],a=e.map.getView();a_(r,a.getResolution()),Jc(r,a.getRotation()),a.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),l=t.getCoordinateFromPixelInternal([a[0]-n*Math.cos(r),a[1]-n*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:kr})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class ax extends la{constructor(e){e=e||{},super({stopDown:Ko}),this.condition_=e.condition?e.condition:ex,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Yh(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===Md)return;const n=t.getSize(),r=e.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return Yh(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Yh(e)&&Ib(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class lx extends Wl{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(e[0],t[0])+i,n.top=Math.min(e[1],t[1])+i,n.width=Math.abs(t[0]-e[0])+i,n.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,n=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new pt([n])}getGeometry(){return this.geometry_}}const Xs={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Zr extends ji{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class hx extends la{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new lx(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??Ib,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const n=i[0]-t[0],r=i[1]-t[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Zr(Xs.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Zr(t?Xs.BOXEND:Xs.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Zr(Xs.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Zr(Xs.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Zr(Xs.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class ux extends hx{constructor(e){e=e||{};const t=e.condition?e.condition:sx;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let n=this.getGeometry();if(this.out_){const r=i.rotatedExtentForGeometry(n),o=i.getResolutionForExtentInternal(r),a=i.getResolution()/o;n=n.clone(),n.scale(a*a)}i.fitInternal(n,{duration:this.duration_,easing:kr})}}const as={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class cx extends aa{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return Ob(t)&&Fb(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==ce.KEYDOWN){const i=e.originalEvent,n=i.key;if(this.condition_(e)&&(n==as.DOWN||n==as.LEFT||n==as.RIGHT||n==as.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,h=0;n==as.DOWN?h=-a:n==as.LEFT?l=-a:n==as.RIGHT?l=a:h=a;const u=[l,h];Jc(u,o.getRotation()),JC(o,u,this.duration_),i.preventDefault(),t=!0}}return!t}}class dx extends aa{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!nx(t)&&Fb(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==ce.KEYDOWN||e.type==ce.KEYPRESS){const i=e.originalEvent,n=i.key;if(this.condition_(e)&&(n==="+"||n==="-")){const r=e.map,o=n==="+"?this.delta_:-this.delta_,a=r.getView();Gd(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}class fx extends aa{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:ix;this.condition_=e.onFocusOnly?zu(Pb,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==ce.WHEEL)return!0;const i=e.map,n=e.originalEvent;n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let r;if(e.type==ce.WHEEL&&(r=n.deltaY,N_&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=wd),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)),r===0)return!1;this.lastDelta_=r;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=r;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-ze(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Gd(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class gx extends la{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Ko),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=r-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=r;const o=e.map,a=o.getView();a.getConstraints().rotation!==Md&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Hd(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class px extends la{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Ko),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,a=Math.sqrt(r*r+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,h=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Hd(this.targetPointers))),l.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),n=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function mx(s){s=s||{};const e=new Oi,t=new HC(-.005,.05,100);return(s.altShiftDragRotate!==void 0?s.altShiftDragRotate:!0)&&e.push(new ax),(s.doubleClickZoom!==void 0?s.doubleClickZoom:!0)&&e.push(new QC({delta:s.zoomDelta,duration:s.zoomDuration})),(s.dragPan!==void 0?s.dragPan:!0)&&e.push(new ox({onFocusOnly:s.onFocusOnly,kinetic:t})),(s.pinchRotate!==void 0?s.pinchRotate:!0)&&e.push(new gx),(s.pinchZoom!==void 0?s.pinchZoom:!0)&&e.push(new px({duration:s.zoomDuration})),(s.keyboard!==void 0?s.keyboard:!0)&&(e.push(new cx),e.push(new dx({delta:s.zoomDelta,duration:s.zoomDuration}))),(s.mouseWheelZoom!==void 0?s.mouseWheelZoom:!0)&&e.push(new fx({onFocusOnly:s.onFocusOnly,duration:s.zoomDuration})),(s.shiftDragZoom!==void 0?s.shiftDragZoom:!0)&&e.push(new ux({duration:s.zoomDuration})),e}function Db(s){if(s instanceof na){s.setMapInternal(null);return}s instanceof Nr&&s.getLayers().forEach(Db)}function kb(s,e){if(s instanceof na){s.setMapInternal(e);return}if(s instanceof Nr){const t=s.getLayers().getArray();for(let i=0,n=t.length;i<n;++i)kb(t[i],e)}}let pk=class extends Ri{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=bx(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:wd,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Xt(),this.pixelToCoordinateTransform_=Xt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||qC(),this.interactions=t.interactions||mx({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new YC(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ft.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(ft.VIEW,this.handleViewChanged_),this.addChangeListener(ft.SIZE,this.handleSizeChanged_),this.addChangeListener(ft.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof cn)&&e.view.then(function(n){i.setView(new cn(n))}),this.controls.addEventListener(Mt.ADD,n=>{n.element.setMap(this)}),this.controls.addEventListener(Mt.REMOVE,n=>{n.element.setMap(null)}),this.interactions.addEventListener(Mt.ADD,n=>{n.element.setMap(this)}),this.interactions.addEventListener(Mt.REMOVE,n=>{n.element.setMap(null)}),this.overlays_.addEventListener(Mt.ADD,n=>{this.addOverlayInternal_(n.element)}),this.overlays_.addEventListener(Mt.REMOVE,n=>{const r=n.element.getId();r!==void 0&&delete this.overlayIdIndex_[r.toString()],n.element.setMap(null)}),this.controls.forEach(n=>{n.setMap(this)}),this.interactions.forEach(n=>{n.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){kb(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const r=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:So,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(n){i.push(n)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(n){n instanceof Nr?t(n.getLayers()):e.push(n)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const n=t.layerFilter!==void 0?t.layerFilter:So,r=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,o,n,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),n=this.getSize(),r=i.width/n[0],o=i.height/n[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/r,(a.clientY-i.top)/o]}getTarget(){return this.get(ft.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Lu(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?$e(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ft.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Oi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const n=e[t];if(!n.visible)continue;const r=n.layer.getRenderer();if(r&&!r.ready)return!0;const o=n.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=nn(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?$e(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ft.SIZE)}getView(){return this.get(ft.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,n){return XC(this.frameState_,e,t,i,n)}handleBrowserEvent(e,t){t=t||e.type;const i=new Dn(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Nu.POINTERDOWN||i===ce.WHEEL||i===ce.KEYDOWN){const n=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():n,o=t.target,a=r instanceof ShadowRoot?r.host===o?r.host.ownerDocument:r:r===n?n.documentElement:r;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const n=this.getInteractions().getArray().slice();for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let n=this.maxTilesLoading_,r=n;if(e){const o=e.viewHints;if(o[Ne.ANIMATING]||o[Ne.INTERACTING]){const a=Date.now()-e.time>8;n=a?0:8,r=a?0:2}}t.getTilesLoading()<n&&(t.reprioritize(),t.loadMoreTiles(n,r))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(ni.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(ni.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new nr(rn.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new nr(rn.LOADSTART,this,e))));const i=this.postRenderFunctions_;for(let n=0,r=i.length;n<r;++n)i[n](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,n=this.targetChangeHandlerKeys_.length;i<n;++i)Ie(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ce.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ce.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new WC(this)),this.mapBrowserEventHandler_=new UC(this,this.moveTolerance_);for(const r in He)this.mapBrowserEventHandler_.addEventListener(He[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ce.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ce.WHEEL,this.boundHandleBrowserEvent_,eb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}this.targetChangeHandlerKeys_=[Ce(i,ce.KEYDOWN,this.handleBrowserEvent,this),Ce(i,ce.KEYPRESS,this.handleBrowserEvent,this)];const n=t.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ie(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ie(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Ce(e,Er.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Ce(e,ce.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ie),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Nn("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Ce(e,Er.PROPERTYCHANGE,this.render,this),Ce(e,ce.CHANGE,this.render,this),Ce(e,"addlayer",this.handleLayerAdd_,this),Ce(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const n=e[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){Db(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(t!==void 0&&bg(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Lo(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:ge(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;r.nextExtent=Lo(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n&&(!this.previousExtent_||!ks(this.previousExtent_)&&!Ls(r.extent,this.previousExtent_))&&(this.dispatchEvent(new nr(rn.MOVESTART,this,n)),this.previousExtent_=Fr(this.previousExtent_)),this.previousExtent_&&!r.viewHints[Ne.ANIMATING]&&!r.viewHints[Ne.INTERACTING]&&!Ls(r.extent,this.previousExtent_)&&(this.dispatchEvent(new nr(rn.MOVEEND,this,r)),Lm(r.extent,this.previousExtent_))),this.dispatchEvent(new nr(rn.POSTRENDER,this,r)),this.renderComplete_=(this.hasListener(rn.LOADSTART)||this.hasListener(rn.LOADEND)||this.hasListener(ni.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Nn("removelayer",t)),this.set(ft.LAYERGROUP,e)}setSize(e){this.set(ft.SIZE,e)}setTarget(e){this.set(ft.TARGET,e)}setView(e){if(!e||e instanceof cn){this.set(ft.VIEW,e);return}this.set(ft.VIEW,new cn);const t=this;e.then(function(i){t.setView(new cn(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){const n=getComputedStyle(e),r=e.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),o=e.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);!isNaN(r)&&!isNaN(o)&&(t=[Math.max(0,r),Math.max(0,o)],!bg(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&km("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!ts(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function bx(s){let e=null;s.keyboardEventTarget!==void 0&&(e=typeof s.keyboardEventTarget=="string"?document.getElementById(s.keyboardEventTarget):s.keyboardEventTarget);const t={},i=s.layers&&typeof s.layers.getLayers=="function"?s.layers:new Nr({layers:s.layers});t[ft.LAYERGROUP]=i,t[ft.TARGET]=s.target,t[ft.VIEW]=s.view instanceof cn?s.view:new cn;let n;s.controls!==void 0&&(Array.isArray(s.controls)?n=new Oi(s.controls.slice()):(be(typeof s.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),n=s.controls));let r;s.interactions!==void 0&&(Array.isArray(s.interactions)?r=new Oi(s.interactions.slice()):(be(typeof s.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),r=s.interactions));let o;return s.overlays!==void 0?Array.isArray(s.overlays)?o=new Oi(s.overlays.slice()):(be(typeof s.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=s.overlays):o=new Oi,{controls:n,interactions:r,keyboardEventTarget:e,overlays:o,values:t}}const dt={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class bk extends Ri{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+q_,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(dt.ELEMENT,this.handleElementChanged),this.addChangeListener(dt.MAP,this.handleMapChanged),this.addChangeListener(dt.OFFSET,this.handleOffsetChanged),this.addChangeListener(dt.POSITION,this.handlePositionChanged),this.addChangeListener(dt.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(dt.ELEMENT)}getId(){return this.id}getMap(){return this.get(dt.MAP)||null}getOffset(){return this.get(dt.OFFSET)}getPosition(){return this.get(dt.POSITION)}getPositioning(){return this.get(dt.POSITIONING)}handleElementChanged(){tb(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){var t;this.mapPostrenderListenerKey&&((t=this.element)==null||t.remove(),Ie(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Ce(e,rn.POSTRENDER,this.render,this),this.updatePixelPosition();const i=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?i.insertBefore(this.element,i.childNodes[0]||null):i.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(dt.ELEMENT,e)}setMap(e){this.set(dt.MAP,e)}setOffset(e){this.set(dt.OFFSET,e)}setPosition(e){this.set(dt.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(dt.POSITION))return;const i=this.getRect(t.getTargetElement(),t.getSize()),n=this.getElement(),r=this.getRect(n,[B_(n),V_(n)]);e=e||{};const o=e.margin===void 0?20:e.margin;if(!ii(i,r)){const a=r[0]-i[0],l=i[2]-r[2],h=r[1]-i[1],u=i[3]-r[3],c=[0,0];if(a<0?c[0]=a-o:l<0&&(c[0]=Math.abs(l)+o),h<0?c[1]=h-o:u<0&&(c[1]=Math.abs(u)+o),c[0]!==0||c[1]!==0){const d=t.getView().getCenterInternal(),f=t.getPixelFromCoordinateInternal(d);if(!f)return;const g=[f[0]+c[0],f[1]+c[1]],p=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(g),duration:p.duration,easing:p.easing})}}}getRect(e,t){const i=e.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+t[0],r+t[1]]}setPositioning(e){this.set(dt.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const i=e.getPixelFromCoordinate(t),n=e.getSize();this.updateRenderedPosition(i,n)}updateRenderedPosition(e,t){const i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const o=Math.round(e[0]+n[0])+"px",a=Math.round(e[1]+n[1])+"px";let l="0%",h="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?l="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(l="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?h="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(h="-50%");const u=`translate(${l}, ${h}) translate(${o}, ${a})`;this.rendered.transform_!=u&&(this.rendered.transform_=u,i.transform=u)}getOptions(){return this.options}}class yx{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();){const t=this.pop();t instanceof Wl&&t.dispose()}}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return be(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return be(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var t;return(t=this.entries_[e])==null?void 0:t.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){be(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function ml(s,e,t,i){return i!==void 0?(i[0]=s,i[1]=e,i[2]=t,i):[s,e,t]}function Nb(s,e,t){return s+"/"+e+"/"+t}function yk(s){return Nb(s[0],s[1],s[2])}function zb(s){return vx(s[0],s[1],s[2])}function vx(s,e,t){return(e<<s)+t}function wx(s,e){const t=s[0],i=s[1],n=s[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const r=e.getFullTileRange(t);return r?r.containsXY(i,n):!0}class Bd{constructor(e,t,i,n){this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function $s(s,e,t,i,n){return n!==void 0?(n.minX=s,n.maxX=e,n.minY=t,n.maxY=i,n):new Bd(s,e,t,i)}const jg=[];class vk extends oa{constructor(e,t,i,n,r){super(e,t,{transition:0}),this.context_=null,this.executorGroups=[],this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=n.bind(void 0,this),this.removeSourceTiles_=r,this.wrappedTileCoord=i}getContext(){return this.context_||(this.context_=We(1,1,jg)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){const t=ge(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&(As(this.context_),jg.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}let wk=class extends oa{constructor(e,t,i,n,r,o){super(e,t,o),this.extent=null,this.format_=n,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=r,this.url_=i,this.key=i}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==X.IDLE&&(this.setState(X.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(X.ERROR)}setFeatures(e){this.features_=e,this.setState(X.LOADED)}setLoader(e){this.loader_=e}},oh=class{constructor(e){this.tagName_=e}getTagName(){return this.tagName_}};class _x extends oh{constructor(e,t){super(e),this.conditions=t,be(this.conditions.length>=2,"At least 2 conditions are required")}}class Ex extends _x{constructor(e){super("And",Array.prototype.slice.call(arguments))}}class Cx extends oh{constructor(e,t,i){if(super("BBOX"),this.geometryName=e,this.extent=t,t.length!==4)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");this.srsName=i}}class ha extends oh{constructor(e,t){super(e),this.propertyName=t}}class xx extends ha{constructor(e,t,i){super("During",e),this.begin=t,this.end=i}}class zr extends ha{constructor(e,t,i,n){super(e,t),this.expression=i,this.matchCase=n}}class Rx extends zr{constructor(e,t,i){super("PropertyIsEqualTo",e,t,i)}}class Sx extends zr{constructor(e,t){super("PropertyIsGreaterThan",e,t)}}class Tx extends zr{constructor(e,t){super("PropertyIsGreaterThanOrEqualTo",e,t)}}class Mx extends ha{constructor(e,t,i){super("PropertyIsBetween",e),this.lowerBoundary=t,this.upperBoundary=i}}class Lx extends ha{constructor(e,t,i,n,r,o){super("PropertyIsLike",e),this.pattern=t,this.wildCard=i!==void 0?i:"*",this.singleChar=n!==void 0?n:".",this.escapeChar=r!==void 0?r:"!",this.matchCase=o}}class Ax extends ha{constructor(e){super("PropertyIsNull",e)}}class Px extends zr{constructor(e,t){super("PropertyIsLessThan",e,t)}}class Ix extends zr{constructor(e,t){super("PropertyIsLessThanOrEqualTo",e,t)}}class Ox extends oh{constructor(e){super("Not"),this.condition=e}}class Fx extends zr{constructor(e,t,i){super("PropertyIsNotEqualTo",e,t,i)}}function Dx(s){const e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Ex,e))}function Ck(s){return new Ox(s)}function kx(s,e,t){return new Cx(s,e,t)}function xk(s,e,t){return new Rx(s,e,t)}function Rk(s,e,t){return new Fx(s,e,t)}function Sk(s,e){return new Px(s,e)}function Tk(s,e){return new Ix(s,e)}function Mk(s,e){return new Sx(s,e)}function Lk(s,e){return new Tx(s,e)}function Ak(s){return new Ax(s)}function Pk(s,e,t){return new Mx(s,e,t)}function Ik(s,e,t,i,n,r){return new Lx(s,e,t,i,n,r)}function Ok(s,e,t){return new xx(s,e,t)}var cs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gb(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Vd={exports:{}};Vd.exports;(function(s){var e=function(){var t=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function o(l,h){if(!r[l]){r[l]={};for(var u=0;u<l.length;u++)r[l][l.charAt(u)]=u}return r[l][h]}var a={compressToBase64:function(l){if(l==null)return"";var h=a._compress(l,6,function(u){return i.charAt(u)});switch(h.length%4){default:case 0:return h;case 1:return h+"===";case 2:return h+"==";case 3:return h+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:a._decompress(l.length,32,function(h){return o(i,l.charAt(h))})},compressToUTF16:function(l){return l==null?"":a._compress(l,15,function(h){return t(h+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:a._decompress(l.length,16384,function(h){return l.charCodeAt(h)-32})},compressToUint8Array:function(l){for(var h=a.compress(l),u=new Uint8Array(h.length*2),c=0,d=h.length;c<d;c++){var f=h.charCodeAt(c);u[c*2]=f>>>8,u[c*2+1]=f%256}return u},decompressFromUint8Array:function(l){if(l==null)return a.decompress(l);for(var h=new Array(l.length/2),u=0,c=h.length;u<c;u++)h[u]=l[u*2]*256+l[u*2+1];var d=[];return h.forEach(function(f){d.push(t(f))}),a.decompress(d.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":a._compress(l,6,function(h){return n.charAt(h)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),a._decompress(l.length,32,function(h){return o(n,l.charAt(h))}))},compress:function(l){return a._compress(l,16,function(h){return t(h)})},_compress:function(l,h,u){if(l==null)return"";var c,d,f={},g={},p="",y="",b="",v=2,_=3,m=2,E=[],C=0,x=0,w;for(w=0;w<l.length;w+=1)if(p=l.charAt(w),Object.prototype.hasOwnProperty.call(f,p)||(f[p]=_++,g[p]=!0),y=b+p,Object.prototype.hasOwnProperty.call(f,y))b=y;else{if(Object.prototype.hasOwnProperty.call(g,b)){if(b.charCodeAt(0)<256){for(c=0;c<m;c++)C=C<<1,x==h-1?(x=0,E.push(u(C)),C=0):x++;for(d=b.charCodeAt(0),c=0;c<8;c++)C=C<<1|d&1,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=d>>1}else{for(d=1,c=0;c<m;c++)C=C<<1|d,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=0;for(d=b.charCodeAt(0),c=0;c<16;c++)C=C<<1|d&1,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=d>>1}v--,v==0&&(v=Math.pow(2,m),m++),delete g[b]}else for(d=f[b],c=0;c<m;c++)C=C<<1|d&1,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=d>>1;v--,v==0&&(v=Math.pow(2,m),m++),f[y]=_++,b=String(p)}if(b!==""){if(Object.prototype.hasOwnProperty.call(g,b)){if(b.charCodeAt(0)<256){for(c=0;c<m;c++)C=C<<1,x==h-1?(x=0,E.push(u(C)),C=0):x++;for(d=b.charCodeAt(0),c=0;c<8;c++)C=C<<1|d&1,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=d>>1}else{for(d=1,c=0;c<m;c++)C=C<<1|d,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=0;for(d=b.charCodeAt(0),c=0;c<16;c++)C=C<<1|d&1,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=d>>1}v--,v==0&&(v=Math.pow(2,m),m++),delete g[b]}else for(d=f[b],c=0;c<m;c++)C=C<<1|d&1,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=d>>1;v--,v==0&&(v=Math.pow(2,m),m++)}for(d=2,c=0;c<m;c++)C=C<<1|d&1,x==h-1?(x=0,E.push(u(C)),C=0):x++,d=d>>1;for(;;)if(C=C<<1,x==h-1){E.push(u(C));break}else x++;return E.join("")},decompress:function(l){return l==null?"":l==""?null:a._decompress(l.length,32768,function(h){return l.charCodeAt(h)})},_decompress:function(l,h,u){var c=[],d=4,f=4,g=3,p="",y=[],b,v,_,m,E,C,x,w={val:u(0),position:h,index:1};for(b=0;b<3;b+=1)c[b]=b;for(_=0,E=Math.pow(2,2),C=1;C!=E;)m=w.val&w.position,w.position>>=1,w.position==0&&(w.position=h,w.val=u(w.index++)),_|=(m>0?1:0)*C,C<<=1;switch(_){case 0:for(_=0,E=Math.pow(2,8),C=1;C!=E;)m=w.val&w.position,w.position>>=1,w.position==0&&(w.position=h,w.val=u(w.index++)),_|=(m>0?1:0)*C,C<<=1;x=t(_);break;case 1:for(_=0,E=Math.pow(2,16),C=1;C!=E;)m=w.val&w.position,w.position>>=1,w.position==0&&(w.position=h,w.val=u(w.index++)),_|=(m>0?1:0)*C,C<<=1;x=t(_);break;case 2:return""}for(c[3]=x,v=x,y.push(x);;){if(w.index>l)return"";for(_=0,E=Math.pow(2,g),C=1;C!=E;)m=w.val&w.position,w.position>>=1,w.position==0&&(w.position=h,w.val=u(w.index++)),_|=(m>0?1:0)*C,C<<=1;switch(x=_){case 0:for(_=0,E=Math.pow(2,8),C=1;C!=E;)m=w.val&w.position,w.position>>=1,w.position==0&&(w.position=h,w.val=u(w.index++)),_|=(m>0?1:0)*C,C<<=1;c[f++]=t(_),x=f-1,d--;break;case 1:for(_=0,E=Math.pow(2,16),C=1;C!=E;)m=w.val&w.position,w.position>>=1,w.position==0&&(w.position=h,w.val=u(w.index++)),_|=(m>0?1:0)*C,C<<=1;c[f++]=t(_),x=f-1,d--;break;case 2:return y.join("")}if(d==0&&(d=Math.pow(2,g),g++),c[x])p=c[x];else if(x===f)p=v+v.charAt(0);else return null;y.push(p),c[f++]=v+p.charAt(0),d--,v=p,d==0&&(d=Math.pow(2,g),g++)}}};return a}();s!=null?s.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(Vd);var Nx=Vd.exports;const Fk=Gb(Nx);var Hb={exports:{}},Xh={exports:{}},Yg;function zx(){return Yg||(Yg=1,function(s,e){(function(t,i){s.exports=i()})(cs,function(){function t(p){return!isNaN(parseFloat(p))&&isFinite(p)}function i(p){return p.charAt(0).toUpperCase()+p.substring(1)}function n(p){return function(){return this[p]}}var r=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],a=["fileName","functionName","source"],l=["args"],h=["evalOrigin"],u=r.concat(o,a,l,h);function c(p){if(p)for(var y=0;y<u.length;y++)p[u[y]]!==void 0&&this["set"+i(u[y])](p[u[y]])}c.prototype={getArgs:function(){return this.args},setArgs:function(p){if(Object.prototype.toString.call(p)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=p},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(p){if(p instanceof c)this.evalOrigin=p;else if(p instanceof Object)this.evalOrigin=new c(p);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var p=this.getFileName()||"",y=this.getLineNumber()||"",b=this.getColumnNumber()||"",v=this.getFunctionName()||"";return this.getIsEval()?p?"[eval] ("+p+":"+y+":"+b+")":"[eval]:"+y+":"+b:v?v+" ("+p+":"+y+":"+b+")":p+":"+y+":"+b}},c.fromString=function(y){var b=y.indexOf("("),v=y.lastIndexOf(")"),_=y.substring(0,b),m=y.substring(b+1,v).split(","),E=y.substring(v+1);if(E.indexOf("@")===0)var C=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(E,""),x=C[1],w=C[2],R=C[3];return new c({functionName:_,args:m||void 0,fileName:x,lineNumber:w||void 0,columnNumber:R||void 0})};for(var d=0;d<r.length;d++)c.prototype["get"+i(r[d])]=n(r[d]),c.prototype["set"+i(r[d])]=function(p){return function(y){this[p]=!!y}}(r[d]);for(var f=0;f<o.length;f++)c.prototype["get"+i(o[f])]=n(o[f]),c.prototype["set"+i(o[f])]=function(p){return function(y){if(!t(y))throw new TypeError(p+" must be a Number");this[p]=Number(y)}}(o[f]);for(var g=0;g<a.length;g++)c.prototype["get"+i(a[g])]=n(a[g]),c.prototype["set"+i(a[g])]=function(p){return function(y){this[p]=String(y)}}(a[g]);return c})}(Xh)),Xh.exports}(function(s,e){(function(t,i){s.exports=i(zx())})(cs,function(i){var n=/(^|@)\S+:\d+/,r=/^\s*at .*(\S+:\d+|\(native\))/m,o=/^(eval@)?(\[native code])?$/;return{parse:function(l){if(typeof l.stacktrace<"u"||typeof l["opera#sourceloc"]<"u")return this.parseOpera(l);if(l.stack&&l.stack.match(r))return this.parseV8OrIE(l);if(l.stack)return this.parseFFOrSafari(l);throw new Error("Cannot parse given Error object")},extractLocation:function(l){if(l.indexOf(":")===-1)return[l];var h=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=h.exec(l.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(l){var h=l.stack.split(`
`).filter(function(u){return!!u.match(r)},this);return h.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var c=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),d=c.match(/ (\(.+\)$)/);c=d?c.replace(d[0],""):c;var f=this.extractLocation(d?d[1]:c),g=d&&c||void 0,p=["eval","<anonymous>"].indexOf(f[0])>-1?void 0:f[0];return new i({functionName:g,fileName:p,lineNumber:f[1],columnNumber:f[2],source:u})},this)},parseFFOrSafari:function(l){var h=l.stack.split(`
`).filter(function(u){return!u.match(o)},this);return h.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new i({functionName:u});var c=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=u.match(c),f=d&&d[1]?d[1]:void 0,g=this.extractLocation(u.replace(c,""));return new i({functionName:f,fileName:g[0],lineNumber:g[1],columnNumber:g[2],source:u})},this)},parseOpera:function(l){return!l.stacktrace||l.message.indexOf(`
`)>-1&&l.message.split(`
`).length>l.stacktrace.split(`
`).length?this.parseOpera9(l):l.stack?this.parseOpera11(l):this.parseOpera10(l)},parseOpera9:function(l){for(var h=/Line (\d+).*script (?:in )?(\S+)/i,u=l.message.split(`
`),c=[],d=2,f=u.length;d<f;d+=2){var g=h.exec(u[d]);g&&c.push(new i({fileName:g[2],lineNumber:g[1],source:u[d]}))}return c},parseOpera10:function(l){for(var h=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=l.stacktrace.split(`
`),c=[],d=0,f=u.length;d<f;d+=2){var g=h.exec(u[d]);g&&c.push(new i({functionName:g[3]||void 0,fileName:g[2],lineNumber:g[1],source:u[d]}))}return c},parseOpera11:function(l){var h=l.stack.split(`
`).filter(function(u){return!!u.match(n)&&!u.match(/^Error created at/)},this);return h.map(function(u){var c=u.split("@"),d=this.extractLocation(c.pop()),f=c.shift()||"",g=f.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,p;f.match(/\(([^)]*)\)/)&&(p=f.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var y=p===void 0||p==="[arguments not available]"?void 0:p.split(",");return new i({functionName:g,args:y,fileName:d[0],lineNumber:d[1],columnNumber:d[2],source:u})},this)}}})})(Hb);var Gx=Hb.exports;const Dk=Gb(Gx);var Bb={},ah={},Wd={},Xg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");Wd.encode=function(s){if(0<=s&&s<Xg.length)return Xg[s];throw new TypeError("Must be between 0 and 63: "+s)};Wd.decode=function(s){var e=65,t=90,i=97,n=122,r=48,o=57,a=43,l=47,h=26,u=52;return e<=s&&s<=t?s-e:i<=s&&s<=n?s-i+h:r<=s&&s<=o?s-r+u:s==a?62:s==l?63:-1};var Vb=Wd,Ud=5,Wb=1<<Ud,Ub=Wb-1,jb=Wb;function Hx(s){return s<0?(-s<<1)+1:(s<<1)+0}function Bx(s){var e=(s&1)===1,t=s>>1;return e?-t:t}ah.encode=function(e){var t="",i,n=Hx(e);do i=n&Ub,n>>>=Ud,n>0&&(i|=jb),t+=Vb.encode(i);while(n>0);return t};ah.decode=function(e,t,i){var n=e.length,r=0,o=0,a,l;do{if(t>=n)throw new Error("Expected more digits in base 64 VLQ value.");if(l=Vb.decode(e.charCodeAt(t++)),l===-1)throw new Error("Invalid base64 digit: "+e.charAt(t-1));a=!!(l&jb),l&=Ub,r=r+(l<<o),o+=Ud}while(a);i.value=Bx(r),i.rest=t};var Gr={};(function(s){function e(w,R,I){if(R in w)return w[R];if(arguments.length===3)return I;throw new Error('"'+R+'" is a required argument.')}s.getArg=e;var t=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function n(w){var R=w.match(t);return R?{scheme:R[1],auth:R[2],host:R[3],port:R[4],path:R[5]}:null}s.urlParse=n;function r(w){var R="";return w.scheme&&(R+=w.scheme+":"),R+="//",w.auth&&(R+=w.auth+"@"),w.host&&(R+=w.host),w.port&&(R+=":"+w.port),w.path&&(R+=w.path),R}s.urlGenerate=r;var o=32;function a(w){var R=[];return function(I){for(var T=0;T<R.length;T++)if(R[T].input===I){var A=R[0];return R[0]=R[T],R[T]=A,R[0].result}var F=w(I);return R.unshift({input:I,result:F}),R.length>o&&R.pop(),F}}var l=a(function(R){var I=R,T=n(R);if(T){if(!T.path)return R;I=T.path}for(var A=s.isAbsolute(I),F=[],S=0,O=0;;)if(S=O,O=I.indexOf("/",S),O===-1){F.push(I.slice(S));break}else for(F.push(I.slice(S,O));O<I.length&&I[O]==="/";)O++;for(var M,D=0,O=F.length-1;O>=0;O--)M=F[O],M==="."?F.splice(O,1):M===".."?D++:D>0&&(M===""?(F.splice(O+1,D),D=0):(F.splice(O,2),D--));return I=F.join("/"),I===""&&(I=A?"/":"."),T?(T.path=I,r(T)):I});s.normalize=l;function h(w,R){w===""&&(w="."),R===""&&(R=".");var I=n(R),T=n(w);if(T&&(w=T.path||"/"),I&&!I.scheme)return T&&(I.scheme=T.scheme),r(I);if(I||R.match(i))return R;if(T&&!T.host&&!T.path)return T.host=R,r(T);var A=R.charAt(0)==="/"?R:l(w.replace(/\/+$/,"")+"/"+R);return T?(T.path=A,r(T)):A}s.join=h,s.isAbsolute=function(w){return w.charAt(0)==="/"||t.test(w)};function u(w,R){w===""&&(w="."),w=w.replace(/\/$/,"");for(var I=0;R.indexOf(w+"/")!==0;){var T=w.lastIndexOf("/");if(T<0||(w=w.slice(0,T),w.match(/^([^\/]+:\/)?\/*$/)))return R;++I}return Array(I+1).join("../")+R.substr(w.length+1)}s.relative=u;var c=function(){var w=Object.create(null);return!("__proto__"in w)}();function d(w){return w}function f(w){return p(w)?"$"+w:w}s.toSetString=c?d:f;function g(w){return p(w)?w.slice(1):w}s.fromSetString=c?d:g;function p(w){if(!w)return!1;var R=w.length;if(R<9||w.charCodeAt(R-1)!==95||w.charCodeAt(R-2)!==95||w.charCodeAt(R-3)!==111||w.charCodeAt(R-4)!==116||w.charCodeAt(R-5)!==111||w.charCodeAt(R-6)!==114||w.charCodeAt(R-7)!==112||w.charCodeAt(R-8)!==95||w.charCodeAt(R-9)!==95)return!1;for(var I=R-10;I>=0;I--)if(w.charCodeAt(I)!==36)return!1;return!0}function y(w,R,I){var T=m(w.source,R.source);return T!==0||(T=w.originalLine-R.originalLine,T!==0)||(T=w.originalColumn-R.originalColumn,T!==0||I)||(T=w.generatedColumn-R.generatedColumn,T!==0)||(T=w.generatedLine-R.generatedLine,T!==0)?T:m(w.name,R.name)}s.compareByOriginalPositions=y;function b(w,R,I){var T;return T=w.originalLine-R.originalLine,T!==0||(T=w.originalColumn-R.originalColumn,T!==0||I)||(T=w.generatedColumn-R.generatedColumn,T!==0)||(T=w.generatedLine-R.generatedLine,T!==0)?T:m(w.name,R.name)}s.compareByOriginalPositionsNoSource=b;function v(w,R,I){var T=w.generatedLine-R.generatedLine;return T!==0||(T=w.generatedColumn-R.generatedColumn,T!==0||I)||(T=m(w.source,R.source),T!==0)||(T=w.originalLine-R.originalLine,T!==0)||(T=w.originalColumn-R.originalColumn,T!==0)?T:m(w.name,R.name)}s.compareByGeneratedPositionsDeflated=v;function _(w,R,I){var T=w.generatedColumn-R.generatedColumn;return T!==0||I||(T=m(w.source,R.source),T!==0)||(T=w.originalLine-R.originalLine,T!==0)||(T=w.originalColumn-R.originalColumn,T!==0)?T:m(w.name,R.name)}s.compareByGeneratedPositionsDeflatedNoLine=_;function m(w,R){return w===R?0:w===null?1:R===null?-1:w>R?1:-1}function E(w,R){var I=w.generatedLine-R.generatedLine;return I!==0||(I=w.generatedColumn-R.generatedColumn,I!==0)||(I=m(w.source,R.source),I!==0)||(I=w.originalLine-R.originalLine,I!==0)||(I=w.originalColumn-R.originalColumn,I!==0)?I:m(w.name,R.name)}s.compareByGeneratedPositionsInflated=E;function C(w){return JSON.parse(w.replace(/^\)]}'[^\n]*\n/,""))}s.parseSourceMapInput=C;function x(w,R,I){if(R=R||"",w&&(w[w.length-1]!=="/"&&R[0]!=="/"&&(w+="/"),R=w+R),I){var T=n(I);if(!T)throw new Error("sourceMapURL could not be parsed");if(T.path){var A=T.path.lastIndexOf("/");A>=0&&(T.path=T.path.substring(0,A+1))}R=h(r(T),R)}return l(R)}s.computeSourceURL=x})(Gr);var jd={},Yd=Gr,Xd=Object.prototype.hasOwnProperty,Es=typeof Map<"u";function En(){this._array=[],this._set=Es?new Map:Object.create(null)}En.fromArray=function(e,t){for(var i=new En,n=0,r=e.length;n<r;n++)i.add(e[n],t);return i};En.prototype.size=function(){return Es?this._set.size:Object.getOwnPropertyNames(this._set).length};En.prototype.add=function(e,t){var i=Es?e:Yd.toSetString(e),n=Es?this.has(e):Xd.call(this._set,i),r=this._array.length;(!n||t)&&this._array.push(e),n||(Es?this._set.set(e,r):this._set[i]=r)};En.prototype.has=function(e){if(Es)return this._set.has(e);var t=Yd.toSetString(e);return Xd.call(this._set,t)};En.prototype.indexOf=function(e){if(Es){var t=this._set.get(e);if(t>=0)return t}else{var i=Yd.toSetString(e);if(Xd.call(this._set,i))return this._set[i]}throw new Error('"'+e+'" is not in the set.')};En.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)};En.prototype.toArray=function(){return this._array.slice()};jd.ArraySet=En;var Yb={},Xb=Gr;function Vx(s,e){var t=s.generatedLine,i=e.generatedLine,n=s.generatedColumn,r=e.generatedColumn;return i>t||i==t&&r>=n||Xb.compareByGeneratedPositionsInflated(s,e)<=0}function lh(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}lh.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)};lh.prototype.add=function(e){Vx(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))};lh.prototype.toArray=function(){return this._sorted||(this._array.sort(Xb.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};Yb.MappingList=lh;var qr=ah,Ye=Gr,bl=jd.ArraySet,Wx=Yb.MappingList;function ci(s){s||(s={}),this._file=Ye.getArg(s,"file",null),this._sourceRoot=Ye.getArg(s,"sourceRoot",null),this._skipValidation=Ye.getArg(s,"skipValidation",!1),this._ignoreInvalidMapping=Ye.getArg(s,"ignoreInvalidMapping",!1),this._sources=new bl,this._names=new bl,this._mappings=new Wx,this._sourcesContents=null}ci.prototype._version=3;ci.fromSourceMap=function(e,t){var i=e.sourceRoot,n=new ci(Object.assign(t||{},{file:e.file,sourceRoot:i}));return e.eachMapping(function(r){var o={generated:{line:r.generatedLine,column:r.generatedColumn}};r.source!=null&&(o.source=r.source,i!=null&&(o.source=Ye.relative(i,o.source)),o.original={line:r.originalLine,column:r.originalColumn},r.name!=null&&(o.name=r.name)),n.addMapping(o)}),e.sources.forEach(function(r){var o=r;i!==null&&(o=Ye.relative(i,r)),n._sources.has(o)||n._sources.add(o);var a=e.sourceContentFor(r);a!=null&&n.setSourceContent(r,a)}),n};ci.prototype.addMapping=function(e){var t=Ye.getArg(e,"generated"),i=Ye.getArg(e,"original",null),n=Ye.getArg(e,"source",null),r=Ye.getArg(e,"name",null);!this._skipValidation&&this._validateMapping(t,i,n,r)===!1||(n!=null&&(n=String(n),this._sources.has(n)||this._sources.add(n)),r!=null&&(r=String(r),this._names.has(r)||this._names.add(r)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:i!=null&&i.line,originalColumn:i!=null&&i.column,source:n,name:r}))};ci.prototype.setSourceContent=function(e,t){var i=e;this._sourceRoot!=null&&(i=Ye.relative(this._sourceRoot,i)),t!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[Ye.toSetString(i)]=t):this._sourcesContents&&(delete this._sourcesContents[Ye.toSetString(i)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};ci.prototype.applySourceMap=function(e,t,i){var n=t;if(t==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);n=e.file}var r=this._sourceRoot;r!=null&&(n=Ye.relative(r,n));var o=new bl,a=new bl;this._mappings.unsortedForEach(function(l){if(l.source===n&&l.originalLine!=null){var h=e.originalPositionFor({line:l.originalLine,column:l.originalColumn});h.source!=null&&(l.source=h.source,i!=null&&(l.source=Ye.join(i,l.source)),r!=null&&(l.source=Ye.relative(r,l.source)),l.originalLine=h.line,l.originalColumn=h.column,h.name!=null&&(l.name=h.name))}var u=l.source;u!=null&&!o.has(u)&&o.add(u);var c=l.name;c!=null&&!a.has(c)&&a.add(c)},this),this._sources=o,this._names=a,e.sources.forEach(function(l){var h=e.sourceContentFor(l);h!=null&&(i!=null&&(l=Ye.join(i,l)),r!=null&&(l=Ye.relative(r,l)),this.setSourceContent(l,h))},this)};ci.prototype._validateMapping=function(e,t,i,n){if(t&&typeof t.line!="number"&&typeof t.column!="number"){var r="original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.";if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(r),!1;throw new Error(r)}if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!i&&!n)){if(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&i)return;var r="Invalid mapping: "+JSON.stringify({generated:e,source:i,original:t,name:n});if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(r),!1;throw new Error(r)}};ci.prototype._serializeMappings=function(){for(var e=0,t=1,i=0,n=0,r=0,o=0,a="",l,h,u,c,d=this._mappings.toArray(),f=0,g=d.length;f<g;f++){if(h=d[f],l="",h.generatedLine!==t)for(e=0;h.generatedLine!==t;)l+=";",t++;else if(f>0){if(!Ye.compareByGeneratedPositionsInflated(h,d[f-1]))continue;l+=","}l+=qr.encode(h.generatedColumn-e),e=h.generatedColumn,h.source!=null&&(c=this._sources.indexOf(h.source),l+=qr.encode(c-o),o=c,l+=qr.encode(h.originalLine-1-n),n=h.originalLine-1,l+=qr.encode(h.originalColumn-i),i=h.originalColumn,h.name!=null&&(u=this._names.indexOf(h.name),l+=qr.encode(u-r),r=u)),a+=l}return a};ci.prototype._generateSourcesContent=function(e,t){return e.map(function(i){if(!this._sourcesContents)return null;t!=null&&(i=Ye.relative(t,i));var n=Ye.toSetString(i);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null},this)};ci.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e};ci.prototype.toString=function(){return JSON.stringify(this.toJSON())};Bb.SourceMapGenerator=ci;var hh={},$b={};(function(s){s.GREATEST_LOWER_BOUND=1,s.LEAST_UPPER_BOUND=2;function e(t,i,n,r,o,a){var l=Math.floor((i-t)/2)+t,h=o(n,r[l],!0);return h===0?l:h>0?i-l>1?e(l,i,n,r,o,a):a==s.LEAST_UPPER_BOUND?i<r.length?i:-1:l:l-t>1?e(t,l,n,r,o,a):a==s.LEAST_UPPER_BOUND?l:t<0?-1:t}s.search=function(i,n,r,o){if(n.length===0)return-1;var a=e(-1,n.length,i,n,r,o||s.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&r(n[a],n[a-1],!0)===0;)--a;return a}})($b);var Kb={};function Ux(s){function e(n,r,o){var a=n[r];n[r]=n[o],n[o]=a}function t(n,r){return Math.round(n+Math.random()*(r-n))}function i(n,r,o,a){if(o<a){var l=t(o,a),h=o-1;e(n,l,a);for(var u=n[a],c=o;c<a;c++)r(n[c],u,!1)<=0&&(h+=1,e(n,h,c));e(n,h+1,c);var d=h+1;i(n,r,o,d-1),i(n,r,d+1,a)}}return i}function jx(s){let e=Ux.toString();return new Function(`return ${e}`)()(s)}let $g=new WeakMap;Kb.quickSort=function(s,e,t=0){let i=$g.get(e);i===void 0&&(i=jx(e),$g.set(e,i)),i(s,e,t,s.length-1)};var Z=Gr,$d=$b,Lr=jd.ArraySet,Yx=ah,Ho=Kb.quickSort;function De(s,e){var t=s;return typeof s=="string"&&(t=Z.parseSourceMapInput(s)),t.sections!=null?new Si(t,e):new ot(t,e)}De.fromSourceMap=function(s,e){return ot.fromSourceMap(s,e)};De.prototype._version=3;De.prototype.__generatedMappings=null;Object.defineProperty(De.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});De.prototype.__originalMappings=null;Object.defineProperty(De.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});De.prototype._charIsMappingSeparator=function(e,t){var i=e.charAt(t);return i===";"||i===","};De.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")};De.GENERATED_ORDER=1;De.ORIGINAL_ORDER=2;De.GREATEST_LOWER_BOUND=1;De.LEAST_UPPER_BOUND=2;De.prototype.eachMapping=function(e,t,i){var n=t||null,r=i||De.GENERATED_ORDER,o;switch(r){case De.GENERATED_ORDER:o=this._generatedMappings;break;case De.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}for(var a=this.sourceRoot,l=e.bind(n),h=this._names,u=this._sources,c=this._sourceMapURL,d=0,f=o.length;d<f;d++){var g=o[d],p=g.source===null?null:u.at(g.source);p!==null&&(p=Z.computeSourceURL(a,p,c)),l({source:p,generatedLine:g.generatedLine,generatedColumn:g.generatedColumn,originalLine:g.originalLine,originalColumn:g.originalColumn,name:g.name===null?null:h.at(g.name)})}};De.prototype.allGeneratedPositionsFor=function(e){var t=Z.getArg(e,"line"),i={source:Z.getArg(e,"source"),originalLine:t,originalColumn:Z.getArg(e,"column",0)};if(i.source=this._findSourceIndex(i.source),i.source<0)return[];var n=[],r=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",Z.compareByOriginalPositions,$d.LEAST_UPPER_BOUND);if(r>=0){var o=this._originalMappings[r];if(e.column===void 0)for(var a=o.originalLine;o&&o.originalLine===a;)n.push({line:Z.getArg(o,"generatedLine",null),column:Z.getArg(o,"generatedColumn",null),lastColumn:Z.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++r];else for(var l=o.originalColumn;o&&o.originalLine===t&&o.originalColumn==l;)n.push({line:Z.getArg(o,"generatedLine",null),column:Z.getArg(o,"generatedColumn",null),lastColumn:Z.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++r]}return n};hh.SourceMapConsumer=De;function ot(s,e){var t=s;typeof s=="string"&&(t=Z.parseSourceMapInput(s));var i=Z.getArg(t,"version"),n=Z.getArg(t,"sources"),r=Z.getArg(t,"names",[]),o=Z.getArg(t,"sourceRoot",null),a=Z.getArg(t,"sourcesContent",null),l=Z.getArg(t,"mappings"),h=Z.getArg(t,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);o&&(o=Z.normalize(o)),n=n.map(String).map(Z.normalize).map(function(u){return o&&Z.isAbsolute(o)&&Z.isAbsolute(u)?Z.relative(o,u):u}),this._names=Lr.fromArray(r.map(String),!0),this._sources=Lr.fromArray(n,!0),this._absoluteSources=this._sources.toArray().map(function(u){return Z.computeSourceURL(o,u,e)}),this.sourceRoot=o,this.sourcesContent=a,this._mappings=l,this._sourceMapURL=e,this.file=h}ot.prototype=Object.create(De.prototype);ot.prototype.consumer=De;ot.prototype._findSourceIndex=function(s){var e=s;if(this.sourceRoot!=null&&(e=Z.relative(this.sourceRoot,e)),this._sources.has(e))return this._sources.indexOf(e);var t;for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==s)return t;return-1};ot.fromSourceMap=function(e,t){var i=Object.create(ot.prototype),n=i._names=Lr.fromArray(e._names.toArray(),!0),r=i._sources=Lr.fromArray(e._sources.toArray(),!0);i.sourceRoot=e._sourceRoot,i.sourcesContent=e._generateSourcesContent(i._sources.toArray(),i.sourceRoot),i.file=e._file,i._sourceMapURL=t,i._absoluteSources=i._sources.toArray().map(function(f){return Z.computeSourceURL(i.sourceRoot,f,t)});for(var o=e._mappings.toArray().slice(),a=i.__generatedMappings=[],l=i.__originalMappings=[],h=0,u=o.length;h<u;h++){var c=o[h],d=new Zb;d.generatedLine=c.generatedLine,d.generatedColumn=c.generatedColumn,c.source&&(d.source=r.indexOf(c.source),d.originalLine=c.originalLine,d.originalColumn=c.originalColumn,c.name&&(d.name=n.indexOf(c.name)),l.push(d)),a.push(d)}return Ho(i.__originalMappings,Z.compareByOriginalPositions),i};ot.prototype._version=3;Object.defineProperty(ot.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function Zb(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}const $h=Z.compareByGeneratedPositionsDeflatedNoLine;function Kg(s,e){let t=s.length,i=s.length-e;if(!(i<=1))if(i==2){let n=s[e],r=s[e+1];$h(n,r)>0&&(s[e]=r,s[e+1]=n)}else if(i<20)for(let n=e;n<t;n++)for(let r=n;r>e;r--){let o=s[r-1],a=s[r];if($h(o,a)<=0)break;s[r-1]=a,s[r]=o}else Ho(s,$h,e)}ot.prototype._parseMappings=function(e,t){var i=1,n=0,r=0,o=0,a=0,l=0,h=e.length,u=0,c={},d=[],f=[],g,p,y,b;let v=0;for(;u<h;)if(e.charAt(u)===";")i++,u++,n=0,Kg(f,v),v=f.length;else if(e.charAt(u)===",")u++;else{for(g=new Zb,g.generatedLine=i,y=u;y<h&&!this._charIsMappingSeparator(e,y);y++);for(e.slice(u,y),p=[];u<y;)Yx.decode(e,u,c),b=c.value,u=c.rest,p.push(b);if(p.length===2)throw new Error("Found a source, but no line and column");if(p.length===3)throw new Error("Found a source and line, but no column");if(g.generatedColumn=n+p[0],n=g.generatedColumn,p.length>1&&(g.source=a+p[1],a+=p[1],g.originalLine=r+p[2],r=g.originalLine,g.originalLine+=1,g.originalColumn=o+p[3],o=g.originalColumn,p.length>4&&(g.name=l+p[4],l+=p[4])),f.push(g),typeof g.originalLine=="number"){let m=g.source;for(;d.length<=m;)d.push(null);d[m]===null&&(d[m]=[]),d[m].push(g)}}Kg(f,v),this.__generatedMappings=f;for(var _=0;_<d.length;_++)d[_]!=null&&Ho(d[_],Z.compareByOriginalPositionsNoSource);this.__originalMappings=[].concat(...d)};ot.prototype._findMapping=function(e,t,i,n,r,o){if(e[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[i]);if(e[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[n]);return $d.search(e,t,r,o)};ot.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var i=this._generatedMappings[e+1];if(t.generatedLine===i.generatedLine){t.lastGeneratedColumn=i.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}};ot.prototype.originalPositionFor=function(e){var t={generatedLine:Z.getArg(e,"line"),generatedColumn:Z.getArg(e,"column")},i=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",Z.compareByGeneratedPositionsDeflated,Z.getArg(e,"bias",De.GREATEST_LOWER_BOUND));if(i>=0){var n=this._generatedMappings[i];if(n.generatedLine===t.generatedLine){var r=Z.getArg(n,"source",null);r!==null&&(r=this._sources.at(r),r=Z.computeSourceURL(this.sourceRoot,r,this._sourceMapURL));var o=Z.getArg(n,"name",null);return o!==null&&(o=this._names.at(o)),{source:r,line:Z.getArg(n,"originalLine",null),column:Z.getArg(n,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}};ot.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1};ot.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var i=this._findSourceIndex(e);if(i>=0)return this.sourcesContent[i];var n=e;this.sourceRoot!=null&&(n=Z.relative(this.sourceRoot,n));var r;if(this.sourceRoot!=null&&(r=Z.urlParse(this.sourceRoot))){var o=n.replace(/^file:\/\//,"");if(r.scheme=="file"&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!r.path||r.path=="/")&&this._sources.has("/"+n))return this.sourcesContent[this._sources.indexOf("/"+n)]}if(t)return null;throw new Error('"'+n+'" is not in the SourceMap.')};ot.prototype.generatedPositionFor=function(e){var t=Z.getArg(e,"source");if(t=this._findSourceIndex(t),t<0)return{line:null,column:null,lastColumn:null};var i={source:t,originalLine:Z.getArg(e,"line"),originalColumn:Z.getArg(e,"column")},n=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",Z.compareByOriginalPositions,Z.getArg(e,"bias",De.GREATEST_LOWER_BOUND));if(n>=0){var r=this._originalMappings[n];if(r.source===i.source)return{line:Z.getArg(r,"generatedLine",null),column:Z.getArg(r,"generatedColumn",null),lastColumn:Z.getArg(r,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};hh.BasicSourceMapConsumer=ot;function Si(s,e){var t=s;typeof s=="string"&&(t=Z.parseSourceMapInput(s));var i=Z.getArg(t,"version"),n=Z.getArg(t,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new Lr,this._names=new Lr;var r={line:-1,column:0};this._sections=n.map(function(o){if(o.url)throw new Error("Support for url field in sections not implemented.");var a=Z.getArg(o,"offset"),l=Z.getArg(a,"line"),h=Z.getArg(a,"column");if(l<r.line||l===r.line&&h<r.column)throw new Error("Section offsets must be ordered and non-overlapping.");return r=a,{generatedOffset:{generatedLine:l+1,generatedColumn:h+1},consumer:new De(Z.getArg(o,"map"),e)}})}Si.prototype=Object.create(De.prototype);Si.prototype.constructor=De;Si.prototype._version=3;Object.defineProperty(Si.prototype,"sources",{get:function(){for(var s=[],e=0;e<this._sections.length;e++)for(var t=0;t<this._sections[e].consumer.sources.length;t++)s.push(this._sections[e].consumer.sources[t]);return s}});Si.prototype.originalPositionFor=function(e){var t={generatedLine:Z.getArg(e,"line"),generatedColumn:Z.getArg(e,"column")},i=$d.search(t,this._sections,function(r,o){var a=r.generatedLine-o.generatedOffset.generatedLine;return a||r.generatedColumn-o.generatedOffset.generatedColumn}),n=this._sections[i];return n?n.consumer.originalPositionFor({line:t.generatedLine-(n.generatedOffset.generatedLine-1),column:t.generatedColumn-(n.generatedOffset.generatedLine===t.generatedLine?n.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}};Si.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})};Si.prototype.sourceContentFor=function(e,t){for(var i=0;i<this._sections.length;i++){var n=this._sections[i],r=n.consumer.sourceContentFor(e,!0);if(r||r==="")return r}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')};Si.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var i=this._sections[t];if(i.consumer._findSourceIndex(Z.getArg(e,"source"))!==-1){var n=i.consumer.generatedPositionFor(e);if(n){var r={line:n.line+(i.generatedOffset.generatedLine-1),column:n.column+(i.generatedOffset.generatedLine===n.line?i.generatedOffset.generatedColumn-1:0)};return r}}}return{line:null,column:null}};Si.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var i=0;i<this._sections.length;i++)for(var n=this._sections[i],r=n.consumer._generatedMappings,o=0;o<r.length;o++){var a=r[o],l=n.consumer._sources.at(a.source);l!==null&&(l=Z.computeSourceURL(n.consumer.sourceRoot,l,this._sourceMapURL)),this._sources.add(l),l=this._sources.indexOf(l);var h=null;a.name&&(h=n.consumer._names.at(a.name),this._names.add(h),h=this._names.indexOf(h));var u={source:l,generatedLine:a.generatedLine+(n.generatedOffset.generatedLine-1),generatedColumn:a.generatedColumn+(n.generatedOffset.generatedLine===a.generatedLine?n.generatedOffset.generatedColumn-1:0),originalLine:a.originalLine,originalColumn:a.originalColumn,name:h};this.__generatedMappings.push(u),typeof u.originalLine=="number"&&this.__originalMappings.push(u)}Ho(this.__generatedMappings,Z.compareByGeneratedPositionsDeflated),Ho(this.__originalMappings,Z.compareByOriginalPositions)};hh.IndexedSourceMapConsumer=Si;var Xx=Bb.SourceMapGenerator,yl=Gr,$x=/(\r?\n)/,Kx=10,Hr="$$$isSourceNode$$$";function ai(s,e,t,i,n){this.children=[],this.sourceContents={},this.line=s??null,this.column=e??null,this.source=t??null,this.name=n??null,this[Hr]=!0,i!=null&&this.add(i)}ai.fromStringWithSourceMap=function(e,t,i){var n=new ai,r=e.split($x),o=0,a=function(){var d=g(),f=g()||"";return d+f;function g(){return o<r.length?r[o++]:void 0}},l=1,h=0,u=null;return t.eachMapping(function(d){if(u!==null)if(l<d.generatedLine)c(u,a()),l++,h=0;else{var f=r[o]||"",g=f.substr(0,d.generatedColumn-h);r[o]=f.substr(d.generatedColumn-h),h=d.generatedColumn,c(u,g),u=d;return}for(;l<d.generatedLine;)n.add(a()),l++;if(h<d.generatedColumn){var f=r[o]||"";n.add(f.substr(0,d.generatedColumn)),r[o]=f.substr(d.generatedColumn),h=d.generatedColumn}u=d},this),o<r.length&&(u&&c(u,a()),n.add(r.splice(o).join(""))),t.sources.forEach(function(d){var f=t.sourceContentFor(d);f!=null&&(i!=null&&(d=yl.join(i,d)),n.setSourceContent(d,f))}),n;function c(d,f){if(d===null||d.source===void 0)n.add(f);else{var g=i?yl.join(i,d.source):d.source;n.add(new ai(d.originalLine,d.originalColumn,g,f,d.name))}}};ai.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(t){this.add(t)},this);else if(e[Hr]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};ai.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else if(e[Hr]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};ai.prototype.walk=function(e){for(var t,i=0,n=this.children.length;i<n;i++)t=this.children[i],t[Hr]?t.walk(e):t!==""&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})};ai.prototype.join=function(e){var t,i,n=this.children.length;if(n>0){for(t=[],i=0;i<n-1;i++)t.push(this.children[i]),t.push(e);t.push(this.children[i]),this.children=t}return this};ai.prototype.replaceRight=function(e,t){var i=this.children[this.children.length-1];return i[Hr]?i.replaceRight(e,t):typeof i=="string"?this.children[this.children.length-1]=i.replace(e,t):this.children.push("".replace(e,t)),this};ai.prototype.setSourceContent=function(e,t){this.sourceContents[yl.toSetString(e)]=t};ai.prototype.walkSourceContents=function(e){for(var t=0,i=this.children.length;t<i;t++)this.children[t][Hr]&&this.children[t].walkSourceContents(e);for(var n=Object.keys(this.sourceContents),t=0,i=n.length;t<i;t++)e(yl.fromSetString(n[t]),this.sourceContents[n[t]])};ai.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e};ai.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},i=new Xx(e),n=!1,r=null,o=null,a=null,l=null;return this.walk(function(h,u){t.code+=h,u.source!==null&&u.line!==null&&u.column!==null?((r!==u.source||o!==u.line||a!==u.column||l!==u.name)&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:t.line,column:t.column},name:u.name}),r=u.source,o=u.line,a=u.column,l=u.name,n=!0):n&&(i.addMapping({generated:{line:t.line,column:t.column}}),r=null,n=!1);for(var c=0,d=h.length;c<d;c++)h.charCodeAt(c)===Kx?(t.line++,t.column=0,c+1===d?(r=null,n=!1):n&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:t.line,column:t.column},name:u.name})):t.column++}),this.walkSourceContents(function(h,u){i.setSourceContent(h,u)}),{code:t.code,map:i}};var kk=hh.SourceMapConsumer;const Zx="modulepreload",qx=function(s,e){return new URL(s,e).href},Zg={},Nk=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.allSettled(t.map(h=>{if(h=qx(h,i),h in Zg)return;Zg[h]=!0;const u=h.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!i)for(let g=o.length-1;g>=0;g--){const p=o[g];if(p.href===h&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${c}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Zx,u||(f.as="script"),f.crossOrigin="",f.href=h,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((g,p)=>{f.addEventListener("load",g),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})};var qb={exports:{}};(function(s,e){(function(t,i){i()})(cs,function(){function t(h,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function i(h,u,c){var d=new XMLHttpRequest;d.open("GET",h),d.responseType="blob",d.onload=function(){l(d.response,u,c)},d.onerror=function(){console.error("could not download file")},d.send()}function n(h){var u=new XMLHttpRequest;u.open("HEAD",h,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function r(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof cs=="object"&&cs.global===cs?cs:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(h,u,c){var d=o.URL||o.webkitURL,f=document.createElement("a");u=u||h.name||"download",f.download=u,f.rel="noopener",typeof h=="string"?(f.href=h,f.origin===location.origin?r(f):n(f.href)?i(h,u,c):r(f,f.target="_blank")):(f.href=d.createObjectURL(h),setTimeout(function(){d.revokeObjectURL(f.href)},4e4),setTimeout(function(){r(f)},0))}:"msSaveOrOpenBlob"in navigator?function(h,u,c){if(u=u||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(t(h,c),u);else if(n(h))i(h,u,c);else{var d=document.createElement("a");d.href=h,d.target="_blank",setTimeout(function(){r(d)})}}:function(h,u,c,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof h=="string")return i(h,u,c);var f=h.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||f&&g||a)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var _=y.result;_=p?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=_:location=_,d=null},y.readAsDataURL(h)}else{var b=o.URL||o.webkitURL,v=b.createObjectURL(h);d?d.location=v:location.href=v,d=null,setTimeout(function(){b.revokeObjectURL(v)},4e4)}});o.saveAs=l.saveAs=l,s.exports=l})})(qb);var zk=qb.exports;class uh{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=di,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let i=t.dataProjection?he(t.dataProjection):this.readProjection(e);t.extent&&i&&i.getUnits()==="tile-pixels"&&(i=he(i),i.setWorldExtent(t.extent)),t={dataProjection:i,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return ne()}readFeature(e,t){return ne()}readFeatures(e,t){return ne()}readGeometry(e,t){return ne()}readProjection(e){return ne()}writeFeature(e,t){return ne()}writeFeatures(e,t){return ne()}writeGeometry(e,t){return ne()}}function at(s,e,t){const i=t?he(t.featureProjection):null,n=t?he(t.dataProjection):null;let r=s;if(i&&n&&!gn(i,n)){e&&(r=s.clone());const o=e?i:n,a=e?n:i;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(Rr(o,a))}if(e&&t&&t.decimals!==void 0){const o=Math.pow(10,t.decimals),a=function(l){for(let h=0,u=l.length;h<u;++h)l[h]=Math.round(l[h]*o)/o;return l};r===s&&(r=s.clone()),r.applyTransform(a)}return r}function Kd(s,e){const t=e?he(e.featureProjection):null,i=e?he(e.dataProjection):null;return t&&i&&!gn(t,i)?Gm(s,i,t):s}const Jx={Point:Ei,LineString:zt,Polygon:pt,MultiPoint:ss,MultiLineString:xi,MultiPolygon:_n};function Qx(s,e,t){return Array.isArray(e[0])?(Km(s,0,e,t)||(s=s.slice(),Pu(s,0,e,t)),s):(gd(s,0,e,t)||(s=s.slice(),sl(s,0,e,t)),s)}function Jb(s,e){var r;const t=s.geometry;if(!t)return[];if(Array.isArray(t))return t.map(o=>Jb({...s,geometry:o})).flat();const i=t.type==="MultiPolygon"?"Polygon":t.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const n=t.layout.length;return at(new _t(i,i==="Polygon"?Qx(t.flatCoordinates,t.ends,n):t.flatCoordinates,(r=t.ends)==null?void 0:r.flat(),n,s.properties||{},s.id).enableSimplifyTransformed(),!1,e)}function Zd(s,e){if(!s)return null;if(Array.isArray(s)){const i=s.map(n=>Zd(n,e));return new _i(i)}const t=Jx[s.type];return at(new t(s.flatCoordinates,s.layout,s.ends),!1,e)}class Qb extends uh{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Ma(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Ma(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return ne()}readFeaturesFromObject(e,t){return ne()}readGeometry(e,t){return this.readGeometryFromObject(Ma(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return ne()}readProjection(e){return this.readProjectionFromObject(Ma(e))}readProjectionFromObject(e){return ne()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return ne()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return ne()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return ne()}}function Ma(s){if(typeof s=="string"){const e=JSON.parse(s);return e||null}return s!==null?s:null}class eR extends Qb{constructor(e){e=e||{},super(),this.dataProjection=he(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=he(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let i=null;e.type==="Feature"?i=e:i={type:"Feature",geometry:e,properties:null};const n=qd(i.geometry);if(this.featureClass===_t)return Jb({geometry:n,id:i.id,properties:i.properties},t);const r=new di;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&r.setGeometryName(i.geometry_name),r.setGeometry(Zd(n,t)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(e,t){const i=e;let n=null;if(i.type==="FeatureCollection"){const r=e;n=[];const o=r.features;for(let a=0,l=o.length;a<l;++a){const h=this.readFeatureFromObject(o[a],t);h&&n.push(h)}}else n=[this.readFeatureFromObject(e,t)];return n.flat()}readGeometryFromObject(e,t){return tR(e,t)}readProjectionFromObject(e){const t=e.crs;let i;if(t)if(t.type=="name")i=he(t.properties.name);else if(t.type==="EPSG")i=he("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(e,t){t=this.adaptOptions(t);const i={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(i.id=n),!e.hasProperties())return i;const r=e.getProperties(),o=e.getGeometry();return o&&(i.geometry=Gu(o,t),delete r[e.getGeometryName()]),Ss(r)||(i.properties=r),i}writeFeaturesObject(e,t){t=this.adaptOptions(t);const i=[];for(let n=0,r=e.length;n<r;++n)i.push(this.writeFeatureObject(e[n],t));return{type:"FeatureCollection",features:i}}writeGeometryObject(e,t){return Gu(e,this.adaptOptions(t))}}function qd(s,e){if(!s)return null;let t;switch(s.type){case"Point":{t=nR(s);break}case"LineString":{t=sR(s);break}case"Polygon":{t=lR(s);break}case"MultiPoint":{t=oR(s);break}case"MultiLineString":{t=rR(s);break}case"MultiPolygon":{t=aR(s);break}case"GeometryCollection":{t=iR(s);break}default:throw new Error("Unsupported GeoJSON type: "+s.type)}return t}function tR(s,e){const t=qd(s);return Zd(t,e)}function iR(s,e){return s.geometries.map(function(i){return qd(i)})}function nR(s){const e=s.coordinates;return{type:"Point",flatCoordinates:e,layout:Ns(e.length)}}function sR(s){var i;const e=s.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Ns(((i=e[0])==null?void 0:i.length)||2)}}function rR(s){var r,o;const e=s.coordinates,t=((o=(r=e[0])==null?void 0:r[0])==null?void 0:o.length)||2,i=[],n=ta(i,0,e,t);return{type:"MultiLineString",flatCoordinates:i,ends:n,layout:Ns(t)}}function oR(s){var t;const e=s.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Ns(((t=e[0])==null?void 0:t.length)||2)}}function aR(s){var r,o;const e=s.coordinates,t=[],i=((o=(r=e[0])==null?void 0:r[0])==null?void 0:o[0].length)||2,n=Bm(t,0,e,i);return{type:"MultiPolygon",flatCoordinates:t,ends:n,layout:Ns(i)}}function lR(s){var r,o;const e=s.coordinates,t=[],i=(o=(r=e[0])==null?void 0:r[0])==null?void 0:o.length,n=ta(t,0,e,i);return{type:"Polygon",flatCoordinates:t,ends:n,layout:Ns(i)}}function Gu(s,e){s=at(s,!0,e);const t=s.getType();let i;switch(t){case"Point":{i=gR(s);break}case"LineString":{i=uR(s);break}case"Polygon":{i=pR(s,e);break}case"MultiPoint":{i=dR(s);break}case"MultiLineString":{i=cR(s);break}case"MultiPolygon":{i=fR(s,e);break}case"GeometryCollection":{i=hR(s,e);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return i}function hR(s,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:s.getGeometriesArray().map(function(i){return Gu(i,e)})}}function uR(s,e){return{type:"LineString",coordinates:s.getCoordinates()}}function cR(s,e){return{type:"MultiLineString",coordinates:s.getCoordinates()}}function dR(s,e){return{type:"MultiPoint",coordinates:s.getCoordinates()}}function fR(s,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:s.getCoordinates(t)}}function gR(s,e){return{type:"Point",coordinates:s.getCoordinates()}}function pR(s,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:s.getCoordinates(t)}}const Is="http://www.w3.org/2001/XMLSchema-instance";function le(s,e){return Br().createElementNS(s,e)}function Ct(s,e){return ey(s,e,[]).join("")}function ey(s,e,t){if(s.nodeType==Node.CDATA_SECTION_NODE||s.nodeType==Node.TEXT_NODE)t.push(s.nodeValue);else{let i;for(i=s.firstChild;i;i=i.nextSibling)ey(i,e,t)}return t}function si(s){return"documentElement"in s}function mR(s,e,t){return s.getAttributeNS(e,t)||""}function ri(s){return new DOMParser().parseFromString(s,"application/xml")}function vl(s,e){return function(t,i){const n=s.call(e??this,t,i);if(n!==void 0){const r=i[i.length-1];Re(r,n)}}}function te(s,e){return function(t,i){const n=s.call(e??this,t,i);n!==void 0&&i[i.length-1].push(n)}}function ie(s,e){return function(t,i){const n=s.call(e??this,t,i);n!==void 0&&(i[i.length-1]=n)}}function Pt(s,e,t){return function(i,n){const r=s.call(this,i,n);if(r!==void 0){const o=n[n.length-1],a=i.localName;let l;a in o?l=o[a]:(l=[],o[a]=l),l.push(r)}}}function P(s,e,t){return function(i,n){const r=s.call(this,i,n);if(r!==void 0){const o=n[n.length-1],a=e!==void 0?e:i.localName;o[a]=r}}}function L(s,e){return function(t,i,n){s.call(e??this,t,i,n),n[n.length-1].node.appendChild(t)}}function ty(s,e){let t,i;return function(n,r,o){if(t===void 0){t={};const a={};a[n.localName]=s,t[n.namespaceURI]=a,i=Be(n.localName)}iy(t,i,r,o)}}function Be(s,e){return function(t,i,n){const o=i[i.length-1].node;let a=s;a===void 0&&(a=n);const l=e!==void 0?e:o.namespaceURI;return le(l,a)}}const it=Be();function Gt(s,e){const t=e.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=s[e[n]];return i}function G(s,e,t){t=t!==void 0?t:{};let i,n;for(i=0,n=s.length;i<n;++i)t[s[i]]=e;return t}function Nt(s,e,t,i){let n;for(n=e.firstElementChild;n;n=n.nextElementSibling){const r=s[n.namespaceURI];if(r!==void 0){const o=r[n.localName];o!==void 0&&o.call(i,n,t)}}}function W(s,e,t,i,n){return i.push(s),Nt(e,t,i,n),i.pop()}function iy(s,e,t,i,n,r){const o=(n!==void 0?n:t).length;let a,l;for(let h=0;h<o;++h)a=t[h],a!==void 0&&(l=e.call(r,a,i,n!==void 0?n[h]:void 0),l!==void 0&&s[l.namespaceURI][l.localName].call(r,l,a,i))}function ae(s,e,t,i,n,r,o){return n.push(s),iy(e,t,i,n,r,o),n.pop()}let Kh;function bR(){return Kh===void 0&&typeof XMLSerializer<"u"&&(Kh=new XMLSerializer),Kh}let Zh;function Br(){return Zh===void 0&&typeof document<"u"&&(Zh=document.implementation.createDocument("","",null)),Zh}class ua extends uh{constructor(){super(),this.xmlSerializer_=bR()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const i=ri(e);return this.readFeatureFromDocument(i,t)}return si(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const i=this.readFeaturesFromDocument(e,t);return i.length>0?i[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const i=ri(e);return this.readFeaturesFromDocument(i,t)}return si(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const i=[];for(let n=e.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&Re(i,this.readFeaturesFromNode(n,t));return i}readFeaturesFromNode(e,t){return ne()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const i=ri(e);return this.readGeometryFromDocument(i,t)}return si(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=ri(e);return this.readProjectionFromDocument(t)}return si(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const i=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(i)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const i=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(i)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const i=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(i)}writeGeometryNode(e,t){return null}}const yn="http://www.opengis.net/gml",yR=/^\s*$/;class Q extends ua{constructor(e){super(),e=e||{},this.featureType=e.featureType,this.featureNS=e.featureNS,this.srsName=e.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:te(this.readFeaturesInternal),featureMembers:ie(this.readFeaturesInternal)},this.supportedMediaTypes=["application/gml+xml"]}readFeaturesInternal(e,t){const i=e.localName;let n=null;if(i=="FeatureCollection")n=W([],this.FEATURE_COLLECTION_PARSERS,e,t,this);else if(i=="featureMembers"||i=="featureMember"||i=="member"){const r=t[0];let o=r.featureType,a=r.featureNS;const l="p",h="p0";if(!o&&e.childNodes){o=[],a={};for(let d=0,f=e.childNodes.length;d<f;++d){const g=e.childNodes[d];if(g.nodeType===1){const p=g.nodeName.split(":").pop();if(!o.includes(p)){let y="",b=0;const v=g.namespaceURI;for(const _ in a){if(a[_]===v){y=_;break}++b}y||(y=l+b,a[y]=v),o.push(y+":"+p)}}}i!="featureMember"&&(r.featureType=o,r.featureNS=a)}if(typeof a=="string"){const d=a;a={},a[h]=d}const u={},c=Array.isArray(o)?o:[o];for(const d in a){const f={};for(let g=0,p=c.length;g<p;++g)(c[g].includes(":")?c[g].split(":")[0]:h)===d&&(f[c[g].split(":").pop()]=i=="featureMembers"?te(this.readFeatureElement,this):ie(this.readFeatureElement,this));u[a[d]]=f}i=="featureMember"||i=="member"?n=W(void 0,u,e,t):n=W([],u,e,t)}return n===null&&(n=[]),n}readGeometryOrExtent(e,t){const i=t[0];return i.srsName=e.firstElementChild.getAttribute("srsName"),i.srsDimension=e.firstElementChild.getAttribute("srsDimension"),W(null,this.GEOMETRY_PARSERS,e,t,this)}readExtentElement(e,t){const i=t[0],n=this.readGeometryOrExtent(e,t);return n?Kd(n,i):void 0}readGeometryElement(e,t){const i=t[0],n=this.readGeometryOrExtent(e,t);return n?at(n,!1,i):void 0}readFeatureElementInternal(e,t,i){let n;const r={};for(let l=e.firstElementChild;l;l=l.nextElementSibling){let h;const u=l.localName;l.childNodes.length===0||l.childNodes.length===1&&(l.firstChild.nodeType===3||l.firstChild.nodeType===4)?(h=Ct(l,!1),yR.test(h)&&(h=void 0)):(i&&(h=u==="boundedBy"?this.readExtentElement(l,t):this.readGeometryElement(l,t)),h?u!=="boundedBy"&&(n=u):h=this.readFeatureElementInternal(l,t,!1));const c=l.attributes.length;if(c>0&&!(h instanceof rd)){h={_content_:h};for(let d=0;d<c;d++){const f=l.attributes[d].name;h[f]=l.attributes[d].value}}r[u]?(r[u]instanceof Array||(r[u]=[r[u]]),r[u].push(h)):r[u]=h}if(!i)return r;const o=new di(r);n&&o.setGeometryName(n);const a=e.getAttribute("fid")||mR(e,this.namespace,"id");return a&&o.setId(a),o}readFeatureElement(e,t){return this.readFeatureElementInternal(e,t,!0)}readPoint(e,t){const i=this.readFlatCoordinatesFromNode(e,t);if(i)return new Ei(i,"XYZ")}readMultiPoint(e,t){const i=W([],this.MULTIPOINT_PARSERS,e,t,this);if(i)return new ss(i)}readMultiLineString(e,t){const i=W([],this.MULTILINESTRING_PARSERS,e,t,this);if(i)return new xi(i)}readMultiPolygon(e,t){const i=W([],this.MULTIPOLYGON_PARSERS,e,t,this);if(i)return new _n(i)}pointMemberParser(e,t){Nt(this.POINTMEMBER_PARSERS,e,t,this)}lineStringMemberParser(e,t){Nt(this.LINESTRINGMEMBER_PARSERS,e,t,this)}polygonMemberParser(e,t){Nt(this.POLYGONMEMBER_PARSERS,e,t,this)}readLineString(e,t){const i=this.readFlatCoordinatesFromNode(e,t);if(i)return new zt(i,"XYZ")}readFlatLinearRing(e,t){const i=W(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this);if(i)return i}readLinearRing(e,t){const i=this.readFlatCoordinatesFromNode(e,t);if(i)return new Sr(i,"XYZ")}readPolygon(e,t){const i=W([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this);if(i&&i[0]){const n=i[0],r=[n.length];let o,a;for(o=1,a=i.length;o<a;++o)Re(n,i[o]),r.push(n.length);return new pt(n,"XYZ",r)}}readFlatCoordinatesFromNode(e,t){return W(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}readGeometryFromNode(e,t){const i=this.readGeometryElement(e,[this.getReadOptions(e,t||{})]);return i||null}readFeaturesFromNode(e,t){const i={featureType:this.featureType,featureNS:this.featureNS};return i&&Object.assign(i,this.getReadOptions(e,t)),this.readFeaturesInternal(e,[i])||[]}readProjectionFromNode(e){return he(this.srsName?this.srsName:e.firstElementChild.getAttribute("srsName"))}}Q.prototype.namespace=yn;Q.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}};Q.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}};Q.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}};Q.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:te(Q.prototype.pointMemberParser),pointMembers:te(Q.prototype.pointMemberParser)}};Q.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:te(Q.prototype.lineStringMemberParser),lineStringMembers:te(Q.prototype.lineStringMemberParser)}};Q.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:te(Q.prototype.polygonMemberParser),polygonMembers:te(Q.prototype.polygonMemberParser)}};Q.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:te(Q.prototype.readFlatCoordinatesFromNode)}};Q.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:te(Q.prototype.readLineString)}};Q.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:te(Q.prototype.readPolygon)}};Q.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:ie(Q.prototype.readFlatLinearRing)}};function Qn(s){const e=Ct(s,!1);return vR(e)}function vR(s){const e=/^\s*(true|1)|(false|0)\s*$/.exec(s);if(e)return e[1]!==void 0||!1}function ch(s){const e=Ct(s,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Te(s){const e=Ct(s,!1);return wR(e)}function wR(s){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(s);if(e)return parseFloat(e[1])}function Je(s){const e=Ct(s,!1);return ar(e)}function ar(s){const e=/^\s*(\d+)\s*$/.exec(s);if(e)return parseInt(e[1],10)}function $(s){return Ct(s,!1).trim()}function Ar(s,e){re(s,e?"1":"0")}function _R(s,e){s.appendChild(Br().createCDATASection(e))}function ER(s,e){const t=new Date(e*1e3),i=t.getUTCFullYear()+"-"+Yr(t.getUTCMonth()+1,2)+"-"+Yr(t.getUTCDate(),2)+"T"+Yr(t.getUTCHours(),2)+":"+Yr(t.getUTCMinutes(),2)+":"+Yr(t.getUTCSeconds(),2)+"Z";s.appendChild(Br().createTextNode(i))}function Tt(s,e){const t=e.toPrecision();s.appendChild(Br().createTextNode(t))}function wl(s,e){const t=e.toString();s.appendChild(Br().createTextNode(t))}function re(s,e){s.appendChild(Br().createTextNode(e))}const CR=yn+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",xR={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class fe extends Q{constructor(e){e=e||{},super(e),this.FEATURE_COLLECTION_PARSERS[yn].featureMember=te(this.readFeaturesInternal),this.schemaLocation=e.schemaLocation?e.schemaLocation:CR}readFlatCoordinates(e,t){const i=Ct(e,!1).replace(/^\s*|\s*$/g,""),r=t[0].srsName;let o="enu";if(r){const h=he(r);h&&(o=h.getAxisOrientation())}const a=i.trim().split(/\s+/),l=[];for(let h=0,u=a.length;h<u;h++){const c=a[h].split(/,+/),d=parseFloat(c[0]),f=parseFloat(c[1]),g=c.length===3?parseFloat(c[2]):0;o.startsWith("en")?l.push(d,f,g):l.push(f,d,g)}return l}readBox(e,t){const i=W([null],this.BOX_PARSERS_,e,t,this);return ui(i[1][0],i[1][1],i[1][3],i[1][4])}innerBoundaryIsParser(e,t){const i=W(void 0,this.RING_PARSERS,e,t,this);i&&t[t.length-1].push(i)}outerBoundaryIsParser(e,t){const i=W(void 0,this.RING_PARSERS,e,t,this);if(i){const n=t[t.length-1];n[0]=i}}GEOMETRY_NODE_FACTORY_(e,t,i){const n=t[t.length-1],r=n.multiSurface,o=n.surface,a=n.multiCurve;return Array.isArray(e)?i="Envelope":(i=e.getType(),i==="MultiPolygon"&&r===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="MultiLineString"&&a===!0&&(i="MultiCurve")),le("http://www.opengis.net/gml",i)}writeFeatureElement(e,t,i){const n=t.getId();n&&e.setAttribute("fid",n);const r=i[i.length-1],o=r.featureNS,a=t.getGeometryName();r.serializers||(r.serializers={},r.serializers[o]={});const l=[],h=[];if(t.hasProperties()){const c=t.getProperties();for(const d in c){const f=c[d];f!=null&&(l.push(d),h.push(f),d==a||typeof f.getSimplifiedGeometry=="function"?d in r.serializers[o]||(r.serializers[o][d]=L(this.writeGeometryElement,this)):d in r.serializers[o]||(r.serializers[o][d]=L(re)))}}const u=Object.assign({},r);u.node=e,ae(u,r.serializers,Be(void 0,o),h,i,l)}writeCurveOrLineString(e,t,i){const r=i[i.length-1].srsName;if(e.nodeName!=="LineStringSegment"&&r&&e.setAttribute("srsName",r),e.nodeName==="LineString"||e.nodeName==="LineStringSegment"){const o=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(o),this.writeCoordinates_(o,t,i)}else if(e.nodeName==="Curve"){const o=le(e.namespaceURI,"segments");e.appendChild(o),this.writeCurveSegments_(o,t,i)}}writeLineStringOrCurveMember(e,t,i){const n=this.GEOMETRY_NODE_FACTORY_(t,i);n&&(e.appendChild(n),this.writeCurveOrLineString(n,t,i))}writeMultiCurveOrLineString(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName,a=n.curve;o&&e.setAttribute("srsName",o);const l=t.getLineStrings();ae({node:e,hasZ:r,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeGeometryElement(e,t,i){const n=i[i.length-1],r=Object.assign({},n);r.node=e;let o;Array.isArray(t)?o=Kd(t,n):o=at(t,!0,n),ae(r,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}createCoordinatesNode_(e){const t=le(e,"coordinates");return t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," "),t}writeCoordinates_(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName,a=t.getCoordinates(),l=a.length,h=new Array(l);for(let u=0;u<l;++u){const c=a[u];h[u]=this.getCoords_(c,o,r)}re(e,h.join(" "))}writeCurveSegments_(e,t,i){const n=le(e.namespaceURI,"LineStringSegment");e.appendChild(n),this.writeCurveOrLineString(n,t,i)}writeSurfaceOrPolygon(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName;if(e.nodeName!=="PolygonPatch"&&o&&e.setAttribute("srsName",o),e.nodeName==="Polygon"||e.nodeName==="PolygonPatch"){const a=t.getLinearRings();ae({node:e,hasZ:r,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(e.nodeName==="Surface"){const a=le(e.namespaceURI,"patches");e.appendChild(a),this.writeSurfacePatches_(a,t,i)}}RING_NODE_FACTORY_(e,t,i){const n=t[t.length-1],r=n.node,o=n.exteriorWritten;return o===void 0&&(n.exteriorWritten=!0),le(r.namespaceURI,o!==void 0?"innerBoundaryIs":"outerBoundaryIs")}writeSurfacePatches_(e,t,i){const n=le(e.namespaceURI,"PolygonPatch");e.appendChild(n),this.writeSurfaceOrPolygon(n,t,i)}writeRing(e,t,i){const n=le(e.namespaceURI,"LinearRing");e.appendChild(n),this.writeLinearRing(n,t,i)}getCoords_(e,t,i){let r=(t?he(t).getAxisOrientation():"enu").startsWith("en")?e[0]+","+e[1]:e[1]+","+e[0];if(i){const o=e[2]||0;r+=","+o}return r}writePoint(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName;o&&e.setAttribute("srsName",o);const a=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(a);const l=t.getCoordinates(),h=this.getCoords_(l,o,r);re(a,h)}writeMultiPoint(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName;o&&e.setAttribute("srsName",o);const a=t.getPoints();ae({node:e,hasZ:r,srsName:o},this.POINTMEMBER_SERIALIZERS,Be("pointMember"),a,i,void 0,this)}writePointMember(e,t,i){const n=le(e.namespaceURI,"Point");e.appendChild(n),this.writePoint(n,t,i)}writeLinearRing(e,t,i){const r=i[i.length-1].srsName;r&&e.setAttribute("srsName",r);const o=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(o),this.writeCoordinates_(o,t,i)}writeMultiSurfaceOrPolygon(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName,a=n.surface;o&&e.setAttribute("srsName",o);const l=t.getPolygons();ae({node:e,hasZ:r,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeSurfaceOrPolygonMember(e,t,i){const n=this.GEOMETRY_NODE_FACTORY_(t,i);n&&(e.appendChild(n),this.writeSurfaceOrPolygon(n,t,i))}writeEnvelope(e,t,i){const r=i[i.length-1].srsName;r&&e.setAttribute("srsName",r);const o=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];ae({node:e},this.ENVELOPE_SERIALIZERS,it,a,i,o,this)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(e,t,i){const n=t[t.length-1].node;return le("http://www.opengis.net/gml",xR[n.nodeName])}}fe.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:ie(fe.prototype.readFlatCoordinates)}};fe.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:fe.prototype.innerBoundaryIsParser,outerBoundaryIs:fe.prototype.outerBoundaryIsParser}};fe.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:te(fe.prototype.readFlatCoordinates)}};fe.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:ie(Q.prototype.readPoint),MultiPoint:ie(Q.prototype.readMultiPoint),LineString:ie(Q.prototype.readLineString),MultiLineString:ie(Q.prototype.readMultiLineString),LinearRing:ie(Q.prototype.readLinearRing),Polygon:ie(Q.prototype.readPolygon),MultiPolygon:ie(Q.prototype.readMultiPolygon),Box:ie(fe.prototype.readBox)}};fe.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:L(fe.prototype.writeCurveOrLineString),MultiCurve:L(fe.prototype.writeMultiCurveOrLineString),Point:L(fe.prototype.writePoint),MultiPoint:L(fe.prototype.writeMultiPoint),LineString:L(fe.prototype.writeCurveOrLineString),MultiLineString:L(fe.prototype.writeMultiCurveOrLineString),LinearRing:L(fe.prototype.writeLinearRing),Polygon:L(fe.prototype.writeSurfaceOrPolygon),MultiPolygon:L(fe.prototype.writeMultiSurfaceOrPolygon),Surface:L(fe.prototype.writeSurfaceOrPolygon),MultiSurface:L(fe.prototype.writeMultiSurfaceOrPolygon),Envelope:L(fe.prototype.writeEnvelope)}};fe.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:L(fe.prototype.writeLineStringOrCurveMember),curveMember:L(fe.prototype.writeLineStringOrCurveMember)}};fe.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:L(fe.prototype.writeRing),innerBoundaryIs:L(fe.prototype.writeRing)}};fe.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:L(fe.prototype.writePointMember)}};fe.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:L(fe.prototype.writeSurfaceOrPolygonMember),polygonMember:L(fe.prototype.writeSurfaceOrPolygonMember)}};fe.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:L(re),upperCorner:L(re)}};const RR=yn+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",SR={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class B extends Q{constructor(e){e=e||{},super(e),this.surface_=e.surface!==void 0?e.surface:!1,this.curve_=e.curve!==void 0?e.curve:!1,this.multiCurve_=e.multiCurve!==void 0?e.multiCurve:!0,this.multiSurface_=e.multiSurface!==void 0?e.multiSurface:!0,this.schemaLocation=e.schemaLocation?e.schemaLocation:RR,this.hasZ=e.hasZ!==void 0?e.hasZ:!1}readMultiCurve(e,t){const i=W([],this.MULTICURVE_PARSERS,e,t,this);if(i)return new xi(i)}readFlatCurveRing(e,t){const i=W([],this.MULTICURVE_PARSERS,e,t,this),n=[];for(let r=0,o=i.length;r<o;++r)Re(n,i[r].getFlatCoordinates());return n}readMultiSurface(e,t){const i=W([],this.MULTISURFACE_PARSERS,e,t,this);if(i)return new _n(i)}curveMemberParser(e,t){Nt(this.CURVEMEMBER_PARSERS,e,t,this)}surfaceMemberParser(e,t){Nt(this.SURFACEMEMBER_PARSERS,e,t,this)}readPatch(e,t){return W([null],this.PATCHES_PARSERS,e,t,this)}readSegment(e,t){return W([],this.SEGMENTS_PARSERS,e,t,this)}readPolygonPatch(e,t){return W([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this)}readLineStringSegment(e,t){return W([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}interiorParser(e,t){const i=W(void 0,this.RING_PARSERS,e,t,this);i&&t[t.length-1].push(i)}exteriorParser(e,t){const i=W(void 0,this.RING_PARSERS,e,t,this);if(i){const n=t[t.length-1];n[0]=i}}readSurface(e,t){const i=W([null],this.SURFACE_PARSERS,e,t,this);if(i&&i[0]){const n=i[0],r=[n.length];let o,a;for(o=1,a=i.length;o<a;++o)Re(n,i[o]),r.push(n.length);return new pt(n,"XYZ",r)}}readCurve(e,t){const i=W([null],this.CURVE_PARSERS,e,t,this);if(i)return new zt(i,"XYZ")}readEnvelope(e,t){const i=W([null],this.ENVELOPE_PARSERS,e,t,this);return ui(i[1][0],i[1][1],i[2][0],i[2][1])}readFlatPos(e,t){let i=Ct(e,!1);const n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,r=[];let o;for(;o=n.exec(i);)r.push(parseFloat(o[1])),i=i.substr(o[0].length);if(i!=="")return;const l=t[0].srsName;if((l?he(l).getAxisOrientation():"enu")==="neu")for(let c=0,d=r.length;c<d;c+=3){const f=r[c],g=r[c+1];r[c]=g,r[c+1]=f}const u=r.length;if(u==2&&r.push(0),u!==0)return r}readFlatPosList(e,t){const i=Ct(e,!1).replace(/^\s*|\s*$/g,""),n=t[0],r=n.srsName,o=n.srsDimension,a=r?he(r).getAxisOrientation():"enu",l=i.split(/\s+/);let h=2;e.getAttribute("srsDimension")?h=ar(e.getAttribute("srsDimension")):e.getAttribute("dimension")?h=ar(e.getAttribute("dimension")):e.parentNode.getAttribute("srsDimension")?h=ar(e.parentNode.getAttribute("srsDimension")):o&&(h=ar(o));const u=a.startsWith("en");let c,d,f;const g=[];for(let p=0,y=l.length;p<y;p+=h)c=parseFloat(l[p]),d=parseFloat(l[p+1]),f=h===3?parseFloat(l[p+2]):0,u?g.push(c,d,f):g.push(d,c,f);return g}writePos_(e,t,i){const n=i[i.length-1],r=n.hasZ,o=r?"3":"2";e.setAttribute("srsDimension",o);const a=n.srsName,l=a?he(a).getAxisOrientation():"enu",h=t.getCoordinates();let u=l.startsWith("en")?h[0]+" "+h[1]:h[1]+" "+h[0];if(r){const c=h[2]||0;u+=" "+c}re(e,u)}getCoords_(e,t,i){let r=(t?he(t).getAxisOrientation():"enu").startsWith("en")?e[0]+" "+e[1]:e[1]+" "+e[0];if(i){const o=e[2]||0;r+=" "+o}return r}writePosList_(e,t,i){const n=i[i.length-1],r=n.hasZ,o=r?"3":"2";e.setAttribute("srsDimension",o);const a=n.srsName,l=t.getCoordinates(),h=l.length,u=new Array(h);let c;for(let d=0;d<h;++d)c=l[d],u[d]=this.getCoords_(c,a,r);re(e,u.join(" "))}writePoint(e,t,i){const r=i[i.length-1].srsName;r&&e.setAttribute("srsName",r);const o=le(e.namespaceURI,"pos");e.appendChild(o),this.writePos_(o,t,i)}writeEnvelope(e,t,i){const r=i[i.length-1].srsName;r&&e.setAttribute("srsName",r);const o=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];ae({node:e},this.ENVELOPE_SERIALIZERS,it,a,i,o,this)}writeLinearRing(e,t,i){const r=i[i.length-1].srsName;r&&e.setAttribute("srsName",r);const o=le(e.namespaceURI,"posList");e.appendChild(o),this.writePosList_(o,t,i)}RING_NODE_FACTORY_(e,t,i){const n=t[t.length-1],r=n.node,o=n.exteriorWritten;return o===void 0&&(n.exteriorWritten=!0),le(r.namespaceURI,o!==void 0?"interior":"exterior")}writeSurfaceOrPolygon(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName;if(e.nodeName!=="PolygonPatch"&&o&&e.setAttribute("srsName",o),e.nodeName==="Polygon"||e.nodeName==="PolygonPatch"){const a=t.getLinearRings();ae({node:e,hasZ:r,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(e.nodeName==="Surface"){const a=le(e.namespaceURI,"patches");e.appendChild(a),this.writeSurfacePatches_(a,t,i)}}writeCurveOrLineString(e,t,i){const r=i[i.length-1].srsName;if(e.nodeName!=="LineStringSegment"&&r&&e.setAttribute("srsName",r),e.nodeName==="LineString"||e.nodeName==="LineStringSegment"){const o=le(e.namespaceURI,"posList");e.appendChild(o),this.writePosList_(o,t,i)}else if(e.nodeName==="Curve"){const o=le(e.namespaceURI,"segments");e.appendChild(o),this.writeCurveSegments_(o,t,i)}}writeMultiSurfaceOrPolygon(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName,a=n.surface;o&&e.setAttribute("srsName",o);const l=t.getPolygons();ae({node:e,hasZ:r,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeMultiPoint(e,t,i){const n=i[i.length-1],r=n.srsName,o=n.hasZ;r&&e.setAttribute("srsName",r);const a=t.getPoints();ae({node:e,hasZ:o,srsName:r},this.POINTMEMBER_SERIALIZERS,Be("pointMember"),a,i,void 0,this)}writeMultiCurveOrLineString(e,t,i){const n=i[i.length-1],r=n.hasZ,o=n.srsName,a=n.curve;o&&e.setAttribute("srsName",o);const l=t.getLineStrings();ae({node:e,hasZ:r,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeRing(e,t,i){const n=le(e.namespaceURI,"LinearRing");e.appendChild(n),this.writeLinearRing(n,t,i)}writeSurfaceOrPolygonMember(e,t,i){const n=this.GEOMETRY_NODE_FACTORY_(t,i);n&&(e.appendChild(n),this.writeSurfaceOrPolygon(n,t,i))}writePointMember(e,t,i){const n=le(e.namespaceURI,"Point");e.appendChild(n),this.writePoint(n,t,i)}writeLineStringOrCurveMember(e,t,i){const n=this.GEOMETRY_NODE_FACTORY_(t,i);n&&(e.appendChild(n),this.writeCurveOrLineString(n,t,i))}writeSurfacePatches_(e,t,i){const n=le(e.namespaceURI,"PolygonPatch");e.appendChild(n),this.writeSurfaceOrPolygon(n,t,i)}writeCurveSegments_(e,t,i){const n=le(e.namespaceURI,"LineStringSegment");e.appendChild(n),this.writeCurveOrLineString(n,t,i)}writeGeometryElement(e,t,i){const n=i[i.length-1],r=Object.assign({},n);r.node=e;let o;Array.isArray(t)?o=Kd(t,n):o=at(t,!0,n),ae(r,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}writeFeatureElement(e,t,i){const n=t.getId();n&&e.setAttribute("fid",n);const r=i[i.length-1],o=r.featureNS,a=t.getGeometryName();r.serializers||(r.serializers={},r.serializers[o]={});const l=[],h=[];if(t.hasProperties()){const c=t.getProperties();for(const d in c){const f=c[d];f!=null&&(l.push(d),h.push(f),d==a||typeof f.getSimplifiedGeometry=="function"?d in r.serializers[o]||(r.serializers[o][d]=L(this.writeGeometryElement,this)):d in r.serializers[o]||(r.serializers[o][d]=L(re)))}}const u=Object.assign({},r);u.node=e,ae(u,r.serializers,Be(void 0,o),h,i,l)}writeFeatureMembers_(e,t,i){const n=i[i.length-1],r=n.featureType,o=n.featureNS,a={};a[o]={},a[o][r]=L(this.writeFeatureElement,this);const l=Object.assign({},n);l.node=e,ae(l,a,Be(r,o),t,i)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(e,t,i){const n=t[t.length-1].node;return le(this.namespace,SR[n.nodeName])}GEOMETRY_NODE_FACTORY_(e,t,i){const n=t[t.length-1],r=n.multiSurface,o=n.surface,a=n.curve,l=n.multiCurve;return Array.isArray(e)?i="Envelope":(i=e.getType(),i==="MultiPolygon"&&r===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="LineString"&&a===!0?i="Curve":i==="MultiLineString"&&l===!0&&(i="MultiCurve")),le(this.namespace,i)}writeGeometryNode(e,t){t=this.adaptOptions(t);const i=le(this.namespace,"geom"),n={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return t&&Object.assign(n,t),this.writeGeometryElement(i,e,[n]),i}writeFeaturesNode(e,t){t=this.adaptOptions(t);const i=le(this.namespace,"featureMembers");i.setAttributeNS(Is,"xsi:schemaLocation",this.schemaLocation);const n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return t&&Object.assign(n,t),this.writeFeatureMembers_(i,e,[n]),i}}B.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:ie(B.prototype.readFlatPos),posList:ie(B.prototype.readFlatPosList),coordinates:ie(fe.prototype.readFlatCoordinates)}};B.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:B.prototype.interiorParser,exterior:B.prototype.exteriorParser}};B.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:ie(Q.prototype.readPoint),MultiPoint:ie(Q.prototype.readMultiPoint),LineString:ie(Q.prototype.readLineString),MultiLineString:ie(Q.prototype.readMultiLineString),LinearRing:ie(Q.prototype.readLinearRing),Polygon:ie(Q.prototype.readPolygon),MultiPolygon:ie(Q.prototype.readMultiPolygon),Surface:ie(B.prototype.readSurface),MultiSurface:ie(B.prototype.readMultiSurface),Curve:ie(B.prototype.readCurve),MultiCurve:ie(B.prototype.readMultiCurve),Envelope:ie(B.prototype.readEnvelope)}};B.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:te(B.prototype.curveMemberParser),curveMembers:te(B.prototype.curveMemberParser)}};B.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:te(B.prototype.surfaceMemberParser),surfaceMembers:te(B.prototype.surfaceMemberParser)}};B.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:te(Q.prototype.readLineString),Curve:te(B.prototype.readCurve)}};B.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:te(Q.prototype.readPolygon),Surface:te(B.prototype.readSurface)}};B.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:ie(B.prototype.readPatch)}};B.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:ie(B.prototype.readSegment)}};B.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:te(B.prototype.readFlatPosList),upperCorner:te(B.prototype.readFlatPosList)}};B.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:ie(B.prototype.readPolygonPatch)}};B.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:vl(B.prototype.readLineStringSegment)}};Q.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:ie(Q.prototype.readFlatLinearRing),Ring:ie(B.prototype.readFlatCurveRing)}};B.prototype.writeFeatures;B.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:L(B.prototype.writeRing),interior:L(B.prototype.writeRing)}};B.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:L(re),upperCorner:L(re)}};B.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:L(B.prototype.writeSurfaceOrPolygonMember),polygonMember:L(B.prototype.writeSurfaceOrPolygonMember)}};B.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:L(B.prototype.writePointMember)}};B.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:L(B.prototype.writeLineStringOrCurveMember),curveMember:L(B.prototype.writeLineStringOrCurveMember)}};B.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:L(B.prototype.writeCurveOrLineString),MultiCurve:L(B.prototype.writeMultiCurveOrLineString),Point:L(B.prototype.writePoint),MultiPoint:L(B.prototype.writeMultiPoint),LineString:L(B.prototype.writeCurveOrLineString),MultiLineString:L(B.prototype.writeMultiCurveOrLineString),LinearRing:L(B.prototype.writeLinearRing),Polygon:L(B.prototype.writeSurfaceOrPolygon),MultiPolygon:L(B.prototype.writeMultiSurfaceOrPolygon),Surface:L(B.prototype.writeSurfaceOrPolygon),MultiSurface:L(B.prototype.writeMultiSurfaceOrPolygon),Envelope:L(B.prototype.writeEnvelope)}};const ke=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],TR="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",MR={rte:ny,trk:sy,wpt:ry},LR=G(ke,{rte:te(ny),trk:te(sy),wpt:te(ry)}),AR=G(ke,{text:P($,"linkText"),type:P($,"linkType")}),PR=G(ke,{name:P($),email:n1,link:ca}),IR=G(ke,{name:P($),desc:P($),author:P(e1),copyright:P(t1),link:ca,time:P(ch),keywords:P($),bounds:i1,extensions:dh}),OR=G(ke,{year:P(Je),license:P($)}),FR=G(ke,{rte:L(a1),trk:L(l1),wpt:L(u1)});class Gk extends ua{constructor(e){super(),e=e||{},this.dataProjection=he("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,i=e.length;t<i;++t){const n=e[t];if(this.readExtensions_){const r=n.get("extensionsNode_")||null;this.readExtensions_(n,r)}n.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(ri(e)):si(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const i=this.readMetadataFromNode(t);if(i)return i}return null}readMetadataFromNode(e){if(!ke.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(ke.includes(t.namespaceURI)&&t.localName==="metadata")return W({},IR,t,[]);return null}readFeatureFromNode(e,t){if(!ke.includes(e.namespaceURI))return null;const i=MR[e.localName];if(!i)return null;const n=i(e,[this.getReadOptions(e,t)]);return n?(this.handleReadExtensions_([n]),n):null}readFeaturesFromNode(e,t){if(!ke.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const i=W([],LR,e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_(i),i):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const i=le("http://www.topografix.com/GPX/1/1","gpx");return i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Is),i.setAttributeNS(Is,"xsi:schemaLocation",TR),i.setAttribute("version","1.1"),i.setAttribute("creator","OpenLayers"),ae({node:i},FR,QR,e,[t]),i}}const DR=G(ke,{name:P($),cmt:P($),desc:P($),src:P($),link:ca,number:P(Je),extensions:dh,type:P($),rtept:s1}),kR=G(ke,{ele:P(Te),time:P(ch)}),NR=G(ke,{name:P($),cmt:P($),desc:P($),src:P($),link:ca,number:P(Je),type:P($),extensions:dh,trkseg:o1}),zR=G(ke,{trkpt:r1}),GR=G(ke,{ele:P(Te),time:P(ch)}),HR=G(ke,{ele:P(Te),time:P(ch),magvar:P(Te),geoidheight:P(Te),name:P($),cmt:P($),desc:P($),src:P($),link:ca,sym:P($),type:P($),fix:P($),sat:P(Je),hdop:P(Te),vdop:P(Te),pdop:P(Te),ageofdgpsdata:P(Te),dgpsid:P(Je),extensions:dh}),BR=["text","type"],VR=G(ke,{text:L(re),type:L(re)}),WR=G(ke,["name","cmt","desc","src","link","number","type","rtept"]),UR=G(ke,{name:L(re),cmt:L(re),desc:L(re),src:L(re),link:L(ef),number:L(wl),type:L(re),rtept:ty(L(tf))}),jR=G(ke,["ele","time"]),YR=G(ke,["name","cmt","desc","src","link","number","type","trkseg"]),XR=G(ke,{name:L(re),cmt:L(re),desc:L(re),src:L(re),link:L(ef),number:L(wl),type:L(re),trkseg:ty(L(h1))}),$R=Be("trkpt"),KR=G(ke,{trkpt:L(tf)}),ZR=G(ke,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),qR=G(ke,{ele:L(Tt),time:L(ER),magvar:L(Tt),geoidheight:L(Tt),name:L(re),cmt:L(re),desc:L(re),src:L(re),link:L(ef),sym:L(re),type:L(re),fix:L(re),sat:L(wl),hdop:L(Tt),vdop:L(Tt),pdop:L(Tt),ageofdgpsdata:L(Tt),dgpsid:L(wl)}),JR={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function QR(s,e,t){const i=s.getGeometry();if(i){const n=JR[i.getType()];if(n){const r=e[e.length-1].node;return le(r.namespaceURI,n)}}}function Jd(s,e,t,i){return s.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in i?(s.push(i.ele),delete i.ele,e.hasZ=!0):s.push(0),"time"in i?(s.push(i.time),delete i.time,e.hasM=!0):s.push(0),s}function Qd(s,e,t){let i="XY",n=2;if(s.hasZ&&s.hasM?(i="XYZM",n=4):s.hasZ?(i="XYZ",n=3):s.hasM&&(i="XYM",n=3),n!==4){for(let r=0,o=e.length/4;r<o;r++)e[r*n]=e[r*4],e[r*n+1]=e[r*4+1],s.hasZ&&(e[r*n+2]=e[r*4+2]),s.hasM&&(e[r*n+2]=e[r*4+3]);if(e.length=e.length/4*n,t)for(let r=0,o=t.length;r<o;r++)t[r]=t[r]/4*n}return i}function e1(s,e){const t=W({},PR,s,e);if(t)return t}function t1(s,e){const t=W({},OR,s,e);if(t){const i=s.getAttribute("author");return i!==null&&(t.author=i),t}}function i1(s,e){const t=e[e.length-1],i=s.getAttribute("minlat"),n=s.getAttribute("minlon"),r=s.getAttribute("maxlat"),o=s.getAttribute("maxlon");n!==null&&i!==null&&o!==null&&r!==null&&(t.bounds=[[parseFloat(n),parseFloat(i)],[parseFloat(o),parseFloat(r)]])}function n1(s,e){const t=e[e.length-1],i=s.getAttribute("id"),n=s.getAttribute("domain");i!==null&&n!==null&&(t.email=`${i}@${n}`)}function ca(s,e){const t=e[e.length-1],i=s.getAttribute("href");i!==null&&(t.link=i),Nt(AR,s,e)}function dh(s,e){const t=e[e.length-1];t.extensionsNode_=s}function s1(s,e){const t=W({},kR,s,e);if(t){const i=e[e.length-1],n=i.flatCoordinates,r=i.layoutOptions;Jd(n,r,s,t)}}function r1(s,e){const t=W({},GR,s,e);if(t){const i=e[e.length-1],n=i.flatCoordinates,r=i.layoutOptions;Jd(n,r,s,t)}}function o1(s,e){const t=e[e.length-1];Nt(zR,s,e);const i=t.flatCoordinates;t.ends.push(i.length)}function ny(s,e){const t=e[0],i=W({flatCoordinates:[],layoutOptions:{}},DR,s,e);if(!i)return;const n=i.flatCoordinates;delete i.flatCoordinates;const r=i.layoutOptions;delete i.layoutOptions;const o=Qd(r,n),a=new zt(n,o);at(a,!1,t);const l=new di(a);return l.setProperties(i,!0),l}function sy(s,e){const t=e[0],i=W({flatCoordinates:[],ends:[],layoutOptions:{}},NR,s,e);if(!i)return;const n=i.flatCoordinates;delete i.flatCoordinates;const r=i.ends;delete i.ends;const o=i.layoutOptions;delete i.layoutOptions;const a=Qd(o,n,r),l=new xi(n,a,r);at(l,!1,t);const h=new di(l);return h.setProperties(i,!0),h}function ry(s,e){const t=e[0],i=W({},HR,s,e);if(!i)return;const n={},r=Jd([],n,s,i),o=Qd(n,r),a=new Ei(r,o);at(a,!1,t);const l=new di(a);return l.setProperties(i,!0),l}function ef(s,e,t){s.setAttribute("href",e);const n=t[t.length-1].properties,r=[n.linkText,n.linkType];ae({node:s},VR,it,r,t,BR)}function tf(s,e,t){const i=t[t.length-1],r=i.node.namespaceURI,o=i.properties;switch(s.setAttributeNS(null,"lat",String(e[1])),s.setAttributeNS(null,"lon",String(e[0])),i.geometryLayout){case"XYZM":e[3]!==0&&(o.time=e[3]);case"XYZ":e[2]!==0&&(o.ele=e[2]);break;case"XYM":e[2]!==0&&(o.time=e[2]);break}const l=s.nodeName=="rtept"?jR[r]:ZR[r],h=Gt(o,l);ae({node:s,properties:o},qR,it,h,t,l)}function a1(s,e,t){const i=t[0],n=e.getProperties(),r={node:s};r.properties=n;const o=e.getGeometry();if(o.getType()=="LineString"){const u=at(o,!0,i);r.geometryLayout=u.getLayout(),n.rtept=u.getCoordinates()}const a=t[t.length-1].node,l=WR[a.namespaceURI],h=Gt(n,l);ae(r,UR,it,h,t,l)}function l1(s,e,t){const i=t[0],n=e.getProperties(),r={node:s};r.properties=n;const o=e.getGeometry();if(o.getType()=="MultiLineString"){const u=at(o,!0,i);n.trkseg=u.getLineStrings()}const a=t[t.length-1].node,l=YR[a.namespaceURI],h=Gt(n,l);ae(r,XR,it,h,t,l)}function h1(s,e,t){const i={node:s};i.geometryLayout=e.getLayout(),i.properties={},ae(i,KR,$R,e.getCoordinates(),t)}function u1(s,e,t){const i=t[0],n=t[t.length-1];n.properties=e.getProperties();const r=e.getGeometry();if(r.getType()=="Point"){const o=at(r,!0,i);n.geometryLayout=o.getLayout(),tf(s,o.getCoordinates(),t)}}class c1 extends uh{constructor(){super()}getType(){return"text"}readFeature(e,t){return this.readFeatureFromText(La(e),this.adaptOptions(t))}readFeatureFromText(e,t){return ne()}readFeatures(e,t){return this.readFeaturesFromText(La(e),this.adaptOptions(t))}readFeaturesFromText(e,t){return ne()}readGeometry(e,t){return this.readGeometryFromText(La(e),this.adaptOptions(t))}readGeometryFromText(e,t){return ne()}readProjection(e){return this.readProjectionFromText(La(e))}readProjectionFromText(e){return this.dataProjection}writeFeature(e,t){return this.writeFeatureText(e,this.adaptOptions(t))}writeFeatureText(e,t){return ne()}writeFeatures(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))}writeFeaturesText(e,t){return ne()}writeGeometry(e,t){return this.writeGeometryText(e,this.adaptOptions(t))}writeGeometryText(e,t){return ne()}}function La(s){return typeof s=="string"?s:""}const d1=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,f1=/^H.([A-Z]{3}).*?:(.*)/,g1=/^HFDTE(\d{2})(\d{2})(\d{2})/,p1=/^HFDTEDATE:(\d{2})(\d{2})(\d{2}),(\d{2})/,m1=/\r\n|\r|\n/;class Hk extends c1{constructor(e){super(),e=e||{},this.dataProjection=he("EPSG:4326"),this.altitudeMode_=e.altitudeMode?e.altitudeMode:"none",this.lad_=!1,this.lod_=!1,this.ladStart_=0,this.ladStop_=0,this.lodStart_=0,this.lodStop_=0}readFeatureFromText(e,t){const i=this.altitudeMode_,n=e.split(m1),r={},o=[];let a=2e3,l=0,h=1,u=-1,c,d;for(c=0,d=n.length;c<d;++c){const y=n[c];let b;if(y.charAt(0)=="B"){if(b=d1.exec(y),b){const v=parseInt(b[1],10),_=parseInt(b[2],10),m=parseInt(b[3],10);let E=parseInt(b[4],10)+parseInt(b[5],10)/6e4;this.lad_&&(E+=parseInt(y.slice(this.ladStart_,this.ladStop_),10)/6e4/10**(this.ladStop_-this.ladStart_)),b[6]=="S"&&(E=-E);let C=parseInt(b[7],10)+parseInt(b[8],10)/6e4;if(this.lod_&&(C+=parseInt(y.slice(this.lodStart_,this.lodStop_),10)/6e4/10**(this.lodStop_-this.lodStart_)),b[9]=="W"&&(C=-C),o.push(C,E),i!="none"){let w;i=="gps"?w=parseInt(b[11],10):i=="barometric"?w=parseInt(b[12],10):w=0,o.push(w)}let x=Date.UTC(a,l,h,v,_,m);x<u&&(x=Date.UTC(a,l,h+1,v,_,m)),o.push(x/1e3),u=x}}else if(y.charAt(0)=="H")b=p1.exec(y),b?(h=parseInt(b[1],10),l=parseInt(b[2],10)-1,a=2e3+parseInt(b[3],10)):(b=g1.exec(y),b?(h=parseInt(b[1],10),l=parseInt(b[2],10)-1,a=2e3+parseInt(b[3],10)):(b=f1.exec(y),b&&(r[b[1]]=b[2].trim())));else if(y.charAt(0)=="I"){const v=parseInt(y.slice(1,3),10);for(let _=0;_<v;_++){const m=y.slice(7+_*7,10+_*7);if(m==="LAD"||m==="LOD"){const E=parseInt(y.slice(3+_*7,5+_*7),10)-1,C=parseInt(y.slice(5+_*7,7+_*7),10);m==="LAD"?(this.lad_=!0,this.ladStart_=E,this.ladStop_=C):m==="LOD"&&(this.lod_=!0,this.lodStart_=E,this.lodStop_=C)}}}}if(o.length===0)return null;const f=i=="none"?"XYM":"XYZM",g=new zt(o,f),p=new di(at(g,!1,t));return p.setProperties(r,!0),p}readFeaturesFromText(e,t){const i=this.readFeatureFromText(e,t);return i?[i]:[]}}const Rn=["http://www.google.com/kml/ext/2.2"],ee=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],b1="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",qg={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},y1=G(ee,{ExtendedData:wy,Region:_y,MultiGeometry:P(by,"geometry"),LineString:P(py,"geometry"),LinearRing:P(my,"geometry"),Point:P(yy,"geometry"),Polygon:P(vy,"geometry"),Style:P(rf),StyleMap:eS,address:P($),description:P($),name:P($),open:P(Qn),phoneNumber:P($),styleUrl:P(uy),visibility:P(Qn)},G(Rn,{MultiTrack:P(B1,"geometry"),Track:P(gy,"geometry")})),v1=G(ee,{ExtendedData:wy,Region:_y,Link:dS,address:P($),description:P($),name:P($),open:P(Qn),phoneNumber:P($),visibility:P(Qn)}),w1=G(ee,{href:P(hy)}),_1=G(ee,{Altitude:P(Te),Longitude:P(Te),Latitude:P(Te),Tilt:P(Te),AltitudeMode:P($),Heading:P(Te),Roll:P(Te)}),oy=G(ee,{LatLonAltBox:rS,Lod:aS}),E1=G(ee,["Document","Placemark"]),C1=G(ee,{Document:L(wS),Placemark:L(xy)});let gr,ja=null,Hu,mo,bo,yo,_l,Bu=null,nf,Vu=null,Wu,ys=null,Jg=null,Uu=null;function El(s){return 32/Math.min(s[0],s[1])}function x1(){gr=[255,255,255,1],ja=new Ui({color:gr}),Hu=[20,2],mo="pixels",bo="pixels",yo=[64,64],_l="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",Bu=new zs({anchor:Hu,anchorOrigin:"bottom-left",anchorXUnits:mo,anchorYUnits:bo,crossOrigin:"anonymous",rotation:0,scale:El(yo),size:yo,src:_l}),nf="NO_IMAGE",Vu=new wi({color:gr,width:1}),Wu=new wi({color:[51,51,51,1],width:2}),ys=new ia({font:"bold 16px Helvetica",fill:ja,stroke:Wu,scale:.8}),Jg=new st({fill:ja,image:Bu,text:ys,stroke:Vu,zIndex:0}),Uu=[Jg]}let Aa;function R1(s){return s}class Bk extends ua{constructor(e){super(),e=e||{},Uu||x1(),this.dataProjection=he("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:Uu,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:R1,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const i=G(ee,{Document:vl(this.readDocumentOrFolder_,this),Folder:vl(this.readDocumentOrFolder_,this),Placemark:te(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),n=W([],i,e,t,this);if(n)return n}readPlacemark_(e,t){const i=W({geometry:null},y1,e,t,this);if(!i)return;const n=new di,r=e.getAttribute("id");r!==null&&n.setId(r);const o=t[0],a=i.geometry;if(a&&at(a,!1,o),n.setGeometry(a),delete i.geometry,this.extractStyles_){const l=i.Style,h=i.styleUrl,u=T1(l,h,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);n.setStyle(u)}return delete i.Style,n.setProperties(i,!0),n}readSharedStyle_(e,t){const i=e.getAttribute("id");if(i!==null){const n=rf.call(this,e,t);if(n){let r,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?r=new URL("#"+i,o).href:r="#"+i,this.sharedStyles_[r]=n}}}readSharedStyleMap_(e,t){const i=e.getAttribute("id");if(i===null)return;const n=dy.call(this,e,t);if(!n)return;let r,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?r=new URL("#"+i,o).href:r="#"+i,this.sharedStyles_[r]=n}readFeatureFromNode(e,t){if(!ee.includes(e.namespaceURI))return null;const i=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return i||null}readFeaturesFromNode(e,t){if(!ee.includes(e.namespaceURI))return[];let i;const n=e.localName;if(n=="Document"||n=="Folder")return i=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),i||[];if(n=="Placemark"){const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r?[r]:[]}if(n=="kml"){i=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling){const o=this.readFeaturesFromNode(r,t);o&&Re(i,o)}return i}return[]}readName(e){if(e){if(typeof e=="string"){const t=ri(e);return this.readNameFromDocument(t)}return si(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const i=this.readNameFromNode(t);if(i)return i}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(ee.includes(t.namespaceURI)&&t.localName=="name")return $(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const i=t.localName;if(ee.includes(t.namespaceURI)&&(i=="Document"||i=="Folder"||i=="Placemark"||i=="kml")){const n=this.readNameFromNode(t);if(n)return n}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const i=ri(e);Re(t,this.readNetworkLinksFromDocument(i))}else si(e)?Re(t,this.readNetworkLinksFromDocument(e)):Re(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Re(t,this.readNetworkLinksFromNode(i));return t}readNetworkLinksFromNode(e){const t=[];for(let i=e.firstElementChild;i;i=i.nextElementSibling)if(ee.includes(i.namespaceURI)&&i.localName=="NetworkLink"){const n=W({},v1,i,[]);t.push(n)}for(let i=e.firstElementChild;i;i=i.nextElementSibling){const n=i.localName;ee.includes(i.namespaceURI)&&(n=="Document"||n=="Folder"||n=="kml")&&Re(t,this.readNetworkLinksFromNode(i))}return t}readRegion(e){const t=[];if(typeof e=="string"){const i=ri(e);Re(t,this.readRegionFromDocument(i))}else si(e)?Re(t,this.readRegionFromDocument(e)):Re(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Re(t,this.readRegionFromNode(i));return t}readRegionFromNode(e){const t=[];for(let i=e.firstElementChild;i;i=i.nextElementSibling)if(ee.includes(i.namespaceURI)&&i.localName=="Region"){const n=W({},oy,i,[]);t.push(n)}for(let i=e.firstElementChild;i;i=i.nextElementSibling){const n=i.localName;ee.includes(i.namespaceURI)&&(n=="Document"||n=="Folder"||n=="kml")&&Re(t,this.readRegionFromNode(i))}return t}readCamera(e){const t=[];if(typeof e=="string"){const i=ri(e);Re(t,this.readCameraFromDocument(i))}else si(e)?Re(t,this.readCameraFromDocument(e)):Re(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType===Node.ELEMENT_NODE&&Re(t,this.readCameraFromNode(i));return t}readCameraFromNode(e){const t=[];for(let i=e.firstElementChild;i;i=i.nextElementSibling)if(ee.includes(i.namespaceURI)&&i.localName==="Camera"){const n=W({},_1,i,[]);t.push(n)}for(let i=e.firstElementChild;i;i=i.nextElementSibling){const n=i.localName;ee.includes(i.namespaceURI)&&(n==="Document"||n==="Folder"||n==="Placemark"||n==="kml")&&Re(t,this.readCameraFromNode(i))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const i=le(ee[4],"kml"),n="http://www.w3.org/2000/xmlns/";i.setAttributeNS(n,"xmlns:gx",Rn[0]),i.setAttributeNS(n,"xmlns:xsi",Is),i.setAttributeNS(Is,"xsi:schemaLocation",b1);const r={node:i},o={};e.length>1?o.Document=e:e.length==1&&(o.Placemark=e[0]);const a=E1[i.namespaceURI],l=Gt(o,a);return ae(r,C1,it,l,[t],a,this),i}}function S1(s,e){const t=[0,0];let i="start";const n=s.getImage();if(n){const a=n.getSize();if(a&&a.length==2){const l=n.getScaleArray(),h=n.getAnchor();t[0]=l[0]*(a[0]-h[0]),t[1]=l[1]*(a[1]/2-h[1]),i="left"}}let r=s.getText();return r?(r=r.clone(),r.setFont(r.getFont()||ys.getFont()),r.setScale(r.getScale()||ys.getScale()),r.setFill(r.getFill()||ys.getFill()),r.setStroke(r.getStroke()||Wu)):r=ys.clone(),r.setText(e),r.setOffsetX(t[0]),r.setOffsetY(t[1]),r.setTextAlign(i),new st({image:n,text:r})}function T1(s,e,t,i,n){return function(r,o){let a=n,l="",h=[];if(a){const c=r.getGeometry();if(c)if(c instanceof _i)h=c.getGeometriesArrayRecursive().filter(function(d){const f=d.getType();return f==="Point"||f==="MultiPoint"}),a=h.length>0;else{const d=c.getType();a=d==="Point"||d==="MultiPoint"}}a&&(l=r.get("name"),a=a&&!!l,a&&/&[^&]+;/.test(l)&&(Aa||(Aa=document.createElement("textarea")),Aa.innerHTML=l,l=Aa.value));let u=t;if(s?u=s:e&&(u=ay(e,t,i)),a){const c=S1(u[0],l);if(h.length>0){c.setGeometry(new _i(h));const d=new st({geometry:u[0].getGeometry(),image:null,fill:u[0].getFill(),stroke:u[0].getStroke(),text:null});return[c,d].concat(u.slice(1))}return c}return u}}function ay(s,e,t){return Array.isArray(s)?s:typeof s=="string"?ay(t[s],e,t):e}function fh(s){const e=Ct(s,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const i=t[1];return[parseInt(i.substr(6,2),16),parseInt(i.substr(4,2),16),parseInt(i.substr(2,2),16),parseInt(i.substr(0,2),16)/255]}}function ly(s){let e=Ct(s,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const i=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let n;for(;n=i.exec(e);){const r=parseFloat(n[1]),o=parseFloat(n[2]),a=n[3]?parseFloat(n[3]):0;t.push(r,o,a),e=e.substr(n[0].length)}if(e==="")return t}function hy(s){const e=Ct(s,!1).trim();let t=s.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function uy(s){const e=Ct(s,!1).trim().replace(/^(?!.*#)/,"#");let t=s.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function M1(s){const e=s.getAttribute("xunits"),t=s.getAttribute("yunits");let i;return e!=="insetPixels"?t!=="insetPixels"?i="bottom-left":i="top-left":t!=="insetPixels"?i="bottom-right":i="top-right",{x:parseFloat(s.getAttribute("x")),xunits:qg[e],y:parseFloat(s.getAttribute("y")),yunits:qg[t],origin:i}}function cy(s){return Te(s)}const L1=G(ee,{Pair:Q1});function dy(s,e){return W(void 0,L1,s,e,this)}const A1=G(ee,{Icon:P(U1),color:P(fh),heading:P(Te),hotSpot:P(M1),scale:P(cy)});function P1(s,e){const t=W({},A1,s,e);if(!t)return;const i=e[e.length-1],n="Icon"in t?t.Icon:{},r=!("Icon"in t)||Object.keys(n).length>0;let o;const a=n.href;a?o=a:r&&(o=_l);let l,h,u,c="bottom-left";const d=t.hotSpot;d?(l=[d.x,d.y],h=d.xunits,u=d.yunits,c=d.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(o)&&(o.includes("pushpin")?(l=Hu,h=mo,u=bo):o.includes("arrow-reverse")?(l=[54,42],h=mo,u=bo):o.includes("paddle")&&(l=[32,1],h=mo,u=bo));let f;const g=n.x,p=n.y;g!==void 0&&p!==void 0&&(f=[g,p]);let y;const b=n.w,v=n.h;b!==void 0&&v!==void 0&&(y=[b,v]);let _;const m=t.heading;m!==void 0&&(_=Gi(m));const E=t.scale,C=t.color;if(r){o==_l&&(y=yo);const x=new zs({anchor:l,anchorOrigin:c,anchorXUnits:h,anchorYUnits:u,crossOrigin:this.crossOrigin_,offset:f,offsetOrigin:"bottom-left",rotation:_,scale:E,size:y,src:this.iconUrlFunction_(o),color:C}),w=x.getScaleArray()[0],R=x.getSize();if(R===null){const I=x.getImageState();if(I===q.IDLE||I===q.LOADING){const T=function(){const A=x.getImageState();if(!(A===q.IDLE||A===q.LOADING)){const F=x.getSize();if(F&&F.length==2){const S=El(F);x.setScale(w*S)}x.unlistenImageChange(T)}};x.listenImageChange(T),I===q.IDLE&&x.load()}}else if(R.length==2){const I=El(R);x.setScale(w*I)}i.imageStyle=x}else i.imageStyle=nf}const I1=G(ee,{color:P(fh),scale:P(cy)});function O1(s,e){const t=W({},I1,s,e);if(!t)return;const i=e[e.length-1],n=new ia({fill:new Ui({color:"color"in t?t.color:gr}),scale:t.scale});i.textStyle=n}const F1=G(ee,{color:P(fh),width:P(Te)});function D1(s,e){const t=W({},F1,s,e);if(!t)return;const i=e[e.length-1],n=new wi({color:"color"in t?t.color:gr,width:"width"in t?t.width:1});i.strokeStyle=n}const k1=G(ee,{color:P(fh),fill:P(Qn),outline:P(Qn)});function N1(s,e){const t=W({},k1,s,e);if(!t)return;const i=e[e.length-1],n=new Ui({color:"color"in t?t.color:gr});i.fillStyle=n;const r=t.fill;r!==void 0&&(i.fill=r);const o=t.outline;o!==void 0&&(i.outline=o)}const z1=G(ee,{coordinates:ie(ly)});function fy(s,e){return W(null,z1,s,e)}function G1(s,e){const i=e[e.length-1].coordinates,n=Ct(s,!1),o=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(n);if(o){const a=parseFloat(o[1]),l=parseFloat(o[2]),h=parseFloat(o[3]);i.push([a,l,h])}else i.push([])}const H1=G(Rn,{Track:te(gy)});function B1(s,e){const t=W([],H1,s,e);if(t)return new xi(t)}const V1=G(ee,{when:fS},G(Rn,{coord:G1}));function gy(s,e){const t=W({coordinates:[],whens:[]},V1,s,e);if(!t)return;const i=[],n=t.coordinates,r=t.whens;for(let o=0,a=Math.min(n.length,r.length);o<a;++o)n[o].length==3&&i.push(n[o][0],n[o][1],n[o][2],r[o]);return new zt(i,"XYZM")}const W1=G(ee,{href:P(hy)},G(Rn,{x:P(Te),y:P(Te),w:P(Te),h:P(Te)}));function U1(s,e){const t=W({},W1,s,e);return t||null}const j1=G(ee,{coordinates:ie(ly)});function sf(s,e){return W(null,j1,s,e)}const gh=G(ee,{extrude:P(Qn),tessellate:P(Qn),altitudeMode:P($)});function py(s,e){const t=W({},gh,s,e),i=sf(s,e);if(i){const n=new zt(i,"XYZ");return n.setProperties(t,!0),n}}function my(s,e){const t=W({},gh,s,e),i=sf(s,e);if(i){const n=new pt(i,"XYZ",[i.length]);return n.setProperties(t,!0),n}}const Y1=G(ee,{LineString:te(py),LinearRing:te(my),MultiGeometry:te(by),Point:te(yy),Polygon:te(vy)});function by(s,e){const t=W([],Y1,s,e);if(!t)return null;if(t.length===0)return new _i(t);let i,n=!0;const r=t[0].getType();let o;for(let a=1,l=t.length;a<l;++a)if(o=t[a],o.getType()!=r){n=!1;break}if(n){let a,l;if(r=="Point"){const h=t[0];a=h.getLayout(),l=h.getFlatCoordinates();for(let u=1,c=t.length;u<c;++u)o=t[u],Re(l,o.getFlatCoordinates());i=new ss(l,a),qh(i,t)}else if(r=="LineString")i=new xi(t),qh(i,t);else if(r=="Polygon")i=new _n(t),qh(i,t);else if(r=="GeometryCollection"||r.startsWith("Multi"))i=new _i(t);else throw new Error("Unknown geometry type found")}else i=new _i(t);return i}function yy(s,e){const t=W({},gh,s,e),i=sf(s,e);if(i){const n=new Ei(i,"XYZ");return n.setProperties(t,!0),n}}const X1=G(ee,{innerBoundaryIs:hS,outerBoundaryIs:cS});function vy(s,e){const t=W({},gh,s,e),i=W([null],X1,s,e);if(i&&i[0]){const n=i[0],r=[n.length];for(let a=1,l=i.length;a<l;++a)Re(n,i[a]),r.push(n.length);const o=new pt(n,"XYZ",r);return o.setProperties(t,!0),o}}const $1=G(ee,{IconStyle:P1,LabelStyle:O1,LineStyle:D1,PolyStyle:N1});function rf(s,e){const t=W({},$1,s,e,this);if(!t)return null;let i="fillStyle"in t?t.fillStyle:ja;const n=t.fill;n!==void 0&&!n&&(i=null);let r;"imageStyle"in t?t.imageStyle!=nf&&(r=t.imageStyle):r=Bu;const o="textStyle"in t?t.textStyle:ys,a="strokeStyle"in t?t.strokeStyle:Vu,l=t.outline;return l!==void 0&&!l?[new st({geometry:function(h){const u=h.getGeometry(),c=u.getType();if(c==="GeometryCollection"){const d=u;return new _i(d.getGeometriesArrayRecursive().filter(function(f){const g=f.getType();return g!=="Polygon"&&g!=="MultiPolygon"}))}if(c!=="Polygon"&&c!=="MultiPolygon")return u},fill:i,image:r,stroke:a,text:o,zIndex:void 0}),new st({geometry:function(h){const u=h.getGeometry(),c=u.getType();if(c==="GeometryCollection"){const d=u;return new _i(d.getGeometriesArrayRecursive().filter(function(f){const g=f.getType();return g==="Polygon"||g==="MultiPolygon"}))}if(c==="Polygon"||c==="MultiPolygon")return u},fill:i,stroke:null,zIndex:void 0})]:[new st({fill:i,image:r,stroke:a,text:o,zIndex:void 0})]}function qh(s,e){const t=e.length,i=new Array(e.length),n=new Array(e.length),r=new Array(e.length);let o,a,l;o=!1,a=!1,l=!1;for(let h=0;h<t;++h){const u=e[h];i[h]=u.get("extrude"),n[h]=u.get("tessellate"),r[h]=u.get("altitudeMode"),o=o||i[h]!==void 0,a=a||n[h]!==void 0,l=l||r[h]}o&&s.set("extrude",i),a&&s.set("tessellate",n),l&&s.set("altitudeMode",r)}const K1=G(ee,{displayName:P($),value:P($)});function Z1(s,e){const t=s.getAttribute("name");Nt(K1,s,e);const i=e[e.length-1];t&&i.displayName?i[t]={value:i.value,displayName:i.displayName,toString:function(){return i.value}}:t!==null?i[t]=i.value:i.displayName!==null&&(i[i.displayName]=i.value),delete i.value}const q1=G(ee,{Data:Z1,SchemaData:iS});function wy(s,e){Nt(q1,s,e)}function _y(s,e){Nt(oy,s,e)}const J1=G(ee,{Style:P(rf),key:P($),styleUrl:P(uy)});function Q1(s,e){const t=W({},J1,s,e,this);if(!t)return;const i=t.key;if(i&&i=="normal"){const n=t.styleUrl;n&&(e[e.length-1]=n);const r=t.Style;r&&(e[e.length-1]=r)}}function eS(s,e){const t=dy.call(this,s,e);if(!t)return;const i=e[e.length-1];if(Array.isArray(t))i.Style=t;else if(typeof t=="string")i.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const tS=G(ee,{SimpleData:nS});function iS(s,e){Nt(tS,s,e)}function nS(s,e){const t=s.getAttribute("name");if(t!==null){const i=$(s),n=e[e.length-1];n[t]=i}}const sS=G(ee,{altitudeMode:P($),minAltitude:P(Te),maxAltitude:P(Te),north:P(Te),south:P(Te),east:P(Te),west:P(Te)});function rS(s,e){const t=W({},sS,s,e);if(!t)return;const i=e[e.length-1],n=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];i.extent=n,i.altitudeMode=t.altitudeMode,i.minAltitude=parseFloat(t.minAltitude),i.maxAltitude=parseFloat(t.maxAltitude)}const oS=G(ee,{minLodPixels:P(Te),maxLodPixels:P(Te),minFadeExtent:P(Te),maxFadeExtent:P(Te)});function aS(s,e){const t=W({},oS,s,e);if(!t)return;const i=e[e.length-1];i.minLodPixels=parseFloat(t.minLodPixels),i.maxLodPixels=parseFloat(t.maxLodPixels),i.minFadeExtent=parseFloat(t.minFadeExtent),i.maxFadeExtent=parseFloat(t.maxFadeExtent)}const lS=G(ee,{LinearRing:te(fy)});function hS(s,e){const t=W([],lS,s,e);t.length>0&&e[e.length-1].push(...t)}const uS=G(ee,{LinearRing:ie(fy)});function cS(s,e){const t=W(void 0,uS,s,e);if(t){const i=e[e.length-1];i[0]=t}}function dS(s,e){Nt(w1,s,e)}function fS(s,e){const i=e[e.length-1].whens,n=Ct(s,!1),r=Date.parse(n);i.push(isNaN(r)?0:r)}function ph(s,e){const t=pn(e),n=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let r=0;r<4;++r){const o=Math.floor(n[r]).toString(16);n[r]=o.length==1?"0"+o:o}re(s,n.join(""))}function gS(s,e,t){const i=t[t.length-1],n=i.layout,r=i.stride;let o;if(n=="XY"||n=="XYM")o=2;else if(n=="XYZ"||n=="XYZM")o=3;else throw new Error("Invalid geometry layout");const a=e.length;let l="";if(a>0){l+=e[0];for(let h=1;h<o;++h)l+=","+e[h];for(let h=r;h<a;h+=r){l+=" "+e[h];for(let u=1;u<o;++u)l+=","+e[h+u]}}re(s,l)}const Ya=G(ee,{Data:L(pS),value:L(bS),displayName:L(mS)});function pS(s,e,t){s.setAttribute("name",e.name);const i={node:s},n=e.value;typeof n=="object"?(n!==null&&n.displayName&&ae(i,Ya,it,[n.displayName],t,["displayName"]),n!==null&&n.value&&ae(i,Ya,it,[n.value],t,["value"])):ae(i,Ya,it,[n],t,["value"])}function mS(s,e){_R(s,e)}function bS(s,e){re(s,e)}const yS=G(ee,{Placemark:L(xy)}),vS=function(s,e,t){const i=e[e.length-1].node;return le(i.namespaceURI,"Placemark")};function wS(s,e,t){ae({node:s},yS,vS,e,t,void 0,this)}const _S=Be("Data");function ES(s,e,t){const i={node:s},n=e.names,r=e.values,o=n.length;for(let a=0;a<o;a++)ae(i,Ya,_S,[{name:n[a],value:r[a]}],t)}const Qg=G(ee,["href"],G(Rn,["x","y","w","h"])),ep=G(ee,{href:L(re)},G(Rn,{x:L(Tt),y:L(Tt),w:L(Tt),h:L(Tt)})),CS=function(s,e,t){return le(Rn[0],"gx:"+t)};function xS(s,e,t){const i={node:s},n=t[t.length-1].node;let r=Qg[n.namespaceURI],o=Gt(e,r);ae(i,ep,it,o,t,r),r=Qg[Rn[0]],o=Gt(e,r),ae(i,ep,CS,o,t,r)}const RS=G(ee,["scale","heading","Icon","color","hotSpot"]),SS=G(ee,{Icon:L(xS),color:L(ph),heading:L(Tt),hotSpot:L(QS),scale:L(Sy)});function TS(s,e,t){const i={node:s},n={},r=e.getSrc(),o=e.getSize(),a=e.getImageSize(),l={href:r};if(o){l.w=o[0],l.h=o[1];const y=e.getAnchor(),b=e.getOrigin();if(b&&a&&b[0]!==0&&b[1]!==o[1]&&(l.x=b[0],l.y=a[1]-(b[1]+o[1])),y&&(y[0]!==o[0]/2||y[1]!==o[1]/2)){const v={x:y[0],xunits:"pixels",y:o[1]-y[1],yunits:"pixels"};n.hotSpot=v}}n.Icon=l;let h=e.getScaleArray()[0],u=o;if(u===null&&(u=yo),u.length==2){const y=El(u);h=h/y}h!==1&&(n.scale=h);const c=e.getRotation();c!==0&&(n.heading=c);const d=e.getColor();d&&(n.color=d);const f=t[t.length-1].node,g=RS[f.namespaceURI],p=Gt(n,g);ae(i,SS,it,p,t,g)}const MS=G(ee,["color","scale"]),LS=G(ee,{color:L(ph),scale:L(Sy)});function AS(s,e,t){const i={node:s},n={},r=e.getFill();r&&(n.color=r.getColor());const o=e.getScale();o&&o!==1&&(n.scale=o);const a=t[t.length-1].node,l=MS[a.namespaceURI],h=Gt(n,l);ae(i,LS,it,h,t,l)}const PS=G(ee,["color","width"]),IS=G(ee,{color:L(ph),width:L(Tt)});function OS(s,e,t){const i={node:s},n={color:e.getColor(),width:Number(e.getWidth())||1},r=t[t.length-1].node,o=PS[r.namespaceURI],a=Gt(n,o);ae(i,IS,it,a,t,o)}const FS={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},Ey=function(s,e,t){if(s){const i=e[e.length-1].node;return le(i.namespaceURI,FS[s.getType()])}},DS=Be("Point"),kS=Be("LineString"),NS=Be("LinearRing"),zS=Be("Polygon"),GS=G(ee,{LineString:L(pr),Point:L(pr),Polygon:L(Ry),GeometryCollection:L(Cy)});function Cy(s,e,t){const i={node:s},n=e.getType();let r=[],o;if(n==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(a){const l=a.getType();if(l==="MultiPoint")r=r.concat(a.getPoints());else if(l==="MultiLineString")r=r.concat(a.getLineStrings());else if(l==="MultiPolygon")r=r.concat(a.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")r.push(a);else throw new Error("Unknown geometry type")}),o=Ey;else if(n==="MultiPoint")r=e.getPoints(),o=DS;else if(n==="MultiLineString")r=e.getLineStrings(),o=kS;else if(n==="MultiPolygon")r=e.getPolygons(),o=zS;else throw new Error("Unknown geometry type");ae(i,GS,o,r,t)}const HS=G(ee,{LinearRing:L(pr)});function tp(s,e,t){ae({node:s},HS,NS,[e],t)}const Jh=G(ee,{ExtendedData:L(ES),MultiGeometry:L(Cy),LineString:L(pr),LinearRing:L(pr),Point:L(pr),Polygon:L(Ry),Style:L(JS),address:L(re),description:L(re),name:L(re),open:L(Ar),phoneNumber:L(re),styleUrl:L(re),visibility:L(Ar)}),BS=G(ee,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),VS=Be("ExtendedData");function xy(s,e,t){const i={node:s};e.getId()&&s.setAttribute("id",e.getId());const n=e.getProperties(),r={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};r[e.getGeometryName()]=1;const o=Object.keys(n||{}).sort().filter(function(f){return!r[f]}),a=e.getStyleFunction();if(a){const f=a(e,0);if(f){const g=Array.isArray(f)?f:[f];let p=g;if(e.getGeometry()&&(p=g.filter(function(y){const b=y.getGeometryFunction()(e);if(b){const v=b.getType();return v==="GeometryCollection"?b.getGeometriesArrayRecursive().filter(function(_){const m=_.getType();return m==="Point"||m==="MultiPoint"}).length:v==="Point"||v==="MultiPoint"}})),this.writeStyles_){let y=g,b=g;e.getGeometry()&&(y=g.filter(function(v){const _=v.getGeometryFunction()(e);if(_){const m=_.getType();return m==="GeometryCollection"?_.getGeometriesArrayRecursive().filter(function(E){const C=E.getType();return C==="LineString"||C==="MultiLineString"}).length:m==="LineString"||m==="MultiLineString"}}),b=g.filter(function(v){const _=v.getGeometryFunction()(e);if(_){const m=_.getType();return m==="GeometryCollection"?_.getGeometriesArrayRecursive().filter(function(E){const C=E.getType();return C==="Polygon"||C==="MultiPolygon"}).length:m==="Polygon"||m==="MultiPolygon"}})),n.Style={pointStyles:p,lineStyles:y,polyStyles:b}}if(p.length&&n.name===void 0){const y=p[0].getText();y&&(n.name=y.getText())}}}const l=t[t.length-1].node,h=BS[l.namespaceURI],u=Gt(n,h);if(ae(i,Jh,it,u,t,h),o.length>0){const f=Gt(n,o);ae(i,Jh,VS,[{names:o,values:f}],t)}const c=t[0];let d=e.getGeometry();d&&(d=at(d,!0,c)),ae(i,Jh,Ey,[d],t)}const WS=G(ee,["extrude","tessellate","altitudeMode","coordinates"]),US=G(ee,{extrude:L(Ar),tessellate:L(Ar),altitudeMode:L(re),coordinates:L(gS)});function pr(s,e,t){const i=e.getFlatCoordinates(),n={node:s};n.layout=e.getLayout(),n.stride=e.getStride();const r=e.getProperties();r.coordinates=i;const o=t[t.length-1].node,a=WS[o.namespaceURI],l=Gt(r,a);ae(n,US,it,l,t,a)}const jS=G(ee,["color","fill","outline"]),ip=G(ee,{outerBoundaryIs:L(tp),innerBoundaryIs:L(tp)}),YS=Be("innerBoundaryIs"),XS=Be("outerBoundaryIs");function Ry(s,e,t){const i=e.getLinearRings(),n=i.shift(),r={node:s};ae(r,ip,YS,i,t),ae(r,ip,XS,[n],t)}const $S=G(ee,{color:L(ph),fill:L(Ar),outline:L(Ar)});function KS(s,e,t){const i={node:s},n=e.getFill(),r=e.getStroke(),o={color:n?n.getColor():void 0,fill:n?void 0:!1,outline:r?void 0:!1},a=t[t.length-1].node,l=jS[a.namespaceURI],h=Gt(o,l);ae(i,$S,it,h,t,l)}function Sy(s,e){Tt(s,Math.round(e*1e6)/1e6)}const ZS=G(ee,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),qS=G(ee,{IconStyle:L(TS),LabelStyle:L(AS),LineStyle:L(OS),PolyStyle:L(KS)});function JS(s,e,t){const i={node:s},n={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(n.LabelStyle=l);const h=e.pointStyles[0].getImage();h&&typeof h.getSrc=="function"&&(n.IconStyle=h)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(n.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!n.LineStyle&&(n.LineStyle=l),n.PolyStyle=e.polyStyles[0]}const r=t[t.length-1].node,o=ZS[r.namespaceURI],a=Gt(n,o);ae(i,qS,it,a,t,o)}function QS(s,e){s.setAttribute("x",String(e.x)),s.setAttribute("y",String(e.y)),s.setAttribute("xunits",e.xunits),s.setAttribute("yunits",e.yunits)}const ju=65536*65536,np=1/ju,eT=12,sp=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),Qh=0,Pa=1,Jr=2,Ia=5;class tT{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,i=this.length){for(;this.pos<i;){const n=this.readVarint(),r=n>>3,o=this.pos;this.type=n&7,e(r,t,this),this.pos===o&&this.skip(n)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*ju;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*ju;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let i,n;return n=t[this.pos++],i=n&127,n<128||(n=t[this.pos++],i|=(n&127)<<7,n<128)||(n=t[this.pos++],i|=(n&127)<<14,n<128)||(n=t[this.pos++],i|=(n&127)<<21,n<128)?i:(n=t[this.pos],i|=(n&15)<<28,iT(i,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=eT&&sp?sp.decode(this.buf.subarray(t,e)):pT(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===Jr?this.readVarint()+this.pos:this.pos+1}skip(e){const t=e&7;if(t===Qh)for(;this.buf[this.pos++]>127;);else if(t===Jr)this.pos=this.readVarint()+this.pos;else if(t===Ia)this.pos+=4;else if(t===Pa)this.pos+=8;else throw new Error(`Unimplemented type: ${t}`)}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.dataView=new DataView(i.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*np),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*np),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){nT(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;const t=this.pos;this.pos=mT(this.buf,e,this.pos);const i=this.pos-t;i>=128&&rp(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let i=0;i<t;i++)this.buf[this.pos++]=e[i]}writeRawMessage(e,t){this.pos++;const i=this.pos;e(t,this);const n=this.pos-i;n>=128&&rp(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n}writeMessage(e,t,i){this.writeTag(e,Jr),this.writeRawMessage(t,i)}writePackedVarint(e,t){t.length&&this.writeMessage(e,oT,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,aT,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,uT,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,lT,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,hT,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,cT,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,dT,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,fT,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,gT,t)}writeBytesField(e,t){this.writeTag(e,Jr),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,Ia),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,Ia),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,Pa),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,Pa),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,Qh),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,Qh),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,Jr),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,Ia),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,Pa),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function iT(s,e,t){const i=t.buf;let n,r;if(r=i[t.pos++],n=(r&112)>>4,r<128||(r=i[t.pos++],n|=(r&127)<<3,r<128)||(r=i[t.pos++],n|=(r&127)<<10,r<128)||(r=i[t.pos++],n|=(r&127)<<17,r<128)||(r=i[t.pos++],n|=(r&127)<<24,r<128)||(r=i[t.pos++],n|=(r&1)<<31,r<128))return Ks(s,n,e);throw new Error("Expected varint not more than 10 bytes")}function Ks(s,e,t){return t?e*4294967296+(s>>>0):(e>>>0)*4294967296+(s>>>0)}function nT(s,e){let t,i;if(s>=0?(t=s%4294967296|0,i=s/4294967296|0):(t=~(-s%4294967296),i=~(-s/4294967296),t^4294967295?t=t+1|0:(t=0,i=i+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),sT(t,i,e),rT(i,e)}function sT(s,e,t){t.buf[t.pos++]=s&127|128,s>>>=7,t.buf[t.pos++]=s&127|128,s>>>=7,t.buf[t.pos++]=s&127|128,s>>>=7,t.buf[t.pos++]=s&127|128,s>>>=7,t.buf[t.pos]=s&127}function rT(s,e){const t=(s&7)<<4;e.buf[e.pos++]|=t|((s>>>=3)?128:0),s&&(e.buf[e.pos++]=s&127|((s>>>=7)?128:0),s&&(e.buf[e.pos++]=s&127|((s>>>=7)?128:0),s&&(e.buf[e.pos++]=s&127|((s>>>=7)?128:0),s&&(e.buf[e.pos++]=s&127|((s>>>=7)?128:0),s&&(e.buf[e.pos++]=s&127)))))}function rp(s,e,t){const i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(i);for(let n=t.pos-1;n>=s;n--)t.buf[n+i]=t.buf[n]}function oT(s,e){for(let t=0;t<s.length;t++)e.writeVarint(s[t])}function aT(s,e){for(let t=0;t<s.length;t++)e.writeSVarint(s[t])}function lT(s,e){for(let t=0;t<s.length;t++)e.writeFloat(s[t])}function hT(s,e){for(let t=0;t<s.length;t++)e.writeDouble(s[t])}function uT(s,e){for(let t=0;t<s.length;t++)e.writeBoolean(s[t])}function cT(s,e){for(let t=0;t<s.length;t++)e.writeFixed32(s[t])}function dT(s,e){for(let t=0;t<s.length;t++)e.writeSFixed32(s[t])}function fT(s,e){for(let t=0;t<s.length;t++)e.writeFixed64(s[t])}function gT(s,e){for(let t=0;t<s.length;t++)e.writeSFixed64(s[t])}function pT(s,e,t){let i="",n=e;for(;n<t;){const r=s[n];let o=null,a=r>239?4:r>223?3:r>191?2:1;if(n+a>t)break;let l,h,u;a===1?r<128&&(o=r):a===2?(l=s[n+1],(l&192)===128&&(o=(r&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=s[n+1],h=s[n+2],(l&192)===128&&(h&192)===128&&(o=(r&15)<<12|(l&63)<<6|h&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=s[n+1],h=s[n+2],u=s[n+3],(l&192)===128&&(h&192)===128&&(u&192)===128&&(o=(r&15)<<18|(l&63)<<12|(h&63)<<6|u&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),n+=a}return i}function mT(s,e,t){for(let i=0,n,r;i<e.length;i++){if(n=e.charCodeAt(i),n>55295&&n<57344)if(r)if(n<56320){s[t++]=239,s[t++]=191,s[t++]=189,r=n;continue}else n=r-55296<<10|n-56320|65536,r=null;else{n>56319||i+1===e.length?(s[t++]=239,s[t++]=191,s[t++]=189):r=n;continue}else r&&(s[t++]=239,s[t++]=191,s[t++]=189,r=null);n<128?s[t++]=n:(n<2048?s[t++]=n>>6|192:(n<65536?s[t++]=n>>12|224:(s[t++]=n>>18|240,s[t++]=n>>12&63|128),s[t++]=n>>6&63|128),s[t++]=n&63|128)}return t}class Vk extends uh{constructor(e){super(),e=e||{},this.dataProjection=new Zc({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:_t,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,i,n){e.pos=t.geometry;const r=e.readVarint()+e.pos;let o=1,a=0,l=0,h=0,u=0,c=0;for(;e.pos<r;){if(!a){const d=e.readVarint();o=d&7,a=d>>3}if(a--,o===1||o===2)l+=e.readSVarint(),h+=e.readSVarint(),o===1&&u>c&&(n.push(u),c=u),i.push(l,h),u+=2;else if(o===7)u>c&&(i.push(i[c],i[c+1]),u+=2);else throw new Error("Invalid command found in the PBF")}u>c&&(n.push(u),c=u)}createFeature_(e,t,i){const n=t.type;if(n===0)return null;let r;const o=t.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=t.id,o[this.layerName_]=t.layer.name;const l=[],h=[];this.readRawGeometry_(e,t,l,h);const u=_T(n,h.length);if(this.featureClass===_t)r=new this.featureClass(u,l,h,2,o,a),r.transform(i.dataProjection);else{let c;if(u=="Polygon"){const g=Zm(l,h);c=g.length>1?new _n(l,"XY",g):new pt(l,"XY",h)}else c=u==="Point"?new Ei(l,"XY"):u==="LineString"?new zt(l,"XY"):u==="MultiPoint"?new ss(l,"XY"):u==="MultiLineString"?new xi(l,"XY",h):null;const d=this.featureClass;r=new d,this.geometryName_&&r.setGeometryName(this.geometryName_);const f=at(c,!1,i);r.setGeometry(f),a!==void 0&&r.setId(a),r.setProperties(o,!0)}return r}getType(){return"arraybuffer"}readFeatures(e,t){const i=this.layers_;t=this.adaptOptions(t);const n=he(t.dataProjection);n.setWorldExtent(t.extent),t.dataProjection=n;const r=new tT(e),o=r.readFields(bT,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const h=o[l],u=h?[0,0,h.extent,h.extent]:null;n.setExtent(u);for(let c=0,d=h.length;c<d;++c){const f=wT(r,h,c),g=this.createFeature_(r,f,t);g!==null&&a.push(g)}}return a}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function bT(s,e,t){if(s===3){const i={keys:[],values:[],features:[]},n=t.readVarint()+t.pos;t.readFields(yT,i,n),i.length=i.features.length,i.length&&(e[i.name]=i)}}function yT(s,e,t){if(s===15)e.version=t.readVarint();else if(s===1)e.name=t.readString();else if(s===5)e.extent=t.readVarint();else if(s===2)e.features.push(t.pos);else if(s===3)e.keys.push(t.readString());else if(s===4){let i=null;const n=t.readVarint()+t.pos;for(;t.pos<n;)s=t.readVarint()>>3,i=s===1?t.readString():s===2?t.readFloat():s===3?t.readDouble():s===4?t.readVarint64():s===5?t.readVarint():s===6?t.readSVarint():s===7?t.readBoolean():null;e.values.push(i)}}function vT(s,e,t){if(s==1)e.id=t.readVarint();else if(s==2){const i=t.readVarint()+t.pos;for(;t.pos<i;){const n=e.layer.keys[t.readVarint()],r=e.layer.values[t.readVarint()];e.properties[n]=r}}else s==3?e.type=t.readVarint():s==4&&(e.geometry=t.pos)}function wT(s,e,t){s.pos=e.features[t];const i=s.readVarint()+s.pos,n={layer:e,type:0,properties:{}};return s.readFields(vT,n,i),n}function _T(s,e){let t;return s===1?t=e===1?"Point":"MultiPoint":s===2?t=e===1?"LineString":"MultiLineString":s===3&&(t="Polygon"),t}class Ty{read(e){if(!e)return null;if(typeof e=="string"){const t=ri(e);return this.readFromDocument(t)}return si(e)?this.readFromDocument(e):this.readFromNode(e)}readFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null}readFromNode(e){ne()}}const ET="http://www.w3.org/1999/xlink";function of(s){return s.getAttributeNS(ET,"href")}const Ht=[null,"http://www.opengis.net/ows/1.1"],CT=G(Ht,{ServiceIdentification:P($T),ServiceProvider:P(ZT),OperationsMetadata:P(YT)});class xT extends Ty{constructor(){super()}readFromNode(e){const t=W({},CT,e,[]);return t||null}}const RT=G(Ht,{DeliveryPoint:P($),City:P($),AdministrativeArea:P($),PostalCode:P($),Country:P($),ElectronicMailAddress:P($)}),ST=G(Ht,{Value:Pt(qT)}),TT=G(Ht,{AllowedValues:P(GT)}),MT=G(Ht,{Phone:P(XT),Address:P(zT)}),LT=G(Ht,{HTTP:P(UT)}),AT=G(Ht,{Get:Pt(WT),Post:void 0}),PT=G(Ht,{DCP:P(VT)}),IT=G(Ht,{Operation:jT}),OT=G(Ht,{Voice:P($),Facsimile:P($)}),FT=G(Ht,{Constraint:Pt(HT)}),DT=G(Ht,{IndividualName:P($),PositionName:P($),ContactInfo:P(BT)}),kT=G(Ht,{Abstract:P($),AccessConstraints:P($),Fees:P($),Title:P($),ServiceTypeVersion:P($),ServiceType:P($)}),NT=G(Ht,{ProviderName:P($),ProviderSite:P(of),ServiceContact:P(KT)});function zT(s,e){return W({},RT,s,e)}function GT(s,e){return W({},ST,s,e)}function HT(s,e){const t=s.getAttribute("name");if(t)return W({name:t},TT,s,e)}function BT(s,e){return W({},MT,s,e)}function VT(s,e){return W({},LT,s,e)}function WT(s,e){const t=of(s);if(t)return W({href:t},FT,s,e)}function UT(s,e){return W({},AT,s,e)}function jT(s,e){const t=s.getAttribute("name"),i=W({},PT,s,e);if(!i)return;const n=e[e.length-1];n[t]=i}function YT(s,e){return W({},IT,s,e)}function XT(s,e){return W({},OT,s,e)}function $T(s,e){return W({},kT,s,e)}function KT(s,e){return W({},DT,s,e)}function ZT(s,e){return W({},NT,s,e)}function qT(s,e){return $(s)}class Wk extends Qb{constructor(e){super(),e=e||{},this.layerName_=e.layerName,this.layers_=e.layers?e.layers:null,this.dataProjection=he(e.dataProjection?e.dataProjection:"EPSG:4326")}readFeaturesFromObject(e,t){if(e.type=="Topology"){const i=e;let n,r=null,o=null;i.transform&&(n=i.transform,r=n.scale,o=n.translate);const a=i.arcs;n&&oM(a,r,o);const l=[],h=i.objects,u=this.layerName_;let c;for(const d in h)this.layers_&&!this.layers_.includes(d)||(h[d].type==="GeometryCollection"?(c=h[d],l.push.apply(l,rM(c,a,r,o,u,d,t))):(c=h[d],l.push(My(c,a,r,o,u,d,t))));return l}return[]}readProjectionFromObject(e){return this.dataProjection}}const JT={Point:QT,LineString:tM,Polygon:nM,MultiPoint:eM,MultiLineString:iM,MultiPolygon:sM};function mh(s,e){const t=[];let i;for(let n=0,r=s.length;n<r;++n)if(i=s[n],n>0&&t.pop(),i>=0){const o=e[i];for(let a=0,l=o.length;a<l;++a)t.push(o[a].slice(0))}else{const o=e[~i];for(let a=o.length-1;a>=0;--a)t.push(o[a].slice(0))}return t}function QT(s,e,t){const i=s.coordinates;return e&&t&&af(i,e,t),new Ei(i)}function eM(s,e,t){const i=s.coordinates;if(e&&t)for(let n=0,r=i.length;n<r;++n)af(i[n],e,t);return new ss(i)}function tM(s,e){const t=mh(s.arcs,e);return new zt(t)}function iM(s,e){const t=[];for(let i=0,n=s.arcs.length;i<n;++i)t[i]=mh(s.arcs[i],e);return new xi(t)}function nM(s,e){const t=[];for(let i=0,n=s.arcs.length;i<n;++i)t[i]=mh(s.arcs[i],e);return new pt(t)}function sM(s,e){const t=[];for(let i=0,n=s.arcs.length;i<n;++i){const r=s.arcs[i],o=[];for(let a=0,l=r.length;a<l;++a)o[a]=mh(r[a],e);t[i]=o}return new _n(t)}function rM(s,e,t,i,n,r,o){const a=s.geometries,l=[];for(let h=0,u=a.length;h<u;++h)l[h]=My(a[h],e,t,i,n,r,o);return l}function My(s,e,t,i,n,r,o){let a=null;const l=s.type;if(l){const c=JT[l];l==="Point"||l==="MultiPoint"?a=c(s,t,i):a=c(s,e),a=at(a,!1,o)}const h=new di({geometry:a});s.id!==void 0&&h.setId(s.id);let u=s.properties;return n&&(u||(u={}),u[n]=r),u&&h.setProperties(u,!0),h}function oM(s,e,t){for(let i=0,n=s.length;i<n;++i)aM(s[i],e,t)}function aM(s,e,t){let i=0,n=0;for(let r=0,o=s.length;r<o;++r){const a=s[r];i+=a[0],n+=a[1],a[0]=i,a[1]=n,af(a,e,t)}}function af(s,e,t){s[0]=s[0]*e[0]+t[0],s[1]=s[1]*e[1]+t[1]}class Se extends B{constructor(e){e=e||{},super(e),this.schemaLocation=e.schemaLocation?e.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}writeGeometryElement(e,t,i){const n=i[i.length-1];i[i.length-1]=Object.assign({multiCurve:!0,multiSurface:!0},n),super.writeGeometryElement(e,t,i)}}Se.prototype.namespace="http://www.opengis.net/gml/3.2";Se.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:ie(B.prototype.readFlatPos),posList:ie(B.prototype.readFlatPosList),coordinates:ie(fe.prototype.readFlatCoordinates)}};Se.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:B.prototype.interiorParser,exterior:B.prototype.exteriorParser}};Se.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:ie(Q.prototype.readPoint),MultiPoint:ie(Q.prototype.readMultiPoint),LineString:ie(Q.prototype.readLineString),MultiLineString:ie(Q.prototype.readMultiLineString),LinearRing:ie(Q.prototype.readLinearRing),Polygon:ie(Q.prototype.readPolygon),MultiPolygon:ie(Q.prototype.readMultiPolygon),Surface:ie(Se.prototype.readSurface),MultiSurface:ie(B.prototype.readMultiSurface),Curve:ie(Se.prototype.readCurve),MultiCurve:ie(B.prototype.readMultiCurve),Envelope:ie(Se.prototype.readEnvelope)}};Se.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:te(B.prototype.curveMemberParser),curveMembers:te(B.prototype.curveMemberParser)}};Se.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:te(B.prototype.surfaceMemberParser),surfaceMembers:te(B.prototype.surfaceMemberParser)}};Se.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:te(Q.prototype.readLineString),Curve:te(B.prototype.readCurve)}};Se.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:te(Q.prototype.readPolygon),Surface:te(B.prototype.readSurface)}};Se.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:ie(B.prototype.readPatch)}};Se.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:ie(B.prototype.readSegment)}};Se.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:te(B.prototype.readFlatPosList),upperCorner:te(B.prototype.readFlatPosList)}};Se.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:ie(B.prototype.readPolygonPatch)}};Se.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:vl(B.prototype.readLineStringSegment)}};Se.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:te(Q.prototype.pointMemberParser),pointMembers:te(Q.prototype.pointMemberParser)}};Se.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:te(Q.prototype.lineStringMemberParser),lineStringMembers:te(Q.prototype.lineStringMemberParser)}};Se.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:te(Q.prototype.polygonMemberParser),polygonMembers:te(Q.prototype.polygonMemberParser)}};Se.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:te(Q.prototype.readFlatCoordinatesFromNode)}};Se.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:te(Q.prototype.readLineString)}};Se.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:te(Q.prototype.readPolygon)}};Se.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:ie(Q.prototype.readFlatLinearRing),Ring:ie(Se.prototype.readFlatCurveRing)}};Se.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:L(B.prototype.writeRing),interior:L(B.prototype.writeRing)}};Se.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:L(re),upperCorner:L(re)}};Se.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:L(B.prototype.writeSurfaceOrPolygonMember),polygonMember:L(B.prototype.writeSurfaceOrPolygonMember)}};Se.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:L(B.prototype.writePointMember)}};Se.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:L(B.prototype.writeLineStringOrCurveMember),curveMember:L(B.prototype.writeLineStringOrCurveMember)}};Se.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:L(B.prototype.writeCurveOrLineString),MultiCurve:L(B.prototype.writeMultiCurveOrLineString),Point:L(Se.prototype.writePoint),MultiPoint:L(B.prototype.writeMultiPoint),LineString:L(B.prototype.writeCurveOrLineString),MultiLineString:L(B.prototype.writeMultiCurveOrLineString),LinearRing:L(B.prototype.writeLinearRing),Polygon:L(B.prototype.writeSurfaceOrPolygon),MultiPolygon:L(B.prototype.writeMultiSurfaceOrPolygon),Surface:L(B.prototype.writeSurfaceOrPolygon),MultiSurface:L(B.prototype.writeMultiSurfaceOrPolygon),Envelope:L(B.prototype.writeEnvelope)}};const op={"http://www.opengis.net/gml":{boundedBy:P(Q.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:te(Q.prototype.readFeaturesInternal)}},lM={"http://www.opengis.net/wfs":{totalInserted:P(Je),totalUpdated:P(Je),totalDeleted:P(Je)},"http://www.opengis.net/wfs/2.0":{totalInserted:P(Je),totalUpdated:P(Je),totalDeleted:P(Je)}},hM={"http://www.opengis.net/wfs":{TransactionSummary:P(lp,"transactionSummary"),InsertResults:P(up,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:P(lp,"transactionSummary"),InsertResults:P(up,"insertIds")}},uM={"http://www.opengis.net/wfs":{PropertyName:L(re)},"http://www.opengis.net/wfs/2.0":{PropertyName:L(re)}},Ly={"http://www.opengis.net/wfs":{Insert:L(cp),Update:L(fp),Delete:L(dp),Property:L(gp),Native:L(pp)},"http://www.opengis.net/wfs/2.0":{Insert:L(cp),Update:L(fp),Delete:L(dp),Property:L(gp),Native:L(pp)}},Ay="feature",lf="http://www.w3.org/2000/xmlns/",hf={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},Yu={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},uf={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},ap={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},cf={"2.0.0":Se,"1.1.0":B,"1.0.0":fe},cM="1.1.0";class Uk extends ua{constructor(e){super(),e=e||{},this.version_=e.version?e.version:cM,this.featureType_=e.featureType,this.featureNS_=e.featureNS,this.gmlFormat_=e.gmlFormat?e.gmlFormat:new cf[this.version_],this.schemaLocation_=e.schemaLocation?e.schemaLocation:ap[this.version_]}getFeatureType(){return this.featureType_}setFeatureType(e){this.featureType_=e}readFeaturesFromNode(e,t){const i={node:e};Object.assign(i,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(i,this.getReadOptions(e,t||{}));const n=[i];let r;this.version_==="2.0.0"?r=op:r=this.gmlFormat_.FEATURE_COLLECTION_PARSERS;let o=W([],r,e,n,this.gmlFormat_);return o||(o=[]),o}readTransactionResponse(e){if(e){if(typeof e=="string"){const t=ri(e);return this.readTransactionResponseFromDocument(t)}return si(e)?this.readTransactionResponseFromDocument(e):this.readTransactionResponseFromNode(e)}}readFeatureCollectionMetadata(e){if(e){if(typeof e=="string"){const t=ri(e);return this.readFeatureCollectionMetadataFromDocument(t)}return si(e)?this.readFeatureCollectionMetadataFromDocument(e):this.readFeatureCollectionMetadataFromNode(e)}}readFeatureCollectionMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t)}readFeatureCollectionMetadataFromNode(e){const t={},i=ar(e.getAttribute("numberOfFeatures"));return t.numberOfFeatures=i,W(t,op,e,[],this.gmlFormat_)}readTransactionResponseFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t)}readTransactionResponseFromNode(e){return W({},hM,e,[])}writeGetFeature(e){const t=le(Yu[this.version_],"GetFeature");t.setAttribute("service","WFS"),t.setAttribute("version",this.version_),e.handle&&t.setAttribute("handle",e.handle),e.outputFormat&&t.setAttribute("outputFormat",e.outputFormat),e.maxFeatures!==void 0&&t.setAttribute("maxFeatures",String(e.maxFeatures)),e.resultType&&t.setAttribute("resultType",e.resultType),e.startIndex!==void 0&&t.setAttribute("startIndex",String(e.startIndex)),e.count!==void 0&&t.setAttribute("count",String(e.count)),e.viewParams!==void 0&&t.setAttribute("viewParams",e.viewParams),t.setAttributeNS(Is,"xsi:schemaLocation",this.schemaLocation_);const i={node:t};if(Object.assign(i,{version:this.version_,srsName:e.srsName,featureNS:e.featureNS?e.featureNS:this.featureNS_,featurePrefix:e.featurePrefix,propertyNames:e.propertyNames?e.propertyNames:[]}),be(Array.isArray(e.featureTypes),"`options.featureTypes` must be an Array"),typeof e.featureTypes[0]=="string"){let n=e.filter;e.bbox&&(be(e.geometryName,"`options.geometryName` must also be provided when `options.bbox` is set"),n=this.combineBboxAndFilter(e.geometryName,e.bbox,e.srsName,n)),Object.assign(i,{geometryName:e.geometryName,filter:n}),Rp(t,e.featureTypes,[i])}else e.featureTypes.forEach(n=>{const r=this.combineBboxAndFilter(n.geometryName,n.bbox,e.srsName,e.filter);Object.assign(i,{geometryName:n.geometryName,filter:r}),Rp(t,[n.name],[i])});return t}combineBboxAndFilter(e,t,i,n){const r=kx(e,t,i);return n?Dx(n,r):r}writeTransaction(e,t,i,n){const r=[],o=n.version?n.version:this.version_,a=le(Yu[o],"Transaction");a.setAttribute("service","WFS"),a.setAttribute("version",o);let l;n&&(l=n.gmlOptions?n.gmlOptions:{},n.handle&&a.setAttribute("handle",n.handle)),a.setAttributeNS(Is,"xsi:schemaLocation",ap[o]);const h=dM(a,l,o,n);return e&&Oa("Insert",e,r,h),t&&Oa("Update",t,r,h),i&&Oa("Delete",i,r,h),n.nativeElements&&Oa("Native",n.nativeElements,r,h),a}readProjectionFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null}readProjectionFromNode(e){if(e.firstElementChild&&e.firstElementChild.firstElementChild){e=e.firstElementChild.firstElementChild;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(!(t.childNodes.length===0||t.childNodes.length===1&&t.firstChild.nodeType===3)){const i=[{}];return this.gmlFormat_.readGeometryElement(t,i),he(i.pop().srsName)}}return null}}function dM(s,e,t,i){const n=i.featurePrefix?i.featurePrefix:Ay;let r;return t==="1.0.0"?r=2:t==="1.1.0"?r=3:t==="2.0.0"&&(r=3.2),Object.assign({node:s},{version:t,featureNS:i.featureNS,featureType:i.featureType,featurePrefix:n,gmlVersion:r,hasZ:i.hasZ,srsName:i.srsName},e)}function Oa(s,e,t,i){ae(i,Ly,Be(s),e,t)}function lp(s,e){return W({},lM,s,e)}const fM={"http://www.opengis.net/ogc":{FeatureId:te(function(s,e){return s.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:te(function(s,e){return s.getAttribute("fid")})}};function hp(s,e){Nt(fM,s,e)}const gM={"http://www.opengis.net/wfs":{Feature:hp},"http://www.opengis.net/wfs/2.0":{Feature:hp}};function up(s,e){return W([],gM,s,e)}function cp(s,e,t){const i=t[t.length-1],n=i.featureType,r=i.featureNS,o=i.gmlVersion,a=le(r,n);s.appendChild(a),o===2?fe.prototype.writeFeatureElement(a,e,t):o===3?B.prototype.writeFeatureElement(a,e,t):Se.prototype.writeFeatureElement(a,e,t)}function Py(s,e,t){const n=t[t.length-1].version,r=hf[n],o=le(r,"Filter"),a=le(r,"FeatureId");o.appendChild(a),a.setAttribute("fid",e),s.appendChild(o)}function df(s,e){s=s||Ay;const t=s+":";return e.startsWith(t)?e:t+e}function dp(s,e,t){const i=t[t.length-1];be(e.getId()!==void 0,"Features must have an id set");const n=i.featureType,r=i.featurePrefix,o=i.featureNS,a=df(r,n);s.setAttribute("typeName",a),s.setAttributeNS(lf,"xmlns:"+r,o);const l=e.getId();l!==void 0&&Py(s,l,t)}function fp(s,e,t){const i=t[t.length-1];be(e.getId()!==void 0,"Features must have an id set");const n=i.version,r=i.featureType,o=i.featurePrefix,a=i.featureNS,l=df(o,r),h=e.getGeometryName();s.setAttribute("typeName",l),s.setAttributeNS(lf,"xmlns:"+o,a);const u=e.getId();if(u!==void 0){const c=e.getKeys(),d=[];for(let f=0,g=c.length;f<g;f++){const p=e.get(c[f]);if(p!==void 0){let y=c[f];p&&typeof p.getSimplifiedGeometry=="function"&&(y=h),d.push({name:y,value:p})}}ae({version:n,gmlVersion:i.gmlVersion,node:s,hasZ:i.hasZ,srsName:i.srsName},Ly,Be("Property"),d,t),Py(s,u,t)}}function gp(s,e,t){const i=t[t.length-1],n=i.version,r=Yu[n],a=le(r,n==="2.0.0"?"ValueReference":"Name"),l=i.gmlVersion;if(s.appendChild(a),re(a,e.name),e.value!==void 0&&e.value!==null){const h=le(r,"Value");s.appendChild(h),e.value&&typeof e.value.getSimplifiedGeometry=="function"?l===2?fe.prototype.writeGeometryElement(h,e.value,t):l===3?B.prototype.writeGeometryElement(h,e.value,t):Se.prototype.writeGeometryElement(h,e.value,t):re(h,e.value)}}function pp(s,e,t){e.vendorId&&s.setAttribute("vendorId",e.vendorId),e.safeToIgnore!==void 0&&s.setAttribute("safeToIgnore",String(e.safeToIgnore)),e.value!==void 0&&re(s,e.value)}const bh={"http://www.opengis.net/wfs":{Query:L(mp)},"http://www.opengis.net/wfs/2.0":{Query:L(mp)},"http://www.opengis.net/ogc":{During:L(vp),And:L(Fa),Or:L(Fa),Not:L(wp),BBOX:L(bp),Contains:L(kn),Intersects:L(kn),Within:L(kn),DWithin:L(yp),PropertyIsEqualTo:L(ti),PropertyIsNotEqualTo:L(ti),PropertyIsLessThan:L(ti),PropertyIsLessThanOrEqualTo:L(ti),PropertyIsGreaterThan:L(ti),PropertyIsGreaterThanOrEqualTo:L(ti),PropertyIsNull:L(_p),PropertyIsBetween:L(Ep),PropertyIsLike:L(Cp)},"http://www.opengis.net/fes/2.0":{During:L(vp),And:L(Fa),Or:L(Fa),Not:L(wp),BBOX:L(bp),Contains:L(kn),Disjoint:L(kn),Intersects:L(kn),ResourceId:L(mM),Within:L(kn),DWithin:L(yp),PropertyIsEqualTo:L(ti),PropertyIsNotEqualTo:L(ti),PropertyIsLessThan:L(ti),PropertyIsLessThanOrEqualTo:L(ti),PropertyIsGreaterThan:L(ti),PropertyIsGreaterThanOrEqualTo:L(ti),PropertyIsNull:L(_p),PropertyIsBetween:L(Ep),PropertyIsLike:L(Cp)}};function mp(s,e,t){const i=t[t.length-1],n=i.version,r=i.featurePrefix,o=i.featureNS,a=i.propertyNames,l=i.srsName;let h;r?h=df(r,e):h=e;let u;n==="2.0.0"?u="typeNames":u="typeName",s.setAttribute(u,h),l&&s.setAttribute("srsName",l),o&&s.setAttributeNS(lf,"xmlns:"+r,o);const c=Object.assign({},i);c.node=s,ae(c,uM,Be("PropertyName"),a,t);const d=i.filter;if(d){const f=le(yh(n),"Filter");s.appendChild(f),pM(f,d,t)}}function pM(s,e,t){const i=t[t.length-1],n={node:s};Object.assign(n,{context:i}),ae(n,bh,Be(e.getTagName()),[e],t)}function bp(s,e,t){const i=t[t.length-1],r=i.context.version;i.srsName=e.srsName;const o=cf[r];Vr(r,s,e.geometryName),o.prototype.writeGeometryElement(s,e.extent,t)}function mM(s,e,t){s.setAttribute("rid",e.rid)}function kn(s,e,t){const i=t[t.length-1],r=i.context.version;i.srsName=e.srsName;const o=cf[r];Vr(r,s,e.geometryName),o.prototype.writeGeometryElement(s,e.geometry,t)}function yp(s,e,t){const r=t[t.length-1].context.version;kn(s,e,t);const o=le(yh(r),"Distance");re(o,e.distance.toString()),r==="2.0.0"?o.setAttribute("uom",e.unit):o.setAttribute("units",e.unit),s.appendChild(o)}function vp(s,e,t){const r=t[t.length-1].context.version;Cl(uf[r],"ValueReference",s,e.propertyName);const o=le(yn,"TimePeriod");s.appendChild(o);const a=le(yn,"begin");o.appendChild(a),xp(a,e.begin);const l=le(yn,"end");o.appendChild(l),xp(l,e.end)}function Fa(s,e,t){const n=t[t.length-1].context,r={node:s};Object.assign(r,{context:n});const o=e.conditions;for(let a=0,l=o.length;a<l;++a){const h=o[a];ae(r,bh,Be(h.getTagName()),[h],t)}}function wp(s,e,t){const n=t[t.length-1].context,r={node:s};Object.assign(r,{context:n});const o=e.condition;ae(r,bh,Be(o.getTagName()),[o],t)}function ti(s,e,t){const r=t[t.length-1].context.version;e.matchCase!==void 0&&s.setAttribute("matchCase",e.matchCase.toString()),Vr(r,s,e.propertyName),xl(r,s,""+e.expression)}function _p(s,e,t){const r=t[t.length-1].context.version;Vr(r,s,e.propertyName)}function Ep(s,e,t){const r=t[t.length-1].context.version,o=yh(r);Vr(r,s,e.propertyName);const a=le(o,"LowerBoundary");s.appendChild(a),xl(r,a,""+e.lowerBoundary);const l=le(o,"UpperBoundary");s.appendChild(l),xl(r,l,""+e.upperBoundary)}function Cp(s,e,t){const r=t[t.length-1].context.version;s.setAttribute("wildCard",e.wildCard),s.setAttribute("singleChar",e.singleChar),s.setAttribute("escapeChar",e.escapeChar),e.matchCase!==void 0&&s.setAttribute("matchCase",e.matchCase.toString()),Vr(r,s,e.propertyName),xl(r,s,""+e.pattern)}function Cl(s,e,t,i){const n=le(s,e);re(n,i),t.appendChild(n)}function xl(s,e,t){Cl(yh(s),"Literal",e,t)}function Vr(s,e,t){s==="2.0.0"?Cl(uf[s],"ValueReference",e,t):Cl(hf[s],"PropertyName",e,t)}function xp(s,e){const t=le(yn,"TimeInstant");s.appendChild(t);const i=le(yn,"timePosition");t.appendChild(i),re(i,e)}function Rp(s,e,t){const i=t[t.length-1],n=Object.assign({},i);n.node=s,ae(n,bh,Be("Query"),e,t)}function yh(s){let e;return s==="2.0.0"?e=uf[s]:e=hf[s],e}const bM="_feature",yM="_layer";class jk extends ua{constructor(e){super(),e=e||{},this.featureNS_="http://mapserver.gis.umn.edu/mapserver",this.gmlFormat_=new fe,this.layers_=e.layers?e.layers:null}getLayers(){return this.layers_}setLayers(e){this.layers_=e}readFeatures_(e,t){e.setAttribute("namespaceURI",this.featureNS_);const i=e.localName;let n=[];if(e.childNodes.length===0)return n;if(i=="msGMLOutput")for(let r=0,o=e.childNodes.length;r<o;r++){const a=e.childNodes[r];if(a.nodeType!==Node.ELEMENT_NODE)continue;const l=a,h=t[0],u=yM,c=l.localName.replace(u,"");if(this.layers_&&!this.layers_.includes(c))continue;const d=c+bM;h.featureType=d,h.featureNS=this.featureNS_;const f={};f[d]=te(this.gmlFormat_.readFeatureElement,this.gmlFormat_);const g=G([h.featureNS,null],f);l.setAttribute("namespaceURI",this.featureNS_);const p=W([],g,l,t,this.gmlFormat_);p&&Re(n,p)}if(i=="FeatureCollection"){const r=W([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,e,[{}],this.gmlFormat_);r&&(n=r)}return n}readFeaturesFromNode(e,t){const i={};return t&&Object.assign(i,this.getReadOptions(e,t)),this.readFeatures_(e,[i])}}const Yi=[null,"http://www.opengis.net/wmts/1.0"],Wr=[null,"http://www.opengis.net/ows/1.1"],vM=G(Yi,{Contents:P(LM)});class Yk extends Ty{constructor(){super(),this.owsParser_=new xT}readFromNode(e){let t=e.getAttribute("version");t&&(t=t.trim());let i=this.owsParser_.readFromNode(e);return i?(i.version=t,i=W(i,vM,e,[]),i||null):null}}const wM=G(Yi,{Layer:Pt(AM),TileMatrixSet:Pt(PM)}),_M=G(Yi,{Style:Pt(IM),Format:Pt($),TileMatrixSetLink:Pt(OM),Dimension:Pt(FM),ResourceURL:Pt(DM)},G(Wr,{Title:P($),Abstract:P($),WGS84BoundingBox:P(Oy),BoundingBox:Pt(kM),Identifier:P($)})),EM=G(Yi,{LegendURL:Pt(NM)},G(Wr,{Title:P($),Identifier:P($)})),CM=G(Yi,{TileMatrixSet:P($),TileMatrixSetLimits:P(GM)}),xM=G(Yi,{TileMatrixLimits:te(HM)}),RM=G(Yi,{TileMatrix:P($),MinTileRow:P(Je),MaxTileRow:P(Je),MinTileCol:P(Je),MaxTileCol:P(Je)}),SM=G(Yi,{Default:P($),Value:Pt($)},G(Wr,{Identifier:P($)})),Iy=G(Wr,{LowerCorner:te(Xu),UpperCorner:te(Xu)}),TM=G(Yi,{WellKnownScaleSet:P($),TileMatrix:Pt(zM)},G(Wr,{SupportedCRS:P($),Identifier:P($),BoundingBox:P(Oy)})),MM=G(Yi,{TopLeftCorner:P(Xu),ScaleDenominator:P(Te),TileWidth:P(Je),TileHeight:P(Je),MatrixWidth:P(Je),MatrixHeight:P(Je)},G(Wr,{Identifier:P($)}));function LM(s,e){return W({},wM,s,e)}function AM(s,e){return W({},_M,s,e)}function PM(s,e){return W({},TM,s,e)}function IM(s,e){const t=W({},EM,s,e);if(!t)return;const i=s.getAttribute("isDefault")==="true";return t.isDefault=i,t}function OM(s,e){return W({},CM,s,e)}function FM(s,e){return W({},SM,s,e)}function DM(s,e){const t=s.getAttribute("format"),i=s.getAttribute("template"),n=s.getAttribute("resourceType"),r={};return t&&(r.format=t),i&&(r.template=i),n&&(r.resourceType=n),r}function Oy(s,e){const t=W([],Iy,s,e);if(t.length==2)return To(t)}function kM(s,e){const t=s.getAttribute("crs"),i=W([],Iy,s,e);if(i.length==2)return{extent:To(i),crs:t}}function NM(s,e){const t={};return t.format=s.getAttribute("format"),t.href=of(s),t}function Xu(s,e){const t=$(s).split(/\s+/);if(!t||t.length!=2)return;const i=+t[0],n=+t[1];if(!(isNaN(i)||isNaN(n)))return[i,n]}function zM(s,e){return W({},MM,s,e)}function GM(s,e){return W([],xM,s,e)}function HM(s,e){return W({},RM,s,e)}function Xa(s,e){return s==null||e==null?NaN:s<e?-1:s>e?1:s>=e?0:NaN}function BM(s,e){return s==null||e==null?NaN:e<s?-1:e>s?1:e>=s?0:NaN}function Fy(s){let e,t,i;s.length!==2?(e=Xa,t=(a,l)=>Xa(s(a),l),i=(a,l)=>s(a)-l):(e=s===Xa||s===BM?s:VM,t=s,i=s);function n(a,l,h=0,u=a.length){if(h<u){if(e(l,l)!==0)return u;do{const c=h+u>>>1;t(a[c],l)<0?h=c+1:u=c}while(h<u)}return h}function r(a,l,h=0,u=a.length){if(h<u){if(e(l,l)!==0)return u;do{const c=h+u>>>1;t(a[c],l)<=0?h=c+1:u=c}while(h<u)}return h}function o(a,l,h=0,u=a.length){const c=n(a,l,h,u-1);return c>h&&i(a[c-1],l)>-i(a[c],l)?c-1:c}return{left:n,center:o,right:r}}function VM(){return 0}function WM(s){return s===null?NaN:+s}const UM=Fy(Xa),jM=UM.right;Fy(WM).center;class Sp extends Map{constructor(e,t=$M){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[i,n]of e)this.set(i,n)}get(e){return super.get(Tp(this,e))}has(e){return super.has(Tp(this,e))}set(e,t){return super.set(YM(this,e),t)}delete(e){return super.delete(XM(this,e))}}function Tp({_intern:s,_key:e},t){const i=e(t);return s.has(i)?s.get(i):t}function YM({_intern:s,_key:e},t){const i=e(t);return s.has(i)?s.get(i):(s.set(i,t),t)}function XM({_intern:s,_key:e},t){const i=e(t);return s.has(i)&&(t=s.get(i),s.delete(i)),t}function $M(s){return s!==null&&typeof s=="object"?s.valueOf():s}const KM=Math.sqrt(50),ZM=Math.sqrt(10),qM=Math.sqrt(2);function Rl(s,e,t){const i=(e-s)/Math.max(0,t),n=Math.floor(Math.log10(i)),r=i/Math.pow(10,n),o=r>=KM?10:r>=ZM?5:r>=qM?2:1;let a,l,h;return n<0?(h=Math.pow(10,-n)/o,a=Math.round(s*h),l=Math.round(e*h),a/h<s&&++a,l/h>e&&--l,h=-h):(h=Math.pow(10,n)*o,a=Math.round(s/h),l=Math.round(e/h),a*h<s&&++a,l*h>e&&--l),l<a&&.5<=t&&t<2?Rl(s,e,t*2):[a,l,h]}function JM(s,e,t){if(e=+e,s=+s,t=+t,!(t>0))return[];if(s===e)return[s];const i=e<s,[n,r,o]=i?Rl(e,s,t):Rl(s,e,t);if(!(r>=n))return[];const a=r-n+1,l=new Array(a);if(i)if(o<0)for(let h=0;h<a;++h)l[h]=(r-h)/-o;else for(let h=0;h<a;++h)l[h]=(r-h)*o;else if(o<0)for(let h=0;h<a;++h)l[h]=(n+h)/-o;else for(let h=0;h<a;++h)l[h]=(n+h)*o;return l}function $u(s,e,t){return e=+e,s=+s,t=+t,Rl(s,e,t)[2]}function QM(s,e,t){e=+e,s=+s,t=+t;const i=e<s,n=i?$u(e,s,t):$u(s,e,t);return(i?-1:1)*(n<0?1/-n:n)}function eL(s){return s}var eu=1,tu=2,Ku=3,lo=4,Mp=1e-6;function tL(s){return"translate("+s+",0)"}function iL(s){return"translate(0,"+s+")"}function nL(s){return e=>+s(e)}function sL(s,e){return e=Math.max(0,s.bandwidth()-e*2)/2,s.round()&&(e=Math.round(e)),t=>+s(t)+e}function rL(){return!this.__axis}function Dy(s,e){var t=[],i=null,n=null,r=6,o=6,a=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,h=s===eu||s===lo?-1:1,u=s===lo||s===tu?"x":"y",c=s===eu||s===Ku?tL:iL;function d(f){var g=i??(e.ticks?e.ticks.apply(e,t):e.domain()),p=n??(e.tickFormat?e.tickFormat.apply(e,t):eL),y=Math.max(r,0)+a,b=e.range(),v=+b[0]+l,_=+b[b.length-1]+l,m=(e.bandwidth?sL:nL)(e.copy(),l),E=f.selection?f.selection():f,C=E.selectAll(".domain").data([null]),x=E.selectAll(".tick").data(g,e).order(),w=x.exit(),R=x.enter().append("g").attr("class","tick"),I=x.select("line"),T=x.select("text");C=C.merge(C.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(R),I=I.merge(R.append("line").attr("stroke","currentColor").attr(u+"2",h*r)),T=T.merge(R.append("text").attr("fill","currentColor").attr(u,h*y).attr("dy",s===eu?"0em":s===Ku?"0.71em":"0.32em")),f!==E&&(C=C.transition(f),x=x.transition(f),I=I.transition(f),T=T.transition(f),w=w.transition(f).attr("opacity",Mp).attr("transform",function(A){return isFinite(A=m(A))?c(A+l):this.getAttribute("transform")}),R.attr("opacity",Mp).attr("transform",function(A){var F=this.parentNode.__axis;return c((F&&isFinite(F=F(A))?F:m(A))+l)})),w.remove(),C.attr("d",s===lo||s===tu?o?"M"+h*o+","+v+"H"+l+"V"+_+"H"+h*o:"M"+l+","+v+"V"+_:o?"M"+v+","+h*o+"V"+l+"H"+_+"V"+h*o:"M"+v+","+l+"H"+_),x.attr("opacity",1).attr("transform",function(A){return c(m(A)+l)}),I.attr(u+"2",h*r),T.attr(u,h*y).text(p),E.filter(rL).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",s===tu?"start":s===lo?"end":"middle"),E.each(function(){this.__axis=m})}return d.scale=function(f){return arguments.length?(e=f,d):e},d.ticks=function(){return t=Array.from(arguments),d},d.tickArguments=function(f){return arguments.length?(t=f==null?[]:Array.from(f),d):t.slice()},d.tickValues=function(f){return arguments.length?(i=f==null?null:Array.from(f),d):i&&i.slice()},d.tickFormat=function(f){return arguments.length?(n=f,d):n},d.tickSize=function(f){return arguments.length?(r=o=+f,d):r},d.tickSizeInner=function(f){return arguments.length?(r=+f,d):r},d.tickSizeOuter=function(f){return arguments.length?(o=+f,d):o},d.tickPadding=function(f){return arguments.length?(a=+f,d):a},d.offset=function(f){return arguments.length?(l=+f,d):l},d}function Xk(s){return Dy(Ku,s)}function $k(s){return Dy(lo,s)}var oL={value:()=>{}};function vh(){for(var s=0,e=arguments.length,t={},i;s<e;++s){if(!(i=arguments[s]+"")||i in t||/[\s.]/.test(i))throw new Error("illegal type: "+i);t[i]=[]}return new $a(t)}function $a(s){this._=s}function aL(s,e){return s.trim().split(/^|\s+/).map(function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}})}$a.prototype=vh.prototype={constructor:$a,on:function(s,e){var t=this._,i=aL(s+"",t),n,r=-1,o=i.length;if(arguments.length<2){for(;++r<o;)if((n=(s=i[r]).type)&&(n=lL(t[n],s.name)))return n;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++r<o;)if(n=(s=i[r]).type)t[n]=Lp(t[n],s.name,e);else if(e==null)for(n in t)t[n]=Lp(t[n],s.name,null);return this},copy:function(){var s={},e=this._;for(var t in e)s[t]=e[t].slice();return new $a(s)},call:function(s,e){if((n=arguments.length-2)>0)for(var t=new Array(n),i=0,n,r;i<n;++i)t[i]=arguments[i+2];if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(r=this._[s],i=0,n=r.length;i<n;++i)r[i].value.apply(e,t)},apply:function(s,e,t){if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(var i=this._[s],n=0,r=i.length;n<r;++n)i[n].value.apply(e,t)}};function lL(s,e){for(var t=0,i=s.length,n;t<i;++t)if((n=s[t]).name===e)return n.value}function Lp(s,e,t){for(var i=0,n=s.length;i<n;++i)if(s[i].name===e){s[i]=oL,s=s.slice(0,i).concat(s.slice(i+1));break}return t!=null&&s.push({name:e,value:t}),s}var Zu="http://www.w3.org/1999/xhtml";const Ap={svg:"http://www.w3.org/2000/svg",xhtml:Zu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wh(s){var e=s+="",t=e.indexOf(":");return t>=0&&(e=s.slice(0,t))!=="xmlns"&&(s=s.slice(t+1)),Ap.hasOwnProperty(e)?{space:Ap[e],local:s}:s}function hL(s){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===Zu&&e.documentElement.namespaceURI===Zu?e.createElement(s):e.createElementNS(t,s)}}function uL(s){return function(){return this.ownerDocument.createElementNS(s.space,s.local)}}function ky(s){var e=wh(s);return(e.local?uL:hL)(e)}function cL(){}function ff(s){return s==null?cL:function(){return this.querySelector(s)}}function dL(s){typeof s!="function"&&(s=ff(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var r=e[n],o=r.length,a=i[n]=new Array(o),l,h,u=0;u<o;++u)(l=r[u])&&(h=s.call(l,l.__data__,u,r))&&("__data__"in l&&(h.__data__=l.__data__),a[u]=h);return new Zt(i,this._parents)}function fL(s){return s==null?[]:Array.isArray(s)?s:Array.from(s)}function gL(){return[]}function Ny(s){return s==null?gL:function(){return this.querySelectorAll(s)}}function pL(s){return function(){return fL(s.apply(this,arguments))}}function mL(s){typeof s=="function"?s=pL(s):s=Ny(s);for(var e=this._groups,t=e.length,i=[],n=[],r=0;r<t;++r)for(var o=e[r],a=o.length,l,h=0;h<a;++h)(l=o[h])&&(i.push(s.call(l,l.__data__,h,o)),n.push(l));return new Zt(i,n)}function zy(s){return function(){return this.matches(s)}}function Gy(s){return function(e){return e.matches(s)}}var bL=Array.prototype.find;function yL(s){return function(){return bL.call(this.children,s)}}function vL(){return this.firstElementChild}function wL(s){return this.select(s==null?vL:yL(typeof s=="function"?s:Gy(s)))}var _L=Array.prototype.filter;function EL(){return Array.from(this.children)}function CL(s){return function(){return _L.call(this.children,s)}}function xL(s){return this.selectAll(s==null?EL:CL(typeof s=="function"?s:Gy(s)))}function RL(s){typeof s!="function"&&(s=zy(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var r=e[n],o=r.length,a=i[n]=[],l,h=0;h<o;++h)(l=r[h])&&s.call(l,l.__data__,h,r)&&a.push(l);return new Zt(i,this._parents)}function Hy(s){return new Array(s.length)}function SL(){return new Zt(this._enter||this._groups.map(Hy),this._parents)}function Sl(s,e){this.ownerDocument=s.ownerDocument,this.namespaceURI=s.namespaceURI,this._next=null,this._parent=s,this.__data__=e}Sl.prototype={constructor:Sl,appendChild:function(s){return this._parent.insertBefore(s,this._next)},insertBefore:function(s,e){return this._parent.insertBefore(s,e)},querySelector:function(s){return this._parent.querySelector(s)},querySelectorAll:function(s){return this._parent.querySelectorAll(s)}};function TL(s){return function(){return s}}function ML(s,e,t,i,n,r){for(var o=0,a,l=e.length,h=r.length;o<h;++o)(a=e[o])?(a.__data__=r[o],i[o]=a):t[o]=new Sl(s,r[o]);for(;o<l;++o)(a=e[o])&&(n[o]=a)}function LL(s,e,t,i,n,r,o){var a,l,h=new Map,u=e.length,c=r.length,d=new Array(u),f;for(a=0;a<u;++a)(l=e[a])&&(d[a]=f=o.call(l,l.__data__,a,e)+"",h.has(f)?n[a]=l:h.set(f,l));for(a=0;a<c;++a)f=o.call(s,r[a],a,r)+"",(l=h.get(f))?(i[a]=l,l.__data__=r[a],h.delete(f)):t[a]=new Sl(s,r[a]);for(a=0;a<u;++a)(l=e[a])&&h.get(d[a])===l&&(n[a]=l)}function AL(s){return s.__data__}function PL(s,e){if(!arguments.length)return Array.from(this,AL);var t=e?LL:ML,i=this._parents,n=this._groups;typeof s!="function"&&(s=TL(s));for(var r=n.length,o=new Array(r),a=new Array(r),l=new Array(r),h=0;h<r;++h){var u=i[h],c=n[h],d=c.length,f=IL(s.call(u,u&&u.__data__,h,i)),g=f.length,p=a[h]=new Array(g),y=o[h]=new Array(g),b=l[h]=new Array(d);t(u,c,p,y,b,f,e);for(var v=0,_=0,m,E;v<g;++v)if(m=p[v]){for(v>=_&&(_=v+1);!(E=y[_])&&++_<g;);m._next=E||null}}return o=new Zt(o,i),o._enter=a,o._exit=l,o}function IL(s){return typeof s=="object"&&"length"in s?s:Array.from(s)}function OL(){return new Zt(this._exit||this._groups.map(Hy),this._parents)}function FL(s,e,t){var i=this.enter(),n=this,r=this.exit();return typeof s=="function"?(i=s(i),i&&(i=i.selection())):i=i.append(s+""),e!=null&&(n=e(n),n&&(n=n.selection())),t==null?r.remove():t(r),i&&n?i.merge(n).order():n}function DL(s){for(var e=s.selection?s.selection():s,t=this._groups,i=e._groups,n=t.length,r=i.length,o=Math.min(n,r),a=new Array(n),l=0;l<o;++l)for(var h=t[l],u=i[l],c=h.length,d=a[l]=new Array(c),f,g=0;g<c;++g)(f=h[g]||u[g])&&(d[g]=f);for(;l<n;++l)a[l]=t[l];return new Zt(a,this._parents)}function kL(){for(var s=this._groups,e=-1,t=s.length;++e<t;)for(var i=s[e],n=i.length-1,r=i[n],o;--n>=0;)(o=i[n])&&(r&&o.compareDocumentPosition(r)^4&&r.parentNode.insertBefore(o,r),r=o);return this}function NL(s){s||(s=zL);function e(c,d){return c&&d?s(c.__data__,d.__data__):!c-!d}for(var t=this._groups,i=t.length,n=new Array(i),r=0;r<i;++r){for(var o=t[r],a=o.length,l=n[r]=new Array(a),h,u=0;u<a;++u)(h=o[u])&&(l[u]=h);l.sort(e)}return new Zt(n,this._parents).order()}function zL(s,e){return s<e?-1:s>e?1:s>=e?0:NaN}function GL(){var s=arguments[0];return arguments[0]=this,s.apply(null,arguments),this}function HL(){return Array.from(this)}function BL(){for(var s=this._groups,e=0,t=s.length;e<t;++e)for(var i=s[e],n=0,r=i.length;n<r;++n){var o=i[n];if(o)return o}return null}function VL(){let s=0;for(const e of this)++s;return s}function WL(){return!this.node()}function UL(s){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var n=e[t],r=0,o=n.length,a;r<o;++r)(a=n[r])&&s.call(a,a.__data__,r,n);return this}function jL(s){return function(){this.removeAttribute(s)}}function YL(s){return function(){this.removeAttributeNS(s.space,s.local)}}function XL(s,e){return function(){this.setAttribute(s,e)}}function $L(s,e){return function(){this.setAttributeNS(s.space,s.local,e)}}function KL(s,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(s):this.setAttribute(s,t)}}function ZL(s,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(s.space,s.local):this.setAttributeNS(s.space,s.local,t)}}function qL(s,e){var t=wh(s);if(arguments.length<2){var i=this.node();return t.local?i.getAttributeNS(t.space,t.local):i.getAttribute(t)}return this.each((e==null?t.local?YL:jL:typeof e=="function"?t.local?ZL:KL:t.local?$L:XL)(t,e))}function By(s){return s.ownerDocument&&s.ownerDocument.defaultView||s.document&&s||s.defaultView}function JL(s){return function(){this.style.removeProperty(s)}}function QL(s,e,t){return function(){this.style.setProperty(s,e,t)}}function eA(s,e,t){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(s):this.style.setProperty(s,i,t)}}function tA(s,e,t){return arguments.length>1?this.each((e==null?JL:typeof e=="function"?eA:QL)(s,e,t??"")):Pr(this.node(),s)}function Pr(s,e){return s.style.getPropertyValue(e)||By(s).getComputedStyle(s,null).getPropertyValue(e)}function iA(s){return function(){delete this[s]}}function nA(s,e){return function(){this[s]=e}}function sA(s,e){return function(){var t=e.apply(this,arguments);t==null?delete this[s]:this[s]=t}}function rA(s,e){return arguments.length>1?this.each((e==null?iA:typeof e=="function"?sA:nA)(s,e)):this.node()[s]}function Vy(s){return s.trim().split(/^|\s+/)}function gf(s){return s.classList||new Wy(s)}function Wy(s){this._node=s,this._names=Vy(s.getAttribute("class")||"")}Wy.prototype={add:function(s){var e=this._names.indexOf(s);e<0&&(this._names.push(s),this._node.setAttribute("class",this._names.join(" ")))},remove:function(s){var e=this._names.indexOf(s);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(s){return this._names.indexOf(s)>=0}};function Uy(s,e){for(var t=gf(s),i=-1,n=e.length;++i<n;)t.add(e[i])}function jy(s,e){for(var t=gf(s),i=-1,n=e.length;++i<n;)t.remove(e[i])}function oA(s){return function(){Uy(this,s)}}function aA(s){return function(){jy(this,s)}}function lA(s,e){return function(){(e.apply(this,arguments)?Uy:jy)(this,s)}}function hA(s,e){var t=Vy(s+"");if(arguments.length<2){for(var i=gf(this.node()),n=-1,r=t.length;++n<r;)if(!i.contains(t[n]))return!1;return!0}return this.each((typeof e=="function"?lA:e?oA:aA)(t,e))}function uA(){this.textContent=""}function cA(s){return function(){this.textContent=s}}function dA(s){return function(){var e=s.apply(this,arguments);this.textContent=e??""}}function fA(s){return arguments.length?this.each(s==null?uA:(typeof s=="function"?dA:cA)(s)):this.node().textContent}function gA(){this.innerHTML=""}function pA(s){return function(){this.innerHTML=s}}function mA(s){return function(){var e=s.apply(this,arguments);this.innerHTML=e??""}}function bA(s){return arguments.length?this.each(s==null?gA:(typeof s=="function"?mA:pA)(s)):this.node().innerHTML}function yA(){this.nextSibling&&this.parentNode.appendChild(this)}function vA(){return this.each(yA)}function wA(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _A(){return this.each(wA)}function EA(s){var e=typeof s=="function"?s:ky(s);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function CA(){return null}function xA(s,e){var t=typeof s=="function"?s:ky(s),i=e==null?CA:typeof e=="function"?e:ff(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),i.apply(this,arguments)||null)})}function RA(){var s=this.parentNode;s&&s.removeChild(this)}function SA(){return this.each(RA)}function TA(){var s=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function MA(){var s=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function LA(s){return this.select(s?MA:TA)}function AA(s){return arguments.length?this.property("__data__",s):this.node().__data__}function PA(s){return function(e){s.call(this,e,this.__data__)}}function IA(s){return s.trim().split(/^|\s+/).map(function(e){var t="",i=e.indexOf(".");return i>=0&&(t=e.slice(i+1),e=e.slice(0,i)),{type:e,name:t}})}function OA(s){return function(){var e=this.__on;if(e){for(var t=0,i=-1,n=e.length,r;t<n;++t)r=e[t],(!s.type||r.type===s.type)&&r.name===s.name?this.removeEventListener(r.type,r.listener,r.options):e[++i]=r;++i?e.length=i:delete this.__on}}}function FA(s,e,t){return function(){var i=this.__on,n,r=PA(e);if(i){for(var o=0,a=i.length;o<a;++o)if((n=i[o]).type===s.type&&n.name===s.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=r,n.options=t),n.value=e;return}}this.addEventListener(s.type,r,t),n={type:s.type,name:s.name,value:e,listener:r,options:t},i?i.push(n):this.__on=[n]}}function DA(s,e,t){var i=IA(s+""),n,r=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,h=a.length,u;l<h;++l)for(n=0,u=a[l];n<r;++n)if((o=i[n]).type===u.type&&o.name===u.name)return u.value}return}for(a=e?FA:OA,n=0;n<r;++n)this.each(a(i[n],e,t));return this}function Yy(s,e,t){var i=By(s),n=i.CustomEvent;typeof n=="function"?n=new n(e,t):(n=i.document.createEvent("Event"),t?(n.initEvent(e,t.bubbles,t.cancelable),n.detail=t.detail):n.initEvent(e,!1,!1)),s.dispatchEvent(n)}function kA(s,e){return function(){return Yy(this,s,e)}}function NA(s,e){return function(){return Yy(this,s,e.apply(this,arguments))}}function zA(s,e){return this.each((typeof e=="function"?NA:kA)(s,e))}function*GA(){for(var s=this._groups,e=0,t=s.length;e<t;++e)for(var i=s[e],n=0,r=i.length,o;n<r;++n)(o=i[n])&&(yield o)}var Xy=[null];function Zt(s,e){this._groups=s,this._parents=e}function da(){return new Zt([[document.documentElement]],Xy)}function HA(){return this}Zt.prototype=da.prototype={constructor:Zt,select:dL,selectAll:mL,selectChild:wL,selectChildren:xL,filter:RL,data:PL,enter:SL,exit:OL,join:FL,merge:DL,selection:HA,order:kL,sort:NL,call:GL,nodes:HL,node:BL,size:VL,empty:WL,each:UL,attr:qL,style:tA,property:rA,classed:hA,text:fA,html:bA,raise:vA,lower:_A,append:EA,insert:xA,remove:SA,clone:LA,datum:AA,on:DA,dispatch:zA,[Symbol.iterator]:GA};function dn(s){return typeof s=="string"?new Zt([[document.querySelector(s)]],[document.documentElement]):new Zt([[s]],Xy)}function BA(s){let e;for(;e=s.sourceEvent;)s=e;return s}function on(s,e){if(s=BA(s),e===void 0&&(e=s.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var i=t.createSVGPoint();return i.x=s.clientX,i.y=s.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var n=e.getBoundingClientRect();return[s.clientX-n.left-e.clientLeft,s.clientY-n.top-e.clientTop]}}return[s.pageX,s.pageY]}const VA={passive:!1},Bo={capture:!0,passive:!1};function iu(s){s.stopImmediatePropagation()}function mr(s){s.preventDefault(),s.stopImmediatePropagation()}function $y(s){var e=s.document.documentElement,t=dn(s).on("dragstart.drag",mr,Bo);"onselectstart"in e?t.on("selectstart.drag",mr,Bo):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ky(s,e){var t=s.document.documentElement,i=dn(s).on("dragstart.drag",null);e&&(i.on("click.drag",mr,Bo),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in t?i.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Da=s=>()=>s;function qu(s,{sourceEvent:e,subject:t,target:i,identifier:n,active:r,x:o,y:a,dx:l,dy:h,dispatch:u}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:n,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:u}})}qu.prototype.on=function(){var s=this._.on.apply(this._,arguments);return s===this._?this:s};function WA(s){return!s.ctrlKey&&!s.button}function UA(){return this.parentNode}function jA(s,e){return e??{x:s.x,y:s.y}}function YA(){return navigator.maxTouchPoints||"ontouchstart"in this}function Kk(){var s=WA,e=UA,t=jA,i=YA,n={},r=vh("start","drag","end"),o=0,a,l,h,u,c=0;function d(m){m.on("mousedown.drag",f).filter(i).on("touchstart.drag",y).on("touchmove.drag",b,VA).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(m,E){if(!(u||!s.call(this,m,E))){var C=_(this,e.call(this,m,E),m,E,"mouse");C&&(dn(m.view).on("mousemove.drag",g,Bo).on("mouseup.drag",p,Bo),$y(m.view),iu(m),h=!1,a=m.clientX,l=m.clientY,C("start",m))}}function g(m){if(mr(m),!h){var E=m.clientX-a,C=m.clientY-l;h=E*E+C*C>c}n.mouse("drag",m)}function p(m){dn(m.view).on("mousemove.drag mouseup.drag",null),Ky(m.view,h),mr(m),n.mouse("end",m)}function y(m,E){if(s.call(this,m,E)){var C=m.changedTouches,x=e.call(this,m,E),w=C.length,R,I;for(R=0;R<w;++R)(I=_(this,x,m,E,C[R].identifier,C[R]))&&(iu(m),I("start",m,C[R]))}}function b(m){var E=m.changedTouches,C=E.length,x,w;for(x=0;x<C;++x)(w=n[E[x].identifier])&&(mr(m),w("drag",m,E[x]))}function v(m){var E=m.changedTouches,C=E.length,x,w;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),x=0;x<C;++x)(w=n[E[x].identifier])&&(iu(m),w("end",m,E[x]))}function _(m,E,C,x,w,R){var I=r.copy(),T=on(R||C,E),A,F,S;if((S=t.call(m,new qu("beforestart",{sourceEvent:C,target:d,identifier:w,active:o,x:T[0],y:T[1],dx:0,dy:0,dispatch:I}),x))!=null)return A=S.x-T[0]||0,F=S.y-T[1]||0,function O(M,D,H){var j=T,V;switch(M){case"start":n[w]=O,V=o++;break;case"end":delete n[w],--o;case"drag":T=on(H||D,E),V=o;break}I.call(M,m,new qu(M,{sourceEvent:D,subject:S,target:d,identifier:w,active:V,x:T[0]+A,y:T[1]+F,dx:T[0]-j[0],dy:T[1]-j[1],dispatch:I}),x)}}return d.filter=function(m){return arguments.length?(s=typeof m=="function"?m:Da(!!m),d):s},d.container=function(m){return arguments.length?(e=typeof m=="function"?m:Da(m),d):e},d.subject=function(m){return arguments.length?(t=typeof m=="function"?m:Da(m),d):t},d.touchable=function(m){return arguments.length?(i=typeof m=="function"?m:Da(!!m),d):i},d.on=function(){var m=r.on.apply(r,arguments);return m===r?d:m},d.clickDistance=function(m){return arguments.length?(c=(m=+m)*m,d):Math.sqrt(c)},d}function pf(s,e,t){s.prototype=e.prototype=t,t.constructor=s}function Zy(s,e){var t=Object.create(s.prototype);for(var i in e)t[i]=e[i];return t}function fa(){}var Vo=.7,Tl=1/Vo,br="\\s*([+-]?\\d+)\\s*",Wo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XA=/^#([0-9a-f]{3,8})$/,$A=new RegExp(`^rgb\\(${br},${br},${br}\\)$`),KA=new RegExp(`^rgb\\(${Hi},${Hi},${Hi}\\)$`),ZA=new RegExp(`^rgba\\(${br},${br},${br},${Wo}\\)$`),qA=new RegExp(`^rgba\\(${Hi},${Hi},${Hi},${Wo}\\)$`),JA=new RegExp(`^hsl\\(${Wo},${Hi},${Hi}\\)$`),QA=new RegExp(`^hsla\\(${Wo},${Hi},${Hi},${Wo}\\)$`),Pp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pf(fa,Os,{copy(s){return Object.assign(new this.constructor,this,s)},displayable(){return this.rgb().displayable()},hex:Ip,formatHex:Ip,formatHex8:eP,formatHsl:tP,formatRgb:Op,toString:Op});function Ip(){return this.rgb().formatHex()}function eP(){return this.rgb().formatHex8()}function tP(){return qy(this).formatHsl()}function Op(){return this.rgb().formatRgb()}function Os(s){var e,t;return s=(s+"").trim().toLowerCase(),(e=XA.exec(s))?(t=e[1].length,e=parseInt(e[1],16),t===6?Fp(e):t===3?new Ft(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?ka(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?ka(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=$A.exec(s))?new Ft(e[1],e[2],e[3],1):(e=KA.exec(s))?new Ft(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ZA.exec(s))?ka(e[1],e[2],e[3],e[4]):(e=qA.exec(s))?ka(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=JA.exec(s))?Np(e[1],e[2]/100,e[3]/100,1):(e=QA.exec(s))?Np(e[1],e[2]/100,e[3]/100,e[4]):Pp.hasOwnProperty(s)?Fp(Pp[s]):s==="transparent"?new Ft(NaN,NaN,NaN,0):null}function Fp(s){return new Ft(s>>16&255,s>>8&255,s&255,1)}function ka(s,e,t,i){return i<=0&&(s=e=t=NaN),new Ft(s,e,t,i)}function iP(s){return s instanceof fa||(s=Os(s)),s?(s=s.rgb(),new Ft(s.r,s.g,s.b,s.opacity)):new Ft}function Ml(s,e,t,i){return arguments.length===1?iP(s):new Ft(s,e,t,i??1)}function Ft(s,e,t,i){this.r=+s,this.g=+e,this.b=+t,this.opacity=+i}pf(Ft,Ml,Zy(fa,{brighter(s){return s=s==null?Tl:Math.pow(Tl,s),new Ft(this.r*s,this.g*s,this.b*s,this.opacity)},darker(s){return s=s==null?Vo:Math.pow(Vo,s),new Ft(this.r*s,this.g*s,this.b*s,this.opacity)},rgb(){return this},clamp(){return new Ft(Cs(this.r),Cs(this.g),Cs(this.b),Ll(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dp,formatHex:Dp,formatHex8:nP,formatRgb:kp,toString:kp}));function Dp(){return`#${vs(this.r)}${vs(this.g)}${vs(this.b)}`}function nP(){return`#${vs(this.r)}${vs(this.g)}${vs(this.b)}${vs((isNaN(this.opacity)?1:this.opacity)*255)}`}function kp(){const s=Ll(this.opacity);return`${s===1?"rgb(":"rgba("}${Cs(this.r)}, ${Cs(this.g)}, ${Cs(this.b)}${s===1?")":`, ${s})`}`}function Ll(s){return isNaN(s)?1:Math.max(0,Math.min(1,s))}function Cs(s){return Math.max(0,Math.min(255,Math.round(s)||0))}function vs(s){return s=Cs(s),(s<16?"0":"")+s.toString(16)}function Np(s,e,t,i){return i<=0?s=e=t=NaN:t<=0||t>=1?s=e=NaN:e<=0&&(s=NaN),new yi(s,e,t,i)}function qy(s){if(s instanceof yi)return new yi(s.h,s.s,s.l,s.opacity);if(s instanceof fa||(s=Os(s)),!s)return new yi;if(s instanceof yi)return s;s=s.rgb();var e=s.r/255,t=s.g/255,i=s.b/255,n=Math.min(e,t,i),r=Math.max(e,t,i),o=NaN,a=r-n,l=(r+n)/2;return a?(e===r?o=(t-i)/a+(t<i)*6:t===r?o=(i-e)/a+2:o=(e-t)/a+4,a/=l<.5?r+n:2-r-n,o*=60):a=l>0&&l<1?0:o,new yi(o,a,l,s.opacity)}function sP(s,e,t,i){return arguments.length===1?qy(s):new yi(s,e,t,i??1)}function yi(s,e,t,i){this.h=+s,this.s=+e,this.l=+t,this.opacity=+i}pf(yi,sP,Zy(fa,{brighter(s){return s=s==null?Tl:Math.pow(Tl,s),new yi(this.h,this.s,this.l*s,this.opacity)},darker(s){return s=s==null?Vo:Math.pow(Vo,s),new yi(this.h,this.s,this.l*s,this.opacity)},rgb(){var s=this.h%360+(this.h<0)*360,e=isNaN(s)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,n=2*t-i;return new Ft(nu(s>=240?s-240:s+120,n,i),nu(s,n,i),nu(s<120?s+240:s-120,n,i),this.opacity)},clamp(){return new yi(zp(this.h),Na(this.s),Na(this.l),Ll(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const s=Ll(this.opacity);return`${s===1?"hsl(":"hsla("}${zp(this.h)}, ${Na(this.s)*100}%, ${Na(this.l)*100}%${s===1?")":`, ${s})`}`}}));function zp(s){return s=(s||0)%360,s<0?s+360:s}function Na(s){return Math.max(0,Math.min(1,s||0))}function nu(s,e,t){return(s<60?e+(t-e)*s/60:s<180?t:s<240?e+(t-e)*(240-s)/60:e)*255}function rP(s,e,t,i,n){var r=s*s,o=r*s;return((1-3*s+3*r-o)*e+(4-6*r+3*o)*t+(1+3*s+3*r-3*o)*i+o*n)/6}function oP(s){var e=s.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),n=s[i],r=s[i+1],o=i>0?s[i-1]:2*n-r,a=i<e-1?s[i+2]:2*r-n;return rP((t-i/e)*e,o,n,r,a)}}const mf=s=>()=>s;function aP(s,e){return function(t){return s+t*e}}function lP(s,e,t){return s=Math.pow(s,t),e=Math.pow(e,t)-s,t=1/t,function(i){return Math.pow(s+i*e,t)}}function hP(s){return(s=+s)==1?Jy:function(e,t){return t-e?lP(e,t,s):mf(isNaN(e)?t:e)}}function Jy(s,e){var t=e-s;return t?aP(s,t):mf(isNaN(s)?e:s)}const Al=function s(e){var t=hP(e);function i(n,r){var o=t((n=Ml(n)).r,(r=Ml(r)).r),a=t(n.g,r.g),l=t(n.b,r.b),h=Jy(n.opacity,r.opacity);return function(u){return n.r=o(u),n.g=a(u),n.b=l(u),n.opacity=h(u),n+""}}return i.gamma=s,i}(1);function uP(s){return function(e){var t=e.length,i=new Array(t),n=new Array(t),r=new Array(t),o,a;for(o=0;o<t;++o)a=Ml(e[o]),i[o]=a.r||0,n[o]=a.g||0,r[o]=a.b||0;return i=s(i),n=s(n),r=s(r),a.opacity=1,function(l){return a.r=i(l),a.g=n(l),a.b=r(l),a+""}}}var cP=uP(oP);function dP(s,e){e||(e=[]);var t=s?Math.min(e.length,s.length):0,i=e.slice(),n;return function(r){for(n=0;n<t;++n)i[n]=s[n]*(1-r)+e[n]*r;return i}}function fP(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function gP(s,e){var t=e?e.length:0,i=s?Math.min(t,s.length):0,n=new Array(i),r=new Array(t),o;for(o=0;o<i;++o)n[o]=_h(s[o],e[o]);for(;o<t;++o)r[o]=e[o];return function(a){for(o=0;o<i;++o)r[o]=n[o](a);return r}}function pP(s,e){var t=new Date;return s=+s,e=+e,function(i){return t.setTime(s*(1-i)+e*i),t}}function mi(s,e){return s=+s,e=+e,function(t){return s*(1-t)+e*t}}function mP(s,e){var t={},i={},n;(s===null||typeof s!="object")&&(s={}),(e===null||typeof e!="object")&&(e={});for(n in e)n in s?t[n]=_h(s[n],e[n]):i[n]=e[n];return function(r){for(n in t)i[n]=t[n](r);return i}}var Ju=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,su=new RegExp(Ju.source,"g");function bP(s){return function(){return s}}function yP(s){return function(e){return s(e)+""}}function Qy(s,e){var t=Ju.lastIndex=su.lastIndex=0,i,n,r,o=-1,a=[],l=[];for(s=s+"",e=e+"";(i=Ju.exec(s))&&(n=su.exec(e));)(r=n.index)>t&&(r=e.slice(t,r),a[o]?a[o]+=r:a[++o]=r),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,l.push({i:o,x:mi(i,n)})),t=su.lastIndex;return t<e.length&&(r=e.slice(t),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?yP(l[0].x):bP(e):(e=l.length,function(h){for(var u=0,c;u<e;++u)a[(c=l[u]).i]=c.x(h);return a.join("")})}function _h(s,e){var t=typeof e,i;return e==null||t==="boolean"?mf(e):(t==="number"?mi:t==="string"?(i=Os(e))?(e=i,Al):Qy:e instanceof Os?Al:e instanceof Date?pP:fP(e)?dP:Array.isArray(e)?gP:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?mP:mi)(s,e)}function ev(s,e){return s=+s,e=+e,function(t){return Math.round(s*(1-t)+e*t)}}var Gp=180/Math.PI,Qu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tv(s,e,t,i,n,r){var o,a,l;return(o=Math.sqrt(s*s+e*e))&&(s/=o,e/=o),(l=s*t+e*i)&&(t-=s*l,i-=e*l),(a=Math.sqrt(t*t+i*i))&&(t/=a,i/=a,l/=a),s*i<e*t&&(s=-s,e=-e,l=-l,o=-o),{translateX:n,translateY:r,rotate:Math.atan2(e,s)*Gp,skewX:Math.atan(l)*Gp,scaleX:o,scaleY:a}}var za;function vP(s){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(s+"");return e.isIdentity?Qu:tv(e.a,e.b,e.c,e.d,e.e,e.f)}function wP(s){return s==null||(za||(za=document.createElementNS("http://www.w3.org/2000/svg","g")),za.setAttribute("transform",s),!(s=za.transform.baseVal.consolidate()))?Qu:(s=s.matrix,tv(s.a,s.b,s.c,s.d,s.e,s.f))}function iv(s,e,t,i){function n(h){return h.length?h.pop()+" ":""}function r(h,u,c,d,f,g){if(h!==c||u!==d){var p=f.push("translate(",null,e,null,t);g.push({i:p-4,x:mi(h,c)},{i:p-2,x:mi(u,d)})}else(c||d)&&f.push("translate("+c+e+d+t)}function o(h,u,c,d){h!==u?(h-u>180?u+=360:u-h>180&&(h+=360),d.push({i:c.push(n(c)+"rotate(",null,i)-2,x:mi(h,u)})):u&&c.push(n(c)+"rotate("+u+i)}function a(h,u,c,d){h!==u?d.push({i:c.push(n(c)+"skewX(",null,i)-2,x:mi(h,u)}):u&&c.push(n(c)+"skewX("+u+i)}function l(h,u,c,d,f,g){if(h!==c||u!==d){var p=f.push(n(f)+"scale(",null,",",null,")");g.push({i:p-4,x:mi(h,c)},{i:p-2,x:mi(u,d)})}else(c!==1||d!==1)&&f.push(n(f)+"scale("+c+","+d+")")}return function(h,u){var c=[],d=[];return h=s(h),u=s(u),r(h.translateX,h.translateY,u.translateX,u.translateY,c,d),o(h.rotate,u.rotate,c,d),a(h.skewX,u.skewX,c,d),l(h.scaleX,h.scaleY,u.scaleX,u.scaleY,c,d),h=u=null,function(f){for(var g=-1,p=d.length,y;++g<p;)c[(y=d[g]).i]=y.x(f);return c.join("")}}}var _P=iv(vP,"px, ","px)","deg)"),EP=iv(wP,", ",")",")"),CP=1e-12;function Hp(s){return((s=Math.exp(s))+1/s)/2}function xP(s){return((s=Math.exp(s))-1/s)/2}function RP(s){return((s=Math.exp(2*s))-1)/(s+1)}const SP=function s(e,t,i){function n(r,o){var a=r[0],l=r[1],h=r[2],u=o[0],c=o[1],d=o[2],f=u-a,g=c-l,p=f*f+g*g,y,b;if(p<CP)b=Math.log(d/h)/e,y=function(x){return[a+x*f,l+x*g,h*Math.exp(e*x*b)]};else{var v=Math.sqrt(p),_=(d*d-h*h+i*p)/(2*h*t*v),m=(d*d-h*h-i*p)/(2*d*t*v),E=Math.log(Math.sqrt(_*_+1)-_),C=Math.log(Math.sqrt(m*m+1)-m);b=(C-E)/e,y=function(x){var w=x*b,R=Hp(E),I=h/(t*v)*(R*RP(e*w+E)-xP(E));return[a+I*f,l+I*g,h*R/Hp(e*w+E)]}}return y.duration=b*1e3*e/Math.SQRT2,y}return n.rho=function(r){var o=Math.max(.001,+r),a=o*o,l=a*a;return s(o,a,l)},n}(Math.SQRT2,2,4);var Ir=0,ho=0,Qr=0,nv=1e3,Pl,uo,Il=0,Fs=0,Eh=0,Uo=typeof performance=="object"&&performance.now?performance:Date,sv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(s){setTimeout(s,17)};function bf(){return Fs||(sv(TP),Fs=Uo.now()+Eh)}function TP(){Fs=0}function Ol(){this._call=this._time=this._next=null}Ol.prototype=rv.prototype={constructor:Ol,restart:function(s,e,t){if(typeof s!="function")throw new TypeError("callback is not a function");t=(t==null?bf():+t)+(e==null?0:+e),!this._next&&uo!==this&&(uo?uo._next=this:Pl=this,uo=this),this._call=s,this._time=t,ec()},stop:function(){this._call&&(this._call=null,this._time=1/0,ec())}};function rv(s,e,t){var i=new Ol;return i.restart(s,e,t),i}function MP(){bf(),++Ir;for(var s=Pl,e;s;)(e=Fs-s._time)>=0&&s._call.call(void 0,e),s=s._next;--Ir}function Bp(){Fs=(Il=Uo.now())+Eh,Ir=ho=0;try{MP()}finally{Ir=0,AP(),Fs=0}}function LP(){var s=Uo.now(),e=s-Il;e>nv&&(Eh-=e,Il=s)}function AP(){for(var s,e=Pl,t,i=1/0;e;)e._call?(i>e._time&&(i=e._time),s=e,e=e._next):(t=e._next,e._next=null,e=s?s._next=t:Pl=t);uo=s,ec(i)}function ec(s){if(!Ir){ho&&(ho=clearTimeout(ho));var e=s-Fs;e>24?(s<1/0&&(ho=setTimeout(Bp,s-Uo.now()-Eh)),Qr&&(Qr=clearInterval(Qr))):(Qr||(Il=Uo.now(),Qr=setInterval(LP,nv)),Ir=1,sv(Bp))}}function Vp(s,e,t){var i=new Ol;return e=e==null?0:+e,i.restart(n=>{i.stop(),s(n+e)},e,t),i}var PP=vh("start","end","cancel","interrupt"),IP=[],ov=0,Wp=1,tc=2,Ka=3,Up=4,ic=5,Za=6;function Ch(s,e,t,i,n,r){var o=s.__transition;if(!o)s.__transition={};else if(t in o)return;OP(s,t,{name:e,index:i,group:n,on:PP,tween:IP,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:ov})}function yf(s,e){var t=Ti(s,e);if(t.state>ov)throw new Error("too late; already scheduled");return t}function Xi(s,e){var t=Ti(s,e);if(t.state>Ka)throw new Error("too late; already running");return t}function Ti(s,e){var t=s.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function OP(s,e,t){var i=s.__transition,n;i[e]=t,t.timer=rv(r,0,t.time);function r(h){t.state=Wp,t.timer.restart(o,t.delay,t.time),t.delay<=h&&o(h-t.delay)}function o(h){var u,c,d,f;if(t.state!==Wp)return l();for(u in i)if(f=i[u],f.name===t.name){if(f.state===Ka)return Vp(o);f.state===Up?(f.state=Za,f.timer.stop(),f.on.call("interrupt",s,s.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=Za,f.timer.stop(),f.on.call("cancel",s,s.__data__,f.index,f.group),delete i[u])}if(Vp(function(){t.state===Ka&&(t.state=Up,t.timer.restart(a,t.delay,t.time),a(h))}),t.state=tc,t.on.call("start",s,s.__data__,t.index,t.group),t.state===tc){for(t.state=Ka,n=new Array(d=t.tween.length),u=0,c=-1;u<d;++u)(f=t.tween[u].value.call(s,s.__data__,t.index,t.group))&&(n[++c]=f);n.length=c+1}}function a(h){for(var u=h<t.duration?t.ease.call(null,h/t.duration):(t.timer.restart(l),t.state=ic,1),c=-1,d=n.length;++c<d;)n[c].call(s,u);t.state===ic&&(t.on.call("end",s,s.__data__,t.index,t.group),l())}function l(){t.state=Za,t.timer.stop(),delete i[e];for(var h in i)return;delete s.__transition}}function qa(s,e){var t=s.__transition,i,n,r=!0,o;if(t){e=e==null?null:e+"";for(o in t){if((i=t[o]).name!==e){r=!1;continue}n=i.state>tc&&i.state<ic,i.state=Za,i.timer.stop(),i.on.call(n?"interrupt":"cancel",s,s.__data__,i.index,i.group),delete t[o]}r&&delete s.__transition}}function FP(s){return this.each(function(){qa(this,s)})}function DP(s,e){var t,i;return function(){var n=Xi(this,s),r=n.tween;if(r!==t){i=t=r;for(var o=0,a=i.length;o<a;++o)if(i[o].name===e){i=i.slice(),i.splice(o,1);break}}n.tween=i}}function kP(s,e,t){var i,n;if(typeof t!="function")throw new Error;return function(){var r=Xi(this,s),o=r.tween;if(o!==i){n=(i=o).slice();for(var a={name:e,value:t},l=0,h=n.length;l<h;++l)if(n[l].name===e){n[l]=a;break}l===h&&n.push(a)}r.tween=n}}function NP(s,e){var t=this._id;if(s+="",arguments.length<2){for(var i=Ti(this.node(),t).tween,n=0,r=i.length,o;n<r;++n)if((o=i[n]).name===s)return o.value;return null}return this.each((e==null?DP:kP)(t,s,e))}function vf(s,e,t){var i=s._id;return s.each(function(){var n=Xi(this,i);(n.value||(n.value={}))[e]=t.apply(this,arguments)}),function(n){return Ti(n,i).value[e]}}function av(s,e){var t;return(typeof e=="number"?mi:e instanceof Os?Al:(t=Os(e))?(e=t,Al):Qy)(s,e)}function zP(s){return function(){this.removeAttribute(s)}}function GP(s){return function(){this.removeAttributeNS(s.space,s.local)}}function HP(s,e,t){var i,n=t+"",r;return function(){var o=this.getAttribute(s);return o===n?null:o===i?r:r=e(i=o,t)}}function BP(s,e,t){var i,n=t+"",r;return function(){var o=this.getAttributeNS(s.space,s.local);return o===n?null:o===i?r:r=e(i=o,t)}}function VP(s,e,t){var i,n,r;return function(){var o,a=t(this),l;return a==null?void this.removeAttribute(s):(o=this.getAttribute(s),l=a+"",o===l?null:o===i&&l===n?r:(n=l,r=e(i=o,a)))}}function WP(s,e,t){var i,n,r;return function(){var o,a=t(this),l;return a==null?void this.removeAttributeNS(s.space,s.local):(o=this.getAttributeNS(s.space,s.local),l=a+"",o===l?null:o===i&&l===n?r:(n=l,r=e(i=o,a)))}}function UP(s,e){var t=wh(s),i=t==="transform"?EP:av;return this.attrTween(s,typeof e=="function"?(t.local?WP:VP)(t,i,vf(this,"attr."+s,e)):e==null?(t.local?GP:zP)(t):(t.local?BP:HP)(t,i,e))}function jP(s,e){return function(t){this.setAttribute(s,e.call(this,t))}}function YP(s,e){return function(t){this.setAttributeNS(s.space,s.local,e.call(this,t))}}function XP(s,e){var t,i;function n(){var r=e.apply(this,arguments);return r!==i&&(t=(i=r)&&YP(s,r)),t}return n._value=e,n}function $P(s,e){var t,i;function n(){var r=e.apply(this,arguments);return r!==i&&(t=(i=r)&&jP(s,r)),t}return n._value=e,n}function KP(s,e){var t="attr."+s;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var i=wh(s);return this.tween(t,(i.local?XP:$P)(i,e))}function ZP(s,e){return function(){yf(this,s).delay=+e.apply(this,arguments)}}function qP(s,e){return e=+e,function(){yf(this,s).delay=e}}function JP(s){var e=this._id;return arguments.length?this.each((typeof s=="function"?ZP:qP)(e,s)):Ti(this.node(),e).delay}function QP(s,e){return function(){Xi(this,s).duration=+e.apply(this,arguments)}}function eI(s,e){return e=+e,function(){Xi(this,s).duration=e}}function tI(s){var e=this._id;return arguments.length?this.each((typeof s=="function"?QP:eI)(e,s)):Ti(this.node(),e).duration}function iI(s,e){if(typeof e!="function")throw new Error;return function(){Xi(this,s).ease=e}}function nI(s){var e=this._id;return arguments.length?this.each(iI(e,s)):Ti(this.node(),e).ease}function sI(s,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;Xi(this,s).ease=t}}function rI(s){if(typeof s!="function")throw new Error;return this.each(sI(this._id,s))}function oI(s){typeof s!="function"&&(s=zy(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var r=e[n],o=r.length,a=i[n]=[],l,h=0;h<o;++h)(l=r[h])&&s.call(l,l.__data__,h,r)&&a.push(l);return new Cn(i,this._parents,this._name,this._id)}function aI(s){if(s._id!==this._id)throw new Error;for(var e=this._groups,t=s._groups,i=e.length,n=t.length,r=Math.min(i,n),o=new Array(i),a=0;a<r;++a)for(var l=e[a],h=t[a],u=l.length,c=o[a]=new Array(u),d,f=0;f<u;++f)(d=l[f]||h[f])&&(c[f]=d);for(;a<i;++a)o[a]=e[a];return new Cn(o,this._parents,this._name,this._id)}function lI(s){return(s+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function hI(s,e,t){var i,n,r=lI(e)?yf:Xi;return function(){var o=r(this,s),a=o.on;a!==i&&(n=(i=a).copy()).on(e,t),o.on=n}}function uI(s,e){var t=this._id;return arguments.length<2?Ti(this.node(),t).on.on(s):this.each(hI(t,s,e))}function cI(s){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==s)return;e&&e.removeChild(this)}}function dI(){return this.on("end.remove",cI(this._id))}function fI(s){var e=this._name,t=this._id;typeof s!="function"&&(s=ff(s));for(var i=this._groups,n=i.length,r=new Array(n),o=0;o<n;++o)for(var a=i[o],l=a.length,h=r[o]=new Array(l),u,c,d=0;d<l;++d)(u=a[d])&&(c=s.call(u,u.__data__,d,a))&&("__data__"in u&&(c.__data__=u.__data__),h[d]=c,Ch(h[d],e,t,d,h,Ti(u,t)));return new Cn(r,this._parents,e,t)}function gI(s){var e=this._name,t=this._id;typeof s!="function"&&(s=Ny(s));for(var i=this._groups,n=i.length,r=[],o=[],a=0;a<n;++a)for(var l=i[a],h=l.length,u,c=0;c<h;++c)if(u=l[c]){for(var d=s.call(u,u.__data__,c,l),f,g=Ti(u,t),p=0,y=d.length;p<y;++p)(f=d[p])&&Ch(f,e,t,p,d,g);r.push(d),o.push(u)}return new Cn(r,o,e,t)}var pI=da.prototype.constructor;function mI(){return new pI(this._groups,this._parents)}function bI(s,e){var t,i,n;return function(){var r=Pr(this,s),o=(this.style.removeProperty(s),Pr(this,s));return r===o?null:r===t&&o===i?n:n=e(t=r,i=o)}}function lv(s){return function(){this.style.removeProperty(s)}}function yI(s,e,t){var i,n=t+"",r;return function(){var o=Pr(this,s);return o===n?null:o===i?r:r=e(i=o,t)}}function vI(s,e,t){var i,n,r;return function(){var o=Pr(this,s),a=t(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(s),Pr(this,s))),o===l?null:o===i&&l===n?r:(n=l,r=e(i=o,a))}}function wI(s,e){var t,i,n,r="style."+e,o="end."+r,a;return function(){var l=Xi(this,s),h=l.on,u=l.value[r]==null?a||(a=lv(e)):void 0;(h!==t||n!==u)&&(i=(t=h).copy()).on(o,n=u),l.on=i}}function _I(s,e,t){var i=(s+="")=="transform"?_P:av;return e==null?this.styleTween(s,bI(s,i)).on("end.style."+s,lv(s)):typeof e=="function"?this.styleTween(s,vI(s,i,vf(this,"style."+s,e))).each(wI(this._id,s)):this.styleTween(s,yI(s,i,e),t).on("end.style."+s,null)}function EI(s,e,t){return function(i){this.style.setProperty(s,e.call(this,i),t)}}function CI(s,e,t){var i,n;function r(){var o=e.apply(this,arguments);return o!==n&&(i=(n=o)&&EI(s,o,t)),i}return r._value=e,r}function xI(s,e,t){var i="style."+(s+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,CI(s,e,t??""))}function RI(s){return function(){this.textContent=s}}function SI(s){return function(){var e=s(this);this.textContent=e??""}}function TI(s){return this.tween("text",typeof s=="function"?SI(vf(this,"text",s)):RI(s==null?"":s+""))}function MI(s){return function(e){this.textContent=s.call(this,e)}}function LI(s){var e,t;function i(){var n=s.apply(this,arguments);return n!==t&&(e=(t=n)&&MI(n)),e}return i._value=s,i}function AI(s){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(s==null)return this.tween(e,null);if(typeof s!="function")throw new Error;return this.tween(e,LI(s))}function PI(){for(var s=this._name,e=this._id,t=hv(),i=this._groups,n=i.length,r=0;r<n;++r)for(var o=i[r],a=o.length,l,h=0;h<a;++h)if(l=o[h]){var u=Ti(l,e);Ch(l,s,t,h,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Cn(i,this._parents,s,t)}function II(){var s,e,t=this,i=t._id,n=t.size();return new Promise(function(r,o){var a={value:o},l={value:function(){--n===0&&r()}};t.each(function(){var h=Xi(this,i),u=h.on;u!==s&&(e=(s=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),h.on=e}),n===0&&r()})}var OI=0;function Cn(s,e,t,i){this._groups=s,this._parents=e,this._name=t,this._id=i}function hv(){return++OI}var tn=da.prototype;Cn.prototype={constructor:Cn,select:fI,selectAll:gI,selectChild:tn.selectChild,selectChildren:tn.selectChildren,filter:oI,merge:aI,selection:mI,transition:PI,call:tn.call,nodes:tn.nodes,node:tn.node,size:tn.size,empty:tn.empty,each:tn.each,on:uI,attr:UP,attrTween:KP,style:_I,styleTween:xI,text:TI,textTween:AI,remove:dI,tween:NP,delay:JP,duration:tI,ease:nI,easeVarying:rI,end:II,[Symbol.iterator]:tn[Symbol.iterator]};function FI(s){return((s*=2)<=1?s*s*s:(s-=2)*s*s+2)/2}var DI={time:null,delay:0,duration:250,ease:FI};function kI(s,e){for(var t;!(t=s.__transition)||!(t=t[e]);)if(!(s=s.parentNode))throw new Error(`transition ${e} not found`);return t}function NI(s){var e,t;s instanceof Cn?(e=s._id,s=s._name):(e=hv(),(t=DI).time=bf(),s=s==null?null:s+"");for(var i=this._groups,n=i.length,r=0;r<n;++r)for(var o=i[r],a=o.length,l,h=0;h<a;++h)(l=o[h])&&Ch(l,s,e,h,o,t||kI(l,e));return new Cn(i,this._parents,s,e)}da.prototype.interrupt=FP;da.prototype.transition=NI;const nc=Math.PI,sc=2*nc,us=1e-6,zI=sc-us;function uv(s){this._+=s[0];for(let e=1,t=s.length;e<t;++e)this._+=arguments[e]+s[e]}function GI(s){let e=Math.floor(s);if(!(e>=0))throw new Error(`invalid digits: ${s}`);if(e>15)return uv;const t=10**e;return function(i){this._+=i[0];for(let n=1,r=i.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+i[n]}}class HI{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?uv:GI(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,i,n){this._append`Q${+e},${+t},${this._x1=+i},${this._y1=+n}`}bezierCurveTo(e,t,i,n,r,o){this._append`C${+e},${+t},${+i},${+n},${this._x1=+r},${this._y1=+o}`}arcTo(e,t,i,n,r){if(e=+e,t=+t,i=+i,n=+n,r=+r,r<0)throw new Error(`negative radius: ${r}`);let o=this._x1,a=this._y1,l=i-e,h=n-t,u=o-e,c=a-t,d=u*u+c*c;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(d>us)if(!(Math.abs(c*l-h*u)>us)||!r)this._append`L${this._x1=e},${this._y1=t}`;else{let f=i-o,g=n-a,p=l*l+h*h,y=f*f+g*g,b=Math.sqrt(p),v=Math.sqrt(d),_=r*Math.tan((nc-Math.acos((p+d-y)/(2*b*v)))/2),m=_/v,E=_/b;Math.abs(m-1)>us&&this._append`L${e+m*u},${t+m*c}`,this._append`A${r},${r},0,0,${+(c*f>u*g)},${this._x1=e+E*l},${this._y1=t+E*h}`}}arc(e,t,i,n,r,o){if(e=+e,t=+t,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(n),l=i*Math.sin(n),h=e+a,u=t+l,c=1^o,d=o?n-r:r-n;this._x1===null?this._append`M${h},${u}`:(Math.abs(this._x1-h)>us||Math.abs(this._y1-u)>us)&&this._append`L${h},${u}`,i&&(d<0&&(d=d%sc+sc),d>zI?this._append`A${i},${i},0,1,${c},${e-a},${t-l}A${i},${i},0,1,${c},${this._x1=h},${this._y1=u}`:d>us&&this._append`A${i},${i},0,${+(d>=nc)},${c},${this._x1=e+i*Math.cos(r)},${this._y1=t+i*Math.sin(r)}`)}rect(e,t,i,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${i=+i}v${+n}h${-i}Z`}toString(){return this._}}function BI(s){return Math.abs(s=Math.round(s))>=1e21?s.toLocaleString("en").replace(/,/g,""):s.toString(10)}function Fl(s,e){if((t=(s=e?s.toExponential(e-1):s.toExponential()).indexOf("e"))<0)return null;var t,i=s.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+s.slice(t+1)]}function Or(s){return s=Fl(Math.abs(s)),s?s[1]:NaN}function VI(s,e){return function(t,i){for(var n=t.length,r=[],o=0,a=s[0],l=0;n>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),r.push(t.substring(n-=a,n+a)),!((l+=a+1)>i));)a=s[o=(o+1)%s.length];return r.reverse().join(e)}}function WI(s){return function(e){return e.replace(/[0-9]/g,function(t){return s[+t]})}}var UI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Dl(s){if(!(e=UI.exec(s)))throw new Error("invalid format: "+s);var e;return new wf({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Dl.prototype=wf.prototype;function wf(s){this.fill=s.fill===void 0?" ":s.fill+"",this.align=s.align===void 0?">":s.align+"",this.sign=s.sign===void 0?"-":s.sign+"",this.symbol=s.symbol===void 0?"":s.symbol+"",this.zero=!!s.zero,this.width=s.width===void 0?void 0:+s.width,this.comma=!!s.comma,this.precision=s.precision===void 0?void 0:+s.precision,this.trim=!!s.trim,this.type=s.type===void 0?"":s.type+""}wf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function jI(s){e:for(var e=s.length,t=1,i=-1,n;t<e;++t)switch(s[t]){case".":i=n=t;break;case"0":i===0&&(i=t),n=t;break;default:if(!+s[t])break e;i>0&&(i=0);break}return i>0?s.slice(0,i)+s.slice(n+1):s}var cv;function YI(s,e){var t=Fl(s,e);if(!t)return s+"";var i=t[0],n=t[1],r=n-(cv=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,o=i.length;return r===o?i:r>o?i+new Array(r-o+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+Fl(s,Math.max(0,e+r-1))[0]}function jp(s,e){var t=Fl(s,e);if(!t)return s+"";var i=t[0],n=t[1];return n<0?"0."+new Array(-n).join("0")+i:i.length>n+1?i.slice(0,n+1)+"."+i.slice(n+1):i+new Array(n-i.length+2).join("0")}const Yp={"%":(s,e)=>(s*100).toFixed(e),b:s=>Math.round(s).toString(2),c:s=>s+"",d:BI,e:(s,e)=>s.toExponential(e),f:(s,e)=>s.toFixed(e),g:(s,e)=>s.toPrecision(e),o:s=>Math.round(s).toString(8),p:(s,e)=>jp(s*100,e),r:jp,s:YI,X:s=>Math.round(s).toString(16).toUpperCase(),x:s=>Math.round(s).toString(16)};function Xp(s){return s}var $p=Array.prototype.map,Kp=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function XI(s){var e=s.grouping===void 0||s.thousands===void 0?Xp:VI($p.call(s.grouping,Number),s.thousands+""),t=s.currency===void 0?"":s.currency[0]+"",i=s.currency===void 0?"":s.currency[1]+"",n=s.decimal===void 0?".":s.decimal+"",r=s.numerals===void 0?Xp:WI($p.call(s.numerals,String)),o=s.percent===void 0?"%":s.percent+"",a=s.minus===void 0?"":s.minus+"",l=s.nan===void 0?"NaN":s.nan+"";function h(c){c=Dl(c);var d=c.fill,f=c.align,g=c.sign,p=c.symbol,y=c.zero,b=c.width,v=c.comma,_=c.precision,m=c.trim,E=c.type;E==="n"?(v=!0,E="g"):Yp[E]||(_===void 0&&(_=12),m=!0,E="g"),(y||d==="0"&&f==="=")&&(y=!0,d="0",f="=");var C=p==="$"?t:p==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",x=p==="$"?i:/[%p]/.test(E)?o:"",w=Yp[E],R=/[defgprs%]/.test(E);_=_===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function I(T){var A=C,F=x,S,O,M;if(E==="c")F=w(T)+F,T="";else{T=+T;var D=T<0||1/T<0;if(T=isNaN(T)?l:w(Math.abs(T),_),m&&(T=jI(T)),D&&+T==0&&g!=="+"&&(D=!1),A=(D?g==="("?g:a:g==="-"||g==="("?"":g)+A,F=(E==="s"?Kp[8+cv/3]:"")+F+(D&&g==="("?")":""),R){for(S=-1,O=T.length;++S<O;)if(M=T.charCodeAt(S),48>M||M>57){F=(M===46?n+T.slice(S+1):T.slice(S))+F,T=T.slice(0,S);break}}}v&&!y&&(T=e(T,1/0));var H=A.length+T.length+F.length,j=H<b?new Array(b-H+1).join(d):"";switch(v&&y&&(T=e(j+T,j.length?b-F.length:1/0),j=""),f){case"<":T=A+T+F+j;break;case"=":T=A+j+T+F;break;case"^":T=j.slice(0,H=j.length>>1)+A+T+F+j.slice(H);break;default:T=j+A+T+F;break}return r(T)}return I.toString=function(){return c+""},I}function u(c,d){var f=h((c=Dl(c),c.type="f",c)),g=Math.max(-8,Math.min(8,Math.floor(Or(d)/3)))*3,p=Math.pow(10,-g),y=Kp[8+g/3];return function(b){return f(p*b)+y}}return{format:h,formatPrefix:u}}var Ga,dv,fv;$I({thousands:",",grouping:[3],currency:["$",""]});function $I(s){return Ga=XI(s),dv=Ga.format,fv=Ga.formatPrefix,Ga}function KI(s){return Math.max(0,-Or(Math.abs(s)))}function ZI(s,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Or(e)/3)))*3-Or(Math.abs(s)))}function qI(s,e){return s=Math.abs(s),e=Math.abs(e)-s,Math.max(0,Or(e)-Or(s))+1}function gv(s,e){switch(arguments.length){case 0:break;case 1:this.range(s);break;default:this.range(e).domain(s);break}return this}function JI(s,e){switch(arguments.length){case 0:break;case 1:{typeof s=="function"?this.interpolator(s):this.range(s);break}default:{this.domain(s),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Zp=Symbol("implicit");function QI(){var s=new Sp,e=[],t=[],i=Zp;function n(r){let o=s.get(r);if(o===void 0){if(i!==Zp)return i;s.set(r,o=e.push(r)-1)}return t[o%t.length]}return n.domain=function(r){if(!arguments.length)return e.slice();e=[],s=new Sp;for(const o of r)s.has(o)||s.set(o,e.push(o)-1);return n},n.range=function(r){return arguments.length?(t=Array.from(r),n):t.slice()},n.unknown=function(r){return arguments.length?(i=r,n):i},n.copy=function(){return QI(e,t).unknown(i)},gv.apply(n,arguments),n}function eO(s){return function(){return s}}function tO(s){return+s}var qp=[0,1];function Xn(s){return s}function rc(s,e){return(e-=s=+s)?function(t){return(t-s)/e}:eO(isNaN(e)?NaN:.5)}function iO(s,e){var t;return s>e&&(t=s,s=e,e=t),function(i){return Math.max(s,Math.min(e,i))}}function nO(s,e,t){var i=s[0],n=s[1],r=e[0],o=e[1];return n<i?(i=rc(n,i),r=t(o,r)):(i=rc(i,n),r=t(r,o)),function(a){return r(i(a))}}function sO(s,e,t){var i=Math.min(s.length,e.length)-1,n=new Array(i),r=new Array(i),o=-1;for(s[i]<s[0]&&(s=s.slice().reverse(),e=e.slice().reverse());++o<i;)n[o]=rc(s[o],s[o+1]),r[o]=t(e[o],e[o+1]);return function(a){var l=jM(s,a,1,i)-1;return r[l](n[l](a))}}function rO(s,e){return e.domain(s.domain()).range(s.range()).interpolate(s.interpolate()).clamp(s.clamp()).unknown(s.unknown())}function oO(){var s=qp,e=qp,t=_h,i,n,r,o=Xn,a,l,h;function u(){var d=Math.min(s.length,e.length);return o!==Xn&&(o=iO(s[0],s[d-1])),a=d>2?sO:nO,l=h=null,c}function c(d){return d==null||isNaN(d=+d)?r:(l||(l=a(s.map(i),e,t)))(i(o(d)))}return c.invert=function(d){return o(n((h||(h=a(e,s.map(i),mi)))(d)))},c.domain=function(d){return arguments.length?(s=Array.from(d,tO),u()):s.slice()},c.range=function(d){return arguments.length?(e=Array.from(d),u()):e.slice()},c.rangeRound=function(d){return e=Array.from(d),t=ev,u()},c.clamp=function(d){return arguments.length?(o=d?!0:Xn,u()):o!==Xn},c.interpolate=function(d){return arguments.length?(t=d,u()):t},c.unknown=function(d){return arguments.length?(r=d,c):r},function(d,f){return i=d,n=f,u()}}function aO(){return oO()(Xn,Xn)}function lO(s,e,t,i){var n=QM(s,e,t),r;switch(i=Dl(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(s),Math.abs(e));return i.precision==null&&!isNaN(r=ZI(n,o))&&(i.precision=r),fv(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(r=qI(n,Math.max(Math.abs(s),Math.abs(e))))&&(i.precision=r-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(r=KI(n))&&(i.precision=r-(i.type==="%")*2);break}}return dv(i)}function pv(s){var e=s.domain;return s.ticks=function(t){var i=e();return JM(i[0],i[i.length-1],t??10)},s.tickFormat=function(t,i){var n=e();return lO(n[0],n[n.length-1],t??10,i)},s.nice=function(t){t==null&&(t=10);var i=e(),n=0,r=i.length-1,o=i[n],a=i[r],l,h,u=10;for(a<o&&(h=o,o=a,a=h,h=n,n=r,r=h);u-- >0;){if(h=$u(o,a,t),h===l)return i[n]=o,i[r]=a,e(i);if(h>0)o=Math.floor(o/h)*h,a=Math.ceil(a/h)*h;else if(h<0)o=Math.ceil(o*h)/h,a=Math.floor(a*h)/h;else break;l=h}return s},s}function hO(){var s=aO();return s.copy=function(){return rO(s,hO())},gv.apply(s,arguments),pv(s)}function uO(){var s=0,e=1,t,i,n,r,o=Xn,a=!1,l;function h(c){return c==null||isNaN(c=+c)?l:o(n===0?.5:(c=(r(c)-t)*n,a?Math.max(0,Math.min(1,c)):c))}h.domain=function(c){return arguments.length?([s,e]=c,t=r(s=+s),i=r(e=+e),n=t===i?0:1/(i-t),h):[s,e]},h.clamp=function(c){return arguments.length?(a=!!c,h):a},h.interpolator=function(c){return arguments.length?(o=c,h):o};function u(c){return function(d){var f,g;return arguments.length?([f,g]=d,o=c(f,g),h):[o(0),o(1)]}}return h.range=u(_h),h.rangeRound=u(ev),h.unknown=function(c){return arguments.length?(l=c,h):l},function(c){return r=c,t=c(s),i=c(e),n=t===i?0:1/(i-t),h}}function cO(s,e){return e.domain(s.domain()).interpolator(s.interpolator()).clamp(s.clamp()).unknown(s.unknown())}function dO(){var s=pv(uO()(Xn));return s.copy=function(){return cO(s,dO())},JI.apply(s,arguments)}function Hs(s){for(var e=s.length/6|0,t=new Array(e),i=0;i<e;)t[i]="#"+s.slice(i*6,++i*6);return t}const _f=s=>cP(s[s.length-1]);var fO=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Hs);const Zk=_f(fO);var gO=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Hs);const qk=_f(gO);var pO=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Hs);const Jk=_f(pO);function xh(s){var e=s.length;return function(t){return s[Math.max(0,Math.min(e-1,Math.floor(t*e)))]}}const Qk=xh(Hs("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var eN=xh(Hs("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));xh(Hs("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));xh(Hs("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Zs(s){return function(){return s}}function mO(s){let e=3;return s.digits=function(t){if(!arguments.length)return e;if(t==null)e=null;else{const i=Math.floor(t);if(!(i>=0))throw new RangeError(`invalid digits: ${t}`);e=i}return s},()=>new HI(e)}function bO(s){return typeof s=="object"&&"length"in s?s:Array.from(s)}function mv(s){this._context=s}mv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(s,e){switch(s=+s,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(s,e):this._context.moveTo(s,e);break;case 1:this._point=2;default:this._context.lineTo(s,e);break}}};function yO(s){return new mv(s)}function vO(s){return s[0]}function wO(s){return s[1]}function tN(s,e){var t=Zs(!0),i=null,n=yO,r=null,o=mO(a);s=typeof s=="function"?s:s===void 0?vO:Zs(s),e=typeof e=="function"?e:e===void 0?wO:Zs(e);function a(l){var h,u=(l=bO(l)).length,c,d=!1,f;for(i==null&&(r=n(f=o())),h=0;h<=u;++h)!(h<u&&t(c=l[h],h,l))===d&&((d=!d)?r.lineStart():r.lineEnd()),d&&r.point(+s(c,h,l),+e(c,h,l));if(f)return r=null,f+""||null}return a.x=function(l){return arguments.length?(s=typeof l=="function"?l:Zs(+l),a):s},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:Zs(+l),a):e},a.defined=function(l){return arguments.length?(t=typeof l=="function"?l:Zs(!!l),a):t},a.curve=function(l){return arguments.length?(n=l,i!=null&&(r=n(i)),a):n},a.context=function(l){return arguments.length?(l==null?i=r=null:r=n(i=l),a):i},a}const Ha=s=>()=>s;function _O(s,{sourceEvent:e,target:t,transform:i,dispatch:n}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:n}})}function fn(s,e,t){this.k=s,this.x=e,this.y=t}fn.prototype={constructor:fn,scale:function(s){return s===1?this:new fn(this.k*s,this.x,this.y)},translate:function(s,e){return s===0&e===0?this:new fn(this.k,this.x+this.k*s,this.y+this.k*e)},apply:function(s){return[s[0]*this.k+this.x,s[1]*this.k+this.y]},applyX:function(s){return s*this.k+this.x},applyY:function(s){return s*this.k+this.y},invert:function(s){return[(s[0]-this.x)/this.k,(s[1]-this.y)/this.k]},invertX:function(s){return(s-this.x)/this.k},invertY:function(s){return(s-this.y)/this.k},rescaleX:function(s){return s.copy().domain(s.range().map(this.invertX,this).map(s.invert,s))},rescaleY:function(s){return s.copy().domain(s.range().map(this.invertY,this).map(s.invert,s))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ef=new fn(1,0,0);EO.prototype=fn.prototype;function EO(s){for(;!s.__zoom;)if(!(s=s.parentNode))return Ef;return s.__zoom}function ru(s){s.stopImmediatePropagation()}function eo(s){s.preventDefault(),s.stopImmediatePropagation()}function CO(s){return(!s.ctrlKey||s.type==="wheel")&&!s.button}function xO(){var s=this;return s instanceof SVGElement?(s=s.ownerSVGElement||s,s.hasAttribute("viewBox")?(s=s.viewBox.baseVal,[[s.x,s.y],[s.x+s.width,s.y+s.height]]):[[0,0],[s.width.baseVal.value,s.height.baseVal.value]]):[[0,0],[s.clientWidth,s.clientHeight]]}function Jp(){return this.__zoom||Ef}function RO(s){return-s.deltaY*(s.deltaMode===1?.05:s.deltaMode?1:.002)*(s.ctrlKey?10:1)}function SO(){return navigator.maxTouchPoints||"ontouchstart"in this}function TO(s,e,t){var i=s.invertX(e[0][0])-t[0][0],n=s.invertX(e[1][0])-t[1][0],r=s.invertY(e[0][1])-t[0][1],o=s.invertY(e[1][1])-t[1][1];return s.translate(n>i?(i+n)/2:Math.min(0,i)||Math.max(0,n),o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o))}function iN(){var s=CO,e=xO,t=TO,i=RO,n=SO,r=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=SP,h=vh("start","zoom","end"),u,c,d,f=500,g=150,p=0,y=10;function b(S){S.property("__zoom",Jp).on("wheel.zoom",w,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",I).filter(n).on("touchstart.zoom",T).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(S,O,M,D){var H=S.selection?S.selection():S;H.property("__zoom",Jp),S!==H?E(S,O,M,D):H.interrupt().each(function(){C(this,arguments).event(D).start().zoom(null,typeof O=="function"?O.apply(this,arguments):O).end()})},b.scaleBy=function(S,O,M,D){b.scaleTo(S,function(){var H=this.__zoom.k,j=typeof O=="function"?O.apply(this,arguments):O;return H*j},M,D)},b.scaleTo=function(S,O,M,D){b.transform(S,function(){var H=e.apply(this,arguments),j=this.__zoom,V=M==null?m(H):typeof M=="function"?M.apply(this,arguments):M,Y=j.invert(V),K=typeof O=="function"?O.apply(this,arguments):O;return t(_(v(j,K),V,Y),H,o)},M,D)},b.translateBy=function(S,O,M,D){b.transform(S,function(){return t(this.__zoom.translate(typeof O=="function"?O.apply(this,arguments):O,typeof M=="function"?M.apply(this,arguments):M),e.apply(this,arguments),o)},null,D)},b.translateTo=function(S,O,M,D,H){b.transform(S,function(){var j=e.apply(this,arguments),V=this.__zoom,Y=D==null?m(j):typeof D=="function"?D.apply(this,arguments):D;return t(Ef.translate(Y[0],Y[1]).scale(V.k).translate(typeof O=="function"?-O.apply(this,arguments):-O,typeof M=="function"?-M.apply(this,arguments):-M),j,o)},D,H)};function v(S,O){return O=Math.max(r[0],Math.min(r[1],O)),O===S.k?S:new fn(O,S.x,S.y)}function _(S,O,M){var D=O[0]-M[0]*S.k,H=O[1]-M[1]*S.k;return D===S.x&&H===S.y?S:new fn(S.k,D,H)}function m(S){return[(+S[0][0]+ +S[1][0])/2,(+S[0][1]+ +S[1][1])/2]}function E(S,O,M,D){S.on("start.zoom",function(){C(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(D).end()}).tween("zoom",function(){var H=this,j=arguments,V=C(H,j).event(D),Y=e.apply(H,j),K=M==null?m(Y):typeof M=="function"?M.apply(H,j):M,Ee=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),z=H.__zoom,me=typeof O=="function"?O.apply(H,j):O,ye=l(z.invert(K).concat(Ee/z.k),me.invert(K).concat(Ee/me.k));return function(ve){if(ve===1)ve=me;else{var Ae=ye(ve),Xe=Ee/Ae[2];ve=new fn(Xe,K[0]-Ae[0]*Xe,K[1]-Ae[1]*Xe)}V.zoom(null,ve)}})}function C(S,O,M){return!M&&S.__zooming||new x(S,O)}function x(S,O){this.that=S,this.args=O,this.active=0,this.sourceEvent=null,this.extent=e.apply(S,O),this.taps=0}x.prototype={event:function(S){return S&&(this.sourceEvent=S),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(S,O){return this.mouse&&S!=="mouse"&&(this.mouse[1]=O.invert(this.mouse[0])),this.touch0&&S!=="touch"&&(this.touch0[1]=O.invert(this.touch0[0])),this.touch1&&S!=="touch"&&(this.touch1[1]=O.invert(this.touch1[0])),this.that.__zoom=O,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(S){var O=dn(this.that).datum();h.call(S,this.that,new _O(S,{sourceEvent:this.sourceEvent,target:b,type:S,transform:this.that.__zoom,dispatch:h}),O)}};function w(S,...O){if(!s.apply(this,arguments))return;var M=C(this,O).event(S),D=this.__zoom,H=Math.max(r[0],Math.min(r[1],D.k*Math.pow(2,i.apply(this,arguments)))),j=on(S);if(M.wheel)(M.mouse[0][0]!==j[0]||M.mouse[0][1]!==j[1])&&(M.mouse[1]=D.invert(M.mouse[0]=j)),clearTimeout(M.wheel);else{if(D.k===H)return;M.mouse=[j,D.invert(j)],qa(this),M.start()}eo(S),M.wheel=setTimeout(V,g),M.zoom("mouse",t(_(v(D,H),M.mouse[0],M.mouse[1]),M.extent,o));function V(){M.wheel=null,M.end()}}function R(S,...O){if(d||!s.apply(this,arguments))return;var M=S.currentTarget,D=C(this,O,!0).event(S),H=dn(S.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",Ee,!0),j=on(S,M),V=S.clientX,Y=S.clientY;$y(S.view),ru(S),D.mouse=[j,this.__zoom.invert(j)],qa(this),D.start();function K(z){if(eo(z),!D.moved){var me=z.clientX-V,ye=z.clientY-Y;D.moved=me*me+ye*ye>p}D.event(z).zoom("mouse",t(_(D.that.__zoom,D.mouse[0]=on(z,M),D.mouse[1]),D.extent,o))}function Ee(z){H.on("mousemove.zoom mouseup.zoom",null),Ky(z.view,D.moved),eo(z),D.event(z).end()}}function I(S,...O){if(s.apply(this,arguments)){var M=this.__zoom,D=on(S.changedTouches?S.changedTouches[0]:S,this),H=M.invert(D),j=M.k*(S.shiftKey?.5:2),V=t(_(v(M,j),D,H),e.apply(this,O),o);eo(S),a>0?dn(this).transition().duration(a).call(E,V,D,S):dn(this).call(b.transform,V,D,S)}}function T(S,...O){if(s.apply(this,arguments)){var M=S.touches,D=M.length,H=C(this,O,S.changedTouches.length===D).event(S),j,V,Y,K;for(ru(S),V=0;V<D;++V)Y=M[V],K=on(Y,this),K=[K,this.__zoom.invert(K),Y.identifier],H.touch0?!H.touch1&&H.touch0[2]!==K[2]&&(H.touch1=K,H.taps=0):(H.touch0=K,j=!0,H.taps=1+!!u);u&&(u=clearTimeout(u)),j&&(H.taps<2&&(c=K[0],u=setTimeout(function(){u=null},f)),qa(this),H.start())}}function A(S,...O){if(this.__zooming){var M=C(this,O).event(S),D=S.changedTouches,H=D.length,j,V,Y,K;for(eo(S),j=0;j<H;++j)V=D[j],Y=on(V,this),M.touch0&&M.touch0[2]===V.identifier?M.touch0[0]=Y:M.touch1&&M.touch1[2]===V.identifier&&(M.touch1[0]=Y);if(V=M.that.__zoom,M.touch1){var Ee=M.touch0[0],z=M.touch0[1],me=M.touch1[0],ye=M.touch1[1],ve=(ve=me[0]-Ee[0])*ve+(ve=me[1]-Ee[1])*ve,Ae=(Ae=ye[0]-z[0])*Ae+(Ae=ye[1]-z[1])*Ae;V=v(V,Math.sqrt(ve/Ae)),Y=[(Ee[0]+me[0])/2,(Ee[1]+me[1])/2],K=[(z[0]+ye[0])/2,(z[1]+ye[1])/2]}else if(M.touch0)Y=M.touch0[0],K=M.touch0[1];else return;M.zoom("touch",t(_(V,Y,K),M.extent,o))}}function F(S,...O){if(this.__zooming){var M=C(this,O).event(S),D=S.changedTouches,H=D.length,j,V;for(ru(S),d&&clearTimeout(d),d=setTimeout(function(){d=null},f),j=0;j<H;++j)V=D[j],M.touch0&&M.touch0[2]===V.identifier?delete M.touch0:M.touch1&&M.touch1[2]===V.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(V=on(V,this),Math.hypot(c[0]-V[0],c[1]-V[1])<y)){var Y=dn(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return b.wheelDelta=function(S){return arguments.length?(i=typeof S=="function"?S:Ha(+S),b):i},b.filter=function(S){return arguments.length?(s=typeof S=="function"?S:Ha(!!S),b):s},b.touchable=function(S){return arguments.length?(n=typeof S=="function"?S:Ha(!!S),b):n},b.extent=function(S){return arguments.length?(e=typeof S=="function"?S:Ha([[+S[0][0],+S[0][1]],[+S[1][0],+S[1][1]]]),b):e},b.scaleExtent=function(S){return arguments.length?(r[0]=+S[0],r[1]=+S[1],b):[r[0],r[1]]},b.translateExtent=function(S){return arguments.length?(o[0][0]=+S[0][0],o[1][0]=+S[1][0],o[0][1]=+S[0][1],o[1][1]=+S[1][1],b):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},b.constrain=function(S){return arguments.length?(t=S,b):t},b.duration=function(S){return arguments.length?(a=+S,b):a},b.interpolate=function(S){return arguments.length?(l=S,b):l},b.on=function(){var S=h.on.apply(h,arguments);return S===h?b:S},b.clickDistance=function(S){return arguments.length?(p=(S=+S)*S,b):Math.sqrt(p)},b.tapDistance=function(S){return arguments.length?(y=+S,b):y},b}const Cf=.5;function kl(s){return s instanceof Image||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageBitmap?s:null}function MO(s){return s instanceof Uint8Array||s instanceof Uint8ClampedArray||s instanceof Float32Array||s instanceof DataView?s:null}const LO=new Error("disposed");let qs=null;function AO(s){qs||(qs=We(s.width,s.height,void 0,{willReadFrequently:!0}));const e=qs.canvas,t=s.width;e.width!==t&&(e.width=t);const i=s.height;return e.height!==i&&(e.height=i),qs.clearRect(0,0,t,i),qs.drawImage(s,0,0),qs.getImageData(0,0,t,i).data}const PO=[256,256];class oc extends oa{constructor(e){const t=X.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=kl(this.data_);return e?[e.width,e.height]:PO}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==X.IDLE&&this.state!==X.ERROR)return;this.state=X.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=X.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=X.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(LO),this.controller_=null),super.disposeInternal()}}const IO=10,Qp=.25;class xf{constructor(e,t,i,n,r,o){this.sourceProj_=e,this.targetProj_=t;let a={};const l=Rr(this.targetProj_,this.sourceProj_);this.transformInv_=function(v){const _=v[0]+"/"+v[1];return a[_]||(a[_]=l(v)),a[_]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&_e(n)>=_e(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?_e(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?_e(this.targetProj_.getExtent()):null;const h=is(i),u=$l(i),c=Xl(i),d=Yl(i),f=this.transformInv_(h),g=this.transformInv_(u),p=this.transformInv_(c),y=this.transformInv_(d),b=IO+(o?Math.max(0,Math.ceil(Math.log2(Mo(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,c,d,f,g,p,y,b),this.wrapsXInSource_){let v=1/0;this.triangles_.forEach(function(_,m,E){v=Math.min(v,_.source[0][0],_.source[1][0],_.source[2][0])}),this.triangles_.forEach(_=>{if(Math.max(_.source[0][0],_.source[1][0],_.source[2][0])-v>this.sourceWorldWidth_/2){const m=[[_.source[0][0],_.source[0][1]],[_.source[1][0],_.source[1][1]],[_.source[2][0],_.source[2][1]]];m[0][0]-v>this.sourceWorldWidth_/2&&(m[0][0]-=this.sourceWorldWidth_),m[1][0]-v>this.sourceWorldWidth_/2&&(m[1][0]-=this.sourceWorldWidth_),m[2][0]-v>this.sourceWorldWidth_/2&&(m[2][0]-=this.sourceWorldWidth_);const E=Math.min(m[0][0],m[1][0],m[2][0]);Math.max(m[0][0],m[1][0],m[2][0])-E<this.sourceWorldWidth_/2&&(_.source=m)}})}a={}}addTriangle_(e,t,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[e,t,i]})}addQuad_(e,t,i,n,r,o,a,l,h){const u=To([r,o,a,l]),c=this.sourceWorldWidth_?_e(u)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&c>.5&&c<1;let g=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const y=To([e,t,i,n]);g=_e(y)/this.targetWorldWidth_>Qp||g}!f&&this.sourceProj_.isGlobal()&&c&&(g=c>Qp||g)}if(!g&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!je(u,this.maxSourceExtent_))return;let p=0;if(!g&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(h>0)g=!0;else if(p=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),p!=1&&p!=2&&p!=4&&p!=8)return}if(h>0){if(!g){const y=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(y);let v;f?v=(Zn(r[0],d)+Zn(a[0],d))/2-Zn(b[0],d):v=(r[0]+a[0])/2-b[0];const _=(r[1]+a[1])/2-b[1];g=v*v+_*_>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const y=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(y),v=[(n[0]+e[0])/2,(n[1]+e[1])/2],_=this.transformInv_(v);this.addQuad_(e,t,y,v,r,o,b,_,h-1),this.addQuad_(v,y,i,n,_,b,a,l,h-1)}else{const y=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(y),v=[(i[0]+n[0])/2,(i[1]+n[1])/2],_=this.transformInv_(v);this.addQuad_(e,y,v,n,r,b,_,l,h-1),this.addQuad_(y,t,i,v,b,o,a,_,h-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}p&11||this.addTriangle_(e,i,n,r,a,l),p&14||this.addTriangle_(e,i,t,r,a,o),p&&(p&13||this.addTriangle_(t,n,e,o,l,r),p&7||this.addTriangle_(t,n,i,o,l,a))}calculateSourceExtent(){const e=Kt();return this.triangles_.forEach(function(t,i,n){const r=t.source;po(e,r[0]),po(e,r[1]),po(e,r[2])}),e}getTriangles(){return this.triangles_}}let ou;const vn=[];function em(s,e,t,i,n){s.beginPath(),s.moveTo(0,0),s.lineTo(e,t),s.lineTo(i,n),s.closePath(),s.save(),s.clip(),s.fillRect(0,0,Math.max(e,i)+1,Math.max(t,n)),s.restore()}function au(s,e){return Math.abs(s[e*4]-210)>2||Math.abs(s[e*4+3]-.75*255)>2}function OO(){if(ou===void 0){const s=We(6,6,vn);s.globalCompositeOperation="lighter",s.fillStyle="rgba(210, 0, 0, 0.75)",em(s,4,5,4,0),em(s,4,5,0,5);const e=s.getImageData(0,0,3,3).data;ou=au(e,0)||au(e,4)||au(e,8),As(s),vn.push(s.canvas)}return ou}function jo(s,e,t,i){const n=ql(t,e,s);let r=og(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(r*=o);const a=s.getMetersPerUnit();a!==void 0&&(r/=a);const l=s.getExtent();if(!l||Ms(l,n)){const h=og(s,r,n)/r;isFinite(h)&&h>0&&(r/=h)}return r}function bv(s,e,t,i){const n=Wi(t);let r=jo(s,e,n,i);return(!isFinite(r)||r<=0)&&$c(t,function(o){return r=jo(s,e,o,i),isFinite(r)&&r>0}),r}function Rf(s,e,t,i,n,r,o,a,l,h,u,c,d,f){const g=We(Math.round(t*s),Math.round(t*e),vn);if(c||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(t,t);function p(E){return Math.round(E*t)/t}g.globalCompositeOperation="lighter";const y=Kt();l.forEach(function(E,C,x){Pm(y,E.extent)});let b;const v=t/i,_=(c?1:1+Math.pow(2,-24))/v;if(!d||l.length!==1||h!==0){if(b=We(Math.round(_e(y)*v),Math.round(Ke(y)*v),vn),c||(b.imageSmoothingEnabled=!1),n&&f){const E=(n[0]-y[0])*v,C=-(n[3]-y[3])*v,x=_e(n)*v,w=Ke(n)*v;b.rect(E,C,x,w),b.clip()}l.forEach(function(E,C,x){if(E.image.width>0&&E.image.height>0){if(E.clipExtent){b.save();const A=(E.clipExtent[0]-y[0])*v,F=-(E.clipExtent[3]-y[3])*v,S=_e(E.clipExtent)*v,O=Ke(E.clipExtent)*v;b.rect(c?A:Math.round(A),c?F:Math.round(F),c?S:Math.round(A+S)-Math.round(A),c?O:Math.round(F+O)-Math.round(F)),b.clip()}const w=(E.extent[0]-y[0])*v,R=-(E.extent[3]-y[3])*v,I=_e(E.extent)*v,T=Ke(E.extent)*v;b.drawImage(E.image,h,h,E.image.width-2*h,E.image.height-2*h,c?w:Math.round(w),c?R:Math.round(R),c?I:Math.round(w+I)-Math.round(w),c?T:Math.round(R+T)-Math.round(R)),E.clipExtent&&b.restore()}})}const m=is(o);return a.getTriangles().forEach(function(E,C,x){const w=E.source,R=E.target;let I=w[0][0],T=w[0][1],A=w[1][0],F=w[1][1],S=w[2][0],O=w[2][1];const M=p((R[0][0]-m[0])/r),D=p(-(R[0][1]-m[1])/r),H=p((R[1][0]-m[0])/r),j=p(-(R[1][1]-m[1])/r),V=p((R[2][0]-m[0])/r),Y=p(-(R[2][1]-m[1])/r),K=I,Ee=T;I=0,T=0,A-=K,F-=Ee,S-=K,O-=Ee;const z=[[A,F,0,0,H-M],[S,O,0,0,V-M],[0,0,A,F,j-D],[0,0,S,O,Y-D]],me=s_(z);if(!me)return;if(g.save(),g.beginPath(),OO()||!c){g.moveTo(H,j);const ve=4,Ae=M-H,Xe=D-j;for(let Ue=0;Ue<ve;Ue++)g.lineTo(H+p((Ue+1)*Ae/ve),j+p(Ue*Xe/(ve-1))),Ue!=ve-1&&g.lineTo(H+p((Ue+1)*Ae/ve),j+p((Ue+1)*Xe/(ve-1)));g.lineTo(V,Y)}else g.moveTo(H,j),g.lineTo(M,D),g.lineTo(V,Y);g.clip(),g.transform(me[0],me[2],me[1],me[3],M,D),g.translate(y[0]-K,y[3]-Ee);let ye;if(b)ye=b.canvas,g.scale(_,-_);else{const ve=l[0],Ae=ve.extent;ye=ve.image,g.scale(_e(Ae)/ye.width,-Ke(Ae)/ye.height)}g.drawImage(ye,0,0),g.restore()}),b&&(As(b),vn.push(b.canvas)),u&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(E,C,x){const w=E.target,R=(w[0][0]-m[0])/r,I=-(w[0][1]-m[1])/r,T=(w[1][0]-m[0])/r,A=-(w[1][1]-m[1])/r,F=(w[2][0]-m[0])/r,S=-(w[2][1]-m[1])/r;g.beginPath(),g.moveTo(T,A),g.lineTo(R,I),g.lineTo(F,S),g.closePath(),g.stroke()}),g.restore()),g.canvas}class FO extends oc{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:e.interpolate,transition:e.transition}),this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const t=e.sourceProj,i=t.getExtent(),n=e.sourceTileGrid.getExtent();this.clipExtent_=t.canWrapX()?n?Ot(i,n):i:n;const r=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),o=this.targetTileGrid_.getExtent();let a=this.sourceTileGrid_.getExtent();const l=o?Ot(r,o):r;if(Mo(l)===0){this.state=X.EMPTY;return}i&&(a?a=Ot(a,i):a=i);const h=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),u=e.targetProj,c=bv(t,u,l,h);if(!isFinite(c)||c<=0){this.state=X.EMPTY;return}const d=e.errorThreshold!==void 0?e.errorThreshold:Cf;if(this.triangulation_=new xf(t,u,l,a,c*d,h),this.triangulation_.getTriangles().length===0){this.state=X.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(c);let f=this.triangulation_.calculateSourceExtent();if(a&&(t.canWrapX()?(f[1]=ze(f[1],a[1],a[3]),f[3]=ze(f[3],a[1],a[3])):f=Ot(f,a)),!Mo(f))this.state=X.EMPTY;else{let g=0,p=0;t.canWrapX()&&(g=_e(i),p=Math.floor((f[0]-i[0])/g)),Kc(f.slice(),t,!0).forEach(b=>{const v=this.sourceTileGrid_.getTileRangeForExtentAndZ(b,this.sourceZ_),_=e.getTileFunction;for(let m=v.minX;m<=v.maxX;m++)for(let E=v.minY;E<=v.maxY;E++){const C=_(this.sourceZ_,m,E,this.pixelRatio_);if(C){const x=p*g;this.sourceTiles_.push({tile:C,offset:x})}}++p}),this.sourceTiles_.length===0&&(this.state=X.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];let t=!1;if(this.sourceTiles_.forEach(g=>{var D;const p=g.tile;if(!p||p.getState()!==X.LOADED)return;const y=p.getSize(),b=this.gutter_;let v;const _=MO(p.getData());_?v=_:(t=!0,v=AO(kl(p.getData())));const m=[y[0]+2*b,y[1]+2*b],E=v instanceof Float32Array,C=m[0]*m[1],x=E?Float32Array:Uint8ClampedArray,w=new x(v.buffer),R=x.BYTES_PER_ELEMENT,I=R*w.length/C,T=w.byteLength/m[1],A=Math.floor(T/R/m[0]),F=C*A;let S=w;if(w.length!==F){S=new x(F);let H=0,j=0;const V=m[0]*A;for(let Y=0;Y<m[1];++Y){for(let K=0;K<V;++K)S[H++]=w[j+K];j+=T/R}}const O=this.sourceTileGrid_.getTileCoordExtent(p.tileCoord);O[0]+=g.offset,O[2]+=g.offset;const M=(D=this.clipExtent_)==null?void 0:D.slice();M&&(M[0]+=g.offset,M[2]+=g.offset),e.push({extent:O,clipExtent:M,data:new Uint8ClampedArray(S.buffer),dataType:x,bytesPerPixel:I,pixelSize:m})}),this.sourceTiles_.length=0,e.length===0){this.state=X.ERROR,this.changed();return}const i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),r=typeof n=="number"?n:n[0],o=typeof n=="number"?n:n[1],a=this.targetTileGrid_.getResolution(i),l=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let u,c;const d=e[0].bytesPerPixel,f=Math.ceil(d/3);for(let g=f-1;g>=0;--g){const p=[];for(let E=0,C=e.length;E<C;++E){const x=e[E],w=x.data,R=x.pixelSize,I=R[0],T=R[1],A=We(I,T,vn),F=A.createImageData(I,T),S=F.data;let O=g*3;for(let M=0,D=S.length;M<D;M+=4)S[M]=w[O],S[M+1]=w[O+1],S[M+2]=w[O+2],S[M+3]=255,O+=d;A.putImageData(F,0,0),p.push({extent:x.extent,clipExtent:x.clipExtent,image:A.canvas})}const y=Rf(r,o,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),a,h,this.triangulation_,p,this.gutter_,!1,!1,!1);for(let E=0,C=p.length;E<C;++E){const w=p[E].image.getContext("2d");As(w),vn.push(w.canvas)}const b=y.getContext("2d"),v=b.getImageData(0,0,y.width,y.height);As(b),vn.push(y),u||(c=new Uint8ClampedArray(d*v.width*v.height),u=new e[0].dataType(c.buffer));const _=v.data;let m=g*3;for(let E=0,C=_.length;E<C;E+=4)_[E+3]===255?(c[m]=_[E],c[m+1]=_[E+1],c[m+2]=_[E+2]):(c[m]=0,c[m+1]=0,c[m+2]=0),m+=d}if(t){const g=We(r,o),p=new ImageData(u,r);g.putImageData(p,0,0),this.reprojData_=g.canvas}else this.reprojData_=u;this.reprojSize_=[Math.round(r*this.pixelRatio_),Math.round(o*this.pixelRatio_)],this.state=X.LOADED,this.changed()}load(){if(this.state!==X.IDLE&&this.state!==X.ERROR)return;this.state=X.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i!==X.IDLE&&i!==X.LOADING)return;e++;const n=Ce(t,ce.CHANGE,()=>{const r=t.getState();(r==X.LOADED||r==X.ERROR||r==X.EMPTY)&&(Ie(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t}){t.getState()==X.IDLE&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ie),this.sourcesListenerKeys_=null}}class ac extends oa{constructor(e,t,i,n,r,o,a,l,h,u,c,d){super(r,X.IDLE,d),this.renderEdges_=c!==void 0?c:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=n,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const f=n.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const y=g?Ot(f,g):f;if(Mo(y)===0){this.state=X.EMPTY;return}const b=e.getExtent();b&&(p?p=Ot(p,b):p=b);const v=n.getResolution(this.wrappedTileCoord_[0]),_=bv(e,i,y,v);if(!isFinite(_)||_<=0){this.state=X.EMPTY;return}const m=u!==void 0?u:Cf;if(this.triangulation_=new xf(e,i,y,p,_*m,v),this.triangulation_.getTriangles().length===0){this.state=X.EMPTY;return}this.sourceZ_=t.getZForResolution(_);let E=this.triangulation_.calculateSourceExtent();if(p&&(e.canWrapX()?(E[1]=ze(E[1],p[1],p[3]),E[3]=ze(E[3],p[1],p[3])):E=Ot(E,p)),!Mo(E))this.state=X.EMPTY;else{let C=0,x=0;e.canWrapX()&&(C=_e(b),x=Math.floor((E[0]-b[0])/C)),Kc(E.slice(),e,!0).forEach(R=>{const I=t.getTileRangeForExtentAndZ(R,this.sourceZ_);for(let T=I.minX;T<=I.maxX;T++)for(let A=I.minY;A<=I.maxY;A++){const F=h(this.sourceZ_,T,A,a);if(F){const S=x*C;this.sourceTiles_.push({tile:F,offset:S})}}++x}),this.sourceTiles_.length===0&&(this.state=X.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{var n;const i=t.tile;if(i&&i.getState()==X.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const o=(n=this.clipExtent_)==null?void 0:n.slice();o&&(o[0]+=t.offset,o[2]+=t.offset),e.push({extent:r,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=X.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),n=typeof i=="number"?i:i[0],r=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Rf(n,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=X.LOADED}this.changed()}load(){if(this.state==X.IDLE){this.state=X.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==X.IDLE||i==X.LOADING){e++;const n=Ce(t,ce.CHANGE,r=>{const o=t.getState();(o==X.LOADED||o==X.ERROR||o==X.EMPTY)&&(Ie(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,n){t.getState()==X.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ie),this.sourcesListenerKeys_=null}release(){this.canvas_&&(As(this.canvas_.getContext("2d")),vn.push(this.canvas_),this.canvas_=null),super.release()}}class DO extends na{constructor(e){e=e||{},super(e)}}class kO extends Fd{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],i=e.pixelRatio,n=e.viewState,r=n.resolution,o=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Ot(l,Fi(t.extent,n.projection))),!a[Ne.ANIMATING]&&!a[Ne.INTERACTING]&&!ks(l))if(o){const h=n.projection,u=o.getImage(l,r,i,h);u&&(this.loadImage(u)?this.image=u:u.getState()===q.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),n=$e(t.pixelToCoordinateTransform,e.slice()),r=i.getExtent();if(r&&!Ms(r,n))return null;const o=this.image.getExtent(),a=this.image.getImage(),l=_e(o),h=Math.floor(a.width*((n[0]-o[0])/l));if(h<0||h>=a.width)return null;const u=Ke(o),c=Math.floor(a.height*((o[3]-n[1])/u));return c<0||c>=a.height?null:this.getImageData(a,h,c)}renderFrame(e,t){const i=this.image,n=i.getExtent(),r=i.getResolution(),[o,a]=Array.isArray(r)?r:[r,r],l=i.getPixelRatio(),h=e.layerStatesArray[e.layerIndex],u=e.pixelRatio,c=e.viewState,d=c.center,f=c.resolution,g=u*o/(f*l),p=u*a/(f*l);this.prepareContainer(e,t);const y=this.context.canvas.width,b=this.context.canvas.height,v=this.getRenderContext(e);let _=!1,m=!0;if(h.extent){const R=Fi(h.extent,c.projection);m=je(R,e.extent),_=m&&!ii(R,e.extent),_&&this.clipUnrotated(v,e,R)}const E=i.getImage(),C=Vi(this.tempTransform,y/2,b/2,g,p,0,l*(n[0]-d[0])/o,l*(d[1]-n[3])/a);this.renderedResolution=a*u/l;const x=E.width*C[0],w=E.height*C[3];if(this.getLayer().getSource().getInterpolate()||(v.imageSmoothingEnabled=!1),this.preRender(v,e),m&&x>=.5&&w>=.5){const R=C[4],I=C[5],T=h.opacity;T!==1&&(v.save(),v.globalAlpha=T),v.drawImage(E,0,0,+E.width,+E.height,R,I,x,w),T!==1&&v.restore()}return this.postRender(this.context,e),_&&v.restore(),v.imageSmoothingEnabled=!0,this.container}}class nN extends DO{constructor(e){super(e)}createRenderer(){return new kO(this)}getData(e){return super.getData(e)}}const $n={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class NO extends na{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get($n.PRELOAD)}setPreload(e){this.set($n.PRELOAD,e)}getUseInterimTilesOnError(){return this.get($n.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set($n.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}function lu(s,e,t,i){return`${s},${Nb(e,t,i)}`}function hu(s,e,t){if(!(t in s))return s[t]=new Set([e]),!0;const i=s[t],n=i.has(e);return n||i.add(e),!n}function zO(s,e,t){const i=s[t];return i?i.delete(e):!1}function tm(s,e){const t=s.layerStatesArray[s.layerIndex];t.extent&&(e=Ot(e,Fi(t.extent,s.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const n=i.getTileGridForProjection(s.viewState.projection).getExtent();n&&(e=Ot(e,n))}return e}class yv extends Fd{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Kt(),this.tempTileRange_=new Bd(0,0,0,0),this.tempTileCoord_=ml(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new yx(i),this.renderedProjection_=void 0,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(e,t,i,n){const r=this.tileCache_,a=this.getLayer().getSource(),l=lu(a.getKey(),e,t,i);let h;if(r.containsKey(l))h=r.get(l);else{if(h=a.getTile(e,t,i,n.pixelRatio,n.viewState.projection),!h)return null;r.set(l,h)}return h}getTile(e,t,i,n){const r=this.getOrCreateTile(e,t,i,n);return r||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),n=$e(t.pixelToCoordinateTransform,e.slice()),r=i.getExtent();if(r&&!Ms(r,n))return null;const o=t.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(t.pixelRatio);for(let u=l.getZForResolution(o.resolution);u>=l.getMinZoom();--u){const c=l.getTileCoordForCoordAndZ(n,u),d=this.getTile(u,c[1],c[2],t);if(!d||d.getState()!==X.LOADED)continue;const f=l.getOrigin(u),g=gt(l.getTileSize(u)),p=l.getResolution(u);let y;if(d instanceof Ab||d instanceof ac)y=d.getImage();else if(d instanceof oc){if(y=kl(d.getData()),!y)continue}else continue;const b=Math.floor(h*((n[0]-f[0])/p-c[1]*g[0])),v=Math.floor(h*((f[1]-n[1])/p-c[2]*g[1])),_=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(y,b+_,v+_)}return null}prepareFrame(e){this.renderedProjection_?e.viewState.projection!==this.renderedProjection_&&(this.tileCache_.clear(),this.renderedProjection_=e.viewState.projection):this.renderedProjection_=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedRevision_?this.renderedRevision_!==i&&(this.renderedRevision_=i,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedRevision_=i,!0}enqueueTiles(e,t,i,n,r){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),h=l.getTileGridForProjection(o.projection),u=ge(l);u in e.wantedTiles||(e.wantedTiles[u]={});const c=e.wantedTiles[u],d=a.getMapInternal(),f=Math.max(i-r,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),l.zDirection));for(let g=i;g>=f;--g){const p=h.getTileRangeForExtentAndZ(t,g,this.tempTileRange_),y=h.getResolution(g);for(let b=p.minX;b<=p.maxX;++b)for(let v=p.minY;v<=p.maxY;++v){const _=this.getTile(g,b,v,e);if(!_||!hu(n,_,g))continue;const E=_.getKey();if(c[E]=!0,_.getState()===X.IDLE&&!e.tileQueue.isKeyQueued(E)){const C=ml(g,b,v,this.tempTileCoord_);e.tileQueue.enqueue([_,u,h.getTileCoordCenter(C),y])}}}}findStaleTile_(e,t){const i=this.tileCache_,n=e[0],r=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const h=lu(a[l],n,r,o);if(i.containsKey(h)){const u=i.get(h);if(u.getState()===X.LOADED)return u.endTransition(ge(this)),hu(t,u,n),!0}}return!1}findAltTiles_(e,t,i,n){const r=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!r)return!1;let o=!0;const a=this.tileCache_,h=this.getLayer().getRenderSource().getKey();for(let u=r.minX;u<=r.maxX;++u)for(let c=r.minY;c<=r.maxY;++c){const d=lu(h,i,u,c);let f=!1;if(a.containsKey(d)){const g=a.get(d);g.getState()===X.LOADED&&(hu(n,g,i),f=!0)}f||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],n=e.viewState,r=n.projection,o=n.resolution,a=n.center,l=e.pixelRatio,h=this.getLayer(),u=h.getSource(),c=u.getRevision(),d=u.getTileGridForProjection(r),f=d.getZForResolution(o,u.zDirection),g=d.getResolution(f),p=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let y=e.extent;const b=u.getTilePixelRatio(l);this.prepareContainer(e,t);const v=this.context.canvas.width,_=this.context.canvas.height,m=i.extent&&Fi(i.extent);m&&(y=Ot(y,Fi(i.extent)));const E=g*v/2/b,C=g*_/2/b,x=[a[0]-E,a[1]-C,a[0]+E,a[1]+C],w={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent){const V=d.getZForResolution(n.nextResolution,u.zDirection),Y=tm(e,e.nextExtent);this.enqueueTiles(e,Y,V,w,R)}const I=tm(e,y);if(this.enqueueTiles(e,I,f,w,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,I,f-1,w,R-1)},0),!(f in w))return this.container;const T=ge(this),A=e.time;for(const V of w[f]){const Y=V.getState();if((V instanceof ac||V instanceof FO)&&Y===X.EMPTY)continue;const K=V.tileCoord;if(Y===X.LOADED&&V.getAlpha(T,A)===1){V.endTransition(T);continue}if(this.renderComplete=!1,this.findStaleTile_(K,w)){zO(w,V,f),e.animate=!0;continue}if(this.findAltTiles_(d,K,f+1,w))continue;const me=d.getMinZoom();for(let ye=f-1;ye>=me&&!this.findAltTiles_(d,K,ye,w);--ye);}const F=g/o*l/b,S=this.getRenderContext(e);Vi(this.tempTransform,v/2,_/2,F,F,0,-v/2,-_/2),i.extent&&this.clipUnrotated(S,e,m),u.getInterpolate()||(S.imageSmoothingEnabled=!1),this.preRender(S,e);const O=Object.keys(w).map(Number);O.sort(zi);let M;const D=[],H=[];for(let V=O.length-1;V>=0;--V){const Y=O[V],K=u.getTilePixelSize(Y,l,r),z=d.getResolution(Y)/g,me=K[0]*z*F,ye=K[1]*z*F,ve=d.getTileCoordForCoordAndZ(is(x),Y),Ae=d.getTileCoordExtent(ve),Xe=$e(this.tempTransform,[b*(Ae[0]-x[0])/g,b*(x[3]-Ae[3])/g]),Ue=b*u.getGutterForProjection(r);for(const mt of w[Y]){if(mt.getState()!==X.LOADED)continue;const Mi=mt.tileCoord,Li=ve[1]-Mi[1],Sn=Math.round(Xe[0]-(Li-1)*me),Ai=ve[2]-Mi[2],Bt=Math.round(Xe[1]-(Ai-1)*ye),Qe=Math.round(Xe[0]-Li*me),bt=Math.round(Xe[1]-Ai*ye),fi=Sn-Qe,ht=Bt-bt,xt=O.length===1;let Vt=!1;M=[Qe,bt,Qe+fi,bt,Qe+fi,bt+ht,Qe,bt+ht];for(let Rt=0,qt=D.length;Rt<qt;++Rt)if(!xt&&Y<H[Rt]){const Ge=D[Rt];je([Qe,bt,Qe+fi,bt+ht],[Ge[0],Ge[3],Ge[4],Ge[7]])&&(Vt||(S.save(),Vt=!0),S.beginPath(),S.moveTo(M[0],M[1]),S.lineTo(M[2],M[3]),S.lineTo(M[4],M[5]),S.lineTo(M[6],M[7]),S.moveTo(Ge[6],Ge[7]),S.lineTo(Ge[4],Ge[5]),S.lineTo(Ge[2],Ge[3]),S.lineTo(Ge[0],Ge[1]),S.clip())}D.push(M),H.push(Y),this.drawTile(mt,e,Qe,bt,fi,ht,Ue,xt),Vt&&S.restore(),this.renderedTiles.unshift(mt),this.updateUsedTiles(e.usedTiles,u,mt)}}this.renderedRevision=c,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!Ls(this.renderedExtent_,x),this.renderedExtent_=x,this.renderedPixelRatio=l,this.renderedProjection=r,this.postRender(this.context,e),i.extent&&S.restore(),S.imageSmoothingEnabled=!0;const j=(V,Y)=>{const K=ge(u),Ee=Y.wantedTiles[K],z=Ee?Object.keys(Ee).length:0;this.updateCacheSize(z),this.tileCache_.expireCache()};return e.postRenderFunctions.push(j),this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,n,r,o,a,l){let h;if(e instanceof oc){if(h=kl(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const u=this.getRenderContext(t),c=ge(this),d=t.layerStatesArray[t.layerIndex],f=d.opacity*(l?e.getAlpha(c,t.time):1),g=f!==u.globalAlpha;g&&(u.save(),u.globalAlpha=f),u.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,n,r,o),g&&u.restore(),f!==d.opacity?t.animate=!0:l&&e.endTransition(c)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const n=ge(t);n in e||(e[n]={}),e[n][i.getKey()]=!0}}class sN extends NO{constructor(e){super(e)}createRenderer(){return new yv(this,{cacheSize:this.getCacheSize()})}}function lc(s){return Array.isArray(s)?Math.min(...s):s}const GO={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},im={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class HO extends yv{constructor(e,t){super(e,t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=Xt(),this.tileClipContexts_=null}drawTile(e,t,i,n,r,o,a,l){this.updateExecutorGroup_(e,t.pixelRatio,t.viewState.projection),this.tileImageNeedsRender_(e)&&this.renderTileImage_(e,t),super.drawTile(e,t,i,n,r,o,a,l)}getTile(e,t,i,n){const r=this.getOrCreateTile(e,t,i,n);if(!r)return null;const a=n.viewState.resolution,l=n.viewHints;return(!(l[Ne.ANIMATING]||l[Ne.INTERACTING])||!r.wantedResolution)&&(r.wantedResolution=a),r}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,i){const n=this.getLayer(),r=n.getRevision(),o=n.getRenderOrder()||null,a=e.wantedResolution,l=e.getReplayState(n);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==r&&l.renderedRenderOrder==o)return;const h=n.getSource(),u=!!n.getDeclutter(),c=h.getTileGrid(),f=h.getTileGridForProjection(i).getTileCoordExtent(e.wrappedTileCoord),g=h.getSourceTiles(t,i,e),p=ge(n);delete e.hitDetectionImageData[p],e.executorGroups[p]=[],l.dirty=!1;for(let y=0,b=g.length;y<b;++y){const v=g[y];if(v.getState()!=X.LOADED)continue;const _=v.tileCoord,m=c.getTileCoordExtent(_),E=Ot(f,m),C=Ts(E,n.getRenderBuffer()*a,this.tempExtent),x=Ls(m,E)?null:C,w=new _b(0,E,a,t),R=fl(a,t),I=function(O,M){let D;const H=O.getStyleFunction()||n.getStyleFunction();if(H&&(D=H(O,a)),D){const j=this.renderFeature(O,R,D,w,u,M);l.dirty=l.dirty||j}},T=v.getFeatures();o&&o!==l.renderedRenderOrder&&T.sort(o);for(let O=0,M=T.length;O<M;++O){const D=T[O];(!x||je(x,D.getGeometry().getExtent()))&&I.call(this,D,O)}const A=w.finish(),F=n.getRenderMode()!=="vector"&&u&&g.length===1?null:E,S=new Cb(F,a,t,h.getOverlaps(),A,n.getRenderBuffer(),!0);e.executorGroups[p].push(S)}l.renderedRevision=r,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(e,t,i,n,r){const o=t.viewState.resolution,a=t.viewState.rotation;i=i??0;const l=this.getLayer(),u=l.getSource().getTileGridForProjection(t.viewState.projection),c=To([e]);Ts(c,o*i,c);const d={},f=function(y,b,v){let _=y.getId();_===void 0&&(_=ge(y));const m=d[_];if(m){if(m!==!0&&v<m.distanceSq){if(v===0)return d[_]=!0,r.splice(r.lastIndexOf(m),1),n(y,l,b);m.geometry=b,m.distanceSq=v}}else{if(v===0)return d[_]=!0,n(y,l,b);r.push(d[_]={feature:y,layer:l,geometry:b,distanceSq:v,callback:n})}},g=this.renderedTiles;let p;for(let y=0,b=g.length;!p&&y<b;++y){const v=g[y],_=u.getTileCoordExtent(v.wrappedTileCoord);if(!je(_,c))continue;const m=ge(l),E=[v.executorGroups[m]],C=l.getDeclutter();E.some(x=>{const w=C?t.declutter[C].all().map(R=>R.value):null;for(let R=0,I=x.length;R<I;++R)if(p=x[R].forEachFeatureAtCoordinate(e,o,a,i,f,w),p)return!0})}return p}getFeatures(e){return new Promise((t,i)=>{const n=this.getLayer(),r=ge(n),o=n.getSource(),a=this.renderedProjection,l=a.getExtent(),h=this.renderedResolution,u=o.getTileGridForProjection(a),c=$e(this.renderedPixelToCoordinateTransform_,e.slice()),d=u.getTileCoordForCoordAndResolution(c,h);let f;for(let _=0,m=this.renderedTiles.length;_<m;++_)if(d.toString()===this.renderedTiles[_].tileCoord.toString()){if(f=this.renderedTiles[_],f.getState()===X.LOADED){const E=u.getTileCoordExtent(f.tileCoord);o.getWrapX()&&a.canWrapX()&&!ii(l,E)&&Qc(c,a);break}f=void 0}if(!f||f.loadingSourceTiles>0){t([]);return}const g=u.getTileCoordExtent(f.wrappedTileCoord),p=is(g),y=[(c[0]-p[0])/h,(p[1]-c[1])/h],b=f.getSourceTiles().reduce(function(_,m){return _.concat(m.getFeatures())},[]);let v=f.hitDetectionImageData[r];if(!v){const _=gt(u.getTileSize(u.getZForResolution(h,o.zDirection))),m=this.renderedRotation_,E=[this.getRenderTransform(u.getTileCoordCenter(f.wrappedTileCoord),h,0,Yt,_[0]*Yt,_[1]*Yt,0)];v=xb(_,E,b,n.getStyleFunction(),u.getTileCoordExtent(f.wrappedTileCoord),f.getReplayState(n).renderedResolution,m),f.hitDetectionImageData[r]=v}t(Rb(y,b,v))})}getFeaturesInExtent(e){const t=[],i=this.getTileCache();if(i.getCount()===0)return t;const r=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),o=r.getZForResolution(this.renderedResolution),a={};return i.forEach(l=>{if(l.tileCoord[0]!==o||l.getState()!==X.LOADED)return;const h=l.getSourceTiles();for(let u=0,c=h.length;u<c;++u){const d=h[u],f=d.getKey();if(f in a)continue;a[f]=!0;const g=d.tileCoord;if(je(e,r.getTileCoordExtent(g))){const p=d.getFeatures();if(p)for(let y=0,b=p.length;y<b;++y){const v=p[y],_=v.getGeometry();je(e,_.getExtent())&&t.push(v)}}}}),t}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,t){const i=this.context,n=i.globalAlpha;i.globalAlpha=t.opacity;const r=e.viewHints,o=!(r[Ne.ANIMATING]||r[Ne.INTERACTING]),a=this.renderedTiles;for(let l=0,h=a.length;l<h;++l){const u=a[l],c=u.executorGroups[ge(this.getLayer())],d=this.getLayer().getDeclutter();if(c)for(let f=c.length-1;f>=0;--f)c[f].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(u,e),e.viewState.rotation,o,dl,d?e.declutter[d]:void 0)}i.globalAlpha=n}renderDeferredInternal(e){const i=this.renderedTiles.reduce((a,l,h)=>(l.executorGroups[ge(this.getLayer())].forEach(u=>a.push({executorGroup:u,index:h})),a),[]),n=i.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),r={};for(let a=0,l=i.length;a<l;++a){const h=i[a].executorGroup.getDeferredZIndexContexts();for(const u in h)r[u]=!0}Object.keys(r).sort(zi).map(Number).forEach(a=>{n.forEach((l,h)=>{l[a]&&(l[a].forEach(u=>{const{executorGroup:c,index:d}=i[h],f=c.getRenderedContext(),g=f.globalAlpha;f.globalAlpha=this.renderedOpacity_;const p=this.tileClipContexts_[d];p&&p.draw(f),u.draw(f),p&&f.restore(),f.globalAlpha=g,u.clear()}),l[a].length=0)})})}getTileRenderTransform(e,t){const i=t.pixelRatio,n=t.viewState,r=n.center,o=n.resolution,a=n.rotation,l=t.size,h=Math.round(l[0]*i),u=Math.round(l[1]*i),d=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),f=e.tileCoord,g=d.getTileCoordExtent(e.wrappedTileCoord),p=d.getTileCoordExtent(f,this.tempExtent)[0]-g[0];return Qo(Ua(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(r,o,a,i,h,u,p))}postRender(e,t){var m;const i=t.viewHints,n=!(i[Ne.ANIMATING]||i[Ne.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,this.renderedOpacity_=t.layerStatesArray[t.layerIndex].opacity;const r=this.getLayer(),o=r.getRenderMode(),a=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;const l=r.getDeclutter(),h=l?im[o].filter(E=>!dl.includes(E)):im[o],u=t.viewState,c=u.rotation,d=r.getSource(),g=d.getTileGridForProjection(u.projection).getZForResolution(u.resolution,d.zDirection),p=this.renderedTiles,y=[],b=[],v=[];let _=!0;for(let E=p.length-1;E>=0;--E){const C=p[E];_=_&&!C.getReplayState(r).dirty;const x=C.executorGroups[ge(r)].filter(S=>S.hasExecutors(h));if(x.length===0)continue;const w=this.getTileRenderTransform(C,t),R=C.tileCoord[0];let I=!1;const T=x[0].getClipCoords(w);let A=e,F;if(T){F=new Od,A=F.getContext();for(let S=0,O=y.length;S<O;++S)if(g!==R&&R<b[S]){const M=y[S];je([T[0],T[3],T[4],T[7]],[M[0],M[3],M[4],M[7]])&&(I||(A.save(),I=!0),A.beginPath(),A.moveTo(T[0],T[1]),A.lineTo(T[2],T[3]),A.lineTo(T[4],T[5]),A.lineTo(T[6],T[7]),A.moveTo(M[6],M[7]),A.lineTo(M[4],M[5]),A.lineTo(M[2],M[3]),A.lineTo(M[0],M[1]),A.clip())}y.push(T),b.push(R)}for(let S=0,O=x.length;S<O;++S)x[S].execute(e,[e.canvas.width,e.canvas.height],w,c,n,h,(m=t.declutter)==null?void 0:m[l]);I&&(A===e?A.restore():v[E]=F)}e.globalAlpha=a,this.ready=_,this.tileClipContexts_=v,t.declutter||this.renderDeferredInternal(t),super.postRender(e,t)}renderFeature(e,t,i,n,r,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,h=i.length;l<h;++l)a=gl(n,e,i[l],t,this.boundHandleStyleImageChange_,void 0,r,o)||a;else a=gl(n,e,i,t,this.boundHandleStyleImageChange_,void 0,r,o);return a}tileImageNeedsRender_(e){const t=this.getLayer();if(t.getRenderMode()==="vector")return!1;const i=e.getReplayState(t),n=t.getRevision(),r=e.wantedResolution;return i.renderedTileResolution!==r||i.renderedTileRevision!==n}renderTileImage_(e,t){const i=this.getLayer(),n=e.getReplayState(i),r=i.getRevision(),o=e.executorGroups[ge(i)];n.renderedTileRevision=r;const a=e.wrappedTileCoord,l=a[0],h=i.getSource();let u=t.pixelRatio;const d=t.viewState.projection,f=h.getTileGridForProjection(d),g=f.getResolution(e.tileCoord[0]),p=t.pixelRatio/e.wantedResolution*g,y=f.getResolution(l),b=e.getContext();u=Math.round(Math.max(u,p/u));const v=h.getTilePixelSize(l,u,d);b.canvas.width=v[0],b.canvas.height=v[1];const _=u/p;if(_!==1){const x=Qf(this.tmpTransform_);Ua(x,_,_),b.setTransform.apply(b,x)}const m=f.getTileCoordExtent(a,this.tempExtent),E=p/y,C=Qf(this.tmpTransform_);Ua(C,E,-E),N0(C,-m[0],-m[3]);for(let x=0,w=o.length;x<w;++x)o[x].execute(b,[b.canvas.width*_,b.canvas.height*_],C,0,!0,GO[i.getRenderMode()],null);n.renderedTileResolution=e.wantedResolution}}class rN extends Id{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload;const i=e.cacheSize===void 0?0:e.cacheSize;delete e.cacheSize,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i;const n=e.renderMode||"hybrid";be(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new HO(this,{cacheSize:this.cacheSize_})}getFeatures(e){return super.getFeatures(e)}getFeaturesInExtent(e){return this.getRenderer().getFeaturesInExtent(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get($n.PRELOAD)}getUseInterimTilesOnError(){return this.get($n.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set($n.PRELOAD,e)}setUseInterimTilesOnError(e){this.set($n.USE_INTERIM_TILES_ON_ERROR,e)}}class BO extends ib{constructor(e,t,i,n,r,o,a){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let h=t.getExtent();h&&t.canWrapX()&&(h=h.slice(),h[0]=-1/0,h[2]=1/0);const u=h?Ot(i,h):i,c=Wi(u),d=jo(e,t,c,n),f=Cf,g=new xf(e,t,u,l,d*f,n),p=g.calculateSourceExtent(),y=ks(p)?null:o(p,d,r),b=y?q.IDLE:q.EMPTY,v=y?y.getPixelRatio():1;super(i,n,v,b),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=g,this.targetResolution_=n,this.targetExtent_=i,this.sourceImage_=y,this.sourcePixelRatio_=v,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==q.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==q.LOADED){const t=_e(this.targetExtent_)/this.targetResolution_,i=Ke(this.targetExtent_)/this.targetResolution_;this.canvas_=Rf(t,i,this.sourcePixelRatio_,lc(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==q.IDLE){this.state=q.LOADING,this.changed();const e=this.sourceImage_.getState();e==q.LOADED||e==q.ERROR?this.reproject_():(this.sourceListenerKey_=Ce(this.sourceImage_,ce.CHANGE,t=>{const i=this.sourceImage_.getState();(i==q.LOADED||i==q.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){Ie(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Kn=4,uu={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class VO extends ji{constructor(e,t){super(e),this.image=t}}class WO extends Nd{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const i=Ul(t,e,0);e=t[i]}return e}getImage(e,t,i,n){const r=this.getProjection();if(!r||!n||gn(r,n))return r&&(n=r),this.getImageInternal(e,t,i,n);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&gn(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==t&&Ls(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new BO(r,n,e,t,i,(o,a,l)=>this.getImageInternal(o,a,l,r),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,i,n){if(this.loader){const r=vv(e,t,i,1),o=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===n&&(this.wantedExtent_&&ii(this.wantedExtent_,r)||ii(this.image.getExtent(),r))&&(this.wantedResolution_&&lc(this.wantedResolution_)===o||lc(this.image.getResolution())===o)))return this.image;this.wantedProjection_=n,this.wantedExtent_=r,this.wantedResolution_=o,this.image=new ib(r,o,i,this.loader),this.image.addEventListener(ce.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let i;switch(t.getState()){case q.LOADING:this.loading=!0,i=uu.IMAGELOADSTART;break;case q.LOADED:this.loading=!1,i=uu.IMAGELOADEND;break;case q.ERROR:this.loading=!1,i=uu.IMAGELOADERROR;break;default:return}this.hasListener(i)&&this.dispatchEvent(new VO(i,t))}}function UO(s,e){s.getImage().src=e}function vv(s,e,t,i){const n=e/t,r=Wi(s),o=Un(_e(s)/n,Kn),a=Un(Ke(s)/n,Kn),l=Un((i-1)*o/2,Kn),h=o+2*l,u=Un((i-1)*a/2,Kn),c=a+2*u;return Lo(r,n,0,[h,c])}function Yo(s,e){const t=[];Object.keys(e).forEach(function(n){e[n]!==null&&e[n]!==void 0&&t.push(n+"="+encodeURIComponent(e[n]))});const i=t.join("&");return s=s.replace(/[?&]$/,""),s+=s.includes("?")?"&":"?",s+i}const jO=/\{z\}/g,YO=/\{x\}/g,XO=/\{y\}/g,$O=/\{-y\}/g;function KO(s,e,t,i,n){return s.replace(jO,e.toString()).replace(YO,t.toString()).replace(XO,i.toString()).replace($O,function(){if(n===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(n-i).toString()})}function wv(s){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(s);if(t){const i=t[1].charCodeAt(0),n=t[2].charCodeAt(0);let r;for(r=i;r<=n;++r)e.push(s.replace(t[0],String.fromCharCode(r)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(s),t){const i=parseInt(t[2],10);for(let n=parseInt(t[1],10);n<=i;n++)e.push(s.replace(t[0],n.toString()));return e}return e.push(s),e}const Nl="1.3.0",nm=[101,101];function _v(s,e,t,i,n){n.WIDTH=t[0],n.HEIGHT=t[1];const r=i.getAxisOrientation(),o=qc(n.VERSION,"1.3")>=0;n[o?"CRS":"SRS"]=i.getCode();const a=o&&r.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return n.BBOX=a.join(","),Yo(s,n)}function Ev(s,e,t,i,n,r,o){r=Object.assign({REQUEST:"GetMap"},r);const a=e/t,l=[sg(_e(s)/a,Kn),sg(Ke(s)/a,Kn)];if(t!=1)switch(o){case"geoserver":const u=90*t+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+u:r.FORMAT_OPTIONS="dpi:"+u;break;case"mapserver":r.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":r.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return _v(n,s,l,i,r)}function zl(s,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:Nl,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},s)}function ZO(s){const e=s.hidpi===void 0?!0:s.hidpi,t=he(s.projection||"EPSG:3857"),i=s.ratio||1.5,n=s.load||sb,r=s.crossOrigin??null;return(o,a,l)=>{o=vv(o,a,l,i),l!=1&&(!e||s.serverType===void 0)&&(l=1);const h=Ev(o,a,l,t,s.url,zl(s.params,"GetMap"),s.serverType),u=new Image;return u.crossOrigin=r,n(u,h).then(c=>({image:c,extent:o,pixelRatio:l}))}}function qO(s,e,t){if(s.url===void 0)return;const i=he(s.projection||"EPSG:3857"),n=Lo(e,t,0,nm),r={QUERY_LAYERS:s.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(r,zl(s.params,"GetFeatureInfo"),s.params);const o=rr((e[0]-n[0])/t,Kn),a=rr((n[3]-e[1])/t,Kn),l=qc(r.VERSION,"1.3")>=0;return r[l?"I":"X"]=o,r[l?"J":"Y"]=a,_v(s.url,n,nm,i,r)}function JO(s,e){if(s.url===void 0)return;const t={SERVICE:"WMS",VERSION:Nl,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e!==void 0){const i=he(s.projection||"EPSG:3857").getMetersPerUnit()||1,n=28e-5;t.SCALE=e*i/n}if(Object.assign(t,s.params),s.params!==void 0&&t.LAYER===void 0){const i=t.LAYERS;if(!(!Array.isArray(i)||i.length!==1))return;t.LAYER=i}return Yo(s.url,t)}class oN extends WO{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:UO,this.params_=Object.assign({},e.params),this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,t,i,n){const r=he(i),o=this.getProjection();o&&o!==r&&(t=jo(o,r,e,t),e=ql(e,r,o));const a={url:this.url_,params:{...this.params_,...n},projection:o||r};return qO(a,e,t)}getLegendUrl(e,t){return JO({url:this.url_,params:{...this.params_,...t}},e)}getParams(){return this.params_}getImageInternal(e,t,i,n){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==n)&&(this.loaderProjection_=n,this.loader=ZO({crossOrigin:this.crossOrigin_,params:this.params_,projection:n,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(r,o)=>(this.image.setImage(r),this.imageLoadFunction_(this.image,o),sb(r))})),super.getImageInternal(e,t,i,n))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const cu={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},Js=[0,0,0],Fn=5;class Sf{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,be(I0(this.resolutions_,(n,r)=>r-n),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let n=0,r=this.resolutions_.length-1;n<r;++n)if(!t)t=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,be(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=is(i)),be(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,be(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Rd,be(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((n,r)=>{const o=new Bd(Math.min(0,n[0]),Math.max(n[0]-1,-1),Math.min(0,n[1]),Math.max(n[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,r);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const n=this.getTileRangeForExtentAndZ(e,t);for(let r=n.minX,o=n.maxX;r<=o;++r)for(let a=n.minY,l=n.maxY;a<=l;++a)i([t,r,a])}forEachTileCoordParentTileRange(e,t,i,n){let r,o,a,l=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,n);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),r=$s(o,o,a,a,i)):r=this.getTileRangeForExtentAndZ(l,h,i),t(h,r))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const r=e[1]*2,o=e[2]*2;return $s(r,r+1,o,o+1,t)}const n=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const n=e[0],r=e[1],o=e[2];if(t===n)return $s(r,o,r,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-n),h=Math.floor(r*l),u=Math.floor(o*l);if(t<n)return $s(h,h,u,u,i);const c=Math.floor(l*(r+1))-1,d=Math.floor(l*(o+1))-1;return $s(h,c,u,d,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Js);const n=Js[1],r=Js[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Js);const o=Js[1],a=Js[2];return $s(n,o,r,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),n=gt(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*n[0]*i,t[1]-(e[2]+.5)*n[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),n=this.getResolution(e[0]),r=gt(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*r[0]*n,a=i[1]-(e[2]+1)*r[1]*n,l=o+r[0]*n,h=a+r[1]*n;return ui(o,a,l,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,n,r){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),h=gt(this.getTileSize(o),this.tmpSize_);let u=a*(e-l[0])/i/h[0],c=a*(l[1]-t)/i/h[1];return n?(u=Un(u,Fn)-1,c=Un(c,Fn)-1):(u=rr(u,Fn),c=rr(c,Fn)),ml(o,u,c,r)}getTileCoordForXYAndZ_(e,t,i,n,r){const o=this.getOrigin(i),a=this.getResolution(i),l=gt(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/a/l[0],u=(o[1]-t)/a/l[1];return n?(h=Un(h,Fn)-1,u=Un(u,Fn)-1):(h=rr(h,Fn),u=rr(u,Fn)),ml(i,h,u,r)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=Ul(this.resolutions_,e,t||0);return ze(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Xm(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let n=this.minZoom;n<t;++n)i[n]=this.getTileRangeForExtentAndZ(e,n);this.fullTileRanges_=i}}class Cv extends Sf{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}}function QO(s,e,t){const i=[],n=[],r=[],o=[],a=[];t=t!==void 0?t:[];const l="SupportedCRS",h="TileMatrix",u="Identifier",c="ScaleDenominator",d="TopLeftCorner",f="TileWidth",g="TileHeight",p=s[l],y=he(p),b=y.getMetersPerUnit(),v=y.getAxisOrientation().startsWith("ne");return s[h].sort(function(_,m){return m[c]-_[c]}),s[h].forEach(function(_){let m;if(t.length>0?m=t.find(function(E){return _[u]==E[h]?!0:_[u].includes(":")?!1:s[u]+":"+_[u]===E[h]}):m=!0,m){n.push(_[u]);const E=_[c]*28e-5/b,C=_[f],x=_[g];v?r.push([_[d][1],_[d][0]]):r.push(_[d]),i.push(E),o.push(C==x?C:[C,x]),a.push([_.MatrixWidth,_.MatrixHeight])}}),new Cv({extent:e,origins:r,resolutions:i,matrixIds:n,tileSizes:o,sizes:a})}function xv(s){let e=s.getDefaultTileGrid();return e||(e=n2(s),s.setDefaultTileGrid(e)),e}function e2(s,e,t){const i=e[0],n=s.getTileCoordCenter(e),r=Tf(t);if(!Ms(r,n)){const o=_e(r),a=Math.ceil((r[0]-n[0])/o);return n[0]+=o*a,s.getTileCoordForCoordAndZ(n,i)}return e}function t2(s,e,t,i){i=i!==void 0?i:"top-left";const n=Rv(s,e,t);return new Sf({extent:s,origin:V0(s,i),resolutions:n,tileSize:t})}function i2(s){const e=s||{},t=e.extent||he("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Rv(t,e.maxZoom,e.tileSize,e.maxResolution)};return new Sf(i)}function Rv(s,e,t,i){e=e!==void 0?e:oE,t=gt(t!==void 0?t:Rd);const n=Ke(s),r=_e(s);i=i>0?i:Math.max(r/t[0],n/t[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function n2(s,e,t,i){const n=Tf(s);return t2(n,e,t,i)}function Tf(s){s=he(s);let e=s.getExtent();if(!e){const t=180*Ao.degrees/s.getMetersPerUnit();e=ui(-t,-t,t,t)}return e}class s2 extends Nd{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&gt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||ge(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,n,r){return ne()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:xv(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(t),o=gt(n.getTileSize(e),this.tmpSize);return r==1?o:K_(o,r,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){t=t!==void 0?t:this.getProjection();const i=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=e2(i,e,t)),wx(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class r2 extends ji{constructor(e,t){super(e),this.tile=t}}function o2(s,e){return function(t,i,n){if(!t)return;let r;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(r=a.getHeight()-1)}return KO(s,o,t[1],t[2],r)}}function a2(s,e){const t=s.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=o2(s[n],e);return hc(i)}function hc(s){return s.length===1?s[0]:function(e,t,i){if(!e)return;const n=zb(e),r=Zn(n,s.length);return s[r](e,t,i)}}class Mf extends s2{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Mf.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=ge(t),n=t.getState();let r;n==X.LOADING?(this.tileLoadingKeys_[i]=!0,r=cu.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=n==X.ERROR?cu.TILELOADERROR:n==X.LOADED?cu.TILELOADEND:void 0),r!=null&&this.dispatchEvent(new r2(r,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=wv(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(a2(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class Lf extends Mf{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:l2,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Ab,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!gn(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||gn(t,e)))return this.tileGrid;const i=ge(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=xv(e)),this.tileGridForProjection[i]}createTile_(e,t,i,n,r,o){const a=[e,t,i],l=this.getTileCoordForTileUrlFunction(a,r),h=l?this.tileUrlFunction(l,n,r):void 0,u=new this.tileClass(a,h!==void 0?X.IDLE:X.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(ce.CHANGE,this.handleTileChange.bind(this)),u}getTile(e,t,i,n,r){const o=this.getProjection();if(!o||!r||gn(o,r))return this.getTileInternal(e,t,i,n,o||r);const a=[e,t,i],l=this.getKey(),h=this.getTileGridForProjection(o),u=this.getTileGridForProjection(r),c=this.getTileCoordForTileUrlFunction(a,r),d=new ac(o,h,r,u,a,c,this.getTilePixelRatio(n),this.getGutter(),(f,g,p,y)=>this.getTileInternal(f,g,p,y,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(e,t,i,n,r){const o=this.getKey();return this.createTile_(e,t,i,n,r,o)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=he(e);if(i){const n=ge(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=t)}}}function l2(s,e){s.getImage().src=e}class h2 extends Lf{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:i2({extent:Tf(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const u2='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class aN extends h2{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[u2];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",n=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:n,wrapX:e.wrapX,zDirection:e.zDirection})}}class lN extends Lf{constructor(e){const t=e.requestEncoding!==void 0?e.requestEncoding:"KVP",i=e.tileGrid;let n=e.urls;n===void 0&&e.url!==void 0&&(n=wv(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:n,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection}),this.version_=e.version!==void 0?e.version:"1.0.0",this.format_=e.format!==void 0?e.format:"image/jpeg",this.dimensions_=e.dimensions!==void 0?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=hc(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;const t=e.join(`
`);this.setTileUrlFunction(hc(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const e=this.urls?this.urls.slice(0):[];for(const t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){const t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};t=="KVP"&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=t=="KVP"?Yo(e,i):e.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in i?i[a.toLowerCase()]:o});const n=this.tileGrid,r=this.dimensions_;return function(o,a,l){if(!o)return;const h={TileMatrix:n.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(h,r);let u=e;return t=="KVP"?u=Yo(u,h):u=u.replace(/\{(\w+?)\}/g,function(c,d){return h[d]}),u}}}function hN(s,e){const t=s.Contents.Layer,i=t==null?void 0:t.find(function(A){return A.Identifier==e.layer});if(!i)return null;const n=s.Contents.TileMatrixSet;let r;i.TileMatrixSetLink.length>1?"projection"in e?r=i.TileMatrixSetLink.findIndex(function(A){const S=n.find(function(D){return D.Identifier==A.TileMatrixSet}).SupportedCRS,O=he(S),M=he(e.projection);return O&&M?gn(O,M):S==e.projection}):r=i.TileMatrixSetLink.findIndex(function(A){return A.TileMatrixSet==e.matrixSet}):r=0,r<0&&(r=0);const o=i.TileMatrixSetLink[r].TileMatrixSet,a=i.TileMatrixSetLink[r].TileMatrixSetLimits;let l=i.Format[0];"format"in e&&(l=e.format),r=i.Style.findIndex(function(A){return"style"in e?A.Title==e.style:A.isDefault}),r<0&&(r=0);const h=i.Style[r].Identifier,u={};"Dimension"in i&&i.Dimension.forEach(function(A,F,S){const O=A.Identifier;let M=A.Default;M===void 0&&(M=A.Value[0]),u[O]=M});const d=s.Contents.TileMatrixSet.find(function(A){return A.Identifier==o});let f;const g=d.SupportedCRS;if(g&&(f=he(g)),"projection"in e){const A=he(e.projection);A&&(!f||gn(A,f))&&(f=A)}let p=!1;const y=f.getAxisOrientation().startsWith("ne");let b=d.TileMatrix[0],v={MinTileCol:0,MinTileRow:0,MaxTileCol:b.MatrixWidth-1,MaxTileRow:b.MatrixHeight-1};if(a){v=a[a.length-1];const A=d.TileMatrix.find(F=>F.Identifier===v.TileMatrix||d.Identifier+":"+F.Identifier===v.TileMatrix);A&&(b=A)}const _=b.ScaleDenominator*28e-5/f.getMetersPerUnit(),m=y?[b.TopLeftCorner[1],b.TopLeftCorner[0]]:b.TopLeftCorner,E=b.TileWidth*_,C=b.TileHeight*_;let x=d.BoundingBox;x&&y&&(x=[x[1],x[0],x[3],x[2]]);let w=[m[0]+E*v.MinTileCol,m[1]-C*(1+v.MaxTileRow),m[0]+E*(1+v.MaxTileCol),m[1]-C*v.MinTileRow];if(x!==void 0&&!ii(x,w)){const A=i.WGS84BoundingBox,F=he("EPSG:4326").getExtent();if(w=x,A)p=A[0]===F[0]&&A[2]===F[2];else{const S=Gm(x,d.SupportedCRS,"EPSG:4326");p=S[0]-1e-10<=F[0]&&S[2]+1e-10>=F[2]}}const R=QO(d,w,a),I=[];let T=e.requestEncoding;if(T=T!==void 0?T:"","OperationsMetadata"in s&&"GetTile"in s.OperationsMetadata){const A=s.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let F=0,S=A.length;F<S;++F)if(A[F].Constraint){const M=A[F].Constraint.find(function(D){return D.name=="GetEncoding"}).AllowedValues.Value;if(T===""&&(T=M[0]),T==="KVP")M.includes("KVP")&&I.push(A[F].href);else break}else A[F].href&&(T="KVP",I.push(A[F].href))}return I.length===0&&(T="REST",i.ResourceURL.forEach(function(A){A.resourceType==="tile"&&(l=A.format,I.push(A.template))})),{urls:I,layer:e.layer,matrixSet:o,format:l,projection:f,requestEncoding:T,tileGrid:R,style:h,dimensions:u,wrapX:p,crossOrigin:e.crossOrigin}}class uN extends Lf{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Kt(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,n){const r=he(i),o=this.getProjection()||r;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=ql(e,r,o),h=jo(o,r,e,t),u=a.getZForResolution(h,this.zDirection),c=a.getResolution(u),d=a.getTileCoordForCoordAndZ(l,u);if(a.getResolutions().length<=d[0])return;let f=a.getTileCoordExtent(d,this.tmpExtent_);const g=this.gutter_;g!==0&&(f=Ts(f,c*g,f));const p={QUERY_LAYERS:this.params_.LAYERS};Object.assign(p,zl(this.params_,"GetFeatureInfo"),n);const y=Math.floor((l[0]-f[0])/c),b=Math.floor((f[3]-l[1])/c);return p[this.v13_?"I":"X"]=y,p[this.v13_?"J":"Y"]=b,this.getRequestUrl_(d,f,1,o||r,p)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:Nl,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const n=this.params_.LAYERS;if(!(!Array.isArray(n)||n.length===1))return;i.LAYER=n}if(e!==void 0){const n=this.getProjection()?this.getProjection().getMetersPerUnit():1,r=28e-5;i.SCALE=e*n/r}return Object.assign(i,t),Yo(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,n,r){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=Zn(zb(e),o.length);a=o[l]}return Ev(t,(this.tileGrid||this.getTileGridForProjection(n)).getResolution(e[0]),i,n,a,r,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}updateParams(e){Object.assign(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const e=this.params_.VERSION||Nl;this.v13_=qc(e,"1.3")>=0}tileUrlFunction(e,t,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const r=n.getResolution(e[0]);let o=n.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Ts(o,r*a,o));const l=Object.assign({},zl(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,i,l)}}/*!
 * vanilla-picker v2.12.3
 * https://vanilla-picker.js.org
 *
 * Copyright 2017-2024 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
 * Released under the ISC license.
 */var Af=function(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")},Pf=function(){function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}}(),Ba=function(){function s(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var a=e[Symbol.iterator](),l;!(n=(l=a.next()).done)&&(i.push(l.value),!(t&&i.length===t));n=!0);}catch(h){r=!0,o=h}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return i}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return s(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();String.prototype.startsWith=String.prototype.startsWith||function(s){return this.indexOf(s)===0};String.prototype.padStart=String.prototype.padStart||function(s,e){for(var t=this;t.length<s;)t=e+t;return t};var c2={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function sm(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=e>0?s.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):s.toString();return t||"0"}var d2=function(){function s(e,t,i,n){Af(this,s);var r=this;function o(l){if(l.startsWith("hsl")){var h=l.match(/([\-\d\.e]+)/g).map(Number),u=Ba(h,4),c=u[0],d=u[1],f=u[2],g=u[3];g===void 0&&(g=1),c/=360,d/=100,f/=100,r.hsla=[c,d,f,g]}else if(l.startsWith("rgb")){var p=l.match(/([\-\d\.e]+)/g).map(Number),y=Ba(p,4),b=y[0],v=y[1],_=y[2],m=y[3];m===void 0&&(m=1),r.rgba=[b,v,_,m]}else l.startsWith("#")?r.rgba=s.hexToRgb(l):r.rgba=s.nameToRgb(l)||s.hexToRgb(l)}if(e!==void 0)if(Array.isArray(e))this.rgba=e;else if(i===void 0){var a=e&&""+e;a&&o(a.toLowerCase())}else this.rgba=[e,t,i,n===void 0?1:n]}return Pf(s,[{key:"printRGB",value:function(t){var i=t?this.rgba:this.rgba.slice(0,3),n=i.map(function(r,o){return sm(r,o===3?3:0)});return t?"rgba("+n+")":"rgb("+n+")"}},{key:"printHSL",value:function(t){var i=[360,100,100,1],n=["","%","%",""],r=t?this.hsla:this.hsla.slice(0,3),o=r.map(function(a,l){return sm(a*i[l],l===3?3:1)+n[l]});return t?"hsla("+o+")":"hsl("+o+")"}},{key:"printHex",value:function(t){var i=this.hex;return t?i:i.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=s.hslToRgb(this._hsla)},set:function(t){t.length===3&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=s.rgbToHsl(this._rgba)},set:function(t){t.length===3&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){var t=this.rgba,i=t.map(function(n,r){return r<3?n.toString(16):Math.round(n*255).toString(16)});return"#"+i.map(function(n){return n.padStart(2,"0")}).join("")},set:function(t){this.rgba=s.hexToRgb(t)}}],[{key:"hexToRgb",value:function(t){var i=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!i.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+t);var n=i.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(r){return parseInt(r,16)});return n[3]=n[3]/255,n}},{key:"nameToRgb",value:function(t){var i=t.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),n=c2[i];return n===void 0?n:s.hexToRgb(n.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var i=Ba(t,4),n=i[0],r=i[1],o=i[2],a=i[3];n/=255,r/=255,o/=255;var l=Math.max(n,r,o),h=Math.min(n,r,o),u=void 0,c=void 0,d=(l+h)/2;if(l===h)u=c=0;else{var f=l-h;switch(c=d>.5?f/(2-l-h):f/(l+h),l){case n:u=(r-o)/f+(r<o?6:0);break;case r:u=(o-n)/f+2;break;case o:u=(n-r)/f+4;break}u/=6}return[u,c,d,a]}},{key:"hslToRgb",value:function(t){var i=Ba(t,4),n=i[0],r=i[1],o=i[2],a=i[3],l=void 0,h=void 0,u=void 0;if(r===0)l=h=u=o;else{var c=function(y,b,v){return v<0&&(v+=1),v>1&&(v-=1),v<.16666666666666666?y+(b-y)*6*v:v<.5?b:v<.6666666666666666?y+(b-y)*(.6666666666666666-v)*6:y},d=o<.5?o*(1+r):o+r-o*r,f=2*o-d;l=c(f,d,n+1/3),h=c(f,d,n),u=c(f,d,n-1/3)}var g=[l*255,h*255,u*255].map(Math.round);return g[3]=a,g}}]),s}(),f2=function(){function s(){Af(this,s),this._events=[]}return Pf(s,[{key:"add",value:function(t,i,n){t.addEventListener(i,n,!1),this._events.push({target:t,type:i,handler:n})}},{key:"remove",value:function(t,i,n){this._events=this._events.filter(function(r){var o=!0;return t&&t!==r.target&&(o=!1),i&&i!==r.type&&(o=!1),n&&n!==r.handler&&(o=!1),o&&s._doRemove(r.target,r.type,r.handler),!o})}},{key:"destroy",value:function(){this._events.forEach(function(t){return s._doRemove(t.target,t.type,t.handler)}),this._events=[]}}],[{key:"_doRemove",value:function(t,i,n){t.removeEventListener(i,n,!1)}}]),s}();function g2(s){var e=document.createElement("div");return e.innerHTML=s,e.firstElementChild}function du(s,e,t){var i=!1;function n(l,h,u){return Math.max(h,Math.min(l,u))}function r(l,h,u){if(u&&(i=!0),!!i){l.preventDefault();var c=e.getBoundingClientRect(),d=c.width,f=c.height,g=h.clientX,p=h.clientY,y=n(g-c.left,0,d),b=n(p-c.top,0,f);t(y/d,b/f)}}function o(l,h){var u=l.buttons===void 0?l.which:l.buttons;u===1?r(l,l,h):i=!1}function a(l,h){l.touches.length===1?r(l,l.touches[0],h):i=!1}s.add(e,"mousedown",function(l){o(l,!0)}),s.add(e,"touchstart",function(l){a(l,!0)}),s.add(window,"mousemove",o),s.add(e,"touchmove",a),s.add(window,"mouseup",function(l){i=!1}),s.add(e,"touchend",function(l){i=!1}),s.add(e,"touchcancel",function(l){i=!1})}var p2=`linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,
                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em`,m2=360,Sv="keydown",Va="mousedown",fu="focusin";function Pi(s,e){return(e||document).querySelector(s)}function b2(s){s.preventDefault(),s.stopPropagation()}function gu(s,e,t,i,n){s.add(e,Sv,function(r){t.indexOf(r.key)>=0&&i(r)})}var y2=function(){function s(e){Af(this,s),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new f2,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}return Pf(s,[{key:"setOptions",value:function(t){var i=this;if(!t)return;var n=this.settings;function r(h,u,c){for(var d in h)u[d]=h[d]}if(t instanceof HTMLElement)n.parent=t;else{n.parent&&t.parent&&n.parent!==t.parent&&(this._events.remove(n.parent),this._popupInited=!1),r(t,n),t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose);var o=t.color||t.colour;o&&this._setColor(o)}var a=n.parent;if(a&&n.popup&&!this._popupInited){var l=function(u){return i.openHandler(u)};this._events.add(a,"click",l),gu(this._events,a,[" ","Spacebar","Enter"],l),this._popupInited=!0}else t.parent&&!n.popup&&this.show()}},{key:"openHandler",value:function(t){if(this.show()){t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none";var i=t&&t.type===Sv?this._domEdit:this.domElement;setTimeout(function(){return i.focus()},100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(t){var i=t&&t.type,n=!1;if(!t)n=!0;else if(i===Va||i===fu){var r=(this.__containedEvent||0)+100;t.timeStamp>r&&(n=!0)}else b2(t),n=!0;n&&this.hide()&&(this.settings.parent.style.pointerEvents="",i!==Va&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(t,i){this.closeHandler(),this.setOptions(t),i&&this.openHandler()}},{key:"setColor",value:function(t,i){this._setColor(t,{silent:i})}},{key:"_setColor",value:function(t,i){if(typeof t=="string"&&(t=t.trim()),!!t){i=i||{};var n=void 0;try{n=new d2(t)}catch(o){if(i.failSilently)return;throw o}if(!this.settings.alpha){var r=n.hsla;r[3]=1,n.hsla=r}this.colour=this.color=n,this._setHSLA(null,null,null,null,i)}}},{key:"setColour",value:function(t,i){this.setColor(t,i)}},{key:"show",value:function(){var t=this.settings.parent;if(!t)return!1;if(this.domElement){var i=this._toggleDOM(!0);return this._setPosition(),i}var n=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',r=g2(n);return this.domElement=r,this._domH=Pi(".picker_hue",r),this._domSL=Pi(".picker_sl",r),this._domA=Pi(".picker_alpha",r),this._domEdit=Pi(".picker_editor input",r),this._domSample=Pi(".picker_sample",r),this._domOkay=Pi(".picker_done button",r),this._domCancel=Pi(".picker_cancel button",r),r.classList.add("layout_"+this.settings.layout),this.settings.alpha||r.classList.add("no_alpha"),this.settings.editor||r.classList.add("no_editor"),this.settings.cancelButton||r.classList.add("no_cancel"),this._ifPopup(function(){return r.classList.add("popup")}),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var t=this,i=this,n=this.domElement,r=this._events;function o(h,u,c){r.add(h,u,c)}o(n,"click",function(h){return h.preventDefault()}),du(r,this._domH,function(h,u){return i._setHSLA(h)}),du(r,this._domSL,function(h,u){return i._setHSLA(null,h,1-u)}),this.settings.alpha&&du(r,this._domA,function(h,u){return i._setHSLA(null,null,null,1-u)});var a=this._domEdit;o(a,"input",function(h){i._setColor(this.value,{fromEditor:!0,failSilently:!0})}),o(a,"focus",function(h){var u=this;u.selectionStart===u.selectionEnd&&u.select()}),this._ifPopup(function(){var h=function(d){return t.closeHandler(d)};o(window,Va,h),o(window,fu,h),gu(r,n,["Esc","Escape"],h);var u=function(d){t.__containedEvent=d.timeStamp};o(n,Va,u),o(n,fu,u),o(t._domCancel,"click",h)});var l=function(u){t._ifPopup(function(){return t.closeHandler(u)}),t.onDone&&t.onDone(t.colour)};o(this._domOkay,"click",l),gu(r,n,["Enter"],l)}},{key:"_setPosition",value:function(){var t=this.settings.parent,i=this.domElement;t!==i.parentNode&&t.appendChild(i),this._ifPopup(function(n){getComputedStyle(t).position==="static"&&(t.style.position="relative");var r=n===!0?"popup_right":"popup_"+n;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(o){o===r?i.classList.add(o):i.classList.remove(o)}),i.classList.add(r)})}},{key:"_setHSLA",value:function(t,i,n,r,o){o=o||{};var a=this.colour,l=a.hsla;[t,i,n,r].forEach(function(h,u){(h||h===0)&&(l[u]=h)}),a.hsla=l,this._updateUI(o),this.onChange&&!o.silent&&this.onChange(a)}},{key:"_updateUI",value:function(t){if(!this.domElement)return;t=t||{};var i=this.colour,n=i.hsla,r="hsl("+n[0]*m2+", 100%, 50%)",o=i.hslString,a=i.hslaString,l=this._domH,h=this._domSL,u=this._domA,c=Pi(".picker_selector",l),d=Pi(".picker_selector",h),f=Pi(".picker_selector",u);function g(C,x,w){x.style.left=w*100+"%"}function p(C,x,w){x.style.top=w*100+"%"}g(l,c,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=r,g(h,d,n[1]),p(h,d,1-n[2]),h.style.color=o,p(u,f,1-n[3]);var y=o,b=y.replace("hsl","hsla").replace(")",", 0)"),v="linear-gradient("+[y,b]+")";if(this._domA.style.background=v+", "+p2,!t.fromEditor){var _=this.settings.editorFormat,m=this.settings.alpha,E=void 0;switch(_){case"rgb":E=i.printRGB(m);break;case"hsl":E=i.printHSL(m);break;default:E=i.printHex(m)}this._domEdit.value=E}this._domSample.style.color=a}},{key:"_ifPopup",value:function(t,i){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):i&&i()}},{key:"_toggleDOM",value:function(t){var i=this.domElement;if(!i)return!1;var n=t?"":"none",r=i.style.display!==n;return r&&(i.style.display=n),r}}]),s}();{var pu=document.createElement("style");pu.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(pu),y2.StyleElement=pu}class cN{constructor(e){U(this,"printExtent");this.setPrintExtent(e||[0,0,1/0,1/0])}getPrintExtent(){return this.printExtent}setPrintExtent(e){this.printExtent=e}layerFilter(e){return!0}geometryFilter(e){return!0}feature(e,t){}line(e,t,i,n){}point(e,t,i,n){}text(e,t,i,n){}wmtsLayer(e,t,i){}wmsLayer(e,t,i){}}const Gl={WMTS_PIXEL_SIZE:28e-5,DOTS_PER_INCH:72,METERS_PER_INCH:.0254,CIRCLE_TO_POLYGON_SIDES:64},v2={DPI_PER_DISTANCE_UNIT:()=>Gl.DOTS_PER_INCH/Gl.METERS_PER_INCH};function dN(s,e,t){const[i,n]=s.map(r=>r/v2.DPI_PER_DISTANCE_UNIT()*t/2);return[e[0]-i,e[1]-n,e[0]+i,e[1]+n]}function mu(s){return s.length===1?`0${s}`:s}function bu(s){const e=s[0],t=s[1],i=s[2];if(e!==(e&255)||t!==(t&255)||i!==(i&255))throw new Error(`"(${e},${t},${i})" is not a valid RGB color`);const n=mu(e.toString(16)),r=mu(t.toString(16)),o=mu(i.toString(16));return`#${n}${r}${o}`}function fN(s){const e=s.getProjection(),t=s.getTileGrid();console.assert(t instanceof Cv);const i=t.getMatrixIds(),n=[],r=e.getMetersPerUnit();console.assert(!!r);for(let o=0;o<i.length;o++){const a=t.getFullTileRange(o),l=t.getResolution(o)*r;n.push({identifier:i[o],scaleDenominator:l/Gl.WMTS_PIXEL_SIZE,tileSize:gt(t.getTileSize(o)),topLeftCorner:t.getOrigin(o),matrixSize:[a.maxX-a.minX+1,a.maxY-a.minY+1]})}return n}document.createElement("canvas");function w2(s){const e=document.createElement("a");return e.href=encodeURI(s),decodeURI(e.href)}function gN(s){const e=s.getUrls();return console.assert(e.length>0),w2(e[0])}async function _2(s,e){return await(await fetch(`${s}/status/${e}.json`)).json()}async function pN(s,e){return{status:(await fetch(`${s}/cancel/${e}`,{method:"DELETE"})).status}}async function mN(s,e,t){return await(await fetch(`${s}/report.${e.format}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e,t)})).json()}async function bN(s,e,t=1e3,i=3e4){let n=0-t;return new Promise((r,o)=>{const a=setInterval(async()=>{let l;try{if(l=await _2(s,e.ref),l.error)throw new Error(l.error)}catch(h){o(h)}l.done&&(clearInterval(a),r(`${s}/report/${e.ref}`)),n+=t,n>=i&&(clearInterval(a),o(new Error("Print duration exceeded")))},t)})}const un={LINE_STRING:"LineString",POINT:"Point",POLYGON:"Polygon"},Tv=Object.freeze({LineString:un.LINE_STRING,Point:un.POINT,Polygon:un.POLYGON,MultiLineString:un.LINE_STRING,MultiPoint:un.POINT,MultiPolygon:un.POLYGON});function E2(s){return s in Tv}const Ja="_mfp_style",C2=s=>{const e=s.geometry;return e&&e.type==="Point"?0:1},yu=s=>{const e=Array.isArray(s)?s.join(","):s;return`[${Ja} = '${e}']`};class yN{constructor(e,t){U(this,"layerState_");U(this,"layer_");U(this,"customizer_");U(this,"geojsonFormat",new eR);U(this,"deepIds_",new Map);U(this,"lastDeepId_",0);this.layerState_=e,this.layer_=this.layerState_.layer,this.customizer_=t}encodeVectorLayer(e){const t=this.layer_.getSource();if(!t)return null;console.assert(t instanceof zC);const i=t.getFeaturesInExtent(this.customizer_.getPrintExtent()),n=[],r={version:2};return i.forEach(a=>this.encodeFeature(a,e,n,r)),n.length<=0||Object.keys(r).length<=1?null:(n.sort((a,l)=>{const h=C2;return h(l)-h(a)}),{geoJson:{type:"FeatureCollection",features:n},opacity:this.layerState_.opacity,style:r,type:"geojson",name:this.layer_.get("name")})}encodeFeature(e,t,i,n){let r=null;const o=e.getStyleFunction()||this.layer_.getStyleFunction();o&&(r=o(e,t)),e.getGeometry().getType()==="Circle"&&(e=this.featureCircleAsPolygon(e));const a=this.geojsonFormat.writeFeatureObject(e);let l=r!==null&&!Array.isArray(r)?[r]:r;if(!l||(l=l.filter(u=>!!u),l.length===0))return;console.assert(Array.isArray(l));let h=!1;l.forEach(u=>{let c=u.getGeometry(),d;if(typeof c=="function"&&(c=c(e)),c&&typeof c=="object"){const f=e.clone();f.setGeometry(c),d=this.geojsonFormat.writeFeatureObject(f),i.push(d)}else{if(d=a,c=e.getGeometry(),!c||!this.customizer_.geometryFilter(c))return;h||(i.push(d),h=!0)}this.addVectorStyle(n,d,u)})}getDeepStyleUid(e){const t=[e];let i="";for(;t.length;){const r=t.pop();i+="_k"+ge(r);for(const[o,a]of Object.entries(r))a!=null&&(["number","string","boolean"].includes(typeof a)?i+=`_${o}:${a}`:t.push(a))}if(this.deepIds_.has(i))return this.deepIds_.get(i).toString();const n=++this.lastDeepId_;return this.deepIds_.set(i,n),n.toString()}addVectorStyle(e,t,i){const n=this.getDeepStyleUid(i),r=yu(n);let o;if(r in e)o=!0;else{const a=this.encodeVectorStyle(t,i);o=a&&a.symbolizers.length!==0,o&&(e[r]=a)}if(o){t.properties||(t.properties={}),this.customizer_.feature(this.layerState_,t);const a=t.properties[Ja];if(a){const l=[...a.split(","),n];e[yu(l)]={symbolizers:[...e[yu(a)].symbolizers,...e[r].symbolizers]},t.properties[Ja]=l.join(",")}else t.properties[Ja]=n}}encodeVectorStyle(e,t){const i=e.geometry.type;if(!E2(i))return console.warn("Unsupported geometry type: ",i),null;const n=Tv[i],r={symbolizers:[]},o=t.getFill(),a=t.getImage(),l=t.getStroke(),h=t.getText();return n===un.POLYGON?o!==null&&this.encodeVectorStylePolygon(e,r.symbolizers,o,l):n===un.LINE_STRING?l!==null&&this.encodeVectorStyleLine(e,r.symbolizers,l):n===un.POINT&&a!==null&&this.encodeVectorStylePoint(e,r.symbolizers,a),h!==null&&this.encodeVectorStyleText(e,r.symbolizers,h),r}encodeVectorStyleFill(e,t,i){let n=i.getColor();n!==null&&(console.assert(typeof n=="string"||Array.isArray(n)),n=pn(n),console.assert(Array.isArray(n),"only supporting fill colors"),t.fillColor=bu(n),t.fillOpacity=n[3])}encodeVectorStyleLine(e,t,i){const n={type:"line"};this.encodeVectorStyleStroke(e,n,i),this.customizer_.line(this.layerState_,e,n,i),t.push(n)}encodeVectorStylePoint(e,t,i){let n;i instanceof Dr?n=this.encodeVectorStylePointStyleCircle(e,i):i instanceof zs&&(n=this.encodeVectorStylePointStyleIcon(e,i)),n&&(this.customizer_.point(this.layerState_,e,n,i),t.push(n))}encodeVectorStylePointStyleCircle(e,t){const i={type:"point"};i.pointRadius=t.getRadius();const n=t.getScale();n&&(Array.isArray(n)?i.pointRadius*=(n[0]+n[1])/2:i.pointRadius*=n);const r=t.getFill();let o=t.getStroke();return r!==null&&(this.encodeVectorStyleFill(e,i,r),o||(o=new wi({color:r.getColor()}))),o!==null&&this.encodeVectorStyleStroke(e,i,o),i}encodeVectorStylePointStyleIcon(e,t){const i=t.getSrc();if(i===void 0)return;const n={type:"point",externalGraphic:i},r=t.getOpacity();r!==null&&(n.graphicOpacity=r);const o=t.getSize();if(o!==null){let l=t.getScale();Array.isArray(l)&&(l=(l[0]+l[1])/2),isNaN(l)&&(l=1);const h=o[0]*l,u=o[1]*l;n.graphicWidth=u,this.addGraphicOffset_(n,t,h,u)}let a=t.getRotation();return isNaN(a)&&(a=0),n.rotation=Tu(a),n}addGraphicOffset_(e,t,i,n){if(this.hasDefaultAnchor_(t))return;const r=t.getAnchor(),o=i/2-r[0],a=n/2-r[1];e.graphicXOffset=o,e.graphicYOffset=a}hasDefaultAnchor_(e){const t=e,i=t.anchor_[0]===.5&&t.anchor_[1]===.5,n=t.anchorOrigin_==="top-left",r=t.anchorXUnits_==="fraction",o=t.anchorYUnits_==="fraction";return i&&n&&r&&o}encodeVectorStylePolygon(e,t,i,n){const r={type:"polygon"};this.encodeVectorStyleFill(e,r,i),n!==null&&this.encodeVectorStyleStroke(e,r,n),t.push(r)}encodeVectorStyleStroke(e,t,i){const n=i.getColor();if(n!==null){console.assert(typeof n=="string"||Array.isArray(n));const h=pn(n);console.assert(Array.isArray(h),"only supporting stroke colors"),t.strokeColor=bu(h),t.strokeOpacity=h[3]}const r=i.getLineDash();r!==null&&(t.strokeDashstyle=r.join(" "));const o=i.getWidth();o!==void 0&&(t.strokeWidth=o);const a=i.getLineCap();a&&(t.strokeLinecap=a);const l=i.getLineJoin();l&&(t.strokeLinejoin=l)}encodeVectorStyleText(e,t,i){if(i.getText()){const r=xd(i.getFont()||"sans-serif"),o={type:"text",label:i.getText(),fontFamily:r.family,fontSize:r.size,fontStyle:r.style,fontWeight:r.weight,labelXOffset:i.getOffsetX(),labelYOffset:-i.getOffsetY(),labelAlign:"cm"},a=i.getFill();a!==null&&(this.encodeVectorStyleFill(e,o,a),o.fontColor=o.fillColor);const l=i.getStroke();if(l!==null){const h=l.getColor();if(h){console.assert(typeof h=="string"||Array.isArray(h));const c=pn(h);console.assert(Array.isArray(c),"only supporting stroke colors"),o.haloColor=bu(c),o.haloOpacity=c[3]}const u=l.getWidth();u!==void 0&&(o.haloRadius=u)}this.customizer_.text(this.layerState_,e,o,i),t.push(o)}}featureCircleAsPolygon(e){return new di({...e.getProperties(),geometry:L_(e.getGeometry(),Gl.CIRCLE_TO_POLYGON_SIDES)})}}class lt{constructor(e){this.table=e}reloadData(e,t,i){return this.table.dataLoader.load(e,void 0,void 0,void 0,t,i)}langText(){return this.table.modules.localize.getText(...arguments)}langBind(){return this.table.modules.localize.bind(...arguments)}langLocale(){return this.table.modules.localize.getLocale(...arguments)}commsConnections(){return this.table.modules.comms.getConnections(...arguments)}commsSend(){return this.table.modules.comms.send(...arguments)}layoutMode(){return this.table.modules.layout.getMode()}layoutRefresh(e){return this.table.modules.layout.layout(e)}subscribe(){return this.table.eventBus.subscribe(...arguments)}unsubscribe(){return this.table.eventBus.unsubscribe(...arguments)}subscribed(e){return this.table.eventBus.subscribed(e)}subscriptionChange(){return this.table.eventBus.subscriptionChange(...arguments)}dispatch(){return this.table.eventBus.dispatch(...arguments)}chain(){return this.table.eventBus.chain(...arguments)}confirm(){return this.table.eventBus.confirm(...arguments)}dispatchExternal(){return this.table.externalEvents.dispatch(...arguments)}subscribedExternal(e){return this.table.externalEvents.subscribed(e)}subscriptionChangeExternal(){return this.table.externalEvents.subscriptionChange(...arguments)}options(e){return this.table.options[e]}setOption(e,t){return typeof t<"u"&&(this.table.options[e]=t),this.table.options[e]}deprecationCheck(e,t,i){return this.table.deprecationAdvisor.check(e,t,i)}deprecationCheckMsg(e,t){return this.table.deprecationAdvisor.checkMsg(e,t)}deprecationMsg(e){return this.table.deprecationAdvisor.msg(e)}module(e){return this.table.module(e)}}class Fe{static elVisible(e){return!(e.offsetWidth<=0&&e.offsetHeight<=0)}static elOffset(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}}static retrieveNestedData(e,t,i){var n=e?t.split(e):[t],r=n.length,o;for(let a=0;a<r&&(i=i[n[a]],o=i,!!i);a++);return o}static deepClone(e,t,i=[]){var n={}.__proto__,r=[].__proto__;t||(t=Object.assign(Array.isArray(e)?[]:{},e));for(var o in e){let a=e[o],l,h;a!=null&&typeof a=="object"&&(a.__proto__===n||a.__proto__===r)&&(l=i.findIndex(u=>u.subject===a),l>-1?t[o]=i[l].copy:(h=Object.assign(Array.isArray(a)?[]:{},a),i.unshift({subject:a,copy:h}),t[o]=this.deepClone(a,h,i)))}return t}}let x2=class Mv extends lt{constructor(e,t,i){super(e),this.element=t,this.container=this._lookupContainer(),this.parent=i,this.reversedX=!1,this.childPopup=null,this.blurable=!1,this.blurCallback=null,this.blurEventsBound=!1,this.renderedCallback=null,this.visible=!1,this.hideable=!0,this.element.classList.add("tabulator-popup-container"),this.blurEvent=this.hide.bind(this,!1),this.escEvent=this._escapeCheck.bind(this),this.destroyBinding=this.tableDestroyed.bind(this),this.destroyed=!1}tableDestroyed(){this.destroyed=!0,this.hide(!0)}_lookupContainer(){var e=this.table.options.popupContainer;return typeof e=="string"?(e=document.querySelector(e),e||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)")):e===!0&&(e=this.table.element),e&&!this._checkContainerIsParent(e)&&(e=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),e||(e=document.body),e}_checkContainerIsParent(e,t=this.table.element){return e===t?!0:t.parentNode?this._checkContainerIsParent(e,t.parentNode):!1}renderCallback(e){this.renderedCallback=e}containerEventCoords(e){var t=!(e instanceof MouseEvent),i=t?e.touches[0].pageX:e.pageX,n=t?e.touches[0].pageY:e.pageY;if(this.container!==document.body){let r=Fe.elOffset(this.container);i-=r.left,n-=r.top}return{x:i,y:n}}elementPositionCoords(e,t="right"){var i=Fe.elOffset(e),n,r,o;switch(this.container!==document.body&&(n=Fe.elOffset(this.container),i.left-=n.left,i.top-=n.top),t){case"right":r=i.left+e.offsetWidth,o=i.top-1;break;case"bottom":r=i.left,o=i.top+e.offsetHeight;break;case"left":r=i.left,o=i.top-1;break;case"top":r=i.left,o=i.top;break;case"center":r=i.left+e.offsetWidth/2,o=i.top+e.offsetHeight/2;break}return{x:r,y:o,offset:i}}show(e,t){var i,n,r,o,a;return this.destroyed||this.table.destroyed?this:(e instanceof HTMLElement?(r=e,a=this.elementPositionCoords(e,t),o=a.offset,i=a.x,n=a.y):typeof e=="number"?(o={top:0,left:0},i=e,n=t):(a=this.containerEventCoords(e),i=a.x,n=a.y,this.reversedX=!1),this.element.style.top=n+"px",this.element.style.left=i+"px",this.container.appendChild(this.element),typeof this.renderedCallback=="function"&&this.renderedCallback(),this._fitToScreen(i,n,r,o,t),this.visible=!0,this.subscribe("table-destroy",this.destroyBinding),this.element.addEventListener("mousedown",l=>{l.stopPropagation()}),this)}_fitToScreen(e,t,i,n,r){var o=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;(e+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",i?this.element.style.right=this.container.offsetWidth-n.left+"px":this.element.style.right=this.container.offsetWidth-e+"px",this.reversedX=!0);let a=Math.max(this.container.offsetHeight,o?this.container.scrollHeight:0);if(t+this.element.offsetHeight>a)if(i)switch(r){case"bottom":this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-i.offsetHeight-1+"px";break;default:this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+i.offsetHeight+1+"px"}else this.element.style.height=a+"px"}isVisible(){return this.visible}hideOnBlur(e){return this.blurable=!0,this.visible&&(setTimeout(()=>{this.visible&&(this.table.rowManager.element.addEventListener("scroll",this.blurEvent),this.subscribe("cell-editing",this.blurEvent),document.body.addEventListener("click",this.blurEvent),document.body.addEventListener("contextmenu",this.blurEvent),document.body.addEventListener("mousedown",this.blurEvent),window.addEventListener("resize",this.blurEvent),document.body.addEventListener("keydown",this.escEvent),this.blurEventsBound=!0)},100),this.blurCallback=e),this}_escapeCheck(e){e.keyCode==27&&this.hide()}blockHide(){this.hideable=!1}restoreHide(){this.hideable=!0}hide(e=!1){return this.visible&&this.hideable&&(this.blurable&&this.blurEventsBound&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),document.body.removeEventListener("mousedown",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent),this.blurEventsBound=!1),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!e&&this.blurCallback(),this.unsubscribe("table-destroy",this.destroyBinding)),this}child(e){return this.childPopup&&this.childPopup.hide(),this.childPopup=new Mv(this.table,e,this),this.childPopup}};class pe extends lt{constructor(e,t){super(e),this._handler=null}initialize(){}registerTableOption(e,t){this.table.optionsList.register(e,t)}registerColumnOption(e,t){this.table.columnManager.optionsList.register(e,t)}registerTableFunction(e,t){typeof this.table[e]>"u"?this.table[e]=(...i)=>(this.table.initGuard(e),t(...i)):console.warn("Unable to bind table function, name already in use",e)}registerComponentFunction(e,t,i){return this.table.componentFunctionBinder.bind(e,t,i)}registerDataHandler(e,t){this.table.rowManager.registerDataPipelineHandler(e,t),this._handler=e}registerDisplayHandler(e,t){this.table.rowManager.registerDisplayPipelineHandler(e,t),this._handler=e}displayRows(e){var t=this.table.rowManager.displayRows.length-1,i;if(this._handler&&(i=this.table.rowManager.displayPipeline.findIndex(n=>n.handler===this._handler),i>-1&&(t=i)),e&&(t=t+e),this._handler)return t>-1?this.table.rowManager.getDisplayRows(t):this.activeRows()}activeRows(){return this.table.rowManager.activeRows}refreshData(e,t){t||(t=this._handler),t&&this.table.rowManager.refreshActiveData(t,!1,e)}footerAppend(e){return this.table.footerManager.append(e)}footerPrepend(e){return this.table.footerManager.prepend(e)}footerRemove(e){return this.table.footerManager.remove(e)}popup(e,t){return new x2(this.table,e,t)}alert(e,t){return this.table.alertManager.alert(e,t)}clearAlert(){return this.table.alertManager.clear()}}var R2={rownum:function(s,e,t,i,n,r){return r.getPosition()}};const hr=class hr extends pe{constructor(e){super(e),this.allowedTypes=["","data","download","clipboard","print","htmlOutput"],this.registerColumnOption("accessor"),this.registerColumnOption("accessorParams"),this.registerColumnOption("accessorData"),this.registerColumnOption("accessorDataParams"),this.registerColumnOption("accessorDownload"),this.registerColumnOption("accessorDownloadParams"),this.registerColumnOption("accessorClipboard"),this.registerColumnOption("accessorClipboardParams"),this.registerColumnOption("accessorPrint"),this.registerColumnOption("accessorPrintParams"),this.registerColumnOption("accessorHtmlOutput"),this.registerColumnOption("accessorHtmlOutputParams")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}initializeColumn(e){var t=!1,i={};this.allowedTypes.forEach(n=>{var r="accessor"+(n.charAt(0).toUpperCase()+n.slice(1)),o;e.definition[r]&&(o=this.lookupAccessor(e.definition[r]),o&&(t=!0,i[r]={accessor:o,params:e.definition[r+"Params"]||{}}))}),t&&(e.modules.accessor=i)}lookupAccessor(e){var t=!1;switch(typeof e){case"string":hr.accessors[e]?t=hr.accessors[e]:console.warn("Accessor Error - No such accessor found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t){var i="accessor"+(t.charAt(0).toUpperCase()+t.slice(1)),n=e.getComponent(),r=Fe.deepClone(e.data||{});return this.table.columnManager.traverse(function(o){var a,l,h,u;o.modules.accessor&&(l=o.modules.accessor[i]||o.modules.accessor.accessor||!1,l&&(a=o.getFieldValue(r),a!="undefined"&&(u=o.getComponent(),h=typeof l.params=="function"?l.params(a,r,t,u,n):l.params,o.setFieldValue(r,l.accessor(a,r,t,h,u,n)))))}),r}};U(hr,"moduleName","accessor"),U(hr,"accessors",R2);let uc=hr;var S2={method:"GET"};function cc(s,e){var t=[];if(e=e||"",Array.isArray(s))s.forEach((n,r)=>{t=t.concat(cc(n,e?e+"["+r+"]":r))});else if(typeof s=="object")for(var i in s)t=t.concat(cc(s[i],e?e+"["+i+"]":i));else t.push({key:e,value:s});return t}function T2(s){var e=cc(s),t=[];return e.forEach(function(i){t.push(encodeURIComponent(i.key)+"="+encodeURIComponent(i.value))}),t.join("&")}function Lv(s,e,t){return s&&t&&Object.keys(t).length&&(!e.method||e.method.toLowerCase()=="get")&&(e.method="get",s+=(s.includes("?")?"&":"?")+T2(t)),s}function M2(s,e,t){var i;return new Promise((n,r)=>{if(s=this.urlGenerator.call(this.table,s,e,t),e.method.toUpperCase()!="GET")if(i=typeof this.table.options.ajaxContentType=="object"?this.table.options.ajaxContentType:this.contentTypeFormatters[this.table.options.ajaxContentType],i){for(var o in i.headers)e.headers||(e.headers={}),typeof e.headers[o]>"u"&&(e.headers[o]=i.headers[o]);e.body=i.body.call(this,s,e,t)}else console.warn("Ajax Error - Invalid ajaxContentType value:",this.table.options.ajaxContentType);s?(typeof e.headers>"u"&&(e.headers={}),typeof e.headers.Accept>"u"&&(e.headers.Accept="application/json"),typeof e.headers["X-Requested-With"]>"u"&&(e.headers["X-Requested-With"]="XMLHttpRequest"),typeof e.mode>"u"&&(e.mode="cors"),e.mode=="cors"?(typeof e.headers.Origin>"u"&&(e.headers.Origin=window.location.origin),typeof e.credentials>"u"&&(e.credentials="same-origin")):typeof e.credentials>"u"&&(e.credentials="include"),fetch(s,e).then(a=>{a.ok?a.json().then(l=>{n(l)}).catch(l=>{r(l),console.warn("Ajax Load Error - Invalid JSON returned",l)}):(console.error("Ajax Load Error - Connection Error: "+a.status,a.statusText),r(a))}).catch(a=>{console.error("Ajax Load Error - Connection Error: ",a),r(a)})):(console.warn("Ajax Load Error - No URL Set"),n([]))})}function dc(s,e){var t=[];if(e=e||"",Array.isArray(s))s.forEach((n,r)=>{t=t.concat(dc(n,e?e+"["+r+"]":r))});else if(typeof s=="object")for(var i in s)t=t.concat(dc(s[i],e?e+"["+i+"]":i));else t.push({key:e,value:s});return t}var L2={json:{headers:{"Content-Type":"application/json"},body:function(s,e,t){return JSON.stringify(t)}},form:{headers:{},body:function(s,e,t){var i=dc(t),n=new FormData;return i.forEach(function(r){n.append(r.key,r.value)}),n}}};const pi=class pi extends pe{constructor(e){super(e),this.config={},this.url="",this.urlGenerator=!1,this.params=!1,this.loaderPromise=!1,this.registerTableOption("ajaxURL",!1),this.registerTableOption("ajaxURLGenerator",!1),this.registerTableOption("ajaxParams",{}),this.registerTableOption("ajaxConfig","get"),this.registerTableOption("ajaxContentType","form"),this.registerTableOption("ajaxRequestFunc",!1),this.registerTableOption("ajaxRequesting",function(){}),this.registerTableOption("ajaxResponse",!1),this.contentTypeFormatters=pi.contentTypeFormatters}initialize(){this.loaderPromise=this.table.options.ajaxRequestFunc||pi.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||pi.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}requestParams(e,t,i,n){var r=this.table.options.ajaxParams;return r&&(typeof r=="function"&&(r=r.call(this.table)),n=Object.assign(Object.assign({},r),n)),n}requestDataCheck(e,t,i,n){return!!(!e&&this.url||typeof e=="string")}requestData(e,t,i,n,r){var o;return!r&&this.requestDataCheck(e)?(e&&this.setUrl(e),o=this.generateConfig(i),this.sendRequest(this.url,t,o)):r}setDefaultConfig(e={}){this.config=Object.assign({},pi.defaultConfig),typeof e=="string"?this.config.method=e:Object.assign(this.config,e)}generateConfig(e={}){var t=Object.assign({},this.config);return typeof e=="string"?t.method=e:Object.assign(t,e),t}setUrl(e){this.url=e}getUrl(){return this.url}sendRequest(e,t,i){return this.table.options.ajaxRequesting.call(this.table,e,t)!==!1?this.loaderPromise(e,i,t).then(n=>(this.table.options.ajaxResponse&&(n=this.table.options.ajaxResponse.call(this.table,e,t,n)),n)):Promise.reject()}};U(pi,"moduleName","ajax"),U(pi,"defaultConfig",S2),U(pi,"defaultURLGenerator",Lv),U(pi,"defaultLoaderPromise",M2),U(pi,"contentTypeFormatters",L2);let fc=pi;var A2={replace:function(s){return this.table.setData(s)},update:function(s){return this.table.updateOrAddData(s)},insert:function(s){return this.table.addData(s)}},P2={table:function(s){var e=[],t=!0,i=this.table.columnManager.columns,n=[],r=[];return s=s.split(`
`),s.forEach(function(o){e.push(o.split("	"))}),e.length&&!(e.length===1&&e[0].length<2)?(e[0].forEach(function(o){var a=i.find(function(l){return o&&l.definition.title&&o.trim()&&l.definition.title.trim()===o.trim()});a?n.push(a):t=!1}),t||(t=!0,n=[],e[0].forEach(function(o){var a=i.find(function(l){return o&&l.field&&o.trim()&&l.field.trim()===o.trim()});a?n.push(a):t=!1}),t||(n=this.table.columnManager.columnsByIndex)),t&&e.shift(),e.forEach(function(o){var a={};o.forEach(function(l,h){n[h]&&(a[n[h].field]=l)}),r.push(a)}),r):!1}},I2={copyToClipboard:["ctrl + 67","meta + 67"]},O2={copyToClipboard:function(s){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},F2={keybindings:{bindings:I2,actions:O2}};const zn=class zn extends pe{constructor(e){super(e),this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0,this.registerTableOption("clipboard",!1),this.registerTableOption("clipboardCopyStyled",!0),this.registerTableOption("clipboardCopyConfig",!1),this.registerTableOption("clipboardCopyFormatter",!1),this.registerTableOption("clipboardCopyRowRange","active"),this.registerTableOption("clipboardPasteParser","table"),this.registerTableOption("clipboardPasteAction","insert"),this.registerColumnOption("clipboard"),this.registerColumnOption("titleClipboard")}initialize(){this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,(this.mode===!0||this.mode==="copy")&&this.table.element.addEventListener("copy",e=>{var t,i,n;this.blocked||(e.preventDefault(),this.customSelection?(t=this.customSelection,this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t))):(n=this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig,this.table.options.clipboardCopyStyled,this.rowRange,"clipboard"),i=this.table.modules.export.generateHTMLTable(n),t=i?this.generatePlainContent(n):"",this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t),i=this.table.options.clipboardCopyFormatter("html",i))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",t):e.clipboardData&&e.clipboardData.setData?(e.clipboardData.setData("text/plain",t),i&&e.clipboardData.setData("text/html",i)):e.originalEvent&&e.originalEvent.clipboardData.setData&&(e.originalEvent.clipboardData.setData("text/plain",t),i&&e.originalEvent.clipboardData.setData("text/html",i)),this.dispatchExternal("clipboardCopied",t,i),this.reset())}),(this.mode===!0||this.mode==="paste")&&this.table.element.addEventListener("paste",e=>{this.paste(e)}),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}reset(){this.blocked=!0,this.customSelection=!1}generatePlainContent(e){var t=[];return e.forEach(i=>{var n=[];i.columns.forEach(r=>{var o="";if(r)if(i.type==="group"&&(r.value=r.component.getKey()),r.value===null)o="";else switch(typeof r.value){case"object":o=JSON.stringify(r.value);break;case"undefined":o="";break;default:o=r.value}n.push(o)}),t.push(n.join("	"))}),t.join(`
`)}copy(e,t){var i,n;this.blocked=!1,this.customSelection=!1,(this.mode===!0||this.mode==="copy")&&(this.rowRange=e||this.table.options.clipboardCopyRowRange,typeof window.getSelection<"u"&&typeof document.createRange<"u"?(e=document.createRange(),e.selectNodeContents(this.table.element),i=window.getSelection(),i.toString()&&t&&(this.customSelection=i.toString()),i.removeAllRanges(),i.addRange(e)):typeof document.selection<"u"&&typeof document.body.createTextRange<"u"&&(n=document.body.createTextRange(),n.moveToElementText(this.table.element),n.select()),document.execCommand("copy"),i&&i.removeAllRanges())}setPasteAction(e){switch(typeof e){case"string":this.pasteAction=zn.pasteActions[e],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",e);break;case"function":this.pasteAction=e;break}}setPasteParser(e){switch(typeof e){case"string":this.pasteParser=zn.pasteParsers[e],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",e);break;case"function":this.pasteParser=e;break}}paste(e){var t,i,n;this.checkPasteOrigin(e)&&(t=this.getPasteData(e),i=this.pasteParser.call(this,t),i?(e.preventDefault(),this.table.modExists("mutator")&&(i=this.mutateData(i)),n=this.pasteAction.call(this,i),this.dispatchExternal("clipboardPasted",t,i,n)):this.dispatchExternal("clipboardPasteError",t))}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(i=>{t.push(this.table.modules.mutator.transformRow(i,"clipboard"))}):t=e,t}checkPasteOrigin(e){var t=!0,i=this.confirm("clipboard-paste",[e]);return(i||!["DIV","SPAN"].includes(e.target.tagName))&&(t=!1),t}getPasteData(e){var t;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?t=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text/plain")),t}};U(zn,"moduleName","clipboard"),U(zn,"moduleExtensions",F2),U(zn,"pasteActions",A2),U(zn,"pasteParsers",P2);let gc=zn;class D2{constructor(e){return this._row=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._row.table.componentFunctionBinder.handle("row",t._row,i)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getTable(){return this._row.table}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}_getSelf(){return this._row}}class Av{constructor(e){return this._cell=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._cell.table.componentFunctionBinder.handle("cell",t._cell,i)}})}getValue(){return this._cell.getValue()}getOldValue(){return this._cell.getOldValue()}getInitialValue(){return this._cell.initialValue}getElement(){return this._cell.getElement()}getRow(){return this._cell.row.getComponent()}getData(e){return this._cell.row.getData(e)}getType(){return"cell"}getField(){return this._cell.column.getField()}getColumn(){return this._cell.column.getComponent()}setValue(e,t){typeof t>"u"&&(t=!0),this._cell.setValue(e,t)}restoreOldValue(){this._cell.setValueActual(this._cell.getOldValue())}restoreInitialValue(){this._cell.setValueActual(this._cell.initialValue)}checkHeight(){this._cell.checkHeight()}getTable(){return this._cell.table}_getSelf(){return this._cell}}class ga extends lt{constructor(e,t){super(e.table),this.table=e.table,this.column=e,this.row=t,this.element=null,this.value=null,this.initialValue,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.component=null,this.loaded=!1,this.build()}build(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}generateElement(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.column.isRowHeader&&this.element.classList.add("tabulator-row-header")}_configureCell(){var e=this.element,t=this.column.getField(),i={top:"flex-start",bottom:"flex-end",middle:"center"},n={left:"flex-start",right:"flex-end",center:"center"};if(e.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(e.style.display="inline-flex",e.style.alignItems=i[this.column.vertAlign]||"",this.column.hozAlign&&(e.style.justifyContent=n[this.column.hozAlign]||"")),t&&e.setAttribute("tabulator-field",t),this.column.definition.cssClass){var r=this.column.definition.cssClass.split(" ");r.forEach(o=>{e.classList.add(o)})}this.dispatch("cell-init",this),this.column.visible||this.hide()}_generateContents(){var e;switch(e=this.chain("cell-format",this,null,()=>this.element.innerHTML=this.value),typeof e){case"object":if(e instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(e)}else this.element.innerHTML="",e!=null&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",e);break;case"undefined":this.element.innerHTML="";break;default:this.element.innerHTML=e}}cellRendered(){this.dispatch("cell-rendered",this)}getElement(e){return this.loaded||(this.loaded=!0,e||this.layoutElement()),this.element}getValue(){return this.value}getOldValue(){return this.oldValue}setValue(e,t,i){var n=this.setValueProcessData(e,t,i);n&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}setValueProcessData(e,t,i){var n=!1;return(this.value!==e||i)&&(n=!0,t&&(e=this.chain("cell-value-changing",[this,e],null,e))),this.setValueActual(e),n&&this.dispatch("cell-value-changed",this),n}setValueActual(e){this.oldValue=this.value,this.value=e,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,e),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}layoutElement(){this._generateContents(),this.dispatch("cell-layout",this)}setWidth(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}clearWidth(){this.width="",this.element.style.width=""}getWidth(){return this.width||this.element.offsetWidth}setMinWidth(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}setMaxWidth(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}checkHeight(){this.row.reinitializeHeight()}clearHeight(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}setHeight(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}getHeight(){return this.height||this.element.offsetHeight}show(){this.element.style.display=this.column.vertAlign?"inline-flex":""}hide(){this.element.style.display="none"}delete(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}getIndex(){return this.row.getCellIndex(this)}getComponent(){return this.component||(this.component=new Av(this)),this.component}}class Pv{constructor(e){return this._column=e,this.type="ColumnComponent",new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._column.table.componentFunctionBinder.handle("column",t._column,i)}})}getElement(){return this._column.getElement()}getDefinition(){return this._column.getDefinition()}getField(){return this._column.getField()}getTitleDownload(){return this._column.getTitleDownload()}getCells(){var e=[];return this._column.cells.forEach(function(t){e.push(t.getComponent())}),e}isVisible(){return this._column.visible}show(){this._column.isGroup?this._column.columns.forEach(function(e){e.show()}):this._column.show()}hide(){this._column.isGroup?this._column.columns.forEach(function(e){e.hide()}):this._column.hide()}toggle(){this._column.visible?this.hide():this.show()}delete(){return this._column.delete()}getSubColumns(){var e=[];return this._column.columns.length&&this._column.columns.forEach(function(t){e.push(t.getComponent())}),e}getParentColumn(){return this._column.getParentComponent()}_getSelf(){return this._column}scrollTo(e,t){return this._column.table.columnManager.scrollToColumn(this._column,e,t)}getTable(){return this._column.table}move(e,t){var i=this._column.table.columnManager.findColumn(e);i?this._column.table.columnManager.moveColumn(this._column,i,t):console.warn("Move Error - No matching column found:",i)}getNextColumn(){var e=this._column.nextColumn();return e?e.getComponent():!1}getPrevColumn(){var e=this._column.prevColumn();return e?e.getComponent():!1}updateDefinition(e){return this._column.updateDefinition(e)}getWidth(){return this._column.getWidth()}setWidth(e){var t;return e===!0?t=this._column.reinitializeWidth(!0):t=this._column.setWidth(e),this._column.table.columnManager.rerenderColumns(!0),t}}var Iv={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,headerWordWrap:!1,editableTitle:void 0};const ds=class ds extends lt{constructor(e,t,i){super(t.table),this.definition=e,this.parent=t,this.type="column",this.columns=[],this.cells=[],this.isGroup=!1,this.isRowHeader=i,this.element=this.createElement(),this.contentElement=!1,this.titleHolderElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleDownload=null,this.titleFormatterRendered=!1,this.mapDefinitions(),this.setField(this.definition.field),this.modules={},this.width=null,this.widthStyled="",this.maxWidth=null,this.maxWidthStyled="",this.maxInitialWidth=null,this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this.component=null,this.definition.columns?(this.isGroup=!0,this.definition.columns.forEach((n,r)=>{var o=new ds(n,this);this.attachColumn(o)}),this.checkColumnVisibility()):t.registerColumnField(this),this._initialize()}createElement(){var e=document.createElement("div");switch(e.classList.add("tabulator-col"),e.setAttribute("role","columnheader"),e.setAttribute("aria-sort","none"),this.isRowHeader&&e.classList.add("tabulator-row-header"),this.table.options.columnHeaderVertAlign){case"middle":e.style.justifyContent="center";break;case"bottom":e.style.justifyContent="flex-end";break}return e}createGroupElement(){var e=document.createElement("div");return e.classList.add("tabulator-col-group-cols"),e}mapDefinitions(){var e=this.table.options.columnDefaults;if(e)for(let t in e)typeof this.definition[t]>"u"&&(this.definition[t]=e[t]);this.definition=this.table.columnManager.optionsList.generate(ds.defaultOptionList,this.definition)}checkDefinition(){Object.keys(this.definition).forEach(e=>{ds.defaultOptionList.indexOf(e)===-1&&console.warn("Invalid column definition option in '"+(this.field||this.definition.title)+"' column:",e)})}setField(e){this.field=e,this.fieldStructure=e?this.table.options.nestedFieldSeparator?e.split(this.table.options.nestedFieldSeparator):[e]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}registerColumnPosition(e){this.parent.registerColumnPosition(e)}registerColumnField(e){this.parent.registerColumnField(e)}reRegisterPosition(){this.isGroup?this.columns.forEach(function(e){e.reRegisterPosition()}):this.registerColumnPosition(this)}_initialize(){for(var e=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);e.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),e.headerVertical==="flip"&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}_buildColumnHeader(){var e=this.definition;if(this.dispatch("column-layout",this),typeof e.visible<"u"&&(e.visible?this.show(!0):this.hide(!0)),e.cssClass){var t=e.cssClass.split(" ");t.forEach(i=>{this.element.classList.add(i)})}e.field&&this.element.setAttribute("tabulator-field",e.field),this.setMinWidth(parseInt(e.minWidth)),e.maxInitialWidth&&(this.maxInitialWidth=parseInt(e.maxInitialWidth)),e.maxWidth&&this.setMaxWidth(parseInt(e.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}_buildColumnHeaderContent(){var e=document.createElement("div");return e.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),e.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),e}_buildColumnHeaderTitle(){var e=this.definition,t=document.createElement("div");if(t.classList.add("tabulator-col-title"),e.headerWordWrap&&t.classList.add("tabulator-col-title-wrap"),e.editableTitle){var i=document.createElement("input");i.classList.add("tabulator-title-editor"),i.addEventListener("click",n=>{n.stopPropagation(),i.focus()}),i.addEventListener("mousedown",n=>{n.stopPropagation()}),i.addEventListener("change",()=>{e.title=i.value,this.dispatchExternal("columnTitleChanged",this.getComponent())}),t.appendChild(i),e.field?this.langBind("columns|"+e.field,n=>{i.value=n||e.title||"&nbsp;"}):i.value=e.title||"&nbsp;"}else e.field?this.langBind("columns|"+e.field,n=>{this._formatColumnHeaderTitle(t,n||e.title||"&nbsp;")}):this._formatColumnHeaderTitle(t,e.title||"&nbsp;");return t}_formatColumnHeaderTitle(e,t){var i=this.chain("column-format",[this,t,e],null,()=>t);switch(typeof i){case"object":i instanceof Node?e.appendChild(i):(e.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",i));break;case"undefined":e.innerHTML="";break;default:e.innerHTML=i}}_buildGroupHeader(){if(this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass){var e=this.definition.cssClass.split(" ");e.forEach(t=>{this.element.classList.add(t)})}this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}_getFlatData(e){return e[this.field]}_getNestedData(e){var t=e,i=this.fieldStructure,n=i.length,r;for(let o=0;o<n&&(t=t[i[o]],r=t,!!t);o++);return r}_setFlatData(e,t){this.field&&(e[this.field]=t)}_setNestedData(e,t){var i=e,n=this.fieldStructure,r=n.length;for(let o=0;o<r;o++)if(o==r-1)i[n[o]]=t;else{if(!i[n[o]])if(typeof t<"u")i[n[o]]={};else break;i=i[n[o]]}}attachColumn(e){this.groupElement?(this.columns.push(e),this.groupElement.appendChild(e.getElement()),e.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}verticalAlign(e,t){var i=this.parent.isGroup?this.parent.getGroupElement().clientHeight:t||this.parent.getHeadersElement().clientHeight;this.element.style.height=i+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=i-this.contentElement.offsetHeight+"px"),this.columns.forEach(function(n){n.verticalAlign(e)})}clearVerticalAlign(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach(function(e){e.clearVerticalAlign()}),this.dispatch("column-height",this,"")}getElement(){return this.element}getGroupElement(){return this.groupElement}getField(){return this.field}getTitleDownload(){return this.titleDownload}getFirstColumn(){return this.isGroup?this.columns.length?this.columns[0].getFirstColumn():!1:this}getLastColumn(){return this.isGroup?this.columns.length?this.columns[this.columns.length-1].getLastColumn():!1:this}getColumns(e){var t=[];return e?this.columns.forEach(i=>{t.push(i),t=t.concat(i.getColumns(!0))}):t=this.columns,t}getCells(){return this.cells}getTopColumn(){return this.parent.isGroup?this.parent.getTopColumn():this}getDefinition(e){var t=[];return this.isGroup&&e&&(this.columns.forEach(function(i){t.push(i.getDefinition(!0))}),this.definition.columns=t),this.definition}checkColumnVisibility(){var e=!1;this.columns.forEach(function(t){t.visible&&(e=!0)}),e?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}show(e,t){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.show()}),!this.isGroup&&this.width===null&&this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}hide(e,t){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.hide()}),this.dispatch("column-hide",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}matchChildWidths(){var e=0;this.contentElement&&this.columns.length&&(this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}),this.contentElement.style.maxWidth=e-1+"px",this.table.initialized&&(this.element.style.width=e+"px"),this.parent.isGroup&&this.parent.matchChildWidths())}removeChild(e){var t=this.columns.indexOf(e);t>-1&&this.columns.splice(t,1),this.columns.length||this.delete()}setWidth(e){this.widthFixed=!0,this.setWidthActual(e)}setWidthActual(e){isNaN(e)&&(e=Math.floor(this.table.element.clientWidth/100*parseInt(e))),e=Math.max(this.minWidth,e),this.maxWidth&&(e=Math.min(this.maxWidth,e)),this.width=e,this.widthStyled=e?e+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach(function(t){t.setWidth()}),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this),this.subscribedExternal("columnWidth")&&this.dispatchExternal("columnWidth",this.getComponent())}checkCellHeights(){var e=[];this.cells.forEach(function(t){t.row.heightInitialized&&(t.row.getElement().offsetParent!==null?(e.push(t.row),t.row.clearCellHeight()):t.row.heightInitialized=!1)}),e.forEach(function(t){t.calcHeight()}),e.forEach(function(t){t.setCellHeight()})}getWidth(){var e=0;return this.isGroup?this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}):e=this.width,e}getLeftOffset(){var e=this.element.offsetLeft;return this.parent.isGroup&&(e+=this.parent.getLeftOffset()),e}getHeight(){return Math.ceil(this.element.getBoundingClientRect().height)}setMinWidth(e){this.maxWidth&&e>this.maxWidth&&(e=this.maxWidth,console.warn("the minWidth ("+e+"px) for column '"+this.field+"' cannot be bigger that its maxWidth ("+this.maxWidthStyled+")")),this.minWidth=e,this.minWidthStyled=e?e+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach(function(t){t.setMinWidth()})}setMaxWidth(e){this.minWidth&&e<this.minWidth&&(e=this.minWidth,console.warn("the maxWidth ("+e+"px) for column '"+this.field+"' cannot be smaller that its minWidth ("+this.minWidthStyled+")")),this.maxWidth=e,this.maxWidthStyled=e?e+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach(function(t){t.setMaxWidth()})}delete(){return new Promise((e,t)=>{this.isGroup&&this.columns.forEach(function(n){n.delete()}),this.dispatch("column-delete",this);var i=this.cells.length;for(let n=0;n<i;n++)this.cells[0].delete();this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.contentElement=!1,this.titleElement=!1,this.groupElement=!1,this.parent.isGroup&&this.parent.removeChild(this),this.table.columnManager.deregisterColumn(this),this.table.columnManager.rerenderColumns(!0),this.dispatch("column-deleted",this),e()})}columnRendered(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}generateCell(e){var t=new ga(this,e);return this.cells.push(t),t}nextColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._nextVisibleColumn(e+1):!1}_nextVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._nextVisibleColumn(e+1)}prevColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._prevVisibleColumn(e-1):!1}_prevVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._prevVisibleColumn(e-1)}reinitializeWidth(e){this.widthFixed=!1,typeof this.definition.width<"u"&&!e&&this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(e),this.dispatch("column-width-fit-after",this)}fitToData(e){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach(n=>{n.clearWidth()}));var t=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach(n=>{var r=n.getWidth();r>t&&(t=r)}),t)){var i=t+1;this.maxInitialWidth&&!e&&(i=Math.min(i,this.maxInitialWidth)),this.setWidthActual(i)}}}updateDefinition(e){var t;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(t=Object.assign({},this.getDefinition()),t=Object.assign(t,e),this.table.columnManager.addColumn(t,!1,this).then(i=>(t.field==this.field&&(this.field=!1),this.delete().then(()=>i.getComponent()))))}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}getComponent(){return this.component||(this.component=new Pv(this)),this.component}getPosition(){return this.table.columnManager.getVisibleColumnsByIndex().indexOf(this)+1}getParentComponent(){return this.parent instanceof ds?this.parent.getComponent():!1}};U(ds,"defaultOptionList",Iv);let xs=ds;class Rh{constructor(e){return this._row=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._row.table.componentFunctionBinder.handle("row",t._row,i)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}getIndex(){return this._row.getData("data")[this._row.table.options.index]}getPosition(){return this._row.getPosition()}watchPosition(e){return this._row.watchPosition(e)}delete(){return this._row.delete()}scrollTo(e,t){return this._row.table.rowManager.scrollToRow(this._row,e,t)}move(e,t){this._row.moveToRow(e,t)}update(e){return this._row.updateData(e)}normalizeHeight(){this._row.normalizeHeight(!0)}_getSelf(){return this._row}reformat(){return this._row.reinitialize()}getTable(){return this._row.table}getNextRow(){var e=this._row.nextRow();return e&&e.getComponent()}getPrevRow(){var e=this._row.prevRow();return e&&e.getComponent()}}class Et extends lt{constructor(e,t,i="row"){super(t.table),this.parent=t,this.data={},this.type=i,this.element=!1,this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.position=0,this.positionWatchers=[],this.component=null,this.created=!1,this.setData(e)}create(){this.created||(this.created=!0,this.generateElement())}createElement(){var e=document.createElement("div");e.classList.add("tabulator-row"),e.setAttribute("role","row"),this.element=e}getElement(){return this.create(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}generateElement(){this.createElement(),this.dispatch("row-init",this)}generateCells(){this.cells=this.table.columnManager.generateCells(this)}initialize(e,t){if(this.create(),!this.initialized||e){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this,t),e&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this,t)}rendered(){this.cells.forEach(e=>{e.cellRendered()})}reinitializeHeight(){this.heightInitialized=!1,this.element&&this.element.offsetParent!==null&&this.normalizeHeight(!0)}deinitialize(){this.initialized=!1}deinitializeHeight(){this.heightInitialized=!1}reinitialize(e){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&this.element.offsetParent!==null&&this.initialize(!0),this.dispatch("row-relayout",this)}calcHeight(e){var t=0,i=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(i=this.calcMinHeight(),t=this.calcMaxHeight(),e?this.height=Math.max(t,i):this.height=this.manualHeight?this.height:Math.max(t,i)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}calcMinHeight(){return this.table.options.resizableRows?this.element.clientHeight:0}calcMaxHeight(){var e=0;return this.cells.forEach(function(t){var i=t.getHeight();i>e&&(e=i)}),e}setCellHeight(){this.cells.forEach(function(e){e.setHeight()}),this.heightInitialized=!0}clearCellHeight(){this.cells.forEach(function(e){e.clearHeight()})}normalizeHeight(e){e&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(e),this.setCellHeight()}setHeight(e,t){(this.height!=e||t)&&(this.manualHeight=!0,this.height=e,this.heightStyled=e?e+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight,this.subscribedExternal("rowHeight")&&this.dispatchExternal("rowHeight",this.getComponent()))}getHeight(){return this.outerHeight}getWidth(){return this.element.offsetWidth}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}setData(e){this.data=this.chain("row-data-init-before",[this,e],void 0,e),this.dispatch("row-data-init-after",this)}updateData(e){var t=this.element&&Fe.elVisible(this.element),i={},n;return new Promise((r,o)=>{typeof e=="string"&&(e=JSON.parse(e)),this.dispatch("row-data-save-before",this),this.subscribed("row-data-changing")&&(i=Object.assign(i,this.data),i=Object.assign(i,e)),n=this.chain("row-data-changing",[this,i,e],null,e);for(let a in n)this.data[a]=n[a];this.dispatch("row-data-save-after",this);for(let a in e)this.table.columnManager.getColumnsByFieldRoot(a).forEach(h=>{let u=this.getCell(h.getField());if(u){let c=h.getFieldValue(n);u.getValue()!==c&&(u.setValueProcessData(c),t&&u.cellRendered())}});t?(this.normalizeHeight(!0),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent())):(this.initialized=!1,this.height=0,this.heightStyled=""),this.dispatch("row-data-changed",this,t,e),this.dispatchExternal("rowUpdated",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),r()})}getData(e){return e?this.chain("row-data-retrieve",[this,e],null,this.data):this.data}getCell(e){var t=!1;return e=this.table.columnManager.findColumn(e),!this.initialized&&this.cells.length===0&&this.generateCells(),t=this.cells.find(function(i){return i.column===e}),t}getCellIndex(e){return this.cells.findIndex(function(t){return t===e})}findCell(e){return this.cells.find(t=>t.element===e)}getCells(){return!this.initialized&&this.cells.length===0&&this.generateCells(),this.cells}nextRow(){var e=this.table.rowManager.nextDisplayRow(this,!0);return e||!1}prevRow(){var e=this.table.rowManager.prevDisplayRow(this,!0);return e||!1}moveToRow(e,t){var i=this.table.rowManager.findRow(e);i?(this.table.rowManager.moveRowActual(this,i,!t),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",e)}delete(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}deleteActual(e){this.detachModules(),this.table.rowManager.deleteRow(this,e),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}detachModules(){this.dispatch("row-deleting",this)}deleteCells(){var e=this.cells.length;for(let t=0;t<e;t++)this.cells[0].delete()}wipe(){if(this.detachModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}isDisplayed(){return this.table.rowManager.getDisplayRows().includes(this)}getPosition(){return this.isDisplayed()?this.position:!1}setPosition(e){e!=this.position&&(this.position=e,this.positionWatchers.forEach(t=>{t(this.position)}))}watchPosition(e){this.positionWatchers.push(e),e(this.position)}getGroup(){return this.modules.group||!1}getComponent(){return this.component||(this.component=new Rh(this)),this.component}}var k2={avg:function(s,e,t){var i=0,n=typeof t.precision<"u"?t.precision:2;return s.length&&(i=s.reduce(function(r,o){return Number(r)+Number(o)}),i=i/s.length,i=n!==!1?i.toFixed(n):i),parseFloat(i).toString()},max:function(s,e,t){var i=null,n=typeof t.precision<"u"?t.precision:!1;return s.forEach(function(r){r=Number(r),(r>i||i===null)&&(i=r)}),i!==null?n!==!1?i.toFixed(n):i:""},min:function(s,e,t){var i=null,n=typeof t.precision<"u"?t.precision:!1;return s.forEach(function(r){r=Number(r),(r<i||i===null)&&(i=r)}),i!==null?n!==!1?i.toFixed(n):i:""},sum:function(s,e,t){var i=0,n=typeof t.precision<"u"?t.precision:!1;return s.length&&s.forEach(function(r){r=Number(r),i+=isNaN(r)?0:Number(r)}),n!==!1?i.toFixed(n):i},concat:function(s,e,t){var i=0;return s.length&&(i=s.reduce(function(n,r){return String(n)+String(r)})),i},count:function(s,e,t){var i=0;return s.length&&s.forEach(function(n){n&&i++}),i},unique:function(s,e,t){var i=s.filter((n,r)=>(s||n===0)&&s.indexOf(n)===r);return i.length}};const Gn=class Gn extends pe{constructor(e){super(e),this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.blocked=!1,this.recalcAfterBlock=!1,this.registerTableOption("columnCalcs",!0),this.registerColumnOption("topCalc"),this.registerColumnOption("topCalcParams"),this.registerColumnOption("topCalcFormatter"),this.registerColumnOption("topCalcFormatterParams"),this.registerColumnOption("bottomCalc"),this.registerColumnOption("bottomCalcParams"),this.registerColumnOption("bottomCalcFormatter"),this.registerColumnOption("bottomCalcFormatterParams")}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-calcs-holder"),e}initialize(){this.genColumn=new xs({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this)),this.subscribe("redraw-blocked",this.blockRedraw.bind(this)),this.subscribe("redraw-restored",this.restoreRedraw.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this)),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}tableRedraw(e){this.recalc(this.table.rowManager.activeRows),e&&this.redraw()}blockRedraw(){this.blocked=!0,this.recalcAfterBlock=!1}restoreRedraw(){this.blocked=!1,this.recalcAfterBlock&&(this.recalcAfterBlock=!1,this.recalcActiveRowsRefresh())}userRecalc(){this.recalc(this.table.rowManager.activeRows)}blockCheck(){return this.blocked&&(this.recalcAfterBlock=!0),this.blocked}visibleRows(e,t){return this.topRow&&t.unshift(this.topRow),this.botRow&&t.push(this.botRow),t}rowsUpdated(e){this.table.options.groupBy?this.recalcRowGroup(e):this.recalcActiveRows()}recalcActiveRowsRefresh(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}recalcActiveRows(){this.recalc(this.table.rowManager.activeRows)}cellValueChanged(e){(e.column.definition.topCalc||e.column.definition.bottomCalc)&&(this.table.options.groupBy?((this.table.options.columnCalcs=="table"||this.table.options.columnCalcs=="both")&&this.recalcActiveRows(),this.table.options.columnCalcs!="table"&&this.recalcRowGroup(e.row)):this.recalcActiveRows())}initializeColumnCheck(e){(e.definition.topCalc||e.definition.bottomCalc)&&this.initializeColumn(e)}initializeColumn(e){var t=e.definition,i={topCalcParams:t.topCalcParams||{},botCalcParams:t.bottomCalcParams||{}};if(t.topCalc){switch(typeof t.topCalc){case"string":Gn.calculations[t.topCalc]?i.topCalc=Gn.calculations[t.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.topCalc);break;case"function":i.topCalc=t.topCalc;break}i.topCalc&&(e.modules.columnCalcs=i,this.topCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeTopRow())}if(t.bottomCalc){switch(typeof t.bottomCalc){case"string":Gn.calculations[t.bottomCalc]?i.botCalc=Gn.calculations[t.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.bottomCalc);break;case"function":i.botCalc=t.bottomCalc;break}i.botCalc&&(e.modules.columnCalcs=i,this.botCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeBottomRow())}}registerColumnField(){}removeCalcs(){var e=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),e=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),e=!0),e&&this.table.rowManager.adjustTableSize()}reinitializeCalcs(){this.topCalcs.length&&this.initializeTopRow(),this.botCalcs.length&&this.initializeBottomRow()}initializeTopRow(){var e=document.createDocumentFragment();this.topInitialized||(e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}initializeBottomRow(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}scrollHorizontal(e){this.botInitialized&&this.botRow&&(this.botElement.scrollLeft=e)}recalc(e){var t,i;if(!this.blockCheck()&&(this.topInitialized||this.botInitialized)){if(t=this.rowsToData(e),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),i=this.generateRow("top",t),this.topRow=i;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(i.getElement()),i.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),i=this.generateRow("bottom",t),this.botRow=i;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(i.getElement()),i.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}recalcRowGroup(e){this.recalcGroup(this.table.modules.groupRows.getRowGroup(e))}recalcAll(){if((this.topCalcs.length||this.botCalcs.length)&&(this.table.options.columnCalcs!=="group"&&this.recalcActiveRows(),this.table.options.groupBy&&this.table.options.columnCalcs!=="table")){var e=this.table.modules.groupRows.getChildGroups();e.forEach(t=>{this.recalcGroup(t)})}}recalcGroup(e){var t,i;this.blockCheck()||e&&e.calcs&&(e.calcs.bottom&&(t=this.rowsToData(e.rows),i=this.generateRowData("bottom",t),e.calcs.bottom.updateData(i),e.calcs.bottom.reinitialize()),e.calcs.top&&(t=this.rowsToData(e.rows),i=this.generateRowData("top",t),e.calcs.top.updateData(i),e.calcs.top.reinitialize()))}generateTopRow(e){return this.generateRow("top",this.rowsToData(e))}generateBottomRow(e){return this.generateRow("bottom",this.rowsToData(e))}rowsToData(e){var t=[],i=this.table.options.dataTree&&this.table.options.dataTreeChildColumnCalcs,n=this.table.modules.dataTree;return e.forEach(r=>{var o;t.push(r.getData()),i&&((o=r.modules.dataTree)!=null&&o.open)&&this.rowsToData(n.getFilteredTreeChildren(r)).forEach(a=>{t.push(r)})}),t}generateRow(e,t){var i=this.generateRowData(e,t),n;return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),n=new Et(i,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),n.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+e),n.component=!1,n.getComponent=()=>(n.component||(n.component=new D2(n)),n.component),n.generateCells=()=>{var r=[];this.table.columnManager.columnsByIndex.forEach(o=>{this.genColumn.setField(o.getField()),this.genColumn.hozAlign=o.hozAlign,o.definition[e+"CalcFormatter"]&&this.table.modExists("format")?this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter(o.definition[e+"CalcFormatter"]),params:o.definition[e+"CalcFormatterParams"]||{}}:this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter("plaintext"),params:{}},this.genColumn.definition.cssClass=o.definition.cssClass;var a=new ga(this.genColumn,n);a.getElement(),a.column=o,a.setWidth(),o.cells.push(a),r.push(a),o.visible||a.hide()}),n.cells=r},n}generateRowData(e,t){var i={},n=e=="top"?this.topCalcs:this.botCalcs,r=e=="top"?"topCalc":"botCalc",o,a;return n.forEach(function(l){var h=[];l.modules.columnCalcs&&l.modules.columnCalcs[r]&&(t.forEach(function(u){h.push(l.getFieldValue(u))}),a=r+"Params",o=typeof l.modules.columnCalcs[a]=="function"?l.modules.columnCalcs[a](h,t):l.modules.columnCalcs[a],l.setFieldValue(i,l.modules.columnCalcs[r](h,t,o)))}),i}hasTopCalcs(){return!!this.topCalcs.length}hasBottomCalcs(){return!!this.botCalcs.length}redraw(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}getResults(){var e={},t;return this.table.options.groupBy&&this.table.modExists("groupRows")?(t=this.table.modules.groupRows.getGroups(!0),t.forEach(i=>{e[i.getKey()]=this.getGroupResults(i)})):e={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},e}getGroupResults(e){var t=e._getSelf(),i=e.getSubGroups(),n={},r={};return i.forEach(o=>{n[o.getKey()]=this.getGroupResults(o)}),r={top:t.calcs.top?t.calcs.top.getData():{},bottom:t.calcs.bottom?t.calcs.bottom.getData():{},groups:n},r}adjustForScrollbar(e){this.botRow&&(this.table.rtl?this.botElement.style.paddingLeft=e+"px":this.botElement.style.paddingRight=e+"px")}};U(Gn,"moduleName","columnCalcs"),U(Gn,"calculations",k2);let pc=Gn;class Ov extends pe{constructor(e){super(e),this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.registerTableOption("dataTree",!1),this.registerTableOption("dataTreeFilter",!0),this.registerTableOption("dataTreeSort",!0),this.registerTableOption("dataTreeElementColumn",!1),this.registerTableOption("dataTreeBranchElement",!0),this.registerTableOption("dataTreeChildIndent",9),this.registerTableOption("dataTreeChildField","_children"),this.registerTableOption("dataTreeCollapseElement",!1),this.registerTableOption("dataTreeExpandElement",!1),this.registerTableOption("dataTreeStartExpanded",!1),this.registerTableOption("dataTreeChildColumnCalcs",!1),this.registerTableOption("dataTreeSelectPropagate",!1),this.registerComponentFunction("row","treeCollapse",this.collapseRow.bind(this)),this.registerComponentFunction("row","treeExpand",this.expandRow.bind(this)),this.registerComponentFunction("row","treeToggle",this.toggleRow.bind(this)),this.registerComponentFunction("row","getTreeParent",this.getTreeParent.bind(this)),this.registerComponentFunction("row","getTreeChildren",this.getRowChildren.bind(this)),this.registerComponentFunction("row","addTreeChild",this.addTreeChildRow.bind(this)),this.registerComponentFunction("row","isTreeExpanded",this.isRowExpanded.bind(this))}initialize(){if(this.table.options.dataTree){var e=null,t=this.table.options;switch(this.field=t.dataTreeChildField,this.indent=t.dataTreeChildIndent,this.options("movableRows")&&console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"),t.dataTreeBranchElement?t.dataTreeBranchElement===!0?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):typeof t.dataTreeBranchElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeBranchElement,this.branchEl=e.firstChild):this.branchEl=t.dataTreeBranchElement:(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch-empty")),t.dataTreeCollapseElement?typeof t.dataTreeCollapseElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeCollapseElement,this.collapseEl=e.firstChild):this.collapseEl=t.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),t.dataTreeExpandElement?typeof t.dataTreeExpandElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeExpandElement,this.expandEl=e.firstChild):this.expandEl=t.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),typeof t.dataTreeStartExpanded){case"boolean":this.startOpen=function(i,n){return t.dataTreeStartExpanded};break;case"function":this.startOpen=t.dataTreeStartExpanded;break;default:this.startOpen=function(i,n){return t.dataTreeStartExpanded[n]};break}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.subscribe("table-redrawing",this.tableRedrawing.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}tableRedrawing(e){var t;e&&(t=this.table.rowManager.getRows(),t.forEach(i=>{this.reinitializeRowChildren(i)}))}initializeElementField(){var e=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||(e?e.field:!1)}getRowChildren(e){return this.getTreeChildren(e,!0)}columnMoving(){var e=[];return this.table.rowManager.rows.forEach(t=>{e=e.concat(this.getTreeChildren(t,!1,!0))}),e}rowDataChanged(e,t,i){this.redrawNeeded(i)&&(this.initializeRow(e),t&&(this.layoutRow(e),this.refreshData(!0)))}cellValueChanged(e){var t=e.column.getField();t===this.elementField&&this.layoutRow(e.row)}initializeRow(e){var t=e.getData()[this.field],i=Array.isArray(t),n=i||!i&&typeof t=="object"&&t!==null;!n&&e.modules.dataTree&&e.modules.dataTree.branchEl&&e.modules.dataTree.branchEl.parentNode.removeChild(e.modules.dataTree.branchEl),!n&&e.modules.dataTree&&e.modules.dataTree.controlEl&&e.modules.dataTree.controlEl.parentNode.removeChild(e.modules.dataTree.controlEl),e.modules.dataTree={index:e.modules.dataTree?e.modules.dataTree.index:0,open:n?e.modules.dataTree?e.modules.dataTree.open:this.startOpen(e.getComponent(),0):!1,controlEl:e.modules.dataTree&&n?e.modules.dataTree.controlEl:!1,branchEl:e.modules.dataTree&&n?e.modules.dataTree.branchEl:!1,parent:e.modules.dataTree?e.modules.dataTree.parent:!1,children:n}}reinitializeRowChildren(e){var t=this.getTreeChildren(e,!1,!0);t.forEach(function(i){i.reinitialize(!0)})}layoutRow(e){var t=this.elementField?e.getCell(this.elementField):e.getCells()[0],i=t.getElement(),n=e.modules.dataTree;n.branchEl&&(n.branchEl.parentNode&&n.branchEl.parentNode.removeChild(n.branchEl),n.branchEl=!1),n.controlEl&&(n.controlEl.parentNode&&n.controlEl.parentNode.removeChild(n.controlEl),n.controlEl=!1),this.generateControlElement(e,i),e.getElement().classList.add("tabulator-tree-level-"+n.index),n.index&&(this.branchEl?(n.branchEl=this.branchEl.cloneNode(!0),i.insertBefore(n.branchEl,i.firstChild),this.table.rtl?n.branchEl.style.marginRight=(n.branchEl.offsetWidth+n.branchEl.style.marginLeft)*(n.index-1)+n.index*this.indent+"px":n.branchEl.style.marginLeft=(n.branchEl.offsetWidth+n.branchEl.style.marginRight)*(n.index-1)+n.index*this.indent+"px"):this.table.rtl?i.style.paddingRight=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-right"))+n.index*this.indent+"px":i.style.paddingLeft=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-left"))+n.index*this.indent+"px")}generateControlElement(e,t){var i=e.modules.dataTree,n=i.controlEl;t=t||e.getCells()[0].getElement(),i.children!==!1&&(i.open?(i.controlEl=this.collapseEl.cloneNode(!0),i.controlEl.addEventListener("click",r=>{r.stopPropagation(),this.collapseRow(e)})):(i.controlEl=this.expandEl.cloneNode(!0),i.controlEl.addEventListener("click",r=>{r.stopPropagation(),this.expandRow(e)})),i.controlEl.addEventListener("mousedown",r=>{r.stopPropagation()}),n&&n.parentNode===t?n.parentNode.replaceChild(i.controlEl,n):t.insertBefore(i.controlEl,t.firstChild))}getRows(e){var t=[];return e.forEach((i,n)=>{var r,o;t.push(i),i instanceof Et&&(i.create(),r=i.modules.dataTree,!r.index&&r.children!==!1&&(o=this.getChildren(i,!1,!0),o.forEach(a=>{a.create(),t.push(a)})))}),t}getChildren(e,t,i){var n=e.modules.dataTree,r=[],o=[];return n.children!==!1&&(n.open||t)&&(Array.isArray(n.children)||(n.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?r=this.table.modules.filter.filter(n.children):r=n.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(r,i),r.forEach(a=>{o.push(a);var l=this.getChildren(a,!1,!0);l.forEach(h=>{o.push(h)})})),o}generateChildren(e){var t=[],i=e.getData()[this.field];return Array.isArray(i)||(i=[i]),i.forEach(n=>{var r=new Et(n||{},this.table.rowManager);r.create(),r.modules.dataTree.index=e.modules.dataTree.index+1,r.modules.dataTree.parent=e,r.modules.dataTree.children&&(r.modules.dataTree.open=this.startOpen(r.getComponent(),r.modules.dataTree.index)),t.push(r)}),t}expandRow(e,t){var i=e.modules.dataTree;i.children!==!1&&(i.open=!0,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",e.getComponent(),e.modules.dataTree.index))}collapseRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open=!1,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",e.getComponent(),e.modules.dataTree.index))}toggleRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open?this.collapseRow(e):this.expandRow(e))}isRowExpanded(e){return e.modules.dataTree.open}getTreeParent(e){return e.modules.dataTree.parent?e.modules.dataTree.parent.getComponent():!1}getTreeParentRoot(e){return e.modules.dataTree&&e.modules.dataTree.parent?this.getTreeParentRoot(e.modules.dataTree.parent):e}getFilteredTreeChildren(e){var t=e.modules.dataTree,i=[],n;return t.children&&(Array.isArray(t.children)||(t.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?n=this.table.modules.filter.filter(t.children):n=t.children,n.forEach(r=>{r instanceof Et&&i.push(r)})),i}rowDelete(e){var t=e.modules.dataTree.parent,i;t&&(i=this.findChildIndex(e,t),i!==!1&&t.data[this.field].splice(i,1),t.data[this.field].length||delete t.data[this.field],this.initializeRow(t),this.layoutRow(t)),this.refreshData(!0)}addTreeChildRow(e,t,i,n){var r=!1;typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(e.data[this.field])||(e.data[this.field]=[],e.modules.dataTree.open=this.startOpen(e.getComponent(),e.modules.dataTree.index)),typeof n<"u"&&(r=this.findChildIndex(n,e),r!==!1&&e.data[this.field].splice(i?r:r+1,0,t)),r===!1&&(i?e.data[this.field].unshift(t):e.data[this.field].push(t)),this.initializeRow(e),this.layoutRow(e),this.refreshData(!0)}findChildIndex(e,t){var i=!1;return typeof e=="object"?e instanceof Et?i=e.data:e instanceof Rh?i=e._getSelf().data:typeof HTMLElement<"u"&&e instanceof HTMLElement?t.modules.dataTree&&(i=t.modules.dataTree.children.find(n=>n instanceof Et?n.element===e:!1),i&&(i=i.data)):e===null&&(i=!1):typeof e>"u"?i=!1:i=t.data[this.field].find(n=>n.data[this.table.options.index]==e),i&&(Array.isArray(t.data[this.field])&&(i=t.data[this.field].indexOf(i)),i==-1&&(i=!1)),i}getTreeChildren(e,t,i){var n=e.modules.dataTree,r=[];return n&&n.children&&(Array.isArray(n.children)||(n.children=this.generateChildren(e)),n.children.forEach(o=>{o instanceof Et&&(r.push(t?o.getComponent():o),i&&this.getTreeChildren(o,t,i).forEach(a=>{r.push(a)}))})),r}getChildField(){return this.field}redrawNeeded(e){return(this.field?typeof e[this.field]<"u":!1)||(this.elementField?typeof e[this.elementField]<"u":!1)}}U(Ov,"moduleName","dataTree");function N2(s,e={},t){var i=e.delimiter?e.delimiter:",",n=[],r=[];s.forEach(o=>{var a=[];switch(o.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":o.columns.forEach((l,h)=>{l&&l.depth===1&&(r[h]=typeof l.value>"u"||l.value===null?"":'"'+String(l.value).split('"').join('""')+'"')});break;case"row":o.columns.forEach(l=>{if(l){switch(typeof l.value){case"object":l.value=l.value!==null?JSON.stringify(l.value):"";break;case"undefined":l.value="";break}a.push('"'+String(l.value).split('"').join('""')+'"')}}),n.push(a.join(i));break}}),r.length&&n.unshift(r.join(i)),n=n.join(`
`),e.bom&&(n="\uFEFF"+n),t(n,"text/csv")}function z2(s,e,t){var i=[];s.forEach(n=>{var r={};switch(n.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":n.columns.forEach(o=>{o&&(r[o.component.getTitleDownload()||o.component.getField()]=o.value)}),i.push(r);break}}),i=JSON.stringify(i,null,"	"),t(i,"application/json")}function G2(s,e={},t){var i=[],n=[],r={},o=e.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},a=e.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},l=e.jsPDF||{},h=e.title?e.title:"",u,c;l.orientation||(l.orientation=e.orientation||"landscape"),l.unit||(l.unit="pt"),s.forEach(f=>{switch(f.type){case"header":i.push(d(f));break;case"group":n.push(d(f,o));break;case"calc":n.push(d(f,a));break;case"row":n.push(d(f));break}});function d(f,g){var p=[];return f.columns.forEach(y=>{var b;if(y){switch(typeof y.value){case"object":y.value=y.value!==null?JSON.stringify(y.value):"";break;case"undefined":y.value="";break}b={content:y.value,colSpan:y.width,rowSpan:y.height},g&&(b.styles=g),p.push(b)}}),p}u=this.dependencyRegistry.lookup("jspdf","jsPDF"),c=new u(l),e.autoTable&&(typeof e.autoTable=="function"?r=e.autoTable(c)||{}:r=e.autoTable),h&&(r.didDrawPage=function(f){c.text(h,40,30)}),r.head=i,r.body=n,c.autoTable(r),e.documentProcessing&&e.documentProcessing(c),t(c.output("arraybuffer"),"application/pdf")}function H2(s,e,t){var i=this,n=e.sheetName||"Sheet1",r=this.dependencyRegistry.lookup("XLSX"),o=r.utils.book_new(),a=new lt(this),l="compress"in e?e.compress:!0,h=e.writeOptions||{bookType:"xlsx",bookSST:!0,compression:l},u;h.type="binary",o.SheetNames=[],o.Sheets={};function c(){var g=[],p=[],y={},b={s:{c:0,r:0},e:{c:s[0]?s[0].columns.reduce((v,_)=>v+(_&&_.width?_.width:1),0):0,r:s.length}};return s.forEach((v,_)=>{var m=[];v.columns.forEach(function(E,C){E?(m.push(!(E.value instanceof Date)&&typeof E.value=="object"?JSON.stringify(E.value):E.value),(E.width>1||E.height>-1)&&(E.height>1||E.width>1)&&p.push({s:{r:_,c:C},e:{r:_+E.height-1,c:C+E.width-1}})):m.push("")}),g.push(m)}),r.utils.sheet_add_aoa(y,g),y["!ref"]=r.utils.encode_range(b),p.length&&(y["!merges"]=p),y}if(e.sheetOnly){t(c());return}if(e.sheets)for(var d in e.sheets)e.sheets[d]===!0?(o.SheetNames.push(d),o.Sheets[d]=c()):(o.SheetNames.push(d),a.commsSend(e.sheets[d],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:i.active,intercept:function(g){o.Sheets[d]=g}}));else o.SheetNames.push(n),o.Sheets[n]=c();e.documentProcessing&&(o=e.documentProcessing(o));function f(g){for(var p=new ArrayBuffer(g.length),y=new Uint8Array(p),b=0;b!=g.length;++b)y[b]=g.charCodeAt(b)&255;return p}u=r.write(o,h),t(f(u),"application/octet-stream")}function B2(s,e,t){this.modExists("export",!0)&&t(this.modules.export.generateHTMLTable(s),"text/html")}function V2(s,e,t){const i=[];s.forEach(n=>{const r={};switch(n.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":n.columns.forEach(o=>{o&&(r[o.component.getTitleDownload()||o.component.getField()]=o.value)}),i.push(JSON.stringify(r));break}}),t(i.join(`
`),"application/x-ndjson")}var W2={csv:N2,json:z2,jsonLines:V2,pdf:G2,xlsx:H2,html:B2};const ur=class ur extends pe{constructor(e){super(e),this.registerTableOption("downloadEncoder",function(t,i){return new Blob([t],{type:i})}),this.registerTableOption("downloadConfig",{}),this.registerTableOption("downloadRowRange","active"),this.registerColumnOption("download"),this.registerColumnOption("titleDownload")}initialize(){this.deprecatedOptionsCheck(),this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}deprecatedOptionsCheck(){}downloadToTab(e,t,i,n){this.download(e,t,i,n,!0)}download(e,t,i,n,r){var o=!1;function a(h,u){r?r===!0?this.triggerDownload(h,u,e,t,!0):r(h):this.triggerDownload(h,u,e,t)}if(typeof e=="function"?o=e:ur.downloaders[e]?o=ur.downloaders[e]:console.warn("Download Error - No such download type found: ",e),o){var l=this.generateExportList(n);o.call(this.table,l,i||{},a.bind(this))}}generateExportList(e){var t=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,e||this.table.options.downloadRowRange,"download"),i=this.table.options.groupHeaderDownload;return i&&!Array.isArray(i)&&(i=[i]),t.forEach(n=>{var r;n.type==="group"&&(r=n.columns[0],i&&i[n.indent]&&(r.value=i[n.indent](r.value,n.component._group.getRowCount(),n.component._group.getData(),n.component)))}),t}triggerDownload(e,t,i,n,r){var o=document.createElement("a"),a=this.table.options.downloadEncoder(e,t);a&&(r?window.open(window.URL.createObjectURL(a)):(n=n||"Tabulator."+(typeof i=="function"?"txt":i),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(a,n):(o.setAttribute("href",window.URL.createObjectURL(a)),o.setAttribute("download",n),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o))),this.dispatchExternal("downloadComplete"))}commsReceived(e,t,i){switch(t){case"intercept":this.download(i.type,"",i.options,i.active,i.intercept);break}}};U(ur,"moduleName","download"),U(ur,"downloaders",W2);let mc=ur;function Sh(s,e){var t=e.mask,i=typeof e.maskLetterChar<"u"?e.maskLetterChar:"A",n=typeof e.maskNumberChar<"u"?e.maskNumberChar:"9",r=typeof e.maskWildcardChar<"u"?e.maskWildcardChar:"*";function o(a){var l=t[a];typeof l<"u"&&l!==r&&l!==i&&l!==n&&(s.value=s.value+""+l,o(a+1))}s.addEventListener("keydown",a=>{var l=s.value.length,h=a.key;if(a.keyCode>46&&!a.ctrlKey&&!a.metaKey){if(l>=t.length)return a.preventDefault(),a.stopPropagation(),!1;switch(t[l]){case i:if(h.toUpperCase()==h.toLowerCase())return a.preventDefault(),a.stopPropagation(),!1;break;case n:if(isNaN(h))return a.preventDefault(),a.stopPropagation(),!1;break;case r:break;default:if(h!==t[l])return a.preventDefault(),a.stopPropagation(),!1}}}),s.addEventListener("keyup",a=>{a.keyCode>46&&e.maskAutoFill&&o(s.value.length)}),s.placeholder||(s.placeholder=t),e.maskAutoFill&&o(s.value.length)}function U2(s,e,t,i,n){var r=s.getValue(),o=document.createElement("input");if(o.setAttribute("type",n.search?"search":"text"),o.style.padding="4px",o.style.width="100%",o.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let l in n.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),o.setAttribute(l,o.getAttribute(l)+n.elementAttributes["+"+l])):o.setAttribute(l,n.elementAttributes[l]);o.value=typeof r<"u"?r:"",e(function(){s.getType()==="cell"&&(o.focus({preventScroll:!0}),o.style.height="100%",n.selectContents&&o.select())});function a(l){(r===null||typeof r>"u")&&o.value!==""||o.value!==r?t(o.value)&&(r=o.value):i()}return o.addEventListener("change",a),o.addEventListener("blur",a),o.addEventListener("keydown",function(l){switch(l.keyCode){case 13:a();break;case 27:i();break;case 35:case 36:l.stopPropagation();break}}),n.mask&&Sh(o,n),o}function j2(s,e,t,i,n){var r=s.getValue(),o=n.verticalNavigation||"hybrid",a=String(r!==null&&typeof r<"u"?r:""),l=document.createElement("textarea"),h=0;if(l.style.display="block",l.style.padding="2px",l.style.height="100%",l.style.width="100%",l.style.boxSizing="border-box",l.style.whiteSpace="pre-wrap",l.style.resize="none",n.elementAttributes&&typeof n.elementAttributes=="object")for(let c in n.elementAttributes)c.charAt(0)=="+"?(c=c.slice(1),l.setAttribute(c,l.getAttribute(c)+n.elementAttributes["+"+c])):l.setAttribute(c,n.elementAttributes[c]);l.value=a,e(function(){s.getType()==="cell"&&(l.focus({preventScroll:!0}),l.style.height="100%",l.scrollHeight,l.style.height=l.scrollHeight+"px",s.getRow().normalizeHeight(),n.selectContents&&l.select())});function u(c){(r===null||typeof r>"u")&&l.value!==""||l.value!==r?(t(l.value)&&(r=l.value),setTimeout(function(){s.getRow().normalizeHeight()},300)):i()}return l.addEventListener("change",u),l.addEventListener("blur",u),l.addEventListener("keyup",function(){l.style.height="";var c=l.scrollHeight;l.style.height=c+"px",c!=h&&(h=c,s.getRow().normalizeHeight())}),l.addEventListener("keydown",function(c){switch(c.keyCode){case 13:c.shiftKey&&n.shiftEnterSubmit&&u();break;case 27:i();break;case 38:(o=="editor"||o=="hybrid"&&l.selectionStart)&&(c.stopImmediatePropagation(),c.stopPropagation());break;case 40:(o=="editor"||o=="hybrid"&&l.selectionStart!==l.value.length)&&(c.stopImmediatePropagation(),c.stopPropagation());break;case 35:case 36:c.stopPropagation();break}}),n.mask&&Sh(l,n),l}function Y2(s,e,t,i,n){var r=s.getValue(),o=n.verticalNavigation||"editor",a=document.createElement("input");if(a.setAttribute("type","number"),typeof n.max<"u"&&a.setAttribute("max",n.max),typeof n.min<"u"&&a.setAttribute("min",n.min),typeof n.step<"u"&&a.setAttribute("step",n.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let u in n.elementAttributes)u.charAt(0)=="+"?(u=u.slice(1),a.setAttribute(u,a.getAttribute(u)+n.elementAttributes["+"+u])):a.setAttribute(u,n.elementAttributes[u]);a.value=r;var l=function(u){h()};e(function(){s.getType()==="cell"&&(a.removeEventListener("blur",l),a.focus({preventScroll:!0}),a.style.height="100%",a.addEventListener("blur",l),n.selectContents&&a.select())});function h(){var u=a.value;!isNaN(u)&&u!==""&&(u=Number(u)),u!==r?t(u)&&(r=u):i()}return a.addEventListener("keydown",function(u){switch(u.keyCode){case 13:h();break;case 27:i();break;case 38:case 40:o=="editor"&&(u.stopImmediatePropagation(),u.stopPropagation());break;case 35:case 36:u.stopPropagation();break}}),n.mask&&Sh(a,n),a}function X2(s,e,t,i,n){var r=s.getValue(),o=document.createElement("input");if(o.setAttribute("type","range"),typeof n.max<"u"&&o.setAttribute("max",n.max),typeof n.min<"u"&&o.setAttribute("min",n.min),typeof n.step<"u"&&o.setAttribute("step",n.step),o.style.padding="4px",o.style.width="100%",o.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let l in n.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),o.setAttribute(l,o.getAttribute(l)+n.elementAttributes["+"+l])):o.setAttribute(l,n.elementAttributes[l]);o.value=r,e(function(){s.getType()==="cell"&&(o.focus({preventScroll:!0}),o.style.height="100%")});function a(){var l=o.value;!isNaN(l)&&l!==""&&(l=Number(l)),l!=r?t(l)&&(r=l):i()}return o.addEventListener("blur",function(l){a()}),o.addEventListener("keydown",function(l){switch(l.keyCode){case 13:a();break;case 27:i();break}}),o}function $2(s,e,t,i,n){var r=n.format,o=n.verticalNavigation||"editor",a=r?window.DateTime||luxon.DateTime:null,l=s.getValue(),h=document.createElement("input");function u(d){var f;return a.isDateTime(d)?f=d:r==="iso"?f=a.fromISO(String(d)):f=a.fromFormat(String(d),r),f.toFormat("yyyy-MM-dd")}if(h.type="date",h.style.padding="4px",h.style.width="100%",h.style.boxSizing="border-box",n.max&&h.setAttribute("max",r?u(n.max):n.max),n.min&&h.setAttribute("min",r?u(n.min):n.min),n.elementAttributes&&typeof n.elementAttributes=="object")for(let d in n.elementAttributes)d.charAt(0)=="+"?(d=d.slice(1),h.setAttribute(d,h.getAttribute(d)+n.elementAttributes["+"+d])):h.setAttribute(d,n.elementAttributes[d]);l=typeof l<"u"?l:"",r&&(a?l=u(l):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),h.value=l,e(function(){s.getType()==="cell"&&(h.focus({preventScroll:!0}),h.style.height="100%",n.selectContents&&h.select())});function c(){var d=h.value,f;if((l===null||typeof l>"u")&&d!==""||d!==l){if(d&&r)switch(f=a.fromFormat(String(d),"yyyy-MM-dd"),r){case!0:d=f;break;case"iso":d=f.toISO();break;default:d=f.toFormat(r)}t(d)&&(l=h.value)}else i()}return h.addEventListener("blur",function(d){(d.relatedTarget||d.rangeParent||d.explicitOriginalTarget!==h)&&c()}),h.addEventListener("keydown",function(d){switch(d.keyCode){case 13:c();break;case 27:i();break;case 35:case 36:d.stopPropagation();break;case 38:case 40:o=="editor"&&(d.stopImmediatePropagation(),d.stopPropagation());break}}),h}function K2(s,e,t,i,n){var r=n.format,o=n.verticalNavigation||"editor",a=r?window.DateTime||luxon.DateTime:null,l,h=s.getValue(),u=document.createElement("input");if(u.type="time",u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let d in n.elementAttributes)d.charAt(0)=="+"?(d=d.slice(1),u.setAttribute(d,u.getAttribute(d)+n.elementAttributes["+"+d])):u.setAttribute(d,n.elementAttributes[d]);h=typeof h<"u"?h:"",r&&(a?(a.isDateTime(h)?l=h:r==="iso"?l=a.fromISO(String(h)):l=a.fromFormat(String(h),r),h=l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),u.value=h,e(function(){s.getType()=="cell"&&(u.focus({preventScroll:!0}),u.style.height="100%",n.selectContents&&u.select())});function c(){var d=u.value,f;if((h===null||typeof h>"u")&&d!==""||d!==h){if(d&&r)switch(f=a.fromFormat(String(d),"hh:mm"),r){case!0:d=f;break;case"iso":d=f.toISO();break;default:d=f.toFormat(r)}t(d)&&(h=u.value)}else i()}return u.addEventListener("blur",function(d){(d.relatedTarget||d.rangeParent||d.explicitOriginalTarget!==u)&&c()}),u.addEventListener("keydown",function(d){switch(d.keyCode){case 13:c();break;case 27:i();break;case 35:case 36:d.stopPropagation();break;case 38:case 40:o=="editor"&&(d.stopImmediatePropagation(),d.stopPropagation());break}}),u}function Z2(s,e,t,i,n){var r=n.format,o=n.verticalNavigation||"editor",a=r?this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"):null,l,h=s.getValue(),u=document.createElement("input");if(u.type="datetime-local",u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let d in n.elementAttributes)d.charAt(0)=="+"?(d=d.slice(1),u.setAttribute(d,u.getAttribute(d)+n.elementAttributes["+"+d])):u.setAttribute(d,n.elementAttributes[d]);h=typeof h<"u"?h:"",r&&(a?(a.isDateTime(h)?l=h:r==="iso"?l=a.fromISO(String(h)):l=a.fromFormat(String(h),r),h=l.toFormat("yyyy-MM-dd")+"T"+l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),u.value=h,e(function(){s.getType()==="cell"&&(u.focus({preventScroll:!0}),u.style.height="100%",n.selectContents&&u.select())});function c(){var d=u.value,f;if((h===null||typeof h>"u")&&d!==""||d!==h){if(d&&r)switch(f=a.fromISO(String(d)),r){case!0:d=f;break;case"iso":d=f.toISO();break;default:d=f.toFormat(r)}t(d)&&(h=u.value)}else i()}return u.addEventListener("blur",function(d){(d.relatedTarget||d.rangeParent||d.explicitOriginalTarget!==u)&&c()}),u.addEventListener("keydown",function(d){switch(d.keyCode){case 13:c();break;case 27:i();break;case 35:case 36:d.stopPropagation();break;case 38:case 40:o=="editor"&&(d.stopImmediatePropagation(),d.stopPropagation());break}}),u}let q2=class{constructor(e,t,i,n,r,o){this.edit=e,this.table=e.table,this.cell=t,this.params=this._initializeParams(o),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=t.getType()==="header",this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.lastAction="",this.filterTerm="",this.blurable=!0,this.actions={success:n,cancel:r},this._deprecatedOptionsCheck(),this._initializeValue(),i(this._onRendered.bind(this))}_deprecatedOptionsCheck(){}_initializeValue(){var e=this.cell.getValue();typeof e>"u"&&typeof this.params.defaultValue<"u"&&(e=this.params.defaultValue),this.initialValues=this.params.multiselect?e:[e],this.isFilter&&(this.input.value=this.initialValues?this.initialValues.join(","):"",this.headerFilterInitialListGen())}_onRendered(){var e=this.cell.getElement();function t(i){i.stopPropagation()}this.isFilter||(this.input.style.height="100%",this.input.focus({preventScroll:!0})),e.addEventListener("click",t),setTimeout(()=>{e.removeEventListener("click",t)},1e3),this.input.addEventListener("mousedown",this._preventPopupBlur.bind(this))}_createListElement(){var e=document.createElement("div");return e.classList.add("tabulator-edit-list"),e.addEventListener("mousedown",this._preventBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e}_setListWidth(){var e=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=e.offsetWidth+"px",this.params.maxWidth&&(this.params.maxWidth===!0?this.listEl.style.maxWidth=e.offsetWidth+"px":typeof this.params.maxWidth=="number"?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}_createInputElement(){var e=this.params.elementAttributes,t=document.createElement("input");if(t.setAttribute("type",this.params.clearable?"search":"text"),t.style.padding="4px",t.style.width="100%",t.style.boxSizing="border-box",this.params.autocomplete||(t.style.cursor="default",t.style.caretColor="transparent"),e&&typeof e=="object")for(let i in e)i.charAt(0)=="+"?(i=i.slice(1),t.setAttribute(i,t.getAttribute(i)+e["+"+i])):t.setAttribute(i,e[i]);return this.params.mask&&Sh(t,this.params),this._bindInputEvents(t),t}_initializeParams(e){var t=["values","valuesURL","valuesLookup"],i;return e=Object.assign({},e),e.verticalNavigation=e.verticalNavigation||"editor",e.placeholderLoading=typeof e.placeholderLoading>"u"?"Searching ...":e.placeholderLoading,e.placeholderEmpty=typeof e.placeholderEmpty>"u"?"No Results Found":e.placeholderEmpty,e.filterDelay=typeof e.filterDelay>"u"?300:e.filterDelay,e.emptyValue=Object.keys(e).includes("emptyValue")?e.emptyValue:"",i=Object.keys(e).filter(n=>t.includes(n)).length,i?i>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),e.autocomplete?e.multiselect&&(e.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(e.freetext&&(e.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),e.filterFunc&&(e.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),e.filterRemote&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),e.mask&&(e.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),e.allowEmpty&&(e.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),e.listOnEmpty&&(e.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),e.filterRemote&&!(typeof e.valuesLookup=="function"||e.valuesURL)&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),e}_bindInputEvents(e){e.addEventListener("focus",this._inputFocus.bind(this)),e.addEventListener("click",this._inputClick.bind(this)),e.addEventListener("blur",this._inputBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&e.addEventListener("keyup",this._inputKeyUp.bind(this))}_inputFocus(e){this.rebuildOptionsList()}_filter(){this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(()=>{this.rebuildOptionsList()},this.params.filterDelay)):this._filterList()}_inputClick(e){e.stopPropagation()}_inputBlur(e){this.blurable&&(this.popup?this.popup.hide():this._resolveValue(!0))}_inputSearch(){this._clearChoices()}_inputKeyDown(e){switch(e.keyCode){case 38:this._keyUp(e);break;case 40:this._keyDown(e);break;case 37:case 39:this._keySide(e);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(e);break;case 9:this._keyTab(e);break;default:this._keySelectLetter(e)}}_inputKeyUp(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(e)}}_preventPopupBlur(){this.popup&&this.popup.blockHide(),setTimeout(()=>{this.popup&&this.popup.restoreHide()},10)}_preventBlur(){this.blurable=!1,setTimeout(()=>{this.blurable=!0},10)}_keyTab(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem,!0)}_keyUp(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t>0&&this._focusItem(this.displayItems[t-1]))}_keyDown(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t<this.displayItems.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t<this.displayItems.length-1&&(t==-1?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[t+1])))}_keySide(e){this.params.autocomplete||(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())}_keyEnter(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem)}_keyEsc(e){this._cancel()}_keyHomeEnd(e){this.params.autocomplete&&e.stopImmediatePropagation()}_keySelectLetter(e){this.params.autocomplete||(e.preventDefault(),e.keyCode>=38&&e.keyCode<=90&&this._scrollToValue(e.keyCode))}_keyAutoCompLetter(e){this._filter(),this.lastAction="typing",this.typing=!0}_scrollToValue(e){clearTimeout(this.filterTimeout);var t=String.fromCharCode(e).toLowerCase();this.filterTerm+=t.toLowerCase();var i=this.displayItems.find(n=>typeof n.label<"u"&&n.label.toLowerCase().startsWith(this.filterTerm));i&&this._focusItem(i),this.filterTimeout=setTimeout(()=>{this.filterTerm=""},800)}_focusItem(e){this.lastAction="focus",this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=e,e&&e.element&&(e.element.classList.add("focused"),e.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}headerFilterInitialListGen(){this._generateOptions(!0)}rebuildOptionsList(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch(e=>{Number.isInteger(e)||console.error("List generation error",e)})}_filterList(){this._buildList(this._filterOptions()),this._showList()}_generateOptions(e){var t=[],i=++this.listIteration;return this.filtered=!1,this.params.values?t=this.params.values:this.params.valuesURL?t=this._ajaxRequest(this.params.valuesURL,this.input.value):typeof this.params.valuesLookup=="function"?t=this.params.valuesLookup(this.cell,this.input.value):this.params.valuesLookup&&(t=this._uniqueColumnValues(this.params.valuesLookupField)),t instanceof Promise?(e||this._addPlaceholder(this.params.placeholderLoading),t.then().then(n=>this.listIteration===i?this._parseList(n):Promise.reject(i))):Promise.resolve(this._parseList(t))}_addPlaceholder(e){var t=document.createElement("div");typeof e=="function"&&(e=e(this.cell.getComponent(),this.listEl)),e&&(this._clearList(),e instanceof HTMLElement?t=e:(t.classList.add("tabulator-edit-list-placeholder"),t.innerHTML=e),this.listEl.appendChild(t),this._showList())}_ajaxRequest(e,t){var i=this.params.filterRemote?{term:t}:{};return e=Lv(e,{},i),fetch(e).then(n=>n.ok?n.json().catch(r=>(console.warn("List Ajax Load Error - Invalid JSON returned",r),Promise.reject(r))):(console.error("List Ajax Load Error - Connection Error: "+n.status,n.statusText),Promise.reject(n))).catch(n=>(console.error("List Ajax Load Error - Connection Error: ",n),Promise.reject(n)))}_uniqueColumnValues(e){var t={},i=this.table.getData(this.params.valuesLookup),n;return e?n=this.table.columnManager.getColumnByField(e):n=this.cell.getColumn()._getSelf(),n?i.forEach(r=>{var o=n.getFieldValue(r);this._emptyValueCheck(o)||(this.params.multiselect&&Array.isArray(o)?o.forEach(a=>{this._emptyValueCheck(a)||(t[a]=!0)}):t[o]=!0)}):(console.warn("unable to find matching column to create select lookup list:",e),t=[]),Object.keys(t)}_emptyValueCheck(e){return e===null||typeof e>"u"||e===""}_parseList(e){var t=[];return Array.isArray(e)||(e=Object.entries(e).map(([i,n])=>({label:n,value:i}))),e.forEach(i=>{typeof i!="object"&&(i={label:i,value:i}),this._parseListItem(i,t,0)}),!this.currentItems.length&&this.params.freetext&&(this.input.value=this.initialValues,this.typing=!0,this.lastAction="typing"),this.data=t,t}_parseListItem(e,t,i){var n={};e.options?n=this._parseListGroup(e,i+1):(n={label:e.label,value:e.value,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,selected:!1,visible:!0,level:i,original:e},this.initialValues&&this.initialValues.indexOf(e.value)>-1&&this._chooseItem(n,!0)),t.push(n)}_parseListGroup(e,t){var i={label:e.label,group:!0,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,visible:!0,level:t,options:[],original:e};return e.options.forEach(n=>{this._parseListItem(n,i.options,t)}),i}_sortOptions(e){var t;return this.params.sort&&(t=typeof this.params.sort=="function"?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(t,e)),e}_sortGroup(e,t){t.sort((i,n)=>e(i.label,n.label,i.value,n.value,i.original,n.original)),t.forEach(i=>{i.group&&this._sortGroup(e,i.options)})}_defaultSortFunction(e,t){var i,n,r,o,a=0,l,h=/(\d+)|(\D+)/g,u=/\d/,c=0;if(this.params.sort==="desc"&&([e,t]=[t,e]),!e&&e!==0)c=!t&&t!==0?0:-1;else if(!t&&t!==0)c=1;else{if(isFinite(e)&&isFinite(t))return e-t;if(i=String(e).toLowerCase(),n=String(t).toLowerCase(),i===n)return 0;if(!(u.test(i)&&u.test(n)))return i>n?1:-1;for(i=i.match(h),n=n.match(h),l=i.length>n.length?n.length:i.length;a<l;)if(r=i[a],o=n[a++],r!==o)return isFinite(r)&&isFinite(o)?(r.charAt(0)==="0"&&(r="."+r),o.charAt(0)==="0"&&(o="."+o),r-o):r>o?1:-1;return i.length>n.length}return c}_filterOptions(){var e=this.params.filterFunc||this._defaultFilterFunc,t=this.input.value;return t?(this.filtered=!0,this.data.forEach(i=>{this._filterItem(e,t,i)})):this.filtered=!1,this.data}_filterItem(e,t,i){var n=!1;return i.group?(i.options.forEach(r=>{this._filterItem(e,t,r)&&(n=!0)}),i.visible=n):i.visible=e(t,i.label,i.value,i.original),i.visible}_defaultFilterFunc(e,t,i,n){return e=String(e).toLowerCase(),t!==null&&typeof t<"u"&&(String(t).toLowerCase().indexOf(e)>-1||String(i).toLowerCase().indexOf(e)>-1)}_clearList(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}_buildList(e){this._clearList(),e.forEach(t=>{this._buildItem(t)}),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}_buildItem(e){var t=e.element,i;if(!this.filtered||e.visible){if(!t){if(t=document.createElement("div"),t.tabIndex=0,i=this.params.itemFormatter?this.params.itemFormatter(e.label,e.value,e.original,t):e.label,i instanceof HTMLElement?t.appendChild(i):t.innerHTML=i,e.group?t.classList.add("tabulator-edit-list-group"):t.classList.add("tabulator-edit-list-item"),t.classList.add("tabulator-edit-list-group-level-"+e.level),e.elementAttributes&&typeof e.elementAttributes=="object")for(let n in e.elementAttributes)n.charAt(0)=="+"?(n=n.slice(1),t.setAttribute(n,this.input.getAttribute(n)+e.elementAttributes["+"+n])):t.setAttribute(n,e.elementAttributes[n]);e.group?t.addEventListener("click",this._groupClick.bind(this,e)):t.addEventListener("click",this._itemClick.bind(this,e)),t.addEventListener("mousedown",this._preventBlur.bind(this)),e.element=t}this._styleItem(e),this.listEl.appendChild(t),e.group?e.options.forEach(n=>{this._buildItem(n)}):this.displayItems.push(e)}}_showList(){var e=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&this.input.value===""&&!this.params.listOnEmpty){this.popup&&this.popup.hide(!0);return}this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),e||setTimeout(()=>{this.popup.hideOnBlur(this._resolveValue.bind(this,!0))},10)}}_styleItem(e){e&&e.element&&(e.selected?e.element.classList.add("active"):e.element.classList.remove("active"))}_itemClick(e,t){t.stopPropagation(),this._chooseItem(e)}_groupClick(e,t){t.stopPropagation()}_cancel(){this.popup.hide(!0),this.actions.cancel()}_clearChoices(){this.typing=!0,this.currentItems.forEach(e=>{e.selected=!1,this._styleItem(e)}),this.currentItems=[],this.focusedItem=null}_chooseItem(e,t){var i;this.typing=!1,this.params.multiselect?(i=this.currentItems.indexOf(e),i>-1?(this.currentItems.splice(i,1),e.selected=!1):(this.currentItems.push(e),e.selected=!0),this.input.value=this.currentItems.map(n=>n.label).join(","),this._styleItem(e)):(this.currentItems=[e],e.selected=!0,this.input.value=e.label,this._styleItem(e),t||this._resolveValue()),this._focusItem(e)}_resolveValue(e){var t,i;if(this.popup&&this.popup.hide(!0),this.params.multiselect)t=this.currentItems.map(n=>n.value);else if(e&&this.params.autocomplete&&this.typing)if(this.params.freetext||this.params.allowEmpty&&this.input.value==="")t=this.input.value;else{this.actions.cancel();return}else this.currentItems[0]?t=this.currentItems[0].value:(i=Array.isArray(this.initialValues)?this.initialValues[0]:this.initialValues,i===null||typeof i>"u"||i===""?t=i:t=this.params.emptyValue);t===""&&(t=this.params.emptyValue),this.actions.success(t),this.isFilter&&(this.initialValues=t&&!Array.isArray(t)?[t]:t,this.currentItems=[])}};function J2(s,e,t,i,n){var r=new q2(this,s,e,t,i,n);return r.input}function Q2(s,e,t,i,n){var r=this,o=s.getElement(),a=s.getValue(),l=o.getElementsByTagName("svg").length||5,h=o.getElementsByTagName("svg")[0]?o.getElementsByTagName("svg")[0].getAttribute("width"):14,u=[],c=document.createElement("div"),d=document.createElementNS("http://www.w3.org/2000/svg","svg");function f(b){u.forEach(function(v,_){_<b?(r.table.browser=="ie"?v.setAttribute("class","tabulator-star-active"):v.classList.replace("tabulator-star-inactive","tabulator-star-active"),v.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):(r.table.browser=="ie"?v.setAttribute("class","tabulator-star-inactive"):v.classList.replace("tabulator-star-active","tabulator-star-inactive"),v.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function g(b){var v=document.createElement("span"),_=d.cloneNode(!0);u.push(_),v.addEventListener("mouseenter",function(m){m.stopPropagation(),m.stopImmediatePropagation(),f(b)}),v.addEventListener("mousemove",function(m){m.stopPropagation(),m.stopImmediatePropagation()}),v.addEventListener("click",function(m){m.stopPropagation(),m.stopImmediatePropagation(),t(b),o.blur()}),v.appendChild(_),c.appendChild(v)}function p(b){a=b,f(b)}if(o.style.whiteSpace="nowrap",o.style.overflow="hidden",o.style.textOverflow="ellipsis",c.style.verticalAlign="middle",c.style.display="inline-block",c.style.padding="4px",d.setAttribute("width",h),d.setAttribute("height",h),d.setAttribute("viewBox","0 0 512 512"),d.setAttribute("xml:space","preserve"),d.style.padding="0 1px",n.elementAttributes&&typeof n.elementAttributes=="object")for(let b in n.elementAttributes)b.charAt(0)=="+"?(b=b.slice(1),c.setAttribute(b,c.getAttribute(b)+n.elementAttributes["+"+b])):c.setAttribute(b,n.elementAttributes[b]);for(var y=1;y<=l;y++)g(y);return a=Math.min(parseInt(a),l),f(a),c.addEventListener("mousemove",function(b){f(0)}),c.addEventListener("click",function(b){t(0)}),o.addEventListener("blur",function(b){i()}),o.addEventListener("keydown",function(b){switch(b.keyCode){case 39:p(a+1);break;case 37:p(a-1);break;case 13:t(a);break;case 27:i();break}}),c}function eF(s,e,t,i,n){var r=s.getElement(),o=typeof n.max>"u"?r.getElementsByTagName("div")[0]&&r.getElementsByTagName("div")[0].getAttribute("max")||100:n.max,a=typeof n.min>"u"?r.getElementsByTagName("div")[0]&&r.getElementsByTagName("div")[0].getAttribute("min")||0:n.min,l=(o-a)/100,h=s.getValue()||0,u=document.createElement("div"),c=document.createElement("div"),d,f;function g(){var p=window.getComputedStyle(r,null),y=l*Math.round(c.offsetWidth/((r.clientWidth-parseInt(p.getPropertyValue("padding-left"))-parseInt(p.getPropertyValue("padding-right")))/100))+a;t(y),r.setAttribute("aria-valuenow",y),r.setAttribute("aria-label",h)}if(u.style.position="absolute",u.style.right="0",u.style.top="0",u.style.bottom="0",u.style.width="5px",u.classList.add("tabulator-progress-handle"),c.style.display="inline-block",c.style.position="relative",c.style.height="100%",c.style.backgroundColor="#488CE9",c.style.maxWidth="100%",c.style.minWidth="0%",n.elementAttributes&&typeof n.elementAttributes=="object")for(let p in n.elementAttributes)p.charAt(0)=="+"?(p=p.slice(1),c.setAttribute(p,c.getAttribute(p)+n.elementAttributes["+"+p])):c.setAttribute(p,n.elementAttributes[p]);return r.style.padding="4px 4px",h=Math.min(parseFloat(h),o),h=Math.max(parseFloat(h),a),h=Math.round((h-a)/l),c.style.width=h+"%",r.setAttribute("aria-valuemin",a),r.setAttribute("aria-valuemax",o),c.appendChild(u),u.addEventListener("mousedown",function(p){d=p.screenX,f=c.offsetWidth}),u.addEventListener("mouseover",function(){u.style.cursor="ew-resize"}),r.addEventListener("mousemove",function(p){d&&(c.style.width=f+p.screenX-d+"px")}),r.addEventListener("mouseup",function(p){d&&(p.stopPropagation(),p.stopImmediatePropagation(),d=!1,f=!1,g())}),r.addEventListener("keydown",function(p){switch(p.keyCode){case 39:p.preventDefault(),c.style.width=c.clientWidth+r.clientWidth/100+"px";break;case 37:p.preventDefault(),c.style.width=c.clientWidth-r.clientWidth/100+"px";break;case 9:case 13:g();break;case 27:i();break}}),r.addEventListener("blur",function(){i()}),c}function tF(s,e,t,i,n){var r=s.getValue(),o=document.createElement("input"),a=n.tristate,l=typeof n.indeterminateValue>"u"?null:n.indeterminateValue,h=!1,u=Object.keys(n).includes("trueValue"),c=Object.keys(n).includes("falseValue");if(o.setAttribute("type","checkbox"),o.style.marginTop="5px",o.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let f in n.elementAttributes)f.charAt(0)=="+"?(f=f.slice(1),o.setAttribute(f,o.getAttribute(f)+n.elementAttributes["+"+f])):o.setAttribute(f,n.elementAttributes[f]);o.value=r,a&&(typeof r>"u"||r===l||r==="")&&(h=!0,o.indeterminate=!0),this.table.browser!="firefox"&&this.table.browser!="safari"&&e(function(){s.getType()==="cell"&&o.focus({preventScroll:!0})}),o.checked=u?r===n.trueValue:r===!0||r==="true"||r==="True"||r===1;function d(f){var g=o.checked;return u&&g?g=n.trueValue:c&&!g&&(g=n.falseValue),a?f?h?l:g:o.checked&&!h?(o.checked=!1,o.indeterminate=!0,h=!0,l):(h=!1,g):g}return o.addEventListener("change",function(f){t(d())}),o.addEventListener("blur",function(f){t(d(!0))}),o.addEventListener("keydown",function(f){f.keyCode==13&&t(d()),f.keyCode==27&&i()}),o}function iF(s,e,t,i,n){var r=s._getSelf().column,o,a,l;function h(u){var c=u.getValue(),d="input";switch(typeof c){case"number":d="number";break;case"boolean":d="tickCross";break;case"string":c.includes(`
`)&&(d="textarea");break}return d}return o=n.editorLookup?n.editorLookup(s):h(s),n.paramsLookup&&(l=typeof n.paramsLookup=="function"?n.paramsLookup(o,s):n.paramsLookup[o]),a=this.table.modules.edit.lookupEditor(o,r),a.call(this,s,e,t,i,l||{})}var nF={input:U2,textarea:j2,number:Y2,range:X2,date:$2,time:K2,datetime:Z2,list:J2,star:Q2,progress:eF,tickCross:tF,adaptable:iF};const vo=class vo extends pe{constructor(e){super(e),this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1,this.editedCells=[],this.convertEmptyValues=!1,this.editors=vo.editors,this.registerTableOption("editTriggerEvent","focus"),this.registerTableOption("editorEmptyValue"),this.registerTableOption("editorEmptyValueFunc",this.emptyValueCheck.bind(this)),this.registerColumnOption("editable"),this.registerColumnOption("editor"),this.registerColumnOption("editorParams"),this.registerColumnOption("editorEmptyValue"),this.registerColumnOption("editorEmptyValueFunc"),this.registerColumnOption("cellEditing"),this.registerColumnOption("cellEdited"),this.registerColumnOption("cellEditCancelled"),this.registerTableFunction("getEditedCells",this.getEditedCells.bind(this)),this.registerTableFunction("clearCellEdited",this.clearCellEdited.bind(this)),this.registerTableFunction("navigatePrev",this.navigatePrev.bind(this)),this.registerTableFunction("navigateNext",this.navigateNext.bind(this)),this.registerTableFunction("navigateLeft",this.navigateLeft.bind(this)),this.registerTableFunction("navigateRight",this.navigateRight.bind(this)),this.registerTableFunction("navigateUp",this.navigateUp.bind(this)),this.registerTableFunction("navigateDown",this.navigateDown.bind(this)),this.registerComponentFunction("cell","isEdited",this.cellIsEdited.bind(this)),this.registerComponentFunction("cell","clearEdited",this.clearEdited.bind(this)),this.registerComponentFunction("cell","edit",this.editCell.bind(this)),this.registerComponentFunction("cell","cancelEdit",this.cellCancelEdit.bind(this)),this.registerComponentFunction("cell","navigatePrev",this.navigatePrev.bind(this)),this.registerComponentFunction("cell","navigateNext",this.navigateNext.bind(this)),this.registerComponentFunction("cell","navigateLeft",this.navigateLeft.bind(this)),this.registerComponentFunction("cell","navigateRight",this.navigateRight.bind(this)),this.registerComponentFunction("cell","navigateUp",this.navigateUp.bind(this)),this.registerComponentFunction("cell","navigateDown",this.navigateDown.bind(this))}initialize(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("cell-value-changed",this.updateCellClass.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("row-layout",this.rowEditableCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("clipboard-paste",this.pasteBlocker.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0)),Object.keys(this.table.options).includes("editorEmptyValue")&&(this.convertEmptyValues=!0)}pasteBlocker(e){if(this.currentCell)return!0}keybindingNavigateNext(e){var t=this.currentCell,i=this.options("tabEndNewRow");t&&(this.navigateNext(t,e)||i&&(t.getElement().firstChild.blur(),this.invalidEdit||(i===!0?i=this.table.addRow({}):typeof i=="function"?i=this.table.addRow(i(t.row.getComponent())):i=this.table.addRow(Object.assign({},i)),i.then(()=>{setTimeout(()=>{t.getComponent().navigateNext()})}))))}cellIsEdited(e){return!!e.modules.edit&&e.modules.edit.edited}cellCancelEdit(e){e===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}updateCellClass(e){this.allowEdit(e)?e.getElement().classList.add("tabulator-editable"):e.getElement().classList.remove("tabulator-editable")}clearCellEdited(e){e||(e=this.table.modules.edit.getEditedCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.table.modules.edit.clearEdited(t._getSelf())})}navigatePrev(e=this.currentCell,t){var i,n;if(e){if(t&&t.preventDefault(),i=this.navigateLeft(),i)return!0;if(n=this.table.rowManager.prevDisplayRow(e.row,!0),n&&(i=this.findPrevEditableCell(n,n.cells.length),i))return i.getComponent().edit(),!0}return!1}navigateNext(e=this.currentCell,t){var i,n;if(e){if(t&&t.preventDefault(),i=this.navigateRight(),i)return!0;if(n=this.table.rowManager.nextDisplayRow(e.row,!0),n&&(i=this.findNextEditableCell(n,-1),i))return i.getComponent().edit(),!0}return!1}navigateLeft(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.findPrevEditableCell(e.row,i),n)?(n.getComponent().edit(),!0):!1}navigateRight(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.findNextEditableCell(e.row,i),n)?(n.getComponent().edit(),!0):!1}navigateUp(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.table.rowManager.prevDisplayRow(e.row,!0),n)?(n.cells[i].getComponent().edit(),!0):!1}navigateDown(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.table.rowManager.nextDisplayRow(e.row,!0),n)?(n.cells[i].getComponent().edit(),!0):!1}findNextEditableCell(e,t){var i=!1;if(t<e.cells.length-1)for(var n=t+1;n<e.cells.length;n++){let r=e.cells[n];if(r.column.modules.edit&&Fe.elVisible(r.getElement())&&this.allowEdit(r)){i=r;break}}return i}findPrevEditableCell(e,t){var i=!1;if(t>0)for(var n=t-1;n>=0;n--){let r=e.cells[n];if(r.column.modules.edit&&Fe.elVisible(r.getElement())&&this.allowEdit(r)){i=r;break}}return i}initializeColumnCheck(e){typeof e.definition.editor<"u"&&this.initializeColumn(e)}columnDeleteCheck(e){this.currentCell&&this.currentCell.column===e&&this.cancelEdit()}rowDeleteCheck(e){this.currentCell&&this.currentCell.row===e&&this.cancelEdit()}rowEditableCheck(e){e.getCells().forEach(t=>{t.column.modules.edit&&typeof t.column.modules.edit.check=="function"&&this.updateCellClass(t)})}initializeColumn(e){var t=Object.keys(e.definition).includes("editorEmptyValue"),i={editor:!1,blocked:!1,check:e.definition.editable,params:e.definition.editorParams||{},convertEmptyValues:t,editorEmptyValue:e.definition.editorEmptyValue,editorEmptyValueFunc:e.definition.editorEmptyValueFunc};i.editor=this.lookupEditor(e.definition.editor,e),i.editor&&(e.modules.edit=i)}lookupEditor(e,t){var i;switch(typeof e){case"string":this.editors[e]?i=this.editors[e]:console.warn("Editor Error - No such editor found: ",e);break;case"function":i=e;break;case"boolean":e===!0&&(typeof t.definition.formatter!="function"?this.editors[t.definition.formatter]?i=this.editors[t.definition.formatter]:i=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",t.definition.formatter));break}return i}getCurrentCell(){return this.currentCell?this.currentCell.getComponent():!1}clearEditor(e){var t=this.currentCell,i;if(this.invalidEdit=!1,t){for(this.currentCell=!1,i=t.getElement(),this.dispatch("edit-editor-clear",t,e),i.classList.remove("tabulator-editing");i.firstChild;)i.removeChild(i.firstChild);t.row.getElement().classList.remove("tabulator-editing"),t.table.element.classList.remove("tabulator-editing")}}cancelEdit(){if(this.currentCell){var e=this.currentCell,t=this.currentCell.getComponent();this.clearEditor(!0),e.setValueActual(e.getValue()),e.cellRendered(),(e.column.definition.editor=="textarea"||e.column.definition.variableHeight)&&e.row.normalizeHeight(!0),e.column.definition.cellEditCancelled&&e.column.definition.cellEditCancelled.call(this.table,t),this.dispatch("edit-cancelled",e),this.dispatchExternal("cellEditCancelled",t)}}bindEditor(e){if(e.column.modules.edit){var t=this,i=e.getElement(!0);this.updateCellClass(e),i.setAttribute("tabindex",0),i.addEventListener("mousedown",function(n){n.button===2?n.preventDefault():t.mouseClick=!0}),this.options("editTriggerEvent")==="dblclick"&&i.addEventListener("dblclick",function(n){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),t.edit(e,n,!1))}),(this.options("editTriggerEvent")==="focus"||this.options("editTriggerEvent")==="click")&&i.addEventListener("click",function(n){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),t.edit(e,n,!1))}),this.options("editTriggerEvent")==="focus"&&i.addEventListener("focus",function(n){t.recursionBlock||t.edit(e,n,!1)})}}focusCellNoEvent(e,t){this.recursionBlock=!0,t&&this.table.browser==="ie"||e.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}editCell(e,t){this.focusCellNoEvent(e),this.edit(e,!1,t)}focusScrollAdjust(e){if(this.table.rowManager.getRenderMode()=="virtual"){var t=this.table.rowManager.element.scrollTop,i=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,n=e.row.getElement();n.offsetTop<t?this.table.rowManager.element.scrollTop-=t-n.offsetTop:n.offsetTop+n.offsetHeight>i&&(this.table.rowManager.element.scrollTop+=n.offsetTop+n.offsetHeight-i);var r=this.table.rowManager.element.scrollLeft,o=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,a=e.getElement();this.table.modExists("frozenColumns")&&(r+=parseInt(this.table.modules.frozenColumns.leftMargin||0),o-=parseInt(this.table.modules.frozenColumns.rightMargin||0)),this.table.options.renderHorizontal==="virtual"&&(r-=parseInt(this.table.columnManager.renderer.vDomPadLeft),o-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),a.offsetLeft<r?this.table.rowManager.element.scrollLeft-=r-a.offsetLeft:a.offsetLeft+a.offsetWidth>o&&(this.table.rowManager.element.scrollLeft+=a.offsetLeft+a.offsetWidth-o)}}allowEdit(e){var t=!!e.column.modules.edit;if(e.column.modules.edit)switch(typeof e.column.modules.edit.check){case"function":e.row.initialized&&(t=e.column.modules.edit.check(e.getComponent()));break;case"string":t=!!e.row.data[e.column.modules.edit.check];break;case"boolean":t=e.column.modules.edit.check;break}return t}edit(e,t,i){var n=this,r=!0,o=function(){},a=e.getElement(),l=!1,h,u,c;if(this.currentCell){!this.invalidEdit&&this.currentCell!==e&&this.cancelEdit();return}function d(b){if(n.currentCell===e&&!l){var v=n.chain("edit-success",[e,b],!0,!0);return v===!0||n.table.options.validationMode==="highlight"?(l=!0,n.clearEditor(),e.modules.edit||(e.modules.edit={}),e.modules.edit.edited=!0,n.editedCells.indexOf(e)==-1&&n.editedCells.push(e),b=n.transformEmptyValues(b,e),e.setValue(b,!0),v===!0):(l=!0,n.invalidEdit=!0,n.focusCellNoEvent(e,!0),o(),setTimeout(()=>{l=!1},10),!1)}}function f(){n.currentCell===e&&!l&&n.cancelEdit()}function g(b){o=b}if(e.column.modules.edit.blocked)return this.mouseClick=!1,this.blur(a),!1;if(t&&t.stopPropagation(),r=this.allowEdit(e),r||i){if(n.cancelEdit(),n.currentCell=e,this.focusScrollAdjust(e),u=e.getComponent(),this.mouseClick&&(this.mouseClick=!1,e.column.definition.cellClick&&e.column.definition.cellClick.call(this.table,t,u)),e.column.definition.cellEditing&&e.column.definition.cellEditing.call(this.table,u),this.dispatch("cell-editing",e),this.dispatchExternal("cellEditing",u),c=typeof e.column.modules.edit.params=="function"?e.column.modules.edit.params(u):e.column.modules.edit.params,h=e.column.modules.edit.editor.call(n,u,g,d,f,c),this.currentCell&&h!==!1)if(h instanceof Node){for(a.classList.add("tabulator-editing"),e.row.getElement().classList.add("tabulator-editing"),e.table.element.classList.add("tabulator-editing");a.firstChild;)a.removeChild(a.firstChild);a.appendChild(h),o();for(var p=a.children,y=0;y<p.length;y++)p[y].addEventListener("click",function(b){b.stopPropagation()})}else return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",h),this.blur(a),!1;else return this.blur(a),!1;return!0}else return this.mouseClick=!1,this.blur(a),!1}emptyValueCheck(e){return e===""||e===null||typeof e>"u"}transformEmptyValues(e,t){var i=t.column.modules.edit,n=i.convertEmptyValues||this.convertEmptyValues,r;return n&&(r=i.editorEmptyValueFunc||this.options("editorEmptyValueFunc"),r&&r(e)&&(e=i.convertEmptyValues?i.editorEmptyValue:this.options("editorEmptyValue"))),e}blur(e){this.confirm("edit-blur",[e])||e.blur()}getEditedCells(){var e=[];return this.editedCells.forEach(t=>{e.push(t.getComponent())}),e}clearEdited(e){var t;e.modules.edit&&e.modules.edit.edited&&(e.modules.edit.edited=!1,this.dispatch("edit-edited-clear",e)),t=this.editedCells.indexOf(e),t>-1&&this.editedCells.splice(t,1)}};U(vo,"moduleName","edit"),U(vo,"editors",nF);let bc=vo;class rm{constructor(e,t,i,n){this.type=e,this.columns=t,this.component=i||!1,this.indent=n||0}}class vu{constructor(e,t,i,n,r){this.value=e,this.component=t||!1,this.width=i,this.height=n,this.depth=r}}var sF={},rF={visible:function(){return this.rowManager.getVisibleRows(!1,!0)},all:function(){return this.rowManager.rows},selected:function(){return this.modules.selectRow.selectedRows},active:function(){return this.options.pagination?this.rowManager.getDisplayRows(this.rowManager.displayRows.length-2):this.rowManager.getDisplayRows()}};const Hn=class Hn extends pe{constructor(e){super(e),this.config={},this.cloneTableStyle=!0,this.colVisProp="",this.colVisPropAttach="",this.registerTableOption("htmlOutputConfig",!1),this.registerColumnOption("htmlOutput"),this.registerColumnOption("titleHtmlOutput")}initialize(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}generateExportList(e,t,i,n){var r,o,a,l;return this.cloneTableStyle=t,this.config=e||{},this.colVisProp=n,this.colVisPropAttach=this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1),l=Hn.columnLookups[i],l&&(a=l.call(this.table),a=a.filter(h=>this.columnVisCheck(h))),r=this.config.columnHeaders!==!1?this.headersToExportRows(this.generateColumnGroupHeaders(a)):[],a&&(a=a.map(h=>h.getComponent())),o=this.bodyToExportRows(this.rowLookup(i),a),r.concat(o)}generateTable(e,t,i,n){var r=this.generateExportList(e,t,i,n);return this.generateTableElement(r)}rowLookup(e){var t=[],i;return typeof e=="function"?e.call(this.table).forEach(n=>{n=this.table.rowManager.findRow(n),n&&t.push(n)}):(i=Hn.rowLookups[e]||Hn.rowLookups.active,t=i.call(this.table)),Object.assign([],t)}generateColumnGroupHeaders(e){var t=[];return e||(e=this.config.columnGroups!==!1?this.table.columnManager.columns:this.table.columnManager.columnsByIndex),e.forEach(i=>{var n=this.processColumnGroup(i);n&&t.push(n)}),t}processColumnGroup(e){var t=e.columns,i=0,n=e.definition["title"+this.colVisPropAttach]||e.definition.title,r={title:n,column:e,depth:1};if(t.length){if(r.subGroups=[],r.width=0,t.forEach(o=>{var a=this.processColumnGroup(o);a&&(r.width+=a.width,r.subGroups.push(a),a.depth>i&&(i=a.depth))}),r.depth+=i,!r.width)return!1}else if(this.columnVisCheck(e))r.width=1;else return!1;return r}columnVisCheck(e){var t=e.definition[this.colVisProp];return this.config.rowHeaders===!1&&e.isRowHeader?!1:(typeof t=="function"&&(t=t.call(this.table,e.getComponent())),t===!1||t===!0?t:e.visible&&e.field)}headersToExportRows(e){var t=[],i=0,n=[];function r(o,a){var l=i-a;if(typeof t[a]>"u"&&(t[a]=[]),o.height=o.subGroups?1:l-o.depth+1,t[a].push(o),o.height>1)for(let h=1;h<o.height;h++)typeof t[a+h]>"u"&&(t[a+h]=[]),t[a+h].push(!1);if(o.width>1)for(let h=1;h<o.width;h++)t[a].push(!1);o.subGroups&&o.subGroups.forEach(function(h){r(h,a+1)})}return e.forEach(function(o){o.depth>i&&(i=o.depth)}),e.forEach(function(o){r(o,0)}),t.forEach(o=>{var a=[];o.forEach(l=>{if(l){let h=typeof l.title>"u"?"":l.title;a.push(new vu(h,l.column.getComponent(),l.width,l.height,l.depth))}else a.push(null)}),n.push(new rm("header",a))}),n}bodyToExportRows(e,t=[]){var i=[];return t.length===0&&this.table.columnManager.columnsByIndex.forEach(n=>{this.columnVisCheck(n)&&t.push(n.getComponent())}),this.config.columnCalcs!==!1&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&e.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&e.push(this.table.modules.columnCalcs.botRow)),e=e.filter(n=>{switch(n.type){case"group":return this.config.rowGroups!==!1;case"calc":return this.config.columnCalcs!==!1;case"row":return!(this.table.options.dataTree&&this.config.dataTree===!1&&n.modules.dataTree.parent)}return!0}),e.forEach((n,r)=>{var o=n.getData(this.colVisProp),a=[],l=0;switch(n.type){case"group":l=n.level,a.push(new vu(n.key,n.getComponent(),t.length,1));break;case"calc":case"row":t.forEach(h=>{a.push(new vu(h._column.getFieldValue(o),h,1,1))}),this.table.options.dataTree&&this.config.dataTree!==!1&&(l=n.modules.dataTree.index);break}i.push(new rm(n.type,a,n.getComponent(),l))}),i}generateTableElement(e){var t=document.createElement("table"),i=document.createElement("thead"),n=document.createElement("tbody"),r=this.lookupTableStyles(),o=this.table.options["rowFormatter"+this.colVisPropAttach],a={};return a.rowFormatter=o!==null?o:this.table.options.rowFormatter,this.table.options.dataTree&&this.config.dataTree!==!1&&this.table.modExists("columnCalcs")&&(a.treeElementField=this.table.modules.dataTree.elementField),a.groupHeader=this.table.options["groupHeader"+this.colVisPropAttach],a.groupHeader&&!Array.isArray(a.groupHeader)&&(a.groupHeader=[a.groupHeader]),t.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),i,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),e.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),e.forEach((l,h)=>{let u;switch(l.type){case"header":i.appendChild(this.generateHeaderElement(l,a,r));break;case"group":n.appendChild(this.generateGroupElement(l,a,r));break;case"calc":n.appendChild(this.generateCalcElement(l,a,r));break;case"row":u=this.generateRowElement(l,a,r),this.mapElementStyles(h%2&&r.evenRow?r.evenRow:r.oddRow,u,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),n.appendChild(u);break}}),i.innerHTML&&t.appendChild(i),t.appendChild(n),this.mapElementStyles(this.table.element,t,["border-top","border-left","border-right","border-bottom"]),t}lookupTableStyles(){var e={};return this.cloneTableStyle&&window.getComputedStyle&&(e.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),e.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),e.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),e.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),e.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],e.firstRow&&(e.styleCells=e.firstRow.getElementsByClassName("tabulator-cell"),e.styleRowHeader=e.firstRow.getElementsByClassName("tabulator-row-header")[0],e.firstCell=e.styleCells[0],e.lastCell=e.styleCells[e.styleCells.length-1])),e}generateHeaderElement(e,t,i){var n=document.createElement("tr");return e.columns.forEach(r=>{if(r){var o=document.createElement("th"),a=r.component._column.definition.cssClass?r.component._column.definition.cssClass.split(" "):[];o.colSpan=r.width,o.rowSpan=r.height,o.innerHTML=r.value,this.cloneTableStyle&&(o.style.boxSizing="border-box"),a.forEach(function(l){o.classList.add(l)}),this.mapElementStyles(r.component.getElement(),o,["text-align","border-left","border-right","background-color","color","font-weight","font-family","font-size"]),this.mapElementStyles(r.component._column.contentElement,o,["padding-top","padding-left","padding-right","padding-bottom"]),r.component._column.visible?this.mapElementStyles(r.component.getElement(),o,["width"]):r.component._column.definition.width&&(o.style.width=r.component._column.definition.width+"px"),r.component._column.parent&&r.component._column.parent.isGroup?this.mapElementStyles(r.component._column.parent.groupElement,o,["border-top"]):this.mapElementStyles(r.component.getElement(),o,["border-top"]),r.component._column.isGroup?this.mapElementStyles(r.component.getElement(),o,["border-bottom"]):this.mapElementStyles(this.table.columnManager.getElement(),o,["border-bottom"]),n.appendChild(o)}}),n}generateGroupElement(e,t,i){var n=document.createElement("tr"),r=document.createElement("td"),o=e.columns[0];return n.classList.add("tabulator-print-table-row"),t.groupHeader&&t.groupHeader[e.indent]?o.value=t.groupHeader[e.indent](o.value,e.component._group.getRowCount(),e.component._group.getData(),e.component):t.groupHeader!==!1&&(o.value=e.component._group.generator(o.value,e.component._group.getRowCount(),e.component._group.getData(),e.component)),r.colSpan=o.width,r.innerHTML=o.value,n.classList.add("tabulator-print-table-group"),n.classList.add("tabulator-group-level-"+e.indent),o.component.isVisible()&&n.classList.add("tabulator-group-visible"),this.mapElementStyles(i.firstGroup,n,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(i.firstGroup,r,["padding-top","padding-left","padding-right","padding-bottom"]),n.appendChild(r),n}generateCalcElement(e,t,i){var n=this.generateRowElement(e,t,i);return n.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(i.calcRow,n,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),n}generateRowElement(e,t,i){var n=document.createElement("tr");if(n.classList.add("tabulator-print-table-row"),e.columns.forEach((r,o)=>{if(r){var a=document.createElement("td"),l=r.component._column,h=this.table,u=h.columnManager.findColumnIndex(l),c=r.value,d,f,g={modules:{},getValue:function(){return c},getField:function(){return l.definition.field},getElement:function(){return a},getType:function(){return"cell"},getColumn:function(){return l.getComponent()},getData:function(){return e.component.getData()},getRow:function(){return e.component},getTable:function(){return h},getComponent:function(){return g},column:l},p=l.definition.cssClass?l.definition.cssClass.split(" "):[];if(p.forEach(function(y){a.classList.add(y)}),this.table.modExists("format")&&this.config.formatCells!==!1)c=this.table.modules.format.formatExportValue(g,this.colVisProp);else switch(typeof c){case"object":c=c!==null?JSON.stringify(c):"";break;case"undefined":c="";break}c instanceof Node?a.appendChild(c):a.innerHTML=c,f=["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"],l.isRowHeader?(d=i.styleRowHeader,f.push("background-color")):d=i.styleCells&&i.styleCells[u]?i.styleCells[u]:i.firstCell,d&&(this.mapElementStyles(d,a,f),l.definition.align&&(a.style.textAlign=l.definition.align)),this.table.options.dataTree&&this.config.dataTree!==!1&&(t.treeElementField&&t.treeElementField==l.field||!t.treeElementField&&o==0)&&(e.component._row.modules.dataTree.controlEl&&a.insertBefore(e.component._row.modules.dataTree.controlEl.cloneNode(!0),a.firstChild),e.component._row.modules.dataTree.branchEl&&a.insertBefore(e.component._row.modules.dataTree.branchEl.cloneNode(!0),a.firstChild)),n.appendChild(a),g.modules.format&&g.modules.format.renderedCallback&&g.modules.format.renderedCallback()}}),t.rowFormatter&&e.type==="row"&&this.config.formatCells!==!1){let r=Object.assign(e.component);r.getElement=function(){return n},t.rowFormatter(e.component)}return n}generateHTMLTable(e){var t=document.createElement("div");return t.appendChild(this.generateTableElement(e)),t.innerHTML}getHtml(e,t,i,n){var r=this.generateExportList(i||this.table.options.htmlOutputConfig,t,e,n||"htmlOutput");return this.generateHTMLTable(r)}mapElementStyles(e,t,i){if(this.cloneTableStyle&&e&&t){var n={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var r=window.getComputedStyle(e);i.forEach(function(o){t.style[n[o]]||(t.style[n[o]]=r.getPropertyValue(o))})}}}};U(Hn,"moduleName","export"),U(Hn,"columnLookups",sF),U(Hn,"rowLookups",rF);let yc=Hn;var oF={"=":function(s,e,t,i){return e==s},"<":function(s,e,t,i){return e<s},"<=":function(s,e,t,i){return e<=s},">":function(s,e,t,i){return e>s},">=":function(s,e,t,i){return e>=s},"!=":function(s,e,t,i){return e!=s},regex:function(s,e,t,i){return typeof s=="string"&&(s=new RegExp(s)),s.test(e)},like:function(s,e,t,i){return s===null||typeof s>"u"?e===s:typeof e<"u"&&e!==null?String(e).toLowerCase().indexOf(s.toLowerCase())>-1:!1},keywords:function(s,e,t,i){var n=s.toLowerCase().split(typeof i.separator>"u"?" ":i.separator),r=String(e===null||typeof e>"u"?"":e).toLowerCase(),o=[];return n.forEach(a=>{r.includes(a)&&o.push(!0)}),i.matchAll?o.length===n.length:!!o.length},starts:function(s,e,t,i){return s===null||typeof s>"u"?e===s:typeof e<"u"&&e!==null?String(e).toLowerCase().startsWith(s.toLowerCase()):!1},ends:function(s,e,t,i){return s===null||typeof s>"u"?e===s:typeof e<"u"&&e!==null?String(e).toLowerCase().endsWith(s.toLowerCase()):!1},in:function(s,e,t,i){return Array.isArray(s)?s.length?s.indexOf(e)>-1:!0:(console.warn("Filter Error - filter value is not an array:",s),!1)}};const an=class an extends pe{constructor(e){super(e),this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1,this.tableInitialized=!1,this.registerTableOption("filterMode","local"),this.registerTableOption("initialFilter",!1),this.registerTableOption("initialHeaderFilter",!1),this.registerTableOption("headerFilterLiveFilterDelay",300),this.registerTableOption("placeholderHeaderFilter",!1),this.registerColumnOption("headerFilter"),this.registerColumnOption("headerFilterPlaceholder"),this.registerColumnOption("headerFilterParams"),this.registerColumnOption("headerFilterEmptyCheck"),this.registerColumnOption("headerFilterFunc"),this.registerColumnOption("headerFilterFuncParams"),this.registerColumnOption("headerFilterLiveFilter"),this.registerTableFunction("searchRows",this.searchRows.bind(this)),this.registerTableFunction("searchData",this.searchData.bind(this)),this.registerTableFunction("setFilter",this.userSetFilter.bind(this)),this.registerTableFunction("refreshFilter",this.userRefreshFilter.bind(this)),this.registerTableFunction("addFilter",this.userAddFilter.bind(this)),this.registerTableFunction("getFilters",this.getFilters.bind(this)),this.registerTableFunction("setHeaderFilterFocus",this.userSetHeaderFilterFocus.bind(this)),this.registerTableFunction("getHeaderFilterValue",this.userGetHeaderFilterValue.bind(this)),this.registerTableFunction("setHeaderFilterValue",this.userSetHeaderFilterValue.bind(this)),this.registerTableFunction("getHeaderFilters",this.getHeaderFilters.bind(this)),this.registerTableFunction("removeFilter",this.userRemoveFilter.bind(this)),this.registerTableFunction("clearFilter",this.userClearFilter.bind(this)),this.registerTableFunction("clearHeaderFilter",this.userClearHeaderFilter.bind(this)),this.registerComponentFunction("column","headerFilterFocus",this.setHeaderFilterFocus.bind(this)),this.registerComponentFunction("column","reloadHeaderFilter",this.reloadHeaderFilter.bind(this)),this.registerComponentFunction("column","getHeaderFilterValue",this.getHeaderFilterValue.bind(this)),this.registerComponentFunction("column","setHeaderFilterValue",this.setHeaderFilterValue.bind(this))}initialize(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.subscribe("placeholder",this.generatePlaceholder.bind(this)),this.table.options.filterMode==="remote"&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}tableBuilt(){this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach(e=>{var t=this.table.columnManager.findColumn(e.field);if(t)this.setHeaderFilterValue(t,e.value);else return console.warn("Column Filter Error - No matching column found:",e.field),!1}),this.tableInitialized=!0}remoteFilterParams(e,t,i,n){return n.filter=this.getFilters(!0,!0),n}generatePlaceholder(e){if(this.table.options.placeholderHeaderFilter&&Object.keys(this.headerFilters).length)return this.table.options.placeholderHeaderFilter}userSetFilter(e,t,i,n){this.setFilter(e,t,i,n),this.refreshFilter()}userRefreshFilter(){this.refreshFilter()}userAddFilter(e,t,i,n){this.addFilter(e,t,i,n),this.refreshFilter()}userSetHeaderFilterFocus(e){var t=this.table.columnManager.findColumn(e);if(t)this.setHeaderFilterFocus(t);else return console.warn("Column Filter Focus Error - No matching column found:",e),!1}userGetHeaderFilterValue(e){var t=this.table.columnManager.findColumn(e);if(t)return this.getHeaderFilterValue(t);console.warn("Column Filter Error - No matching column found:",e)}userSetHeaderFilterValue(e,t){var i=this.table.columnManager.findColumn(e);if(i)this.setHeaderFilterValue(i,t);else return console.warn("Column Filter Error - No matching column found:",e),!1}userRemoveFilter(e,t,i){this.removeFilter(e,t,i),this.refreshFilter()}userClearFilter(e){this.clearFilter(e),this.refreshFilter()}userClearHeaderFilter(){this.clearHeaderFilter(),this.refreshFilter()}searchRows(e,t,i){return this.search("rows",e,t,i)}searchData(e,t,i){return this.search("data",e,t,i)}initializeColumnHeaderFilter(e){var t=e.definition;t.headerFilter&&this.initializeColumn(e)}initializeColumn(e,t){var i=this,n=e.getField();function r(o){var a=e.modules.filter.tagType=="input"&&e.modules.filter.attrType=="text"||e.modules.filter.tagType=="textarea"?"partial":"match",l="",h="",u;if(typeof e.modules.filter.prevSuccess>"u"||e.modules.filter.prevSuccess!==o){if(e.modules.filter.prevSuccess=o,e.modules.filter.emptyFunc(o))delete i.headerFilters[n];else{switch(e.modules.filter.value=o,typeof e.definition.headerFilterFunc){case"string":an.filters[e.definition.headerFilterFunc]?(l=e.definition.headerFilterFunc,u=function(c){var d=e.definition.headerFilterFuncParams||{},f=e.getFieldValue(c);return d=typeof d=="function"?d(o,f,c):d,an.filters[e.definition.headerFilterFunc](o,f,c,d)}):console.warn("Header Filter Error - Matching filter function not found: ",e.definition.headerFilterFunc);break;case"function":u=function(c){var d=e.definition.headerFilterFuncParams||{},f=e.getFieldValue(c);return d=typeof d=="function"?d(o,f,c):d,e.definition.headerFilterFunc(o,f,c,d)},l=u;break}if(!u)switch(a){case"partial":u=function(c){var d=e.getFieldValue(c);return typeof d<"u"&&d!==null?String(d).toLowerCase().indexOf(String(o).toLowerCase())>-1:!1},l="like";break;default:u=function(c){return e.getFieldValue(c)==o},l="="}i.headerFilters[n]={value:o,func:u,type:l}}e.modules.filter.value=o,h=JSON.stringify(i.headerFilters),i.prevHeaderFilterChangeCheck!==h&&(i.prevHeaderFilterChangeCheck=h,i.trackChanges(),i.refreshFilter())}return!0}e.modules.filter={success:r,attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(e)}generateHeaderFilterElement(e,t,i){var n=this,r=e.modules.filter.success,o=e.getField(),a,l,h,u,c,d,f,g;e.modules.filter.value=t;function p(){}function y(b){g=b}if(e.modules.filter.headerElement&&e.modules.filter.headerElement.parentNode&&e.contentElement.removeChild(e.modules.filter.headerElement.parentNode),o){switch(e.modules.filter.emptyFunc=e.definition.headerFilterEmptyCheck||function(b){return!b&&b!==0},a=document.createElement("div"),a.classList.add("tabulator-header-filter"),typeof e.definition.headerFilter){case"string":n.table.modules.edit.editors[e.definition.headerFilter]?(l=n.table.modules.edit.editors[e.definition.headerFilter],(e.definition.headerFilter==="tick"||e.definition.headerFilter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(b){return b!==!0&&b!==!1})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",e.definition.editor);break;case"function":l=e.definition.headerFilter;break;case"boolean":e.modules.edit&&e.modules.edit.editor?l=e.modules.edit.editor:e.definition.formatter&&n.table.modules.edit.editors[e.definition.formatter]?(l=n.table.modules.edit.editors[e.definition.formatter],(e.definition.formatter==="tick"||e.definition.formatter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(b){return b!==!0&&b!==!1})):l=n.table.modules.edit.editors.input;break}if(l){if(u={getValue:function(){return typeof t<"u"?t:""},getField:function(){return e.definition.field},getElement:function(){return a},getColumn:function(){return e.getComponent()},getTable:()=>this.table,getType:()=>"header",getRow:function(){return{normalizeHeight:function(){}}}},f=e.definition.headerFilterParams||{},f=typeof f=="function"?f.call(n.table,u):f,h=l.call(this.table.modules.edit,u,y,r,p,f),!h){console.warn("Filter Error - Cannot add filter to "+o+" column, editor returned a value of false");return}if(!(h instanceof Node)){console.warn("Filter Error - Cannot add filter to "+o+" column, editor should return an instance of Node, the editor returned:",h);return}n.langBind("headerFilters|columns|"+e.definition.field,function(b){h.setAttribute("placeholder",typeof b<"u"&&b?b:e.definition.headerFilterPlaceholder||n.langText("headerFilters|default"))}),h.addEventListener("click",function(b){b.stopPropagation(),h.focus()}),h.addEventListener("focus",b=>{var v=this.table.columnManager.contentsElement.scrollLeft,_=this.table.rowManager.element.scrollLeft;v!==_&&(this.table.rowManager.scrollHorizontal(v),this.table.columnManager.scrollHorizontal(v))}),c=!1,d=function(b){c&&clearTimeout(c),c=setTimeout(function(){r(h.value)},n.table.options.headerFilterLiveFilterDelay)},e.modules.filter.headerElement=h,e.modules.filter.attrType=h.hasAttribute("type")?h.getAttribute("type").toLowerCase():"",e.modules.filter.tagType=h.tagName.toLowerCase(),e.definition.headerFilterLiveFilter!==!1&&(e.definition.headerFilter==="autocomplete"||e.definition.headerFilter==="tickCross"||(e.definition.editor==="autocomplete"||e.definition.editor==="tickCross")&&e.definition.headerFilter===!0||(h.addEventListener("keyup",d),h.addEventListener("search",d),e.modules.filter.attrType=="number"&&h.addEventListener("change",function(b){r(h.value)}),e.modules.filter.attrType=="text"&&this.table.browser!=="ie"&&h.setAttribute("type","search")),(e.modules.filter.tagType=="input"||e.modules.filter.tagType=="select"||e.modules.filter.tagType=="textarea")&&h.addEventListener("mousedown",function(b){b.stopPropagation()})),a.appendChild(h),e.contentElement.appendChild(a),i||n.headerFilterColumns.push(e),g&&g()}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",e.definition.title)}hideHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="none")})}showHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="")})}setHeaderFilterFocus(e){e.modules.filter&&e.modules.filter.headerElement?e.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",e.getField())}getHeaderFilterValue(e){if(e.modules.filter&&e.modules.filter.headerElement)return e.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",e.getField())}setHeaderFilterValue(e,t){e&&(e.modules.filter&&e.modules.filter.headerElement?(this.generateHeaderFilterElement(e,t,!0),e.modules.filter.success(t)):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}reloadHeaderFilter(e){e&&(e.modules.filter&&e.modules.filter.headerElement?this.generateHeaderFilterElement(e,e.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}refreshFilter(){this.tableInitialized&&(this.table.options.filterMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0))}trackChanges(){this.changed=!0,this.dispatch("filter-changed")}hasChanged(){var e=this.changed;return this.changed=!1,e}setFilter(e,t,i,n){this.filterList=[],Array.isArray(e)||(e=[{field:e,type:t,value:i,params:n}]),this.addFilter(e)}addFilter(e,t,i,n){var r=!1;Array.isArray(e)||(e=[{field:e,type:t,value:i,params:n}]),e.forEach(o=>{o=this.findFilter(o),o&&(this.filterList.push(o),r=!0)}),r&&this.trackChanges()}findFilter(e){var t;if(Array.isArray(e))return this.findSubFilters(e);var i=!1;return typeof e.field=="function"?i=function(n){return e.field(n,e.type||{})}:an.filters[e.type]?(t=this.table.columnManager.getColumnByField(e.field),t?i=function(n){return an.filters[e.type](e.value,t.getFieldValue(n),n,e.params||{})}:i=function(n){return an.filters[e.type](e.value,n[e.field],n,e.params||{})}):console.warn("Filter Error - No such filter type found, ignoring: ",e.type),e.func=i,e.func?e:!1}findSubFilters(e){var t=[];return e.forEach(i=>{i=this.findFilter(i),i&&t.push(i)}),t.length?t:!1}getFilters(e,t){var i=[];return e&&(i=this.getHeaderFilters()),t&&i.forEach(function(n){typeof n.type=="function"&&(n.type="function")}),i=i.concat(this.filtersToArray(this.filterList,t)),i}filtersToArray(e,t){var i=[];return e.forEach(n=>{var r;Array.isArray(n)?i.push(this.filtersToArray(n,t)):(r={field:n.field,type:n.type,value:n.value},t&&typeof r.type=="function"&&(r.type="function"),i.push(r))}),i}getHeaderFilters(){var e=[];for(var t in this.headerFilters)e.push({field:t,type:this.headerFilters[t].type,value:this.headerFilters[t].value});return e}removeFilter(e,t,i){Array.isArray(e)||(e=[{field:e,type:t,value:i}]),e.forEach(n=>{var r=-1;typeof n.field=="object"?r=this.filterList.findIndex(o=>n===o):r=this.filterList.findIndex(o=>n.field===o.field&&n.type===o.type&&n.value===o.value),r>-1?this.filterList.splice(r,1):console.warn("Filter Error - No matching filter type found, ignoring: ",n.type)}),this.trackChanges()}clearFilter(e){this.filterList=[],e&&this.clearHeaderFilter(),this.trackChanges()}clearHeaderFilter(){this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach(e=>{typeof e.modules.filter.value<"u"&&delete e.modules.filter.value,e.modules.filter.prevSuccess=void 0,this.reloadHeaderFilter(e)}),this.trackChanges()}search(e,t,i,n){var r=[],o=[];return Array.isArray(t)||(t=[{field:t,type:i,value:n}]),t.forEach(a=>{a=this.findFilter(a),a&&o.push(a)}),this.table.rowManager.rows.forEach(a=>{var l=!0;o.forEach(h=>{this.filterRecurse(h,a.getData())||(l=!1)}),l&&r.push(e==="data"?a.getData("data"):a.getComponent())}),r}filter(e,t){var i=[],n=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),this.table.options.filterMode!=="remote"&&(this.filterList.length||Object.keys(this.headerFilters).length)?e.forEach(r=>{this.filterRow(r)&&i.push(r)}):i=e.slice(0),this.subscribedExternal("dataFiltered")&&(i.forEach(r=>{n.push(r.getComponent())}),this.dispatchExternal("dataFiltered",this.getFilters(!0),n)),i}filterRow(e,t){var i=!0,n=e.getData();this.filterList.forEach(o=>{this.filterRecurse(o,n)||(i=!1)});for(var r in this.headerFilters)this.headerFilters[r].func(n)||(i=!1);return i}filterRecurse(e,t){var i=!1;return Array.isArray(e)?e.forEach(n=>{this.filterRecurse(n,t)&&(i=!0)}):i=e.func(t),i}};U(an,"moduleName","filter"),U(an,"filters",oF);let vc=an;function aF(s,e,t){return this.emptyToSpace(this.sanitizeHTML(s.getValue()))}function lF(s,e,t){return s.getValue()}function hF(s,e,t){return s.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(s.getValue()))}function uF(s,e,t){var i=parseFloat(s.getValue()),n="",r,o,a,l,h,u=e.decimal||".",c=e.thousand||",",d=e.negativeSign||"-",f=e.symbol||"",g=!!e.symbolAfter,p=typeof e.precision<"u"?e.precision:2;if(isNaN(i))return this.emptyToSpace(this.sanitizeHTML(s.getValue()));if(i<0&&(i=Math.abs(i),n=d),r=p!==!1?i.toFixed(p):i,r=String(r).split("."),o=r[0],a=r.length>1?u+r[1]:"",e.thousand!==!1)for(l=/(\d+)(\d{3})/;l.test(o);)o=o.replace(l,"$1"+c+"$2");return h=o+a,n===!0?(h="("+h+")",g?h+f:f+h):g?n+h+f:n+f+h}function cF(s,e,t){var i=s.getValue(),n=e.urlPrefix||"",r=e.download,o=i,a=document.createElement("a"),l;function h(u,c){var d=u.shift(),f=c[d];return u.length&&typeof f=="object"?h(u,f):f}if(e.labelField&&(l=s.getData(),o=h(e.labelField.split(this.table.options.nestedFieldSeparator),l)),e.label)switch(typeof e.label){case"string":o=e.label;break;case"function":o=e.label(s);break}if(o){if(e.urlField&&(l=s.getData(),i=Fe.retrieveNestedData(this.table.options.nestedFieldSeparator,e.urlField,l)),e.url)switch(typeof e.url){case"string":i=e.url;break;case"function":i=e.url(s);break}return a.setAttribute("href",n+i),e.target&&a.setAttribute("target",e.target),e.download&&(typeof r=="function"?r=r(s):r=r===!0?"":r,a.setAttribute("download",r)),a.innerHTML=this.emptyToSpace(this.sanitizeHTML(o)),a}else return"&nbsp;"}function dF(s,e,t){var i=document.createElement("img"),n=s.getValue();switch(e.urlPrefix&&(n=e.urlPrefix+s.getValue()),e.urlSuffix&&(n=n+e.urlSuffix),i.setAttribute("src",n),typeof e.height){case"number":i.style.height=e.height+"px";break;case"string":i.style.height=e.height;break}switch(typeof e.width){case"number":i.style.width=e.width+"px";break;case"string":i.style.width=e.width;break}return i.addEventListener("load",function(){s.getRow().normalizeHeight()}),i}function fF(s,e,t){var i=s.getValue(),n=s.getElement(),r=e.allowEmpty,o=e.allowTruthy,a=Object.keys(e).includes("trueValue"),l=typeof e.tickElement<"u"?e.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',h=typeof e.crossElement<"u"?e.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return a&&i===e.trueValue||!a&&(o&&i||i===!0||i==="true"||i==="True"||i===1||i==="1")?(n.setAttribute("aria-checked",!0),l||""):r&&(i==="null"||i===""||i===null||typeof i>"u")?(n.setAttribute("aria-checked","mixed"),""):(n.setAttribute("aria-checked",!1),h||"")}function gF(s,e,t){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),n=e.inputFormat||"yyyy-MM-dd HH:mm:ss",r=e.outputFormat||"dd/MM/yyyy HH:mm:ss",o=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",a=s.getValue();if(typeof i<"u"){var l;return i.isDateTime(a)?l=a:n==="iso"?l=i.fromISO(String(a)):l=i.fromFormat(String(a),n),l.isValid?(e.timezone&&(l=l.setZone(e.timezone)),l.toFormat(r)):o===!0||!a?a:typeof o=="function"?o(a):o}else console.error("Format Error - 'datetime' formatter is dependant on luxon.js")}function pF(s,e,t){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),n=e.inputFormat||"yyyy-MM-dd HH:mm:ss",r=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",o=typeof e.suffix<"u"?e.suffix:!1,a=typeof e.unit<"u"?e.unit:"days",l=typeof e.humanize<"u"?e.humanize:!1,h=typeof e.date<"u"?e.date:i.now(),u=s.getValue();if(typeof i<"u"){var c;return i.isDateTime(u)?c=u:n==="iso"?c=i.fromISO(String(u)):c=i.fromFormat(String(u),n),c.isValid?l?c.diff(h,a).toHuman()+(o?" "+o:""):parseInt(c.diff(h,a)[a])+(o?" "+o:""):r===!0?u:typeof r=="function"?r(u):r}else console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")}function mF(s,e,t){var i=s.getValue();return typeof e[i]>"u"?(console.warn("Missing display value for "+i),i):e[i]}function bF(s,e,t){var i=s.getValue(),n=s.getElement(),r=e&&e.stars?e.stars:5,o=document.createElement("span"),a=document.createElementNS("http://www.w3.org/2000/svg","svg"),l='<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',h='<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>';o.style.verticalAlign="middle",a.setAttribute("width","14"),a.setAttribute("height","14"),a.setAttribute("viewBox","0 0 512 512"),a.setAttribute("xml:space","preserve"),a.style.padding="0 1px",i=i&&!isNaN(i)?parseInt(i):0,i=Math.max(0,Math.min(i,r));for(var u=1;u<=r;u++){var c=a.cloneNode(!0);c.innerHTML=u<=i?l:h,o.appendChild(c)}return n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.textOverflow="ellipsis",n.setAttribute("aria-label",i),o}function yF(s,e,t){var i=this.sanitizeHTML(s.getValue())||0,n=document.createElement("span"),r=e&&e.max?e.max:100,o=e&&e.min?e.min:0,a=e&&typeof e.color<"u"?e.color:["red","orange","green"],l="#666666",h,u;if(!(isNaN(i)||typeof s.getValue()>"u")){switch(n.classList.add("tabulator-traffic-light"),u=parseFloat(i)<=r?parseFloat(i):r,u=parseFloat(u)>=o?parseFloat(u):o,h=(r-o)/100,u=Math.round((u-o)/h),typeof a){case"string":l=a;break;case"function":l=a(i);break;case"object":if(Array.isArray(a)){var c=100/a.length,d=Math.floor(u/c);d=Math.min(d,a.length-1),d=Math.max(d,0),l=a[d];break}}return n.style.backgroundColor=l,n}}function vF(s,e={},t){var i=this.sanitizeHTML(s.getValue())||0,n=s.getElement(),r=e.max?e.max:100,o=e.min?e.min:0,a=e.legendAlign?e.legendAlign:"center",l,h,u,c,d;switch(h=parseFloat(i)<=r?parseFloat(i):r,h=parseFloat(h)>=o?parseFloat(h):o,l=(r-o)/100,h=Math.round((h-o)/l),typeof e.color){case"string":u=e.color;break;case"function":u=e.color(i);break;case"object":if(Array.isArray(e.color)){let y=100/e.color.length,b=Math.floor(h/y);b=Math.min(b,e.color.length-1),b=Math.max(b,0),u=e.color[b];break}default:u="#2DC214"}switch(typeof e.legend){case"string":c=e.legend;break;case"function":c=e.legend(i);break;case"boolean":c=i;break;default:c=!1}switch(typeof e.legendColor){case"string":d=e.legendColor;break;case"function":d=e.legendColor(i);break;case"object":if(Array.isArray(e.legendColor)){let y=100/e.legendColor.length,b=Math.floor(h/y);b=Math.min(b,e.legendColor.length-1),b=Math.max(b,0),d=e.legendColor[b]}break;default:d="#000"}n.style.minWidth="30px",n.style.position="relative",n.setAttribute("aria-label",h);var f=document.createElement("div");f.style.display="inline-block",f.style.width=h+"%",f.style.backgroundColor=u,f.style.height="100%",f.setAttribute("data-max",r),f.setAttribute("data-min",o);var g=document.createElement("div");if(g.style.position="relative",g.style.width="100%",g.style.height="100%",c){var p=document.createElement("div");p.style.position="absolute",p.style.top=0,p.style.left=0,p.style.textAlign=a,p.style.width="100%",p.style.color=d,p.innerHTML=c}return t(function(){if(!(s instanceof Av)){var y=document.createElement("div");y.style.position="absolute",y.style.top="4px",y.style.bottom="4px",y.style.left="4px",y.style.right="4px",n.appendChild(y),n=y}n.appendChild(g),g.appendChild(f),c&&g.appendChild(p)}),""}function wF(s,e,t){return s.getElement().style.backgroundColor=this.sanitizeHTML(s.getValue()),""}function _F(s,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'}function EF(s,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'}function CF(s,e,t){var i=s.getValue(),n=e.size||15,r=n+"px",o,a,l=e.hasOwnProperty("onValue")?e.onValue:!0,h=e.hasOwnProperty("offValue")?e.offValue:!1,u=e.onTruthy?i:i===l;return o=document.createElement("div"),o.classList.add("tabulator-toggle"),u?(o.classList.add("tabulator-toggle-on"),o.style.flexDirection="row-reverse",e.onColor&&(o.style.background=e.onColor)):e.offColor&&(o.style.background=e.offColor),o.style.width=2.5*n+"px",o.style.borderRadius=r,e.clickable&&o.addEventListener("click",c=>{s.setValue(u?h:l)}),a=document.createElement("div"),a.classList.add("tabulator-toggle-switch"),a.style.height=r,a.style.width=r,a.style.borderRadius=r,o.appendChild(a),o}function xF(s,e,t){var i=document.createElement("span"),n=s.getRow(),r=s.getTable();return n.watchPosition(o=>{e.relativeToPage&&(o+=r.modules.page.getPageSize()*(r.modules.page.getPage()-1)),i.innerText=o}),i}function RF(s,e,t){return s.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"}function SF(s,e,t){var i,n,r;function o(a){var l=a.getValue(),h="plaintext";switch(typeof l){case"boolean":h="tickCross";break;case"string":l.includes(`
`)&&(h="textarea");break}return h}return i=e.formatterLookup?e.formatterLookup(s):o(s),e.paramsLookup&&(r=typeof e.paramsLookup=="function"?e.paramsLookup(i,s):e.paramsLookup[i]),n=this.table.modules.format.lookupFormatter(i),n.call(this,s,r||{},t)}function TF(s,e,t){var i=e.delimiter||",",n=s.getValue(),r=this.table,o;return e.valueMap&&(typeof e.valueMap=="string"?o=function(a){return a.map(l=>Fe.retrieveNestedData(r.options.nestedFieldSeparator,e.valueMap,l))}:o=e.valueMap),Array.isArray(n)?(o&&(n=o(n)),n.join(i)):n}function MF(s,e,t){var i=e.indent||"	",n=typeof e.multiline>"u"?!0:e.multiline,r=e.replacer||null,o=s.getValue();return n&&(s.getElement().style.whiteSpace="pre-wrap"),JSON.stringify(o,r,i)}var LF={plaintext:aF,html:lF,textarea:hF,money:uF,link:cF,image:dF,tickCross:fF,datetime:gF,datetimediff:pF,lookup:mF,star:bF,traffic:yF,progress:vF,color:wF,buttonTick:_F,buttonCross:EF,toggle:CF,rownum:xF,handle:RF,adaptable:SF,array:TF,json:MF};const Bn=class Bn extends pe{constructor(e){super(e),this.registerColumnOption("formatter"),this.registerColumnOption("formatterParams"),this.registerColumnOption("formatterPrint"),this.registerColumnOption("formatterPrintParams"),this.registerColumnOption("formatterClipboard"),this.registerColumnOption("formatterClipboardParams"),this.registerColumnOption("formatterHtmlOutput"),this.registerColumnOption("formatterHtmlOutputParams"),this.registerColumnOption("titleFormatter"),this.registerColumnOption("titleFormatterParams")}initialize(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}initializeColumn(e){e.modules.format=this.lookupTypeFormatter(e,""),typeof e.definition.formatterPrint<"u"&&(e.modules.format.print=this.lookupTypeFormatter(e,"Print")),typeof e.definition.formatterClipboard<"u"&&(e.modules.format.clipboard=this.lookupTypeFormatter(e,"Clipboard")),typeof e.definition.formatterHtmlOutput<"u"&&(e.modules.format.htmlOutput=this.lookupTypeFormatter(e,"HtmlOutput"))}lookupTypeFormatter(e,t){var i={params:e.definition["formatter"+t+"Params"]||{}},n=e.definition["formatter"+t];return i.formatter=this.lookupFormatter(n),i}lookupFormatter(e){var t;switch(typeof e){case"string":Bn.formatters[e]?t=Bn.formatters[e]:(console.warn("Formatter Error - No such formatter found: ",e),t=Bn.formatters.plaintext);break;case"function":t=e;break;default:t=Bn.formatters.plaintext;break}return t}cellRendered(e){e.modules.format&&e.modules.format.renderedCallback&&!e.modules.format.rendered&&(e.modules.format.renderedCallback(),e.modules.format.rendered=!0)}formatHeader(e,t,i){var n,r,o,a;return e.definition.titleFormatter?(n=this.lookupFormatter(e.definition.titleFormatter),o=l=>{e.titleFormatterRendered=l},a={getValue:function(){return t},getElement:function(){return i},getType:function(){return"header"},getColumn:function(){return e.getComponent()},getTable:()=>this.table},r=e.definition.titleFormatterParams||{},r=typeof r=="function"?r():r,n.call(this,a,r,o)):t}formatValue(e){var t=e.getComponent(),i=typeof e.column.modules.format.params=="function"?e.column.modules.format.params(t):e.column.modules.format.params;function n(r){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=r,e.modules.format.rendered=!1}return e.column.modules.format.formatter.call(this,t,i,n)}formatExportValue(e,t){var i=e.column.modules.format[t],n;if(i){let r=function(o){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=o,e.modules.format.rendered=!1};return n=typeof i.params=="function"?i.params(e.getComponent()):i.params,i.formatter.call(this,e.getComponent(),n,r)}else return this.formatValue(e)}sanitizeHTML(e){if(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=/]/g,function(i){return t[i]})}else return e}emptyToSpace(e){return e===null||typeof e>"u"||e===""?"&nbsp;":e}};U(Bn,"moduleName","format"),U(Bn,"formatters",LF);let wc=Bn;class Fv extends pe{constructor(e){super(e),this.leftColumns=[],this.rightColumns=[],this.initializationMode="left",this.active=!1,this.blocked=!0,this.registerColumnOption("frozen")}reset(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.active=!1}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-deleted",this.reinitializeColumns.bind(this)),this.subscribe("column-hide",this.reinitializeColumns.bind(this)),this.subscribe("column-show",this.reinitializeColumns.bind(this)),this.subscribe("columns-loaded",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this))}blockLayout(){this.blocked=!0}unblockLayout(){this.blocked=!1}layoutCell(e){this.layoutElement(e.element,e.column)}reinitializeColumns(){this.reset(),this.table.columnManager.columnsByIndex.forEach(e=>{this.initializeColumn(e)}),this.layout()}initializeColumn(e){var t={margin:0,edge:!1};e.isGroup||(this.frozenCheck(e)?(t.position=this.initializationMode,this.initializationMode=="left"?this.leftColumns.push(e):this.rightColumns.unshift(e),this.active=!0,e.modules.frozen=t):this.initializationMode="right")}frozenCheck(e){return e.parent.isGroup&&e.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),e.parent.isGroup?this.frozenCheck(e.parent):e.definition.frozen}layoutCalcRows(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}layoutGroupCalcs(e){e.forEach(t=>{t.calcs.top&&this.layoutRow(t.calcs.top),t.calcs.bottom&&this.layoutRow(t.calcs.bottom),t.groupList&&t.groupList.length&&this.layoutGroupCalcs(t.groupList)})}layoutColumnPosition(e){var t=[],i=0,n=0;this.leftColumns.forEach((r,o)=>{if(r.modules.frozen.marginValue=i,r.modules.frozen.margin=r.modules.frozen.marginValue+"px",r.visible&&(i+=r.getWidth()),o==this.leftColumns.length-1?r.modules.frozen.edge=!0:r.modules.frozen.edge=!1,r.parent.isGroup){var a=this.getColGroupParentElement(r);t.includes(a)||(this.layoutElement(a,r),t.push(a)),a.classList.toggle("tabulator-frozen-left",r.modules.frozen.edge&&r.modules.frozen.position==="left"),a.classList.toggle("tabulator-frozen-right",r.modules.frozen.edge&&r.modules.frozen.position==="right")}else this.layoutElement(r.getElement(),r);e&&r.cells.forEach(l=>{this.layoutElement(l.getElement(!0),r)})}),this.rightColumns.forEach((r,o)=>{r.modules.frozen.marginValue=n,r.modules.frozen.margin=r.modules.frozen.marginValue+"px",r.visible&&(n+=r.getWidth()),o==this.rightColumns.length-1?r.modules.frozen.edge=!0:r.modules.frozen.edge=!1,r.parent.isGroup?this.layoutElement(this.getColGroupParentElement(r),r):this.layoutElement(r.getElement(),r),e&&r.cells.forEach(a=>{this.layoutElement(a.getElement(!0),r)})})}getColGroupParentElement(e){return e.parent.isGroup?this.getColGroupParentElement(e.parent):e.getElement()}layout(){this.active&&!this.blocked&&(this.layoutColumnPosition(),this.reinitializeRows(),this.layoutCalcRows())}reinitializeRows(){var e=this.table.rowManager.getVisibleRows(!0),t=this.table.rowManager.getRows().filter(i=>!e.includes(i));t.forEach(i=>{i.deinitialize()}),e.forEach(i=>{i.type==="row"&&this.layoutRow(i)})}layoutRow(e){this.table.options.layout==="fitDataFill"&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach(t=>{var i=e.getCell(t);i&&this.layoutElement(i.getElement(!0),t)}),this.rightColumns.forEach(t=>{var i=e.getCell(t);i&&this.layoutElement(i.getElement(!0),t)})}layoutElement(e,t){var i;t.modules.frozen&&e&&(e.style.position="sticky",this.table.rtl?i=t.modules.frozen.position==="left"?"right":"left":i=t.modules.frozen.position,e.style[i]=t.modules.frozen.margin,e.classList.add("tabulator-frozen"),e.classList.toggle("tabulator-frozen-left",t.modules.frozen.edge&&t.modules.frozen.position==="left"),e.classList.toggle("tabulator-frozen-right",t.modules.frozen.edge&&t.modules.frozen.position==="right"))}adjustForScrollbar(e){this.rightColumns.length&&(this.table.columnManager.getContentsElement().style.width="calc(100% - "+e+"px)")}getFrozenColumns(){return this.leftColumns.concat(this.rightColumns)}_calcSpace(e,t){var i=0;for(let n=0;n<t;n++)e[n].visible&&(i+=e[n].getWidth());return i}}U(Fv,"moduleName","frozenColumns");class Dv extends pe{constructor(e){super(e),this.topElement=document.createElement("div"),this.rows=[],this.registerComponentFunction("row","freeze",this.freezeRow.bind(this)),this.registerComponentFunction("row","unfreeze",this.unfreezeRow.bind(this)),this.registerComponentFunction("row","isFrozen",this.isRowFrozen.bind(this)),this.registerTableOption("frozenRowsField","id"),this.registerTableOption("frozenRows",!1)}initialize(){var e=document.createDocumentFragment();this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10),this.table.options.frozenRows&&(this.subscribe("data-processed",this.initializeRows.bind(this)),this.subscribe("row-added",this.initializeRow.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this))),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}initializeRows(){this.table.rowManager.getRows().forEach(e=>{this.initializeRow(e)})}initializeRow(e){var t=this.table.options.frozenRows,i=typeof t;i==="number"?e.getPosition()&&e.getPosition()+this.rows.length<=t&&this.freezeRow(e):i==="function"?t.call(this.table,e.getComponent())&&this.freezeRow(e):Array.isArray(t)&&t.includes(e.data[this.options("frozenRowsField")])&&this.freezeRow(e)}isRowFrozen(e){var t=this.rows.indexOf(e);return t>-1}isFrozen(){return!!this.rows.length}visibleRows(e,t){return this.rows.forEach(i=>{t.push(i)}),t}getRows(e){var t=e.slice(0);return this.rows.forEach(function(i){var n=t.indexOf(i);n>-1&&t.splice(n,1)}),t}freezeRow(e){e.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(e.modules.frozen=!0,this.topElement.appendChild(e.getElement()),e.initialize(),e.normalizeHeight(),this.rows.push(e),this.refreshData(!1,"display"),this.table.rowManager.adjustTableSize(),this.styleRows())}unfreezeRow(e){e.modules.frozen?(e.modules.frozen=!1,this.detachRow(e),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}detachRow(e){var t=this.rows.indexOf(e);if(t>-1){var i=e.getElement();i.parentNode&&i.parentNode.removeChild(i),this.rows.splice(t,1)}}styleRows(e){this.rows.forEach((t,i)=>{this.table.rowManager.styleRow(t,i)})}}U(Dv,"moduleName","frozenRows");class AF{constructor(e){return this._group=e,this.type="GroupComponent",new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._group.groupManager.table.componentFunctionBinder.handle("group",t._group,i)}})}getKey(){return this._group.key}getField(){return this._group.field}getElement(){return this._group.element}getRows(){return this._group.getRows(!0)}getSubGroups(){return this._group.getSubGroups(!0)}getParentGroup(){return this._group.parent?this._group.parent.getComponent():!1}isVisible(){return this._group.visible}show(){this._group.show()}hide(){this._group.hide()}toggle(){this._group.toggleVisibility()}scrollTo(e,t){return this._group.groupManager.table.rowManager.scrollToRow(this._group,e,t)}_getSelf(){return this._group}getTable(){return this._group.groupManager.table}}class lr{constructor(e,t,i,n,r,o,a){this.groupManager=e,this.parent=t,this.key=n,this.level=i,this.field=r,this.hasSubGroups=i<e.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=a,this.rows=[],this.groups=[],this.groupList=[],this.generator=o,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=a?a.visible:typeof e.startOpen[i]<"u"?e.startOpen[i]:e.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}wipe(e){e||(this.groupList.length?this.groupList.forEach(function(t){t.wipe()}):this.rows.forEach(t=>{t.modules&&delete t.modules.group})),this.element=!1,this.arrowElement=!1,this.elementContents=!1}createElements(){var e=document.createElement("div");e.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(e),this.groupManager.table.options.movableRows!==!1&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}createValueGroups(){var e=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[e]&&this.groupManager.allowedValues[e].forEach(t=>{this._createGroup(t,e)})}addBindings(){var e;this.groupManager.table.options.groupToggleElement&&(e=this.groupManager.table.options.groupToggleElement=="arrow"?this.arrowElement:this.element,e.addEventListener("click",t=>{this.groupManager.table.options.groupToggleElement==="arrow"&&(t.stopPropagation(),t.stopImmediatePropagation()),setTimeout(()=>{this.toggleVisibility()})}))}_createGroup(e,t){var i=t+"_"+e,n=new lr(this.groupManager,this,t,e,this.groupManager.groupIDLookups[t].field,this.groupManager.headerGenerator[t]||this.groupManager.headerGenerator[0],this.old?this.old.groups[i]:!1);this.groups[i]=n,this.groupList.push(n)}_addRowToGroup(e){var t=this.level+1;if(this.hasSubGroups){var i=this.groupManager.groupIDLookups[t].func(e.getData()),n=t+"_"+i;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]?this.groups[n]&&this.groups[n].addRow(e):(this.groups[n]||this._createGroup(i,t),this.groups[n].addRow(e))}}_addRow(e){this.rows.push(e),e.modules.group=this}insertRow(e,t,i){var n=this.conformRowData({});e.updateData(n);var r=this.rows.indexOf(t);r>-1?i?this.rows.splice(r+1,0,e):this.rows.splice(r,0,e):i?this.rows.push(e):this.rows.unshift(e),e.modules.group=this,this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}scrollHeader(e){this.arrowElement&&(this.arrowElement.style.marginLeft=e,this.groupList.forEach(function(t){t.scrollHeader(e)}))}getRowIndex(e){}conformRowData(e){return this.field?e[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(e=this.parent.conformRowData(e)),e}removeRow(e){var t=this.rows.indexOf(e),i=e.getElement();t>-1&&this.rows.splice(t,1),!this.groupManager.table.options.groupValues&&!this.rows.length?(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0)):(i.parentNode&&i.parentNode.removeChild(i),this.groupManager.blockRedraw||(this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)))}removeGroup(e){var t=e.level+"_"+e.key,i;this.groups[t]&&(delete this.groups[t],i=this.groupList.indexOf(e),i>-1&&this.groupList.splice(i,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}getHeadersAndRows(){var e=[];return e.push(this),this._visSet(),this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.visible?this.groupList.length?this.groupList.forEach(function(t){e=e.concat(t.getHeadersAndRows())}):(this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),e=e.concat(this.rows),this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))):!this.groupList.length&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&(this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))),e}getData(e,t){var i=[];return this._visSet(),(!e||e&&this.visible)&&this.rows.forEach(n=>{i.push(n.getData(t||"data"))}),i}getRowCount(){var e=0;return this.groupList.length?this.groupList.forEach(t=>{e+=t.getRowCount()}):e=this.rows.length,e}toggleVisibility(){this.visible?this.hide():this.show()}hide(){this.visible=!1,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination?(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach(e=>{var t=e.getHeadersAndRows();t.forEach(i=>{i.detachElement()})}):this.rows.forEach(e=>{var t=e.getElement();t.parentNode.removeChild(t)}),this.groupManager.updateGroupRows(!0)):this.groupManager.updateGroupRows(!0),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}show(){if(this.visible=!0,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination){this.element.classList.add("tabulator-group-visible");var e=this.generateElement();this.groupList.length?this.groupList.forEach(t=>{var i=t.getHeadersAndRows();i.forEach(n=>{var r=n.getElement();e.parentNode.insertBefore(r,e.nextSibling),n.initialize(),e=r})}):this.rows.forEach(t=>{var i=t.getElement();e.parentNode.insertBefore(i,e.nextSibling),t.initialize(),e=i}),this.groupManager.updateGroupRows(!0)}else this.groupManager.updateGroupRows(!0);this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}_visSet(){var e=[];typeof this.visible=="function"&&(this.rows.forEach(function(t){e.push(t.getData())}),this.visible=this.visible(this.key,this.getRowCount(),e,this.getComponent()))}getRowGroup(e){var t=!1;return this.groupList.length?this.groupList.forEach(function(i){var n=i.getRowGroup(e);n&&(t=n)}):this.rows.find(function(i){return i===e})&&(t=this),t}getSubGroups(e){var t=[];return this.groupList.forEach(function(i){t.push(e?i.getComponent():i)}),t}getRows(e,t){var i=[];return t&&this.groupList.length?this.groupList.forEach(n=>{i=i.concat(n.getRows(e,t))}):this.rows.forEach(function(n){i.push(e?n.getComponent():n)}),i}generateGroupHeaderContents(){var e=[],t=this.getRows(!1,!0);for(t.forEach(function(i){e.push(i.getData())}),this.elementContents=this.generator(this.key,this.getRowCount(),e,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);typeof this.elementContents=="string"?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}getPath(e=[]){return e.unshift(this.key),this.parent&&this.parent.getPath(e),e}getElement(){return this.elementContents?this.element:this.generateElement()}generateElement(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var e=0;e<this.element.childNodes.length;++e)this.element.childNodes[e].parentNode.removeChild(this.element.childNodes[e]);return this.generateGroupHeaderContents(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}normalizeHeight(){this.setHeight(this.element.clientHeight)}initialize(e){(!this.initialized||e)&&(this.normalizeHeight(),this.initialized=!0)}reinitialize(){this.initialized=!1,this.height=0,Fe.elVisible(this.element)&&this.initialize(!0)}setHeight(e){this.height!=e&&(this.height=e,this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getGroup(){return this}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}deinitializeHeight(){}rendered(){}getComponent(){return this.component||(this.component=new AF(this)),this.component}}class kv extends pe{constructor(e){super(e),this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayHandler=this.getRows.bind(this),this.blockRedraw=!1,this.registerTableOption("groupBy",!1),this.registerTableOption("groupStartOpen",!0),this.registerTableOption("groupValues",!1),this.registerTableOption("groupUpdateOnCellEdit",!1),this.registerTableOption("groupHeader",!1),this.registerTableOption("groupHeaderPrint",null),this.registerTableOption("groupHeaderClipboard",null),this.registerTableOption("groupHeaderHtmlOutput",null),this.registerTableOption("groupHeaderDownload",null),this.registerTableOption("groupToggleElement","arrow"),this.registerTableOption("groupClosedShowCalcs",!1),this.registerTableFunction("setGroupBy",this.setGroupBy.bind(this)),this.registerTableFunction("setGroupValues",this.setGroupValues.bind(this)),this.registerTableFunction("setGroupStartOpen",this.setGroupStartOpen.bind(this)),this.registerTableFunction("setGroupHeader",this.setGroupHeader.bind(this)),this.registerTableFunction("getGroups",this.userGetGroups.bind(this)),this.registerTableFunction("getGroupedData",this.userGetGroupedData.bind(this)),this.registerComponentFunction("row","getGroup",this.rowGetGroup.bind(this))}initialize(){this.subscribe("table-destroy",this._blockRedrawing.bind(this)),this.subscribe("rows-wipe",this._blockRedrawing.bind(this)),this.subscribe("rows-wiped",this._restore_redrawing.bind(this)),this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}_blockRedrawing(){this.blockRedraw=!0}_restore_redrawing(){this.blockRedraw=!1}configureGroupSetup(){if(this.table.options.groupBy){var e=this.table.options.groupBy,t=this.table.options.groupStartOpen,i=this.table.options.groupHeader;if(this.allowedValues=this.table.options.groupValues,Array.isArray(e)&&Array.isArray(i)&&e.length>i.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",(r,o)=>{this.headerGenerator[0]=(a,l,h)=>(typeof a>"u"?"":a)+"<span>("+l+" "+(l===1?r:o.groups.items)+")</span>"}),this.groupIDLookups=[],e)this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="table"&&this.table.options.columnCalcs!="both"&&this.table.modules.columnCalcs.removeCalcs();else if(this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="group"){var n=this.table.columnManager.getRealColumns();n.forEach(r=>{r.definition.topCalc&&this.table.modules.columnCalcs.initializeTopRow(),r.definition.bottomCalc&&this.table.modules.columnCalcs.initializeBottomRow()})}Array.isArray(e)||(e=[e]),e.forEach((r,o)=>{var a,l;typeof r=="function"?a=r:(l=this.table.columnManager.getColumnByField(r),l?a=function(h){return l.getFieldValue(h)}:a=function(h){return h[r]}),this.groupIDLookups.push({field:typeof r=="function"?!1:r,func:a,values:this.allowedValues?this.allowedValues[o]:!1})}),t&&(Array.isArray(t)||(t=[t]),t.forEach(r=>{}),this.startOpen=t),i&&(this.headerGenerator=Array.isArray(i)?i:[i])}else this.groupList=[],this.groups={}}rowSample(e,t){if(this.table.options.groupBy){var i=this.getGroups(!1)[0];t.push(i.getRows(!1)[0])}return t}virtualRenderFill(){var e=this.table.rowManager.tableElement,t=this.table.rowManager.getVisibleRows();if(this.table.options.groupBy)t=t.filter(i=>i.type!=="group"),e.style.minWidth=t.length?"":this.table.columnManager.getWidth()+"px";else return t}rowAddingIndex(e,t,i){if(this.table.options.groupBy){this.assignRowToGroup(e);var n=e.modules.group.rows;return n.length>1&&(!t||t&&n.indexOf(t)==-1?i?n[0]!==e&&(t=n[0],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)):n[n.length-1]!==e&&(t=n[n.length-1],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)):this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)),t}}trackChanges(){this.dispatch("group-changed")}setGroupBy(e){this.table.options.groupBy=e,this.initialized||this.initialize(),this.configureGroupSetup(),!e&&this.table.modExists("columnCalcs")&&this.table.options.columnCalcs===!0&&this.table.modules.columnCalcs.reinitializeCalcs(),this.refreshData(),this.trackChanges()}setGroupValues(e){this.table.options.groupValues=e,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupStartOpen(e){this.table.options.groupStartOpen=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}setGroupHeader(e){this.table.options.groupHeader=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}userGetGroups(e){return this.getGroups(!0)}userGetGroupedData(){return this.table.options.groupBy?this.getGroupedData():this.getData()}rowGetGroup(e){return e.modules.group?e.modules.group.getComponent():!1}rowMoving(e,t,i){if(this.table.options.groupBy){!i&&t instanceof lr&&(t=this.table.rowManager.prevDisplayRow(e)||t);var n=t instanceof lr?t:t.modules.group,r=e instanceof lr?e:e.modules.group;n===r?this.table.rowManager.moveRowInArray(n.rows,e,t,i):(r&&r.removeRow(e),n.insertRow(e,t,i))}}rowDeleting(e){this.table.options.groupBy&&e.modules.group&&e.modules.group.removeRow(e)}rowsUpdated(e){this.table.options.groupBy&&this.updateGroupRows(!0)}cellUpdated(e){this.table.options.groupBy&&this.reassignRowToGroup(e.row)}getRows(e){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(e),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):e.slice(0)}getGroups(e){var t=[];return this.groupList.forEach(function(i){t.push(e?i.getComponent():i)}),t}getChildGroups(e){var t=[];return e||(e=this),e.groupList.forEach(i=>{i.groupList.length?t=t.concat(this.getChildGroups(i)):t.push(i)}),t}wipe(){this.table.options.groupBy&&(this.groupList.forEach(function(e){e.wipe()}),this.groupList=[],this.groups={})}pullGroupListData(e){var t=[];return e.forEach(i=>{var n={};n.level=0,n.rowCount=0,n.headerContent="";var r=[];i.hasSubGroups?(r=this.pullGroupListData(i.groupList),n.level=i.level,n.rowCount=r.length-i.groupList.length,n.headerContent=i.generator(i.key,n.rowCount,i.rows,i),t.push(n),t=t.concat(r)):(n.level=i.level,n.headerContent=i.generator(i.key,i.rows.length,i.rows,i),n.rowCount=i.getRows().length,t.push(n),i.getRows().forEach(o=>{t.push(o.getData("data"))}))}),t}getGroupedData(){return this.pullGroupListData(this.groupList)}getRowGroup(e){var t=!1;return this.options("dataTree")&&(e=this.table.modules.dataTree.getTreeParentRoot(e)),this.groupList.forEach(i=>{var n=i.getRowGroup(e);n&&(t=n)}),t}countGroups(){return this.groupList.length}generateGroups(e){var t=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach(i=>{this.createGroup(i,0,t)}),e.forEach(i=>{this.assignRowToExistingGroup(i,t)})):e.forEach(i=>{this.assignRowToGroup(i,t)}),Object.values(t).forEach(i=>{i.wipe(!0)})}createGroup(e,t,i){var n=t+"_"+e,r;i=i||[],r=new lr(this,!1,t,e,this.groupIDLookups[0].field,this.headerGenerator[0],i[n]),this.groups[n]=r,this.groupList.push(r)}assignRowToExistingGroup(e,t){var i=this.groupIDLookups[0].func(e.getData()),n="0_"+i;this.groups[n]&&this.groups[n].addRow(e)}assignRowToGroup(e,t){var i=this.groupIDLookups[0].func(e.getData()),n=!this.groups["0_"+i];return n&&this.createGroup(i,0,t),this.groups["0_"+i].addRow(e),!n}reassignRowToGroup(e){if(e.type==="row"){var t=e.modules.group,i=t.getPath(),n=this.getExpectedPath(e),r;r=i.length==n.length&&i.every((o,a)=>o===n[a]),r||(t.removeRow(e),this.assignRowToGroup(e,this.groups),this.refreshData(!0))}}getExpectedPath(e){var t=[],i=e.getData();return this.groupIDLookups.forEach(n=>{t.push(n.func(i))}),t}updateGroupRows(e){var t=[];return this.blockRedraw||(this.groupList.forEach(i=>{t=t.concat(i.getHeadersAndRows())}),e&&this.refreshData(!0)),t}scrollHeaders(e){this.table.options.groupBy&&(this.table.options.renderHorizontal==="virtual"&&(e-=this.table.columnManager.renderer.vDomPadLeft),e=e+"px",this.groupList.forEach(t=>{t.scrollHeader(e)}))}removeGroup(e){var t=e.level+"_"+e.key,i;this.groups[t]&&(delete this.groups[t],i=this.groupList.indexOf(e),i>-1&&this.groupList.splice(i,1))}checkBasicModeGroupHeaderWidth(){var e=this.table.rowManager.tableElement,t=!0;this.table.rowManager.getDisplayRows().forEach((i,n)=>{this.table.rowManager.styleRow(i,n),e.appendChild(i.getElement()),i.initialize(!0),i.type!=="group"&&(t=!1)}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}}U(kv,"moduleName","groupRows");var PF={cellEdit:function(s){s.component.setValueProcessData(s.data.oldValue),s.component.cellRendered()},rowAdd:function(s){s.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowDelete:function(s){var e=this.table.rowManager.addRowActual(s.data.data,s.data.pos,s.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(s.component,e),this.table.rowManager.checkPlaceholder()},rowMove:function(s){var e=s.data.posFrom-s.data.posTo>0;this.table.rowManager.moveRowActual(s.component,this.table.rowManager.getRowFromPosition(s.data.posFrom),e),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},IF={cellEdit:function(s){s.component.setValueProcessData(s.data.newValue),s.component.cellRendered()},rowAdd:function(s){var e=this.table.rowManager.addRowActual(s.data.data,s.data.pos,s.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(s.component,e),this.table.rowManager.checkPlaceholder()},rowDelete:function(s){s.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowMove:function(s){this.table.rowManager.moveRowActual(s.component,this.table.rowManager.getRowFromPosition(s.data.posTo),s.data.after),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},OF={undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"]},FF={undo:function(s){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(s.preventDefault(),this.table.modules.history.undo()))},redo:function(s){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(s.preventDefault(),this.table.modules.history.redo()))}},DF={keybindings:{bindings:OF,actions:FF}};const Vn=class Vn extends pe{constructor(e){super(e),this.history=[],this.index=-1,this.registerTableOption("history",!1)}initialize(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}rowMoved(e,t,i){this.action("rowMove",e,{posFrom:e.getPosition(),posTo:t.getPosition(),to:t,after:i})}rowAdded(e,t,i,n){this.action("rowAdd",e,{data:t,pos:i,index:n})}rowDeleted(e){var t,i;this.table.options.groupBy?(i=e.getComponent().getGroup()._getSelf().rows,t=i.indexOf(e),t&&(t=i[t-1])):(t=e.table.rowManager.getRowIndex(e),t&&(t=e.table.rowManager.rows[t-1])),this.action("rowDelete",e,{data:e.getData(),pos:!t,index:t})}cellUpdated(e){this.action("cellEdit",e,{oldValue:e.oldValue,newValue:e.value})}clear(){this.history=[],this.index=-1}action(e,t,i){this.history=this.history.slice(0,this.index+1),this.history.push({type:e,component:t,data:i}),this.index++}getHistoryUndoSize(){return this.index+1}getHistoryRedoSize(){return this.history.length-(this.index+1)}clearComponentHistory(e){var t=this.history.findIndex(function(i){return i.component===e});t>-1&&(this.history.splice(t,1),t<=this.index&&this.index--,this.clearComponentHistory(e))}undo(){if(this.index>-1){let e=this.history[this.index];return Vn.undoers[e.type].call(this,e),this.index--,this.dispatchExternal("historyUndo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Undo Error - No more history to undo":"History module not enabled"),!1}redo(){if(this.history.length-1>this.index){this.index++;let e=this.history[this.index];return Vn.redoers[e.type].call(this,e),this.dispatchExternal("historyRedo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Redo Error - No more history to redo":"History module not enabled"),!1}_rebindRow(e,t){this.history.forEach(function(i){if(i.component instanceof Et)i.component===e&&(i.component=t);else if(i.component instanceof ga&&i.component.row===e){var n=i.component.column.getField();n&&(i.component=t.getCell(n))}})}};U(Vn,"moduleName","history"),U(Vn,"moduleExtensions",DF),U(Vn,"undoers",PF),U(Vn,"redoers",IF);let _c=Vn;class Nv extends pe{constructor(e){super(e),this.fieldIndex=[],this.hasIndex=!1}initialize(){this.tableElementCheck()}tableElementCheck(){this.table.originalElement&&this.table.originalElement.tagName==="TABLE"&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}parseTable(){var e=this.table.originalElement,t=this.table.options,i=e.getElementsByTagName("th"),n=e.getElementsByTagName("tbody")[0],r=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),n=n?n.getElementsByTagName("tr"):[],this._extractOptions(e,t),i.length?this._extractHeaders(i,n):this._generateBlankHeaders(i,n);for(var o=0;o<n.length;o++){var a=n[o],l=a.getElementsByTagName("td"),h={};this.hasIndex||(h[t.index]=o);for(var u=0;u<l.length;u++){var c=l[u];typeof this.fieldIndex[u]<"u"&&(h[this.fieldIndex[u]]=c.innerHTML)}r.push(h)}t.data=r,this.dispatchExternal("htmlImported")}_extractOptions(e,t,i){var n=e.attributes,r=Object.keys(i||t),o={};r.forEach(u=>{o[u.toLowerCase()]=u});for(var a in n){var l=n[a],h;l&&typeof l=="object"&&l.name&&l.name.indexOf("tabulator-")===0&&(h=l.name.replace("tabulator-",""),typeof o[h]<"u"&&(t[o[h]]=this._attribValue(l.value)))}}_attribValue(e){return e==="true"?!0:e==="false"?!1:e}_findCol(e){var t=this.table.options.columns.find(i=>i.title===e);return t||!1}_extractHeaders(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=!1,o=this._findCol(n.textContent),a;o?r=!0:o={title:n.textContent.trim()},o.field||(o.field=n.textContent.trim().toLowerCase().replaceAll(" ","_")),a=n.getAttribute("width"),a&&!o.width&&(o.width=a),this._extractOptions(n,o,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[i]=o.field,o.field==this.table.options.index&&(this.hasIndex=!0),r||this.table.options.columns.push(o)}}_generateBlankHeaders(e,t){for(var i=0;i<e.length;i++){var n=e[i],r={title:"",field:"col"+i};this.fieldIndex[i]=r.field;var o=n.getAttribute("width");o&&(r.width=o),this.table.options.columns.push(r)}}}U(Nv,"moduleName","htmlTableImport");function kF(s){var e=[],t=0,i=0,n=!1;for(let r=0;r<s.length;r++){let o=s[r],a=s[r+1];if(e[t]||(e[t]=[]),e[t][i]||(e[t][i]=""),o=='"'&&n&&a=='"'){e[t][i]+=o,r++;continue}if(o=='"'){n=!n;continue}if(o==","&&!n){i++;continue}if(o=="\r"&&a==`
`&&!n){i=0,t++,r++;continue}if((o=="\r"||o==`
`)&&!n){i=0,t++;continue}e[t][i]+=o}return e}function NF(s){try{return JSON.parse(s)}catch(e){return console.warn("JSON Import Error - File contents is invalid JSON",e),Promise.reject()}}function zF(s){return s}function GF(s){var e=this.dependencyRegistry.lookup("XLSX"),t=e.read(s),i=t.Sheets[t.SheetNames[0]];return e.utils.sheet_to_json(i,{header:1})}var HF={csv:kF,json:NF,array:zF,xlsx:GF};const wo=class wo extends pe{constructor(e){super(e),this.registerTableOption("importFormat"),this.registerTableOption("importReader","text"),this.registerTableOption("importHeaderTransform"),this.registerTableOption("importValueTransform"),this.registerTableOption("importDataValidator"),this.registerTableOption("importFileValidator")}initialize(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}loadDataCheck(e){return this.table.options.importFormat&&(typeof e=="string"||Array.isArray(e)&&e.length&&Array.isArray(e))}loadData(e,t,i,n,r){return this.importData(this.lookupImporter(),e).then(this.structureData.bind(this)).catch(o=>(console.error("Import Error:",o||"Unable to import data"),Promise.reject(o)))}lookupImporter(e){var t;return e||(e=this.table.options.importFormat),typeof e=="string"?t=wo.importers[e]:t=e,t||console.error("Import Error - Importer not found:",e),t}importFromFile(e,t,i){var n=this.lookupImporter(e);if(n)return this.pickFile(t,i).then(this.importData.bind(this,n)).then(this.structureData.bind(this)).then(this.mutateData.bind(this)).then(this.validateData.bind(this)).then(this.setData.bind(this)).catch(r=>(this.dispatch("import-error",r),this.dispatchExternal("importError",r),console.error("Import Error:",r||"Unable to import file"),this.table.dataLoader.alertError(),setTimeout(()=>{this.table.dataLoader.clearAlert()},3e3),Promise.reject(r)))}pickFile(e,t){return new Promise((i,n)=>{var r=document.createElement("input");r.type="file",r.accept=e,r.addEventListener("change",o=>{var a=r.files[0],l=new FileReader,h=this.validateFile(a);if(h===!0){switch(this.dispatch("import-importing",r.files),this.dispatchExternal("importImporting",r.files),t||this.table.options.importReader){case"buffer":l.readAsArrayBuffer(a);break;case"binary":l.readAsBinaryString(a);break;case"url":l.readAsDataURL(a);break;case"text":default:l.readAsText(a)}l.onload=u=>{i(l.result)},l.onerror=u=>{console.warn("File Load Error - Unable to read file"),n(u)}}else n(h)}),this.dispatch("import-choose"),this.dispatchExternal("importChoose"),r.click()})}importData(e,t){var i;return this.table.dataLoader.alertLoader(),new Promise((n,r)=>{setTimeout(()=>{i=e.call(this.table,t),i instanceof Promise||i?n(i):r()},10)})}structureData(e){var t=[];return Array.isArray(e)&&e.length&&Array.isArray(e[0])?(this.table.options.autoColumns?t=this.structureArrayToObject(e):t=this.structureArrayToColumns(e),t):e}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(i=>{t.push(this.table.modules.mutator.transformRow(i,"import"))}):t=e,t}transformHeader(e){var t=[];if(this.table.options.importHeaderTransform)e.forEach(i=>{t.push(this.table.options.importHeaderTransform.call(this.table,i,e))});else return e;return t}transformData(e){var t=[];if(this.table.options.importValueTransform)e.forEach(i=>{t.push(this.table.options.importValueTransform.call(this.table,i,e))});else return e;return t}structureArrayToObject(e){var t=this.transformHeader(e.shift()),i=e.map(n=>{var r={};return n=this.transformData(n),t.forEach((o,a)=>{r[o]=n[a]}),r});return i}structureArrayToColumns(e){var t=[],i=this.transformHeader(e[0]),n=this.table.getColumns();return n[0]&&i[0]&&n[0].getDefinition().title===i[0]&&e.shift(),e.forEach(r=>{var o={};r=this.transformData(r),r.forEach((a,l)=>{var h=n[l];h&&(o[h.getField()]=a)}),t.push(o)}),t}validateFile(e){return this.table.options.importFileValidator?this.table.options.importFileValidator.call(this.table,e):!0}validateData(e){var t;return this.table.options.importDataValidator?(t=this.table.options.importDataValidator.call(this.table,e),t===!0?e:Promise.reject(t)):e}setData(e){return this.dispatch("import-imported",e),this.dispatchExternal("importImported",e),this.table.dataLoader.clearAlert(),this.table.setData(e)}};U(wo,"moduleName","import"),U(wo,"importers",HF);let Ec=wo;class zv extends pe{constructor(e){super(e),this.eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowMouseDown:"row-mousedown",rowMouseUp:"row-mouseup",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellMouseDown:"cell-mousedown",cellMouseUp:"cell-mouseup",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerMouseDown:"column-mousedown",headerMouseUp:"column-mouseup",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupMouseDown:"group-mousedown",groupMouseUp:"group-mouseup",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},this.subscribers={},this.touchSubscribers={},this.columnSubscribers={},this.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},this.registerColumnOption("headerClick"),this.registerColumnOption("headerDblClick"),this.registerColumnOption("headerContext"),this.registerColumnOption("headerMouseEnter"),this.registerColumnOption("headerMouseLeave"),this.registerColumnOption("headerMouseOver"),this.registerColumnOption("headerMouseOut"),this.registerColumnOption("headerMouseMove"),this.registerColumnOption("headerMouseDown"),this.registerColumnOption("headerMouseUp"),this.registerColumnOption("headerTap"),this.registerColumnOption("headerDblTap"),this.registerColumnOption("headerTapHold"),this.registerColumnOption("cellClick"),this.registerColumnOption("cellDblClick"),this.registerColumnOption("cellContext"),this.registerColumnOption("cellMouseEnter"),this.registerColumnOption("cellMouseLeave"),this.registerColumnOption("cellMouseOver"),this.registerColumnOption("cellMouseOut"),this.registerColumnOption("cellMouseMove"),this.registerColumnOption("cellMouseDown"),this.registerColumnOption("cellMouseUp"),this.registerColumnOption("cellTap"),this.registerColumnOption("cellDblTap"),this.registerColumnOption("cellTapHold")}initialize(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this)),this.subscribe("scroll-horizontal",this.clearTouchWatchers.bind(this)),this.subscribe("scroll-vertical",this.clearTouchWatchers.bind(this))}clearTouchWatchers(){var e=Object.values(this.touchWatchers);e.forEach(t=>{for(let i in t)t[i]=null})}cellContentsSelectionFixer(e,t){var i;if(!(this.table.modExists("edit")&&this.table.modules.edit.currentCell===t)){e.preventDefault();try{document.selection?(i=document.body.createTextRange(),i.moveToElementText(t.getElement()),i.select()):window.getSelection&&(i=document.createRange(),i.selectNode(t.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(i))}catch{}}}initializeExternalEvents(){for(let e in this.eventMap)this.subscriptionChangeExternal(e,this.subscriptionChanged.bind(this,e))}subscriptionChanged(e,t){t?this.subscribers[e]||(this.eventMap[e].includes("-")?(this.subscribers[e]=this.handle.bind(this,e),this.subscribe(this.eventMap[e],this.subscribers[e])):this.subscribeTouchEvents(e)):this.eventMap[e].includes("-")?this.subscribers[e]&&!this.columnSubscribers[e]&&!this.subscribedExternal(e)&&(this.unsubscribe(this.eventMap[e],this.subscribers[e]),delete this.subscribers[e]):this.unsubscribeTouchEvents(e)}subscribeTouchEvents(e){var t=this.eventMap[e];this.touchSubscribers[t+"-touchstart"]||(this.touchSubscribers[t+"-touchstart"]=this.handleTouch.bind(this,t,"start"),this.touchSubscribers[t+"-touchend"]=this.handleTouch.bind(this,t,"end"),this.subscribe(t+"-touchstart",this.touchSubscribers[t+"-touchstart"]),this.subscribe(t+"-touchend",this.touchSubscribers[t+"-touchend"])),this.subscribers[e]=!0}unsubscribeTouchEvents(e){var t=!0,i=this.eventMap[e];if(this.subscribers[e]&&!this.subscribedExternal(e)){delete this.subscribers[e];for(let n in this.eventMap)this.eventMap[n]===i&&this.subscribers[n]&&(t=!1);t&&(this.unsubscribe(i+"-touchstart",this.touchSubscribers[i+"-touchstart"]),this.unsubscribe(i+"-touchend",this.touchSubscribers[i+"-touchend"]),delete this.touchSubscribers[i+"-touchstart"],delete this.touchSubscribers[i+"-touchend"])}}initializeColumn(e){var t=e.definition;for(let i in this.eventMap)t[i]&&(this.subscriptionChanged(i,!0),this.columnSubscribers[i]||(this.columnSubscribers[i]=[]),this.columnSubscribers[i].push(e))}handle(e,t,i){this.dispatchEvent(e,t,i)}handleTouch(e,t,i,n){var r=this.touchWatchers[e];switch(e==="column"&&(e="header"),t){case"start":r.tap=!0,clearTimeout(r.tapHold),r.tapHold=setTimeout(()=>{clearTimeout(r.tapHold),r.tapHold=null,r.tap=null,clearTimeout(r.tapDbl),r.tapDbl=null,this.dispatchEvent(e+"TapHold",i,n)},1e3);break;case"end":r.tap&&(r.tap=null,this.dispatchEvent(e+"Tap",i,n)),r.tapDbl?(clearTimeout(r.tapDbl),r.tapDbl=null,this.dispatchEvent(e+"DblTap",i,n)):r.tapDbl=setTimeout(()=>{clearTimeout(r.tapDbl),r.tapDbl=null},300),clearTimeout(r.tapHold),r.tapHold=null;break}}dispatchEvent(e,t,i){var n=i.getComponent(),r;this.columnSubscribers[e]&&(i instanceof ga?r=i.column.definition[e]:i instanceof xs&&(r=i.definition[e]),r&&r(t,n)),this.dispatchExternal(e,t,n)}}U(zv,"moduleName","interaction");var BF={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,navLeft:37,navRight:39,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35},VF={keyBlock:function(s){s.stopPropagation(),s.preventDefault()},scrollPageUp:function(s){var e=this.table.rowManager,t=e.scrollTop-e.element.clientHeight;s.preventDefault(),e.displayRowsCount&&(t>=0?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(s){var e=this.table.rowManager,t=e.scrollTop+e.element.clientHeight,i=e.element.scrollHeight;s.preventDefault(),e.displayRowsCount&&(t<=i?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(s){var e=this.table.rowManager;s.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(s){var e=this.table.rowManager;s.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1]),this.table.element.focus()},navPrev:function(s){this.dispatch("keybinding-nav-prev",s)},navNext:function(s){this.dispatch("keybinding-nav-next",s)},navLeft:function(s){this.dispatch("keybinding-nav-left",s)},navRight:function(s){this.dispatch("keybinding-nav-right",s)},navUp:function(s){this.dispatch("keybinding-nav-up",s)},navDown:function(s){this.dispatch("keybinding-nav-down",s)}};const Wn=class Wn extends pe{constructor(e){super(e),this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1,this.registerTableOption("keybindings",{}),this.registerTableOption("tabEndNewRow",!1)}initialize(){var e=this.table.options.keybindings,t={};this.watchKeys={},this.pressedKeys=[],e!==!1&&(Object.assign(t,Wn.bindings),Object.assign(t,e),this.mapBindings(t),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}mapBindings(e){for(let t in e)Wn.actions[t]?e[t]&&(typeof e[t]!="object"&&(e[t]=[e[t]]),e[t].forEach(i=>{var n=Array.isArray(i)?i:[i];n.forEach(r=>{this.mapBinding(t,r)})})):console.warn("Key Binding Error - no such action:",t)}mapBinding(e,t){var i={action:Wn.actions[e],keys:[],ctrl:!1,shift:!1,meta:!1},n=t.toString().toLowerCase().split(" ").join("").split("+");n.forEach(r=>{switch(r){case"ctrl":i.ctrl=!0;break;case"shift":i.shift=!0;break;case"meta":i.meta=!0;break;default:r=isNaN(r)?r.toUpperCase().charCodeAt(0):parseInt(r),i.keys.push(r),this.watchKeys[r]||(this.watchKeys[r]=[]),this.watchKeys[r].push(i)}})}bindEvents(){var e=this;this.keyupBinding=function(t){var i=t.keyCode,n=e.watchKeys[i];n&&(e.pressedKeys.push(i),n.forEach(function(r){e.checkBinding(t,r)}))},this.keydownBinding=function(t){var i=t.keyCode,n=e.watchKeys[i];if(n){var r=e.pressedKeys.indexOf(i);r>-1&&e.pressedKeys.splice(r,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}clearBindings(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}checkBinding(e,t){var i=!0;return e.ctrlKey==t.ctrl&&e.shiftKey==t.shift&&e.metaKey==t.meta?(t.keys.forEach(n=>{var r=this.pressedKeys.indexOf(n);r==-1&&(i=!1)}),i&&t.action.call(this,e),!0):!1}};U(Wn,"moduleName","keybindings"),U(Wn,"bindings",BF),U(Wn,"actions",VF);let Cc=Wn;class Gv extends pe{constructor(e){super(e),this.menuContainer=null,this.nestedMenuBlock=!1,this.currentComponent=null,this.rootPopup=null,this.columnSubscribers={},this.registerTableOption("rowContextMenu",!1),this.registerTableOption("rowClickMenu",!1),this.registerTableOption("rowDblClickMenu",!1),this.registerTableOption("groupContextMenu",!1),this.registerTableOption("groupClickMenu",!1),this.registerTableOption("groupDblClickMenu",!1),this.registerColumnOption("headerContextMenu"),this.registerColumnOption("headerClickMenu"),this.registerColumnOption("headerDblClickMenu"),this.registerColumnOption("headerMenu"),this.registerColumnOption("headerMenuIcon"),this.registerColumnOption("contextMenu"),this.registerColumnOption("clickMenu"),this.registerColumnOption("dblClickMenu")}initialize(){this.deprecatedOptionsCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeRowWatchers(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu)),this.table.options.rowDblClickMenu&&this.subscribe("row-dblclick",this.loadMenuEvent.bind(this,this.table.options.rowDblClickMenu))}initializeGroupWatchers(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu)),this.table.options.groupDblClickMenu&&this.subscribe("group-dblclick",this.loadMenuEvent.bind(this,this.table.options.groupDblClickMenu))}initializeColumn(e){var t=e.definition;t.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),t.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),t.headerDblClickMenu&&!this.columnSubscribers.headerDblClickMenu&&(this.columnSubscribers.headerDblClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerDblClickMenu"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickMenu)),t.headerMenu&&this.initializeColumnHeaderMenu(e),t.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),t.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu)),t.dblClickMenu&&!this.columnSubscribers.dblClickMenu&&(this.columnSubscribers.dblClickMenu=this.loadMenuTableCellEvent.bind(this,"dblClickMenu"),this.subscribe("cell-dblclick",this.columnSubscribers.dblClickMenu))}initializeColumnHeaderMenu(e){var t=e.definition.headerMenuIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?i.appendChild(t):i.innerHTML=t):i.innerHTML="&vellip;",i.addEventListener("click",n=>{n.stopPropagation(),n.preventDefault(),this.loadMenuEvent(e.definition.headerMenu,n,e)}),e.titleElement.insertBefore(i,e.titleElement.firstChild)}loadMenuTableCellEvent(e,t,i){i._cell&&(i=i._cell),i.column.definition[e]&&this.loadMenuEvent(i.column.definition[e],t,i)}loadMenuTableColumnEvent(e,t,i){i._column&&(i=i._column),i.definition[e]&&this.loadMenuEvent(i.definition[e],t,i)}loadMenuEvent(e,t,i){i._group?i=i._group:i._row&&(i=i._row),e=typeof e=="function"?e.call(this.table,t,i.getComponent()):e,this.loadMenu(t,i,e)}loadMenu(e,t,i,n,r){var o=!(e instanceof MouseEvent),a=document.createElement("div"),l;if(a.classList.add("tabulator-menu"),o||e.preventDefault(),!(!i||!i.length)){if(n)l=r.child(a);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout(()=>{this.nestedMenuBlock=!1},100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=l=this.popup(a)}i.forEach(h=>{var u=document.createElement("div"),c=h.label,d=h.disabled;h.separator?u.classList.add("tabulator-menu-separator"):(u.classList.add("tabulator-menu-item"),typeof c=="function"&&(c=c.call(this.table,t.getComponent())),c instanceof Node?u.appendChild(c):u.innerHTML=c,typeof d=="function"&&(d=d.call(this.table,t.getComponent())),d?(u.classList.add("tabulator-menu-item-disabled"),u.addEventListener("click",f=>{f.stopPropagation()})):h.menu&&h.menu.length?u.addEventListener("click",f=>{f.stopPropagation(),this.loadMenu(f,t,h.menu,u,l)}):h.action&&u.addEventListener("click",f=>{h.action(f,t.getComponent())}),h.menu&&h.menu.length&&u.classList.add("tabulator-menu-item-submenu")),a.appendChild(u)}),a.addEventListener("click",h=>{this.rootPopup&&this.rootPopup.hide()}),l.show(n||e),l===this.rootPopup&&(this.rootPopup.hideOnBlur(()=>{this.rootPopup=null,this.currentComponent&&(this.dispatch("menu-closed",i,l),this.dispatchExternal("menuClosed",this.currentComponent.getComponent()),this.currentComponent=null)}),this.currentComponent=t,this.dispatch("menu-opened",i,l),this.dispatchExternal("menuOpened",t.getComponent()))}}}U(Gv,"moduleName","menu");class Hv extends pe{constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.registerTableOption("movableColumns",!1)}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.classList.add("tabulator-col-placeholder"),e}initialize(){this.table.options.movableColumns&&(this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("alert-show",this.abortMove.bind(this)))}abortMove(){clearTimeout(this.checkTimeout)}initializeColumn(e){var t=this,i={},n;!e.modules.frozen&&!e.isGroup&&!e.isRowHeader&&(n=e.getElement(),i.mousemove=(function(r){e.parent===t.moving.parent&&((t.touchMove?r.touches[0].pageX:r.pageX)-Fe.elOffset(n).left+t.table.columnManager.contentsElement.scrollLeft>e.getWidth()/2?(t.toCol!==e||!t.toColAfter)&&(n.parentNode.insertBefore(t.placeholderElement,n.nextSibling),t.moveColumn(e,!0)):(t.toCol!==e||t.toColAfter)&&(n.parentNode.insertBefore(t.placeholderElement,n),t.moveColumn(e,!1)))}).bind(t),n.addEventListener("mousedown",function(r){t.touchMove=!1,r.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(r,e)},t.checkPeriod))}),n.addEventListener("mouseup",function(r){r.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),t.bindTouchEvents(e)),e.modules.moveColumn=i}bindTouchEvents(e){var t=e.getElement(),i=!1,n,r,o,a,l,h;t.addEventListener("touchstart",u=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,n=e.nextColumn(),o=n?n.getWidth()/2:0,r=e.prevColumn(),a=r?r.getWidth()/2:0,l=0,h=0,i=!1,this.startMove(u,e)},this.checkPeriod)},{passive:!0}),t.addEventListener("touchmove",u=>{var c,d;this.moving&&(this.moveHover(u),i||(i=u.touches[0].pageX),c=u.touches[0].pageX-i,c>0?n&&c-l>o&&(d=n,d!==e&&(i=u.touches[0].pageX,d.getElement().parentNode.insertBefore(this.placeholderElement,d.getElement().nextSibling),this.moveColumn(d,!0))):r&&-c-h>a&&(d=r,d!==e&&(i=u.touches[0].pageX,d.getElement().parentNode.insertBefore(this.placeholderElement,d.getElement()),this.moveColumn(d,!1))),d&&(n=d.nextColumn(),l=o,o=n?n.getWidth()/2:0,r=d.prevColumn(),h=a,a=r?r.getWidth()/2:0))},{passive:!0}),t.addEventListener("touchend",u=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&this.endMove(u)})}startMove(e,t){var i=t.getElement(),n=this.table.columnManager.getContentsElement(),r=this.table.columnManager.getHeadersElement();this.table.modules.selectRange&&this.table.modules.selectRange.columnSelection&&this.table.modules.selectRange.mousedown&&this.table.modules.selectRange.selecting==="column"||(this.moving=t,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-Fe.elOffset(i).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),n.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=n.clientHeight-r.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e),this.dispatch("column-moving",e,this.moving))}_bindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveColumn.mousemove)})}_unbindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveColumn.mousemove)})}moveColumn(e,t){var i=this.moving.getCells();this.toCol=e,this.toColAfter=t,t?e.getCells().forEach(function(n,r){var o=n.getElement(!0);o.parentNode&&i[r]&&o.parentNode.insertBefore(i[r].getElement(),o.nextSibling)}):e.getCells().forEach(function(n,r){var o=n.getElement(!0);o.parentNode&&i[r]&&o.parentNode.insertBefore(i[r].getElement(),o)})}endMove(e){(e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}moveHover(e){var t=this.table.columnManager.getContentsElement(),i=t.scrollLeft,n=(this.touchMove?e.touches[0].pageX:e.pageX)-Fe.elOffset(t).left+i,r;this.hoverElement.style.left=n-this.startX+"px",n-i<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{r=Math.max(0,i-5),this.table.rowManager.getElement().scrollLeft=r,this.autoScrollTimeout=!1},1))),i+t.clientWidth-n<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{r=Math.min(t.clientWidth,i+5),this.table.rowManager.getElement().scrollLeft=r,this.autoScrollTimeout=!1},1)))}}U(Hv,"moduleName","moveColumn");var WF={delete:function(s,e,t){s.delete()}},UF={insert:function(s,e,t){return this.table.addRow(s.getData(),void 0,e),!0},add:function(s,e,t){return this.table.addRow(s.getData()),!0},update:function(s,e,t){return e?(e.update(s.getData()),!0):!1},replace:function(s,e,t){return e?(this.table.addRow(s.getData(),void 0,e),e.delete(),!0):!1}};const fs=class fs extends pe{constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connectionSelectorsTables=!1,this.connectionSelectorsElements=!1,this.connectionElements=[],this.connections=[],this.connectedTable=!1,this.connectedRow=!1,this.registerTableOption("movableRows",!1),this.registerTableOption("movableRowsConnectedTables",!1),this.registerTableOption("movableRowsConnectedElements",!1),this.registerTableOption("movableRowsSender",!1),this.registerTableOption("movableRowsReceiver","insert"),this.registerColumnOption("rowHandle")}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-row"),e.classList.add("tabulator-row-placeholder"),e}initialize(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}initializeGroupHeader(e){var t=this,i={};i.mouseup=(function(n){t.tableRowDrop(n,e)}).bind(t),i.mousemove=(function(n){var r;n.pageY-Fe.elOffset(e.element).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(r=e.getElement(),r.parentNode.insertBefore(t.placeholderElement,r.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(r=e.getElement(),r.previousSibling&&(r.parentNode.insertBefore(t.placeholderElement,r),t.moveRow(e,!1)))}).bind(t),e.modules.moveRow=i}initializeRow(e){var t=this,i={},n;i.mouseup=(function(r){t.tableRowDrop(r,e)}).bind(t),i.mousemove=(function(r){var o=e.getElement();r.pageY-Fe.elOffset(o).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(o.parentNode.insertBefore(t.placeholderElement,o.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(o.parentNode.insertBefore(t.placeholderElement,o),t.moveRow(e,!1))}).bind(t),this.hasHandle||(n=e.getElement(),n.addEventListener("mousedown",function(r){r.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(r,e)},t.checkPeriod))}),n.addEventListener("mouseup",function(r){r.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e,e.getElement())),e.modules.moveRow=i}initializeColumn(e){e.definition.rowHandle&&this.table.options.movableRows!==!1&&(this.hasHandle=!0)}initializeCell(e){if(e.column.definition.rowHandle&&this.table.options.movableRows!==!1){var t=this,i=e.getElement(!0);i.addEventListener("mousedown",function(n){n.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(n,e.row)},t.checkPeriod))}),i.addEventListener("mouseup",function(n){n.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e.row,i)}}bindTouchEvents(e,t){var i=!1,n,r,o,a,l,h;t.addEventListener("touchstart",u=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,n=e.nextRow(),o=n?n.getHeight()/2:0,r=e.prevRow(),a=r?r.getHeight()/2:0,l=0,h=0,i=!1,this.startMove(u,e)},this.checkPeriod)},{passive:!0}),this.moving,this.toRow,this.toRowAfter,t.addEventListener("touchmove",u=>{var c,d;this.moving&&(u.preventDefault(),this.moveHover(u),i||(i=u.touches[0].pageY),c=u.touches[0].pageY-i,c>0?n&&c-l>o&&(d=n,d!==e&&(i=u.touches[0].pageY,d.getElement().parentNode.insertBefore(this.placeholderElement,d.getElement().nextSibling),this.moveRow(d,!0))):r&&-c-h>a&&(d=r,d!==e&&(i=u.touches[0].pageY,d.getElement().parentNode.insertBefore(this.placeholderElement,d.getElement()),this.moveRow(d,!1))),d&&(n=d.nextRow(),l=o,o=n?n.getHeight()/2:0,r=d.prevRow(),h=a,a=r?r.getHeight()/2:0))}),t.addEventListener("touchend",u=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&(this.endMove(u),this.touchMove=!1)})}_bindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveRow.mousemove)})}_unbindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveRow.mousemove)})}startMove(e,t){var i=t.getElement();this.setStartPosition(e,t),this.moving=t,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(t)):(i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i)),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",t.getComponent()),this.moveHover(e)}setStartPosition(e,t){var i=this.touchMove?e.touches[0].pageX:e.pageX,n=this.touchMove?e.touches[0].pageY:e.pageY,r,o;r=t.getElement(),this.connection?(o=r.getBoundingClientRect(),this.startX=o.left-i+window.pageXOffset,this.startY=o.top-n+window.pageYOffset):this.startY=n-r.getBoundingClientRect().top}endMove(e){(!e||e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}moveRow(e,t){this.toRow=e,this.toRowAfter=t}moveHover(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)}moveHoverTable(e){var t=this.table.rowManager.getElement(),i=t.scrollTop,n=(this.touchMove?e.touches[0].pageY:e.pageY)-t.getBoundingClientRect().top+i;this.hoverElement.style.top=Math.min(n-this.startY,this.table.rowManager.element.scrollHeight-this.hoverElement.offsetHeight)+"px"}moveHoverConnections(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"}elementRowDrop(e,t,i){this.dispatchExternal("movableRowsElementDrop",e,t,i?i.getComponent():!1)}connectToTables(e){var t;this.connectionSelectorsTables&&(t=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",t),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:e})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach(i=>{typeof i=="string"?this.connectionElements=this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(i))):this.connectionElements.push(i)}),this.connectionElements.forEach(i=>{var n=r=>{this.elementRowDrop(r,i,this.moving)};i.addEventListener("mouseup",n),i.tabulatorElementDropEvent=n,i.classList.add("tabulator-movingrow-receiving")}))}disconnectFromTables(){var e;this.connectionSelectorsTables&&(e=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",e),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach(t=>{t.classList.remove("tabulator-movingrow-receiving"),t.removeEventListener("mouseup",t.tabulatorElementDropEvent),delete t.tabulatorElementDropEvent})}connect(e,t){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=e,this.connectedRow=t,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(i=>{i.type==="row"&&i.modules.moveRow&&i.modules.moveRow.mouseup&&i.getElement().addEventListener("mouseup",i.modules.moveRow.mouseup)}),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",t,e),!0)}disconnect(e){e===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(t=>{t.type==="row"&&t.modules.moveRow&&t.modules.moveRow.mouseup&&t.getElement().removeEventListener("mouseup",t.modules.moveRow.mouseup)}),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",e)):console.warn("Move Row Error - trying to disconnect from non connected table")}dropComplete(e,t,i){var n=!1;if(i){switch(typeof this.table.options.movableRowsSender){case"string":n=fs.senders[this.table.options.movableRowsSender];break;case"function":n=this.table.options.movableRowsSender;break}n?n.call(this,this.moving?this.moving.getComponent():void 0,t?t.getComponent():void 0,e):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),t?t.getComponent():void 0,e)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),t?t.getComponent():void 0,e);this.endMove()}tableRowDrop(e,t){var i=!1,n=!1;switch(e.stopImmediatePropagation(),typeof this.table.options.movableRowsReceiver){case"string":i=fs.receivers[this.table.options.movableRowsReceiver];break;case"function":i=this.table.options.movableRowsReceiver;break}i?n=i.call(this,this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),n?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:t,success:n})}commsReceived(e,t,i){switch(t){case"connect":return this.connect(e,i.row);case"disconnect":return this.disconnect(e);case"dropcomplete":return this.dropComplete(e,i.row,i.success)}}};U(fs,"moduleName","moveRow"),U(fs,"senders",WF),U(fs,"receivers",UF);let xc=fs;var jF={};const cr=class cr extends pe{constructor(e){super(e),this.allowedTypes=["","data","edit","clipboard","import"],this.enabled=!0,this.registerColumnOption("mutator"),this.registerColumnOption("mutatorParams"),this.registerColumnOption("mutatorData"),this.registerColumnOption("mutatorDataParams"),this.registerColumnOption("mutatorEdit"),this.registerColumnOption("mutatorEditParams"),this.registerColumnOption("mutatorClipboard"),this.registerColumnOption("mutatorClipboardParams"),this.registerColumnOption("mutatorImport"),this.registerColumnOption("mutatorImportParams"),this.registerColumnOption("mutateLink")}initialize(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}rowDataChanged(e,t,i){return this.transformRow(t,"data",i)}initializeColumn(e){var t=!1,i={};this.allowedTypes.forEach(n=>{var r="mutator"+(n.charAt(0).toUpperCase()+n.slice(1)),o;e.definition[r]&&(o=this.lookupMutator(e.definition[r]),o&&(t=!0,i[r]={mutator:o,params:e.definition[r+"Params"]||{}}))}),t&&(e.modules.mutate=i)}lookupMutator(e){var t=!1;switch(typeof e){case"string":cr.mutators[e]?t=cr.mutators[e]:console.warn("Mutator Error - No such mutator found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t,i){var n="mutator"+(t.charAt(0).toUpperCase()+t.slice(1)),r;return this.enabled&&this.table.columnManager.traverse(o=>{var a,l,h;o.modules.mutate&&(a=o.modules.mutate[n]||o.modules.mutate.mutator||!1,a&&(r=o.getFieldValue(typeof i<"u"?i:e),(t=="data"&&!i||typeof r<"u")&&(h=o.getComponent(),l=typeof a.params=="function"?a.params(r,e,t,h):a.params,o.setFieldValue(e,a.mutator(r,e,t,l,h)))))}),e}transformCell(e,t){if(e.column.modules.mutate){var i=e.column.modules.mutate.mutatorEdit||e.column.modules.mutate.mutator||!1,n={};if(i)return n=Object.assign(n,e.row.getData()),e.column.setFieldValue(n,t),i.mutator(t,n,"edit",i.params,e.getComponent())}return t}mutateLink(e){var t=e.column.definition.mutateLink;t&&(Array.isArray(t)||(t=[t]),t.forEach(i=>{var n=e.row.getCell(i);n&&n.setValue(n.getValue(),!0,!0)}))}enable(){this.enabled=!0}disable(){this.enabled=!1}};U(cr,"moduleName","mutator"),U(cr,"mutators",jF);let Rc=cr;function YF(s,e,t,i,n){var r=document.createElement("span"),o=document.createElement("span"),a=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),u=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",c=>{o.innerHTML=c}),this.table.modules.localize.langBind("pagination|counter|of",c=>{l.innerHTML=c}),this.table.modules.localize.langBind("pagination|counter|rows",c=>{u.innerHTML=c}),i?(a.innerHTML=" "+e+"-"+Math.min(e+s-1,i)+" ",h.innerHTML=" "+i+" ",r.appendChild(o),r.appendChild(a),r.appendChild(l),r.appendChild(h),r.appendChild(u)):(a.innerHTML=" 0 ",r.appendChild(o),r.appendChild(a),r.appendChild(u)),r}function XF(s,e,t,i,n){var r=document.createElement("span"),o=document.createElement("span"),a=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),u=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",c=>{o.innerHTML=c}),a.innerHTML=" "+t+" ",this.table.modules.localize.langBind("pagination|counter|of",c=>{l.innerHTML=c}),h.innerHTML=" "+n+" ",this.table.modules.localize.langBind("pagination|counter|pages",c=>{u.innerHTML=c}),r.appendChild(o),r.appendChild(a),r.appendChild(l),r.appendChild(h),r.appendChild(u),r}var $F={rows:YF,pages:XF};const _o=class _o extends pe{constructor(e){super(e),this.mode="local",this.progressiveLoad=!1,this.element=null,this.pageCounterElement=null,this.pageCounter=null,this.size=0,this.page=1,this.count=5,this.max=1,this.remoteRowCountEstimate=null,this.initialLoad=!0,this.dataChanging=!1,this.pageSizes=[],this.registerTableOption("pagination",!1),this.registerTableOption("paginationMode","local"),this.registerTableOption("paginationSize",!1),this.registerTableOption("paginationInitialPage",1),this.registerTableOption("paginationCounter",!1),this.registerTableOption("paginationCounterElement",!1),this.registerTableOption("paginationButtonCount",5),this.registerTableOption("paginationSizeSelector",!1),this.registerTableOption("paginationElement",!1),this.registerTableOption("paginationAddRow","page"),this.registerTableOption("paginationOutOfRange",!1),this.registerTableOption("progressiveLoad",!1),this.registerTableOption("progressiveLoadDelay",0),this.registerTableOption("progressiveLoadScrollMargin",0),this.registerTableFunction("setMaxPage",this.setMaxPage.bind(this)),this.registerTableFunction("setPage",this.setPage.bind(this)),this.registerTableFunction("setPageToRow",this.userSetPageToRow.bind(this)),this.registerTableFunction("setPageSize",this.userSetPageSize.bind(this)),this.registerTableFunction("getPageSize",this.getPageSize.bind(this)),this.registerTableFunction("previousPage",this.previousPage.bind(this)),this.registerTableFunction("nextPage",this.nextPage.bind(this)),this.registerTableFunction("getPage",this.getPage.bind(this)),this.registerTableFunction("getPageMax",this.getPageMax.bind(this)),this.registerComponentFunction("row","pageTo",this.setPageToRow.bind(this))}initialize(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),this.table.options.paginationAddRow=="page"&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),this.table.options.paginationMode==="remote"&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),this.table.options.progressiveLoad==="scroll"&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}rowAddingPosition(e,t){var i=this.table.rowManager,n=i.getDisplayRows(),r;return t?n.length?r=n[0]:i.activeRows.length&&(r=i.activeRows[i.activeRows.length-1],t=!1):n.length&&(r=n[n.length-1],t=!(n.length<this.size)),{index:r,top:t}}calculatePageSizes(){var e,t;this.table.options.paginationSize?this.size=this.table.options.paginationSize:(e=document.createElement("div"),e.classList.add("tabulator-row"),e.style.visibility="hidden",t=document.createElement("div"),t.classList.add("tabulator-cell"),t.innerHTML="Page Row Test",e.appendChild(t),this.table.rowManager.getTableElement().appendChild(e),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/e.offsetHeight),this.table.rowManager.getTableElement().removeChild(e)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}initialLoadComplete(){this.initialLoad=!1}remotePageParams(e,t,i,n){return this.initialLoad||(this.progressiveLoad&&!i||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),n.page=this.page,this.size&&(n.size=this.size),n}userSetPageToRow(e){return this.table.options.pagination&&(e=this.table.rowManager.findRow(e),e)?this.setPageToRow(e):Promise.reject()}userSetPageSize(e){return this.table.options.pagination?(this.setPageSize(e),this.setPage(1)):!1}scrollVertical(e,t){var i,n,r;!t&&!this.table.dataLoader.loading&&(i=this.table.rowManager.getElement(),n=i.scrollHeight-i.clientHeight-e,r=this.table.options.progressiveLoadScrollMargin||i.clientHeight*2,n<r&&this.nextPage().catch(()=>{}))}restOnRenderBefore(e,t){return t||this.mode==="local"&&this.reset(),e}rowsUpdated(){this.refreshData(!0,"all")}createElements(){var e;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),e=document.createElement("button"),e.classList.add("tabulator-page"),e.setAttribute("type","button"),e.setAttribute("role","button"),e.setAttribute("aria-label",""),e.setAttribute("title",""),this.firstBut=e.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=e.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=e.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=e.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}generatePageSizeSelectList(){var e=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))e=this.table.options.paginationSizeSelector,this.pageSizes=e,this.pageSizes.indexOf(this.size)==-1&&e.unshift(this.size);else if(this.pageSizes.indexOf(this.size)==-1){e=[];for(let t=1;t<5;t++)e.push(this.size*t);this.pageSizes=e}else e=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);e.forEach(t=>{var i=document.createElement("option");i.value=t,t===!0?this.langBind("pagination|all",function(n){i.innerHTML=n}):i.innerHTML=t,this.pageSizeSelect.appendChild(i)}),this.pageSizeSelect.value=this.size}}initializePageCounter(){var e=this.table.options.paginationCounter,t=null;e&&(typeof e=="function"?t=e:t=_o.pageCounters[e],t?(this.pageCounter=t,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",e))}initializePaginator(e){var t,i;e||(this.langBind("pagination|first",n=>{this.firstBut.innerHTML=n}),this.langBind("pagination|first_title",n=>{this.firstBut.setAttribute("aria-label",n),this.firstBut.setAttribute("title",n)}),this.langBind("pagination|prev",n=>{this.prevBut.innerHTML=n}),this.langBind("pagination|prev_title",n=>{this.prevBut.setAttribute("aria-label",n),this.prevBut.setAttribute("title",n)}),this.langBind("pagination|next",n=>{this.nextBut.innerHTML=n}),this.langBind("pagination|next_title",n=>{this.nextBut.setAttribute("aria-label",n),this.nextBut.setAttribute("title",n)}),this.langBind("pagination|last",n=>{this.lastBut.innerHTML=n}),this.langBind("pagination|last_title",n=>{this.lastBut.setAttribute("aria-label",n),this.lastBut.setAttribute("title",n)}),this.firstBut.addEventListener("click",()=>{this.setPage(1)}),this.prevBut.addEventListener("click",()=>{this.previousPage()}),this.nextBut.addEventListener("click",()=>{this.nextPage()}),this.lastBut.addEventListener("click",()=>{this.setPage(this.max)}),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(t=document.createElement("label"),this.langBind("pagination|page_size",n=>{this.pageSizeSelect.setAttribute("aria-label",n),this.pageSizeSelect.setAttribute("title",n),t.innerHTML=n}),this.element.appendChild(t),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",n=>{this.setPageSize(this.pageSizeSelect.value=="true"?!0:this.pageSizeSelect.value),this.setPage(1)})),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):typeof this.table.options.paginationCounterElement=="string"&&(i=document.querySelector(this.table.options.paginationCounterElement),i?i.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}initializeProgressive(e){this.initializePaginator(!0),this.mode="progressive_"+e,this.progressiveLoad=!0}trackChanges(){this.dispatch("page-changed")}setMaxRows(e){e?this.max=this.size===!0?1:Math.ceil(e/this.size):this.max=1,this.page>this.max&&(this.page=this.max)}reset(e){this.initialLoad||(this.mode=="local"||e)&&(this.page=1,this.trackChanges())}setMaxPage(e){e=parseInt(e),this.max=e||1,this.page>this.max&&(this.page=this.max,this.trigger())}setPage(e){switch(e){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return e=parseInt(e),e>0&&e<=this.max||this.mode!=="local"?(this.page=e,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",e),Promise.reject())}setPageToRow(e){var t=this.displayRows(-1),i=t.indexOf(e);if(i>-1){var n=this.size===!0?1:Math.ceil((i+1)/this.size);return this.setPage(n)}else return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}setPageSize(e){e!==!0&&(e=parseInt(e)),e>0&&(this.size=e,this.dispatchExternal("pageSizeChanged",e)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}_setPageCounter(e,t,i){var n;if(this.pageCounter)switch(this.mode==="remote"&&(t=this.size,i=(this.page-1)*this.size+1,e=this.remoteRowCountEstimate),n=this.pageCounter.call(this,t,i,this.page,e,this.max),typeof n){case"object":if(n instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(n)}else this.pageCounterElement.innerHTML="",n!=null&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",n);break;case"undefined":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=n}}_setPageButtons(){let e=Math.floor((this.count-1)/2),t=Math.ceil((this.count-1)/2),i=this.max-this.page+e+1<this.count?this.max-this.count+1:Math.max(this.page-e,1),n=this.page<=t?Math.min(this.count,this.max):Math.min(this.page+t,this.max);for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);this.page==1?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(let r=i;r<=n;r++)r>0&&r<=this.max&&this.pagesElement.appendChild(this._generatePageButton(r));this.footerRedraw()}_generatePageButton(e){var t=document.createElement("button");return t.classList.add("tabulator-page"),e==this.page&&t.classList.add("active"),t.setAttribute("type","button"),t.setAttribute("role","button"),this.langBind("pagination|page_title",i=>{t.setAttribute("aria-label",i+" "+e),t.setAttribute("title",i+" "+e)}),t.setAttribute("data-page",e),t.textContent=e,t.addEventListener("click",i=>{this.setPage(e)}),t}previousPage(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}nextPage(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}getPage(){return this.page}getPageMax(){return this.max}getPageSize(e){return this.size}getMode(){return this.mode}getRows(e){var t=0,i,n,r,o,a=e.filter(l=>l.type==="row");if(this.mode=="local"){i=[],this.setMaxRows(e.length),this.size===!0?(n=0,r=e.length):(n=this.size*(this.page-1),r=n+parseInt(this.size)),this._setPageButtons();for(let l=n;l<r;l++){let h=e[l];h&&(i.push(h),h.type==="row"&&(o||(o=h),t++))}return this._setPageCounter(a.length,t,o?a.indexOf(o)+1:0),i}else return this._setPageButtons(),this._setPageCounter(a.length),e.slice(0)}trigger(){var e;switch(this.mode){case"local":return e=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(e),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally(()=>{this.dataChanging=!1});case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}_parseRemoteData(e){var t,i;if(typeof e.last_page>"u"&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),e.data)if(this.max=parseInt(e.last_page)||1,this.remoteRowCountEstimate=typeof e.last_row<"u"?e.last_row:e.last_page*this.size-(this.page==e.last_page?this.size-e.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":this.page==1?this.table.rowManager.setData(e.data,!1,this.page==1):this.table.rowManager.addRows(e.data),this.page<this.max&&setTimeout(()=>{this.nextPage()},this.table.options.progressiveLoadDelay);break;case"progressive_scroll":e=this.page===1?e.data:this.table.rowManager.getData().concat(e.data),this.table.rowManager.setData(e,this.page!==1,this.page==1),t=this.table.options.progressiveLoadScrollMargin||this.table.rowManager.element.clientHeight*2,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+t&&this.page<this.max&&setTimeout(()=>{this.nextPage()});break}return!1}else{if(this.page>this.max&&(console.warn("Remote Pagination Error - Server returned last page value lower than the current page"),i=this.options("paginationOutOfRange"),i))return this.setPage(typeof i=="function"?i.call(this,this.page,this.max):i);this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return e.data}footerRedraw(){var e=this.table.footerManager.containerElement;Math.ceil(e.clientWidth)-e.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(e.clientWidth)-e.scrollWidth<0&&(this.pagesElement.style.display="none"))}};U(_o,"moduleName","page"),U(_o,"pageCounters",$F);let Sc=_o;var KF={local:function(s,e){var t=localStorage.getItem(s+"-"+e);return t?JSON.parse(t):!1},cookie:function(s,e){var t=document.cookie,i=s+"-"+e,n=t.indexOf(i+"="),r,o;return n>-1&&(t=t.slice(n),r=t.indexOf(";"),r>-1&&(t=t.slice(0,r)),o=t.replace(i+"=","")),o?JSON.parse(o):!1}},ZF={local:function(s,e,t){localStorage.setItem(s+"-"+e,JSON.stringify(t))},cookie:function(s,e,t){var i=new Date;i.setDate(i.getDate()+1e4),document.cookie=s+"-"+e+"="+JSON.stringify(t)+"; expires="+i.toUTCString()}};const St=class St extends pe{constructor(e){super(e),this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1,this.registerTableOption("persistence",!1),this.registerTableOption("persistenceID",""),this.registerTableOption("persistenceMode",!0),this.registerTableOption("persistenceReaderFunc",!1),this.registerTableOption("persistenceWriterFunc",!1)}localStorageTest(){var e="_tabulator_test";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}initialize(){if(this.table.options.persistence){var e=this.table.options.persistenceMode,t=this.table.options.persistenceID,i;this.mode=e!==!0?e:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?typeof this.table.options.persistenceReaderFunc=="function"?this.readFunc=this.table.options.persistenceReaderFunc:St.readers[this.table.options.persistenceReaderFunc]?this.readFunc=St.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):St.readers[this.mode]?this.readFunc=St.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?typeof this.table.options.persistenceWriterFunc=="function"?this.writeFunc=this.table.options.persistenceWriterFunc:St.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=St.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):St.writers[this.mode]?this.writeFunc=St.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(t||this.table.element.getAttribute("id")||""),this.config={sort:this.table.options.persistence===!0||this.table.options.persistence.sort,filter:this.table.options.persistence===!0||this.table.options.persistence.filter,headerFilter:this.table.options.persistence===!0||this.table.options.persistence.headerFilter,group:this.table.options.persistence===!0||this.table.options.persistence.group,page:this.table.options.persistence===!0||this.table.options.persistence.page,columns:this.table.options.persistence===!0?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(i=this.retrieveData("page"),i&&(typeof i.paginationSize<"u"&&(this.config.page===!0||this.config.page.size)&&(this.table.options.paginationSize=i.paginationSize),typeof i.paginationInitialPage<"u"&&(this.config.page===!0||this.config.page.page)&&(this.table.options.paginationInitialPage=i.paginationInitialPage))),this.config.group&&(i=this.retrieveData("group"),i&&(typeof i.groupBy<"u"&&(this.config.group===!0||this.config.group.groupBy)&&(this.table.options.groupBy=i.groupBy),typeof i.groupStartOpen<"u"&&(this.config.group===!0||this.config.group.groupStartOpen)&&(this.table.options.groupStartOpen=i.groupStartOpen),typeof i.groupHeader<"u"&&(this.config.group===!0||this.config.group.groupHeader)&&(this.table.options.groupHeader=i.groupHeader))),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("filter-changed",this.eventSave.bind(this,"headerFilter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("column-width",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}eventSave(e){this.config[e]&&this.save(e)}tableBuilt(){var e,t,i;this.config.sort&&(e=this.load("sort"),e&&(this.table.options.initialSort=e)),this.config.filter&&(t=this.load("filter"),t&&(this.table.options.initialFilter=t)),this.config.headerFilter&&(i=this.load("headerFilter"),i&&(this.table.options.initialHeaderFilter=i))}tableRedraw(e){e&&this.config.columns&&this.save("columns")}getColumnLayout(){return this.parseColumns(this.table.columnManager.getColumns())}setColumnLayout(e){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,e,!0)),!0}initializeColumn(e){var t,i;this.config.columns&&(this.defWatcherBlock=!0,t=e.getDefinition(),i=this.config.columns===!0?Object.keys(t):this.config.columns,i.forEach(n=>{var r=Object.getOwnPropertyDescriptor(t,n),o=t[n];r&&Object.defineProperty(t,n,{set:a=>{o=a,this.defWatcherBlock||this.save("columns"),r.set&&r.set(a)},get:()=>(r.get&&r.get(),o)})}),this.defWatcherBlock=!1)}load(e,t){var i=this.retrieveData(e);return t&&(i=i?this.mergeDefinition(t,i):t),i}retrieveData(e){return this.readFunc?this.readFunc(this.id,e):!1}mergeDefinition(e,t,i){var n=[];return t=t||[],t.forEach((r,o)=>{var a=this._findColumn(e,r),l;a&&(i?l=Object.keys(r):this.config.columns===!0||this.config.columns==null?(l=Object.keys(a),l.push("width")):l=this.config.columns,l.forEach(h=>{h!=="columns"&&typeof r[h]<"u"&&(a[h]=r[h])}),a.columns&&(a.columns=this.mergeDefinition(a.columns,r.columns)),n.push(a))}),e.forEach((r,o)=>{var a=this._findColumn(t,r);a||(n.length>o?n.splice(o,0,r):n.push(r))}),n}_findColumn(e,t){var i=t.columns?"group":t.field?"field":"object";return e.find(function(n){switch(i){case"group":return n.title===t.title&&n.columns.length===t.columns.length;case"field":return n.field===t.field;case"object":return n===t}})}save(e){var t={};switch(e){case"columns":t=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":t=this.table.modules.filter.getFilters();break;case"headerFilter":t=this.table.modules.filter.getHeaderFilters();break;case"sort":t=this.validateSorters(this.table.modules.sort.getSort());break;case"group":t=this.getGroupConfig();break;case"page":t=this.getPageConfig();break}this.writeFunc&&this.writeFunc(this.id,e,t)}validateSorters(e){return e.forEach(function(t){t.column=t.field,delete t.field}),e}getGroupConfig(){var e={};return this.config.group&&((this.config.group===!0||this.config.group.groupBy)&&(e.groupBy=this.table.options.groupBy),(this.config.group===!0||this.config.group.groupStartOpen)&&(e.groupStartOpen=this.table.options.groupStartOpen),(this.config.group===!0||this.config.group.groupHeader)&&(e.groupHeader=this.table.options.groupHeader)),e}getPageConfig(){var e={};return this.config.page&&((this.config.page===!0||this.config.page.size)&&(e.paginationSize=this.table.modules.page.getPageSize()),(this.config.page===!0||this.config.page.page)&&(e.paginationInitialPage=this.table.modules.page.getPage())),e}parseColumns(e){var t=[],i=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return e.forEach(n=>{var r={},o=n.getDefinition(),a;n.isGroup?(r.title=o.title,r.columns=this.parseColumns(n.getColumns())):(r.field=n.getField(),this.config.columns===!0||this.config.columns==null?(a=Object.keys(o),a.push("width"),a.push("visible")):a=this.config.columns,a.forEach(l=>{switch(l){case"width":r.width=n.getWidth();break;case"visible":r.visible=n.visible;break;default:typeof o[l]!="function"&&i.indexOf(l)===-1&&(r[l]=o[l])}})),t.push(r)}),t}};U(St,"moduleName","persistence"),U(St,"moduleInitOrder",-10),U(St,"readers",KF),U(St,"writers",ZF);let Tc=St;class Bv extends pe{constructor(e){super(e),this.columnSubscribers={},this.registerTableOption("rowContextPopup",!1),this.registerTableOption("rowClickPopup",!1),this.registerTableOption("rowDblClickPopup",!1),this.registerTableOption("groupContextPopup",!1),this.registerTableOption("groupClickPopup",!1),this.registerTableOption("groupDblClickPopup",!1),this.registerColumnOption("headerContextPopup"),this.registerColumnOption("headerClickPopup"),this.registerColumnOption("headerDblClickPopup"),this.registerColumnOption("headerPopup"),this.registerColumnOption("headerPopupIcon"),this.registerColumnOption("contextPopup"),this.registerColumnOption("clickPopup"),this.registerColumnOption("dblClickPopup"),this.registerComponentFunction("cell","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("column","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("row","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("group","popup",this._componentPopupCall.bind(this))}initialize(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}_componentPopupCall(e,t,i){this.loadPopupEvent(t,null,e,i)}initializeRowWatchers(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup)),this.table.options.rowDblClickPopup&&this.subscribe("row-dblclick",this.loadPopupEvent.bind(this,this.table.options.rowDblClickPopup))}initializeGroupWatchers(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup)),this.table.options.groupDblClickPopup&&this.subscribe("group-dblclick",this.loadPopupEvent.bind(this,this.table.options.groupDblClickPopup))}initializeColumn(e){var t=e.definition;t.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),t.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),t.headerDblClickPopup&&!this.columnSubscribers.headerDblClickPopup&&(this.columnSubscribers.headerDblClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerDblClickPopup"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickPopup)),t.headerPopup&&this.initializeColumnHeaderPopup(e),t.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),t.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup)),t.dblClickPopup&&!this.columnSubscribers.dblClickPopup&&(this.columnSubscribers.dblClickPopup=this.loadPopupTableCellEvent.bind(this,"dblClickPopup"),this.subscribe("cell-click",this.columnSubscribers.dblClickPopup))}initializeColumnHeaderPopup(e){var t=e.definition.headerPopupIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?i.appendChild(t):i.innerHTML=t):i.innerHTML="&vellip;",i.addEventListener("click",n=>{n.stopPropagation(),n.preventDefault(),this.loadPopupEvent(e.definition.headerPopup,n,e)}),e.titleElement.insertBefore(i,e.titleElement.firstChild)}loadPopupTableCellEvent(e,t,i){i._cell&&(i=i._cell),i.column.definition[e]&&this.loadPopupEvent(i.column.definition[e],t,i)}loadPopupTableColumnEvent(e,t,i){i._column&&(i=i._column),i.definition[e]&&this.loadPopupEvent(i.definition[e],t,i)}loadPopupEvent(e,t,i,n){var r;function o(a){r=a}i._group?i=i._group:i._row&&(i=i._row),e=typeof e=="function"?e.call(this.table,t,i.getComponent(),o):e,this.loadPopup(t,i,e,r,n)}loadPopup(e,t,i,n,r){var o=!(e instanceof MouseEvent),a,l;i instanceof HTMLElement?a=i:(a=document.createElement("div"),a.innerHTML=i),a.classList.add("tabulator-popup"),a.addEventListener("click",h=>{h.stopPropagation()}),o||e.preventDefault(),l=this.popup(a),typeof n=="function"&&l.renderCallback(n),e?l.show(e):l.show(t.getElement(),r||"center"),l.hideOnBlur(()=>{this.dispatchExternal("popupClosed",t.getComponent())}),this.dispatchExternal("popupOpened",t.getComponent())}}U(Bv,"moduleName","popup");class Vv extends pe{constructor(e){super(e),this.element=!1,this.manualBlock=!1,this.beforeprintEventHandler=null,this.afterprintEventHandler=null,this.registerTableOption("printAsHtml",!1),this.registerTableOption("printFormatter",!1),this.registerTableOption("printHeader",!1),this.registerTableOption("printFooter",!1),this.registerTableOption("printStyled",!0),this.registerTableOption("printRowRange","visible"),this.registerTableOption("printConfig",{}),this.registerColumnOption("print"),this.registerColumnOption("titlePrint")}initialize(){this.table.options.printAsHtml&&(this.beforeprintEventHandler=this.replaceTable.bind(this),this.afterprintEventHandler=this.cleanup.bind(this),window.addEventListener("beforeprint",this.beforeprintEventHandler),window.addEventListener("afterprint",this.afterprintEventHandler),this.subscribe("table-destroy",this.destroy.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}destroy(){this.table.options.printAsHtml&&(window.removeEventListener("beforeprint",this.beforeprintEventHandler),window.removeEventListener("afterprint",this.afterprintEventHandler))}replaceTable(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}cleanup(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}printFullscreen(e,t,i){var n=window.scrollX,r=window.scrollY,o=document.createElement("div"),a=document.createElement("div"),l=this.table.modules.export.generateTable(typeof i<"u"?i:this.table.options.printConfig,typeof t<"u"?t:this.table.options.printStyled,e||this.table.options.printRowRange,"print"),h,u;this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(o.classList.add("tabulator-print-header"),h=typeof this.table.options.printHeader=="function"?this.table.options.printHeader.call(this.table):this.table.options.printHeader,typeof h=="string"?o.innerHTML=h:o.appendChild(h),this.element.appendChild(o)),this.element.appendChild(l),this.table.options.printFooter&&(a.classList.add("tabulator-print-footer"),u=typeof this.table.options.printFooter=="function"?this.table.options.printFooter.call(this.table):this.table.options.printFooter,typeof u=="string"?a.innerHTML=u:a.appendChild(u),this.element.appendChild(a)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,l),window.print(),this.cleanup(),window.scrollTo(n,r),this.manualBlock=!1}}U(Vv,"moduleName","print");class Wv extends pe{constructor(e){super(e),this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0,this.registerTableOption("reactiveData",!1)}initialize(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this,"cellsave")),this.subscribe("cell-value-save-after",this.unblock.bind(this,"cellsave")),this.subscribe("row-data-save-before",this.block.bind(this,"rowsave")),this.subscribe("row-data-save-after",this.unblock.bind(this,"rowsave")),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}watchData(e){var t=this,i;this.currentVersion++,i=this.currentVersion,this.unwatchData(),this.data=e,this.origFuncs.push=e.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),r;return!t.blocked&&i===t.currentVersion&&(t.block("data-push"),n.forEach(o=>{t.table.rowManager.addRowActual(o,!1)}),r=t.origFuncs.push.apply(e,arguments),t.unblock("data-push")),r}}),this.origFuncs.unshift=e.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),r;return!t.blocked&&i===t.currentVersion&&(t.block("data-unshift"),n.forEach(o=>{t.table.rowManager.addRowActual(o,!0)}),r=t.origFuncs.unshift.apply(e,arguments),t.unblock("data-unshift")),r}}),this.origFuncs.shift=e.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var n,r;return!t.blocked&&i===t.currentVersion&&(t.block("data-shift"),t.data.length&&(n=t.table.rowManager.getRowFromDataObject(t.data[0]),n&&n.deleteActual()),r=t.origFuncs.shift.call(e),t.unblock("data-shift")),r}}),this.origFuncs.pop=e.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var n,r;return!t.blocked&&i===t.currentVersion&&(t.block("data-pop"),t.data.length&&(n=t.table.rowManager.getRowFromDataObject(t.data[t.data.length-1]),n&&n.deleteActual()),r=t.origFuncs.pop.call(e),t.unblock("data-pop")),r}}),this.origFuncs.splice=e.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),r=n[0]<0?e.length+n[0]:n[0],o=n[1],a=n[2]?n.slice(2):!1,l,h;if(!t.blocked&&i===t.currentVersion){if(t.block("data-splice"),a&&(l=e[r]?t.table.rowManager.getRowFromDataObject(e[r]):!1,l?a.forEach(c=>{t.table.rowManager.addRowActual(c,!0,l,!0)}):(a=a.slice().reverse(),a.forEach(c=>{t.table.rowManager.addRowActual(c,!0,!1,!0)}))),o!==0){var u=e.slice(r,typeof n[1]>"u"?n[1]:r+o);u.forEach((c,d)=>{var f=t.table.rowManager.getRowFromDataObject(c);f&&f.deleteActual(d!==u.length-1)})}(a||o!==0)&&t.table.rowManager.reRenderInPosition(),h=t.origFuncs.splice.apply(e,arguments),t.unblock("data-splice")}return h}})}unwatchData(){if(this.data!==!1)for(var e in this.origFuncs)Object.defineProperty(this.data,e,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}watchRow(e){var t=e.getData();for(var i in t)this.watchKey(e,t,i);this.table.options.dataTree&&this.watchTreeChildren(e)}watchTreeChildren(e){var t=this,i=e.getData()[this.table.options.dataTreeChildField],n={};i&&(n.push=i.push,Object.defineProperty(i,"push",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-push");var r=n.push.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-push")}return r}}),n.unshift=i.unshift,Object.defineProperty(i,"unshift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-unshift");var r=n.unshift.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-unshift")}return r}}),n.shift=i.shift,Object.defineProperty(i,"shift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-shift");var r=n.shift.call(i);this.rebuildTree(e),t.unblock("tree-shift")}return r}}),n.pop=i.pop,Object.defineProperty(i,"pop",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-pop");var r=n.pop.call(i);this.rebuildTree(e),t.unblock("tree-pop")}return r}}),n.splice=i.splice,Object.defineProperty(i,"splice",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-splice");var r=n.splice.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-splice")}return r}}))}rebuildTree(e){this.table.modules.dataTree.initializeRow(e),this.table.modules.dataTree.layoutRow(e),this.table.rowManager.refreshActiveData("tree",!1,!0)}watchKey(e,t,i){var n=this,r=Object.getOwnPropertyDescriptor(t,i),o=t[i],a=this.currentVersion;Object.defineProperty(t,i,{set:l=>{if(o=l,!n.blocked&&a===n.currentVersion){n.block("key");var h={};h[i]=l,e.updateData(h),n.unblock("key")}r.set&&r.set(l)},get:()=>(r.get&&r.get(),o)})}unwatchRow(e){var t=e.getData();for(var i in t)Object.defineProperty(t,i,{value:t[i]})}block(e){this.blocked||(this.blocked=e)}unblock(e){this.blocked===e&&(this.blocked=!1)}}U(Wv,"moduleName","reactiveData");class Uv extends pe{constructor(e){super(e),this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.latestX=!1,this.handle=null,this.initialNextColumn=null,this.nextColumn=null,this.initialized=!1,this.registerColumnOption("resizable",!0),this.registerTableOption("resizableColumnFit",!1),this.registerTableOption("resizableColumnGuide",!1)}initialize(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}initializeEventWatchers(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-width",this.columnWidthUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}layoutCellHandles(e){e.row.type==="row"&&(this.deInitializeComponent(e),this.initializeColumn("cell",e,e.column,e.element))}layoutColumnHeader(e){e.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(e),this.initializeColumn("header",e,e,e.element))}columnLayoutUpdated(e){var t=e.prevColumn();this.reinitializeColumn(e),t&&this.reinitializeColumn(t)}columnWidthUpdated(e){e.modules.frozen&&(this.table.modules.frozenColumns.leftColumns.includes(e)?this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.reinitializeColumn(t)}):this.table.modules.frozenColumns.rightColumns.includes(e)&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.reinitializeColumn(t)}))}frozenColumnOffset(e){var t=!1;return e.modules.frozen&&(t=e.modules.frozen.marginValue,e.modules.frozen.position==="left"?t+=e.getWidth()-3:t&&(t-=3)),t!==!1?t+"px":!1}reinitializeColumn(e){var t=this.frozenColumnOffset(e);e.cells.forEach(i=>{i.modules.resize&&i.modules.resize.handleEl&&(t&&(i.modules.resize.handleEl.style[e.modules.frozen.position]=t,i.modules.resize.handleEl.style["z-index"]=11),i.element.after(i.modules.resize.handleEl))}),e.modules.resize&&e.modules.resize.handleEl&&(t&&(e.modules.resize.handleEl.style[e.modules.frozen.position]=t),e.element.after(e.modules.resize.handleEl))}initializeColumn(e,t,i,n){var r=this,o=!1,a=i.definition.resizable,l={},h=i.getLastColumn();if(e==="header"&&(o=i.definition.formatter=="textarea"||i.definition.variableHeight,l={variableHeight:o}),(a===!0||a==e)&&this._checkResizability(h)){var u=document.createElement("span");u.className="tabulator-col-resize-handle",u.addEventListener("click",function(d){d.stopPropagation()});var c=function(d){r.startColumn=i,r.initialNextColumn=r.nextColumn=h.nextColumn(),r._mouseDown(d,h,u)};u.addEventListener("mousedown",c),u.addEventListener("touchstart",c,{passive:!0}),u.addEventListener("dblclick",d=>{var f=h.getWidth();d.stopPropagation(),h.reinitializeWidth(!0),f!==h.getWidth()&&(r.dispatch("column-resized",h),r.dispatchExternal("columnResized",h.getComponent()))}),i.modules.frozen&&(u.style.position="sticky",u.style[i.modules.frozen.position]=this.frozenColumnOffset(i)),l.handleEl=u,n.parentNode&&i.visible&&n.after(u)}t.modules.resize=l}deInitializeColumn(e){this.deInitializeComponent(e),e.cells.forEach(t=>{this.deInitializeComponent(t)})}deInitializeComponent(e){var t;e.modules.resize&&(t=e.modules.resize.handleEl,t&&t.parentElement&&t.parentElement.removeChild(t))}resizeHandle(e,t){e.modules.resize&&e.modules.resize.handleEl&&(e.modules.resize.handleEl.style.height=t)}resize(e,t){var i=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,n=i-this.startX,r=i-this.latestX,o,a;if(this.latestX=i,this.table.rtl&&(n=-n,r=-r),o=t.width==t.minWidth||t.width==t.maxWidth,t.setWidth(this.startWidth+n),a=t.width==t.minWidth||t.width==t.maxWidth,r<0&&(this.nextColumn=this.initialNextColumn),this.table.options.resizableColumnFit&&this.nextColumn&&!(o&&a)){let l=this.nextColumn.getWidth();r>0&&l<=this.nextColumn.minWidth&&(this.nextColumn=this.nextColumn.nextColumn()),this.nextColumn&&this.nextColumn.setWidth(this.nextColumn.getWidth()-r)}this.table.columnManager.rerenderColumns(!0),!this.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights()}calcGuidePosition(e,t,i){var n=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,r=i.getBoundingClientRect().x-this.table.element.getBoundingClientRect().x,o=this.table.element.getBoundingClientRect().x,a=t.element.getBoundingClientRect().left-o,l=n-this.startX,h=Math.max(r+l,a+t.minWidth);return t.maxWidth&&(h=Math.min(h,a+t.maxWidth)),h}_checkResizability(e){return e.definition.resizable}_mouseDown(e,t,i){var n=this,r;this.dispatchExternal("columnResizing",t.getComponent()),n.table.options.resizableColumnGuide&&(r=document.createElement("span"),r.classList.add("tabulator-col-resize-guide"),n.table.element.appendChild(r),setTimeout(()=>{r.style.left=n.calcGuidePosition(e,t,i)+"px"})),n.table.element.classList.add("tabulator-block-select");function o(l){n.table.options.resizableColumnGuide?r.style.left=n.calcGuidePosition(l,t,i)+"px":n.resize(l,t)}function a(l){n.table.options.resizableColumnGuide&&(n.resize(l,t),r.remove()),n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!1),n.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights(),document.body.removeEventListener("mouseup",a),document.body.removeEventListener("mousemove",o),i.removeEventListener("touchmove",o),i.removeEventListener("touchend",a),n.table.element.classList.remove("tabulator-block-select"),n.startWidth!==t.getWidth()&&(n.table.columnManager.verticalAlignHeaders(),n.dispatch("column-resized",t),n.dispatchExternal("columnResized",t.getComponent()))}e.stopPropagation(),n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!0),n.startX=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,n.latestX=n.startX,n.startWidth=t.getWidth(),document.body.addEventListener("mousemove",o),document.body.addEventListener("mouseup",a),i.addEventListener("touchmove",o,{passive:!0}),i.addEventListener("touchend",a)}}U(Uv,"moduleName","resizeColumns");class jv extends pe{constructor(e){super(e),this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null,this.registerTableOption("resizableRows",!1),this.registerTableOption("resizableRowGuide",!1)}initialize(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}initializeRow(e){var t=this,i=e.getElement(),n=document.createElement("div");n.className="tabulator-row-resize-handle";var r=document.createElement("div");r.className="tabulator-row-resize-handle prev",n.addEventListener("click",function(l){l.stopPropagation()});var o=function(l){t.startRow=e,t._mouseDown(l,e,n)};n.addEventListener("mousedown",o),n.addEventListener("touchstart",o,{passive:!0}),r.addEventListener("click",function(l){l.stopPropagation()});var a=function(l){var h=t.table.rowManager.prevDisplayRow(e);h&&(t.startRow=h,t._mouseDown(l,h,r))};r.addEventListener("mousedown",a),r.addEventListener("touchstart",a,{passive:!0}),i.appendChild(n),i.appendChild(r)}resize(e,t){t.setHeight(this.startHeight+((typeof e.screenY>"u"?e.touches[0].screenY:e.screenY)-this.startY))}calcGuidePosition(e,t,i){var n=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,r=i.getBoundingClientRect().y-this.table.element.getBoundingClientRect().y,o=this.table.element.getBoundingClientRect().y,a=t.element.getBoundingClientRect().top-o,l=n-this.startY;return Math.max(r+l,a)}_mouseDown(e,t,i){var n=this,r;n.dispatchExternal("rowResizing",t.getComponent()),n.table.options.resizableRowGuide&&(r=document.createElement("span"),r.classList.add("tabulator-row-resize-guide"),n.table.element.appendChild(r),setTimeout(()=>{r.style.top=n.calcGuidePosition(e,t,i)+"px"})),n.table.element.classList.add("tabulator-block-select");function o(l){n.table.options.resizableRowGuide?r.style.top=n.calcGuidePosition(l,t,i)+"px":n.resize(l,t)}function a(l){n.table.options.resizableRowGuide&&(n.resize(l,t),r.remove()),document.body.removeEventListener("mouseup",o),document.body.removeEventListener("mousemove",o),i.removeEventListener("touchmove",o),i.removeEventListener("touchend",a),n.table.element.classList.remove("tabulator-block-select"),n.dispatchExternal("rowResized",t.getComponent())}e.stopPropagation(),n.startY=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,n.startHeight=t.getHeight(),document.body.addEventListener("mousemove",o),document.body.addEventListener("mouseup",a),i.addEventListener("touchmove",o,{passive:!0}),i.addEventListener("touchend",a)}}U(jv,"moduleName","resizeRows");class Yv extends pe{constructor(e){super(e),this.binding=!1,this.visibilityObserver=!1,this.resizeObserver=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1,this.visible=!1,this.initialized=!1,this.initialRedraw=!1,this.registerTableOption("autoResize",!0)}initialize(){if(this.table.options.autoResize){var e=this.table,t;this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),typeof IntersectionObserver<"u"&&typeof ResizeObserver<"u"&&e.rowManager.getRenderMode()==="virtual"?(this.initializeVisibilityObserver(),this.autoResize=!0,this.resizeObserver=new ResizeObserver(i=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var n=Math.floor(i[0].contentRect.height),r=Math.floor(i[0].contentRect.width);(this.tableHeight!=n||this.tableWidth!=r)&&(this.tableHeight=n,this.tableWidth=r,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),this.redrawTable())}}),this.resizeObserver.observe(e.element),t=window.getComputedStyle(e.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(t.getPropertyValue("max-height")||t.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver(i=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var n=Math.floor(i[0].contentRect.height),r=Math.floor(i[0].contentRect.width);(this.containerHeight!=n||this.containerWidth!=r)&&(this.containerHeight=n,this.containerWidth=r,this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth),this.redrawTable()}}),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell))&&(e.columnManager.rerenderColumns(!0),e.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver(e=>{this.visible=e[0].isIntersecting,this.initialized?this.visible&&(this.redrawTable(this.initialRedraw),this.initialRedraw=!1):(this.initialized=!0,this.initialRedraw=!this.visible)}),this.visibilityObserver.observe(this.table.element)}redrawTable(e){this.initialized&&this.visible&&(this.table.columnManager.rerenderColumns(!0),this.table.redraw(e))}tableResized(){this.table.rowManager.redraw()}clearBindings(){this.binding&&window.removeEventListener("resize",this.binding),this.resizeObserver&&this.resizeObserver.unobserve(this.table.element),this.visibilityObserver&&this.visibilityObserver.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}U(Yv,"moduleName","resizeTable");function qF(s,e,t){var i=document.createElement("div"),n=s.getRow()._row.modules.responsiveLayout;i.classList.add("tabulator-responsive-collapse-toggle"),i.innerHTML=`<svg class='tabulator-responsive-collapse-toggle-open' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />
  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />
</svg>

<svg class='tabulator-responsive-collapse-toggle-close' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />
</svg>`,s.getElement().classList.add("tabulator-row-handle");function r(o){var a=n.element;n.open=o,a&&(n.open?(i.classList.add("open"),a.style.display=""):(i.classList.remove("open"),a.style.display="none"))}return i.addEventListener("click",function(o){o.stopImmediatePropagation(),r(!n.open),s.getTable().rowManager.adjustTableSize()}),r(n.open),i}var JF={format:{formatters:{responsiveCollapse:qF}}};class Mc extends pe{constructor(e){super(e),this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1,this.registerTableOption("responsiveLayout",!1),this.registerTableOption("responsiveLayoutCollapseStartOpen",!0),this.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),this.registerTableOption("responsiveLayoutCollapseFormatter",!1),this.registerColumnOption("responsive")}initialize(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),this.table.options.responsiveLayout==="collapse"&&(this.subscribe("row-data-changed",this.generateCollapsedRowContent.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}tableRedraw(e){["fitColumns","fitDataStretch"].indexOf(this.layoutMode())===-1&&(e||this.update())}initializeResponsivity(){var e=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.collapseFormatter&&(this.collapseFormatter=this.collapseFormatter.bind(this.table)),this.table.columnManager.columnsByIndex.forEach((t,i)=>{t.modules.responsive&&t.modules.responsive.order&&t.modules.responsive.visible&&(t.modules.responsive.index=i,e.push(t),!t.visible&&this.mode==="collapse"&&this.hiddenColumns.push(t))}),e=e.reverse(),e=e.sort((t,i)=>{var n=i.modules.responsive.order-t.modules.responsive.order;return n||i.modules.responsive.index-t.modules.responsive.index}),this.columns=e,this.mode==="collapse"&&this.generateCollapsedContent();for(let t of this.table.columnManager.columnsByIndex)if(t.definition.formatter=="responsiveCollapse"){this.collapseHandleColumn=t;break}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}initializeColumn(e){var t=e.getDefinition();e.modules.responsive={order:typeof t.responsive>"u"?1:t.responsive,visible:t.visible!==!1}}initializeRow(e){var t;e.type!=="calc"&&(t=document.createElement("div"),t.classList.add("tabulator-responsive-collapse"),e.modules.responsiveLayout={element:t,open:this.collapseStartOpen},this.collapseStartOpen||(t.style.display="none"))}layoutRow(e){var t=e.getElement();e.modules.responsiveLayout&&(t.appendChild(e.modules.responsiveLayout.element),this.generateCollapsedRowContent(e))}updateColumnVisibility(e,t){!t&&e.modules.responsive&&(e.modules.responsive.visible=e.visible,this.initializeResponsivity())}hideColumn(e){var t=this.hiddenColumns.length;e.hide(!1,!0),this.mode==="collapse"&&(this.hiddenColumns.unshift(e),this.generateCollapsedContent(),this.collapseHandleColumn&&!t&&this.collapseHandleColumn.show())}showColumn(e){var t;e.show(!1,!0),e.setWidth(e.getWidth()),this.mode==="collapse"&&(t=this.hiddenColumns.indexOf(e),t>-1&&this.hiddenColumns.splice(t,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}update(){for(var e=!0;e;){let t=this.table.modules.layout.getMode()=="fitColumns"?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),i=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-t;if(i<0){let n=this.columns[this.index];n?(this.hideColumn(n),this.index++):e=!1}else{let n=this.columns[this.index-1];n&&i>0&&i>=n.getWidth()?(this.showColumn(n),this.index--):e=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}generateCollapsedContent(){var e=this.table.rowManager.getDisplayRows();e.forEach(t=>{this.generateCollapsedRowContent(t)})}generateCollapsedRowContent(e){var t,i;if(e.modules.responsiveLayout){for(t=e.modules.responsiveLayout.element;t.firstChild;)t.removeChild(t.firstChild);i=this.collapseFormatter(this.generateCollapsedRowData(e)),i&&t.appendChild(i),e.calcHeight(!0)}}generateCollapsedRowData(e){var t=e.getData(),i=[],n;return this.hiddenColumns.forEach(r=>{var o=r.getFieldValue(t);if(r.definition.title&&r.field)if(r.modules.format&&this.table.options.responsiveLayoutCollapseUseFormatters){let a=function(l){l()};n={value:!1,data:{},getValue:function(){return o},getData:function(){return t},getType:function(){return"cell"},getElement:function(){return document.createElement("div")},getRow:function(){return e.getComponent()},getColumn:function(){return r.getComponent()},getTable:()=>this.table},i.push({field:r.field,title:r.definition.title,value:r.modules.format.formatter.call(this.table.modules.format,n,r.modules.format.params,a)})}else i.push({field:r.field,title:r.definition.title,value:o})}),i}formatCollapsedData(e){var t=document.createElement("table");return e.forEach(i=>{var n=document.createElement("tr"),r=document.createElement("td"),o=document.createElement("td"),a,l=document.createElement("strong");r.appendChild(l),this.modules.localize.bind("columns|"+i.field,function(h){l.innerHTML=h||i.title}),i.value instanceof Node?(a=document.createElement("div"),a.appendChild(i.value),o.appendChild(a)):o.innerHTML=i.value,n.appendChild(r),n.appendChild(o),t.appendChild(n)}),Object.keys(e).length?t:""}}U(Mc,"moduleName","responsiveLayout"),U(Mc,"moduleExtensions",JF);function QF(s,e,t){var i=document.createElement("input"),n=!1;if(i.type="checkbox",i.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0))if(i.addEventListener("click",o=>{o.stopPropagation()}),typeof s.getRow=="function"){var r=s.getRow();r instanceof Rh?(i.addEventListener("change",o=>{this.table.options.selectableRowsRangeMode==="click"&&n?n=!1:r.toggleSelect()}),this.table.options.selectableRowsRangeMode==="click"&&i.addEventListener("click",o=>{n=!0,this.table.modules.selectRow.handleComplexRowClick(r._row,o)}),i.checked=r.isSelected&&r.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(r,i)):i=""}else i.addEventListener("change",o=>{this.table.modules.selectRow.selectedRows.length?this.table.deselectRow():this.table.selectRow(e.rowRange)}),this.table.modules.selectRow.registerHeaderSelectCheckbox(i);return i}var eD={format:{formatters:{rowSelection:QF}}};class Lc extends pe{constructor(e){super(e),this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null,this.registerTableOption("selectableRows","highlight"),this.registerTableOption("selectableRowsRangeMode","drag"),this.registerTableOption("selectableRowsRollingSelection",!0),this.registerTableOption("selectableRowsPersistence",!0),this.registerTableOption("selectableRowsCheck",function(t,i){return!0}),this.registerTableFunction("selectRow",this.selectRows.bind(this)),this.registerTableFunction("deselectRow",this.deselectRows.bind(this)),this.registerTableFunction("toggleSelectRow",this.toggleRow.bind(this)),this.registerTableFunction("getSelectedRows",this.getSelectedRows.bind(this)),this.registerTableFunction("getSelectedData",this.getSelectedData.bind(this)),this.registerComponentFunction("row","select",this.selectRows.bind(this)),this.registerComponentFunction("row","deselect",this.deselectRows.bind(this)),this.registerComponentFunction("row","toggleSelect",this.toggleRow.bind(this)),this.registerComponentFunction("row","isSelected",this.isRowSelected.bind(this))}initialize(){this.deprecatedOptionsCheck(),this.table.options.selectableRows==="highlight"&&this.table.options.selectableRange&&(this.table.options.selectableRows=!1),this.table.options.selectableRows!==!1&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectableRows&&!this.table.options.selectableRowsPersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}deprecatedOptionsCheck(){}rowRetrieve(e,t){return e==="selected"?this.selectedRows:t}rowDeleted(e){this._deselectRow(e,!0)}clearSelectionData(e){var t=this.selectedRows.length;this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],t&&e!==!0&&this._rowSelectionChanged()}initializeRow(e){var t=this,i=t.checkRowSelectability(e),n=e.getElement(),r=function(){setTimeout(function(){t.selecting=!1},50),document.body.removeEventListener("mouseup",r)};e.modules.select={selected:!1},n.classList.toggle("tabulator-selectable",i),n.classList.toggle("tabulator-unselectable",!i),t.checkRowSelectability(e)&&t.table.options.selectableRows&&t.table.options.selectableRows!="highlight"&&(t.table.options.selectableRowsRangeMode==="click"?n.addEventListener("click",this.handleComplexRowClick.bind(this,e)):(n.addEventListener("click",function(o){(!t.table.modExists("edit")||!t.table.modules.edit.getCurrentCell())&&t.table._clearSelection(),t.selecting||t.toggleRow(e)}),n.addEventListener("mousedown",function(o){if(o.shiftKey)return t.table._clearSelection(),t.selecting=!0,t.selectPrev=[],document.body.addEventListener("mouseup",r),document.body.addEventListener("keyup",r),t.toggleRow(e),!1}),n.addEventListener("mouseenter",function(o){t.selecting&&(t.table._clearSelection(),t.toggleRow(e),t.selectPrev[1]==e&&t.toggleRow(t.selectPrev[0]))}),n.addEventListener("mouseout",function(o){t.selecting&&(t.table._clearSelection(),t.selectPrev.unshift(e))})))}handleComplexRowClick(e,t){if(t.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||e;var i=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),n=this.table.rowManager.getDisplayRowIndex(e),r=i<=n?i:n,o=i>=n?i:n,a=this.table.rowManager.getDisplayRows().slice(0),l=a.splice(r,o-r+1);t.ctrlKey||t.metaKey?(l.forEach(h=>{h!==this.lastClickedRow&&(this.table.options.selectableRows!==!0&&!this.isRowSelected(e)?this.selectedRows.length<this.table.options.selectableRows&&this.toggleRow(h):this.toggleRow(h))}),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.table.options.selectableRows!==!0&&l.length>this.table.options.selectableRows&&(l=l.slice(0,this.table.options.selectableRows)),this.selectRows(l)),this.table._clearSelection()}else t.ctrlKey||t.metaKey?(this.toggleRow(e),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.selectRows(e),this.lastClickedRow=e)}checkRowSelectability(e){return e&&e.type==="row"?this.table.options.selectableRowsCheck.call(this.table,e.getComponent()):!1}toggleRow(e){this.checkRowSelectability(e)&&(e.modules.select&&e.modules.select.selected?this._deselectRow(e):this._selectRow(e))}selectRows(e){var t=[],i,n;switch(typeof e){case"undefined":i=this.table.rowManager.rows;break;case"number":i=this.table.rowManager.findRow(e);break;case"string":i=this.table.rowManager.findRow(e),i||(i=this.table.rowManager.getRows(e));break;default:i=e;break}Array.isArray(i)?i.length&&(i.forEach(r=>{n=this._selectRow(r,!0,!0),n&&t.push(n)}),this._rowSelectionChanged(!1,t)):i&&this._selectRow(i,!1,!0)}_selectRow(e,t,i){if(!isNaN(this.table.options.selectableRows)&&this.table.options.selectableRows!==!0&&!i&&this.selectedRows.length>=this.table.options.selectableRows)if(this.table.options.selectableRowsRollingSelection)this._deselectRow(this.selectedRows[0]);else return!1;var n=this.table.rowManager.findRow(e);if(n){if(this.selectedRows.indexOf(n)==-1)return n.getElement().classList.add("tabulator-selected"),n.modules.select||(n.modules.select={}),n.modules.select.selected=!0,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!0),this.selectedRows.push(n),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!0),this.dispatchExternal("rowSelected",n.getComponent()),this._rowSelectionChanged(t,n),n}else t||console.warn("Selection Error - No such row found, ignoring selection:"+e)}isRowSelected(e){return this.selectedRows.indexOf(e)!==-1}deselectRows(e,t){var i=[],n,r;switch(typeof e){case"undefined":n=Object.assign([],this.selectedRows);break;case"number":n=this.table.rowManager.findRow(e);break;case"string":n=this.table.rowManager.findRow(e),n||(n=this.table.rowManager.getRows(e));break;default:n=e;break}Array.isArray(n)?n.length&&(n.forEach(o=>{r=this._deselectRow(o,!0,!0),r&&i.push(r)}),this._rowSelectionChanged(t,[],i)):n&&this._deselectRow(n,t,!0)}_deselectRow(e,t){var i=this,n=i.table.rowManager.findRow(e),r,o;if(n){if(r=i.selectedRows.findIndex(function(a){return a==n}),r>-1)return o=n.getElement(),o&&o.classList.remove("tabulator-selected"),n.modules.select||(n.modules.select={}),n.modules.select.selected=!1,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!1),i.selectedRows.splice(r,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!1),this.dispatchExternal("rowDeselected",n.getComponent()),i._rowSelectionChanged(t,void 0,n),n}else t||console.warn("Deselection Error - No such row found, ignoring selection:"+e)}getSelectedData(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getData())}),e}getSelectedRows(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getComponent())}),e}_rowSelectionChanged(e,t=[],i=[]){this.headerCheckboxElement&&(this.selectedRows.length===0?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),e||(Array.isArray(t)||(t=[t]),t=t.map(n=>n.getComponent()),Array.isArray(i)||(i=[i]),i=i.map(n=>n.getComponent()),this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows(),t,i))}registerRowSelectCheckbox(e,t){e._row.modules.select||(e._row.modules.select={}),e._row.modules.select.checkboxEl=t}registerHeaderSelectCheckbox(e){this.headerCheckboxElement=e}childRowSelection(e,t){var i=this.table.modules.dataTree.getChildren(e,!0,!0);if(t)for(let n of i)this._selectRow(n,!0);else for(let n of i)this._deselectRow(n,!0)}}U(Lc,"moduleName","selectRow"),U(Lc,"moduleExtensions",eD);class tD{constructor(e){return this._range=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._range.table.componentFunctionBinder.handle("range",t._range,i)}})}getElement(){return this._range.element}getData(){return this._range.getData()}getCells(){return this._range.getCells(!0,!0)}getStructuredCells(){return this._range.getStructuredCells()}getRows(){return this._range.getRows().map(e=>e.getComponent())}getColumns(){return this._range.getColumns().map(e=>e.getComponent())}getBounds(){return this._range.getBounds()}getTopEdge(){return this._range.top}getBottomEdge(){return this._range.bottom}getLeftEdge(){return this._range.left}getRightEdge(){return this._range.right}setBounds(e,t){this._range.destroyedGuard("setBounds")&&this._range.setBounds(e&&e._cell,t&&t._cell)}setStartBound(e){this._range.destroyedGuard("setStartBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}setEndBound(e){this._range.destroyedGuard("setEndBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}clearValues(){this._range.destroyedGuard("clearValues")&&this._range.clearValues()}remove(){this._range.destroyedGuard("remove")&&this._range.destroy(!0)}}class iD extends lt{constructor(e,t,i,n){super(e),this.rangeManager=t,this.element=null,this.initialized=!1,this.initializing={start:!1,end:!1},this.destroyed=!1,this.top=0,this.bottom=0,this.left=0,this.right=0,this.table=e,this.start={row:0,col:0},this.end={row:0,col:0},this.rangeManager.rowHeader&&(this.left=1,this.right=1,this.start.col=1,this.end.col=1),this.initElement(),setTimeout(()=>{this.initBounds(i,n)})}initElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-range")}initBounds(e,t){this._updateMinMax(),e&&this.setBounds(e,t||e)}setStart(e,t){(this.start.row!==e||this.start.col!==t)&&(this.start.row=e,this.start.col=t,this.initializing.start=!0,this._updateMinMax())}setEnd(e,t){(this.end.row!==e||this.end.col!==t)&&(this.end.row=e,this.end.col=t,this.initializing.end=!0,this._updateMinMax())}setBounds(e,t,i){e&&this.setStartBound(e),this.setEndBound(t||e),this.rangeManager.layoutElement(i)}setStartBound(e){var t,i;e.type==="column"?this.rangeManager.columnSelection&&this.setStart(0,e.getPosition()-1):(t=e.row.position-1,i=e.column.getPosition()-1,e.column===this.rangeManager.rowHeader?this.setStart(t,1):this.setStart(t,i))}setEndBound(e){var t=this._getTableRows().length,i,n,r;e.type==="column"?this.rangeManager.columnSelection&&(this.rangeManager.selecting==="column"?this.setEnd(t-1,e.getPosition()-1):this.rangeManager.selecting==="cell"&&this.setEnd(0,e.getPosition()-1)):(i=e.row.position-1,n=e.column.getPosition()-1,r=e.column===this.rangeManager.rowHeader,this.rangeManager.selecting==="row"?this.setEnd(i,this._getTableColumns().length-1):this.rangeManager.selecting!=="row"&&r?this.setEnd(i,0):this.rangeManager.selecting==="column"?this.setEnd(t-1,n):this.setEnd(i,n))}_updateMinMax(){this.top=Math.min(this.start.row,this.end.row),this.bottom=Math.max(this.start.row,this.end.row),this.left=Math.min(this.start.col,this.end.col),this.right=Math.max(this.start.col,this.end.col),this.initialized?this.dispatchExternal("rangeChanged",this.getComponent()):this.initializing.start&&this.initializing.end&&(this.initialized=!0,this.dispatchExternal("rangeAdded",this.getComponent()))}_getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}_getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}layout(){var e=this.table.rowManager.renderer.vDomTop,t=this.table.rowManager.renderer.vDomBottom,i=this.table.columnManager.renderer.leftCol,n=this.table.columnManager.renderer.rightCol,r,o,a,l,h,u,c,d,f,g;this.table.options.renderHorizontal==="virtual"&&this.rangeManager.rowHeader&&(n+=1),e==null&&(e=0),t==null&&(t=1/0),i==null&&(i=0),n==null&&(n=1/0),this.overlaps(i,e,n,t)&&(r=Math.max(this.top,e),o=Math.min(this.bottom,t),a=Math.max(this.left,i),l=Math.min(this.right,n),h=this.rangeManager.getCell(r,a),u=this.rangeManager.getCell(o,l),c=h.getElement(),d=u.getElement(),f=h.row.getElement(),g=u.row.getElement(),this.element.classList.add("tabulator-range-active"),this.table.rtl?(this.element.style.right=f.offsetWidth-c.offsetLeft-c.offsetWidth+"px",this.element.style.width=c.offsetLeft+c.offsetWidth-d.offsetLeft+"px"):(this.element.style.left=f.offsetLeft+c.offsetLeft+"px",this.element.style.width=d.offsetLeft+d.offsetWidth-c.offsetLeft+"px"),this.element.style.top=f.offsetTop+"px",this.element.style.height=g.offsetTop+g.offsetHeight-f.offsetTop+"px")}atTopLeft(e){return e.row.position-1===this.top&&e.column.getPosition()-1===this.left}atBottomRight(e){return e.row.position-1===this.bottom&&e.column.getPosition()-1===this.right}occupies(e){return this.occupiesRow(e.row)&&this.occupiesColumn(e.column)}occupiesRow(e){return this.top<=e.position-1&&e.position-1<=this.bottom}occupiesColumn(e){return this.left<=e.getPosition()-1&&e.getPosition()-1<=this.right}overlaps(e,t,i,n){return!(this.left>i||e>this.right||this.top>n||t>this.bottom)}getData(){var e=[],t=this.getRows(),i=this.getColumns();return t.forEach(n=>{var r=n.getData(),o={};i.forEach(a=>{o[a.field]=r[a.field]}),e.push(o)}),e}getCells(e,t){var i=[],n=this.getRows(),r=this.getColumns();return e?i=n.map(o=>{var a=[];return o.getCells().forEach(l=>{r.includes(l.column)&&a.push(t?l.getComponent():l)}),a}):n.forEach(o=>{o.getCells().forEach(a=>{r.includes(a.column)&&i.push(t?a.getComponent():a)})}),i}getStructuredCells(){return this.getCells(!0,!0)}getRows(){return this._getTableRows().slice(this.top,this.bottom+1)}getColumns(){return this._getTableColumns().slice(this.left,this.right+1)}clearValues(){var e=this.getCells(),t=this.table.options.selectableRangeClearCellsValue;this.table.blockRedraw(),e.forEach(i=>{i.setValue(t)}),this.table.restoreRedraw()}getBounds(e){var t=this.getCells(!1,e),i={start:null,end:null};return t.length?(i.start=t[0],i.end=t[t.length-1]):console.warn("No bounds defined on range"),i}getComponent(){return this.component||(this.component=new tD(this)),this.component}destroy(e){this.destroyed=!0,this.element.remove(),e&&this.rangeManager.rangeRemoved(this),this.initialized&&this.dispatchExternal("rangeRemoved",this.getComponent())}destroyedGuard(e){return this.destroyed&&console.warn("You cannot call the "+e+" function on a destroyed range"),!this.destroyed}}var nD={rangeJumpUp:["ctrl + 38","meta + 38"],rangeJumpDown:["ctrl + 40","meta + 40"],rangeJumpLeft:["ctrl + 37","meta + 37"],rangeJumpRight:["ctrl + 39","meta + 39"],rangeExpandUp:"shift + 38",rangeExpandDown:"shift + 40",rangeExpandLeft:"shift + 37",rangeExpandRight:"shift + 39",rangeExpandJumpUp:["ctrl + shift + 38","meta + shift + 38"],rangeExpandJumpDown:["ctrl + shift + 40","meta + shift + 40"],rangeExpandJumpLeft:["ctrl + shift + 37","meta + shift + 37"],rangeExpandJumpRight:["ctrl + shift + 39","meta + shift + 39"]},sD={rangeJumpLeft:function(s){this.dispatch("keybinding-nav-range",s,"left",!0,!1)},rangeJumpRight:function(s){this.dispatch("keybinding-nav-range",s,"right",!0,!1)},rangeJumpUp:function(s){this.dispatch("keybinding-nav-range",s,"up",!0,!1)},rangeJumpDown:function(s){this.dispatch("keybinding-nav-range",s,"down",!0,!1)},rangeExpandLeft:function(s){this.dispatch("keybinding-nav-range",s,"left",!1,!0)},rangeExpandRight:function(s){this.dispatch("keybinding-nav-range",s,"right",!1,!0)},rangeExpandUp:function(s){this.dispatch("keybinding-nav-range",s,"up",!1,!0)},rangeExpandDown:function(s){this.dispatch("keybinding-nav-range",s,"down",!1,!0)},rangeExpandJumpLeft:function(s){this.dispatch("keybinding-nav-range",s,"left",!0,!0)},rangeExpandJumpRight:function(s){this.dispatch("keybinding-nav-range",s,"right",!0,!0)},rangeExpandJumpUp:function(s){this.dispatch("keybinding-nav-range",s,"up",!0,!0)},rangeExpandJumpDown:function(s){this.dispatch("keybinding-nav-range",s,"down",!0,!0)}},rD={range:function(s){var e=[],t=this.table.modules.selectRange.activeRange,i=!1,n,r,o,a,l;return l=s.length,t&&(n=t.getBounds(),r=n.start,n.start===n.end&&(i=!0),r&&(e=this.table.rowManager.activeRows.slice(),o=e.indexOf(r.row),i?a=s.length:a=e.indexOf(n.end.row)-o+1,o>-1&&(this.table.blockRedraw(),e=e.slice(o,o+a),e.forEach((h,u)=>{h.updateData(s[u%l])}),this.table.restoreRedraw()))),e}},oD={range:function(s){var e=[],t=[],i=this.table.modules.selectRange.activeRange,n=!1,r,o,a,l,h;return i&&(r=i.getBounds(),o=r.start,r.start===r.end&&(n=!0),o&&(s=s.split(`
`),s.forEach(function(u){e.push(u.split("	"))}),e.length&&(l=this.table.columnManager.getVisibleColumnsByIndex(),h=l.indexOf(o.column),h>-1)))?(n?a=e[0].length:a=l.indexOf(r.end.column)-h+1,l=l.slice(h,h+a),e.forEach(u=>{var c={},d=u.length;l.forEach(function(f,g){c[f.field]=u[g%d]}),t.push(c)}),t):!1}},aD={range:function(){var s=this.modules.selectRange.selectedColumns();return this.columnManager.rowHeader&&s.unshift(this.columnManager.rowHeader),s}},lD={range:function(){return this.modules.selectRange.selectedRows()}},hD={keybindings:{bindings:nD,actions:sD},clipboard:{pasteActions:rD,pasteParsers:oD},export:{columnLookups:aD,rowLookups:lD}};class Qa extends pe{constructor(e){super(e),this.selecting="cell",this.mousedown=!1,this.ranges=[],this.overlay=null,this.rowHeader=null,this.layoutChangeTimeout=null,this.columnSelection=!1,this.rowSelection=!1,this.maxRanges=0,this.activeRange=!1,this.blockKeydown=!1,this.keyDownEvent=this._handleKeyDown.bind(this),this.mouseUpEvent=this._handleMouseUp.bind(this),this.registerTableOption("selectableRange",!1),this.registerTableOption("selectableRangeColumns",!1),this.registerTableOption("selectableRangeRows",!1),this.registerTableOption("selectableRangeClearCells",!1),this.registerTableOption("selectableRangeClearCellsValue",void 0),this.registerTableOption("selectableRangeAutoFocus",!0),this.registerTableFunction("getRangesData",this.getRangesData.bind(this)),this.registerTableFunction("getRanges",this.getRanges.bind(this)),this.registerTableFunction("addRange",this.addRangeFromComponent.bind(this)),this.registerComponentFunction("cell","getRanges",this.cellGetRanges.bind(this)),this.registerComponentFunction("row","getRanges",this.rowGetRanges.bind(this)),this.registerComponentFunction("column","getRanges",this.colGetRanges.bind(this))}initialize(){this.options("selectableRange")&&(this.options("selectableRows")?console.warn("SelectRange functionality cannot be used in conjunction with row selection"):(this.maxRanges=this.options("selectableRange"),this.initializeTable(),this.initializeWatchers()),this.options("columns").findIndex(e=>e.frozen)>0&&console.warn("Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior."),this.options("columns").filter(e=>e.frozen)>1&&console.warn("Having multiple frozen columns with selectRange option may result in unpredictable behavior."))}initializeTable(){this.overlay=document.createElement("div"),this.overlay.classList.add("tabulator-range-overlay"),this.rangeContainer=document.createElement("div"),this.rangeContainer.classList.add("tabulator-range-container"),this.activeRangeCellElement=document.createElement("div"),this.activeRangeCellElement.classList.add("tabulator-range-cell-active"),this.overlay.appendChild(this.rangeContainer),this.overlay.appendChild(this.activeRangeCellElement),this.table.rowManager.element.addEventListener("keydown",this.keyDownEvent),this.resetRanges(),this.table.rowManager.element.appendChild(this.overlay),this.table.columnManager.element.setAttribute("tabindex",0),this.table.element.classList.add("tabulator-ranges")}initializeWatchers(){this.columnSelection=this.options("selectableRangeColumns"),this.rowSelection=this.options("selectableRangeRows"),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-mousedown",this.handleColumnMouseDown.bind(this)),this.subscribe("column-mousemove",this.handleColumnMouseMove.bind(this)),this.subscribe("column-resized",this.handleColumnResized.bind(this)),this.subscribe("column-moving",this.handleColumnMoving.bind(this)),this.subscribe("column-moved",this.handleColumnMoved.bind(this)),this.subscribe("column-width",this.layoutChange.bind(this)),this.subscribe("column-height",this.layoutChange.bind(this)),this.subscribe("column-resized",this.layoutChange.bind(this)),this.subscribe("columns-loaded",this.updateHeaderColumn.bind(this)),this.subscribe("cell-height",this.layoutChange.bind(this)),this.subscribe("cell-rendered",this.renderCell.bind(this)),this.subscribe("cell-mousedown",this.handleCellMouseDown.bind(this)),this.subscribe("cell-mousemove",this.handleCellMouseMove.bind(this)),this.subscribe("cell-click",this.handleCellClick.bind(this)),this.subscribe("cell-editing",this.handleEditingCell.bind(this)),this.subscribe("page-changed",this.redraw.bind(this)),this.subscribe("scroll-vertical",this.layoutChange.bind(this)),this.subscribe("scroll-horizontal",this.layoutChange.bind(this)),this.subscribe("data-destroy",this.tableDestroyed.bind(this)),this.subscribe("data-processed",this.resetRanges.bind(this)),this.subscribe("table-layout",this.layoutElement.bind(this)),this.subscribe("table-redraw",this.redraw.bind(this)),this.subscribe("table-destroy",this.tableDestroyed.bind(this)),this.subscribe("edit-editor-clear",this.finishEditingCell.bind(this)),this.subscribe("edit-blur",this.restoreFocus.bind(this)),this.subscribe("keybinding-nav-prev",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-next",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-left",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-right",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-up",this.keyNavigate.bind(this,"up")),this.subscribe("keybinding-nav-down",this.keyNavigate.bind(this,"down")),this.subscribe("keybinding-nav-range",this.keyNavigateRange.bind(this))}initializeColumn(e){this.columnSelection&&e.definition.headerSort&&this.options("headerSortClickElement")!=="icon"&&console.warn("Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'."),e.modules.edit}updateHeaderColumn(){var e;this.rowSelection&&(this.rowHeader=this.table.columnManager.getVisibleColumnsByIndex()[0],this.rowHeader&&(this.rowHeader.definition.cssClass=this.rowHeader.definition.cssClass+" tabulator-range-row-header",this.rowHeader.definition.headerSort&&console.warn("Using column headerSort with selectableRangeRows option may result in unpredictable behavior"),this.rowHeader.definition.editor&&console.warn("Using column editor with selectableRangeRows option may result in unpredictable behavior"))),this.table.modules.frozenColumns&&this.table.modules.frozenColumns.active&&(e=this.table.modules.frozenColumns.getFrozenColumns(),(e.length>1||e.length===1&&e[0]!==this.rowHeader)&&console.warn("Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior"))}getRanges(){return this.ranges.map(e=>e.getComponent())}getRangesData(){return this.ranges.map(e=>e.getData())}addRangeFromComponent(e,t){return e=e?e._cell:null,t=t?t._cell:null,this.addRange(e,t)}cellGetRanges(e){var t=[];return e.column===this.rowHeader?t=this.ranges.filter(i=>i.occupiesRow(e.row)):t=this.ranges.filter(i=>i.occupies(e)),t.map(i=>i.getComponent())}rowGetRanges(e){var t=this.ranges.filter(i=>i.occupiesRow(e));return t.map(i=>i.getComponent())}colGetRanges(e){var t=this.ranges.filter(i=>i.occupiesColumn(e));return t.map(i=>i.getComponent())}_handleMouseUp(e){this.mousedown=!1,document.removeEventListener("mouseup",this.mouseUpEvent)}_handleKeyDown(e){if(!this.blockKeydown&&(!this.table.modules.edit||this.table.modules.edit&&!this.table.modules.edit.currentCell)){if(e.key==="Enter"){if(this.table.modules.edit&&this.table.modules.edit.currentCell)return;this.table.modules.edit.editCell(this.getActiveCell()),e.preventDefault()}(e.key==="Backspace"||e.key==="Delete")&&this.options("selectableRangeClearCells")&&this.activeRange&&this.activeRange.clearValues()}}initializeFocus(e){var t;this.restoreFocus();try{document.selection?(t=document.body.createTextRange(),t.moveToElementText(e.getElement()),t.select()):window.getSelection&&(t=document.createRange(),t.selectNode(e.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}catch{}}restoreFocus(e){return this.table.rowManager.element.focus(),!0}handleColumnResized(e){var t;this.selecting!=="column"&&this.selecting!=="all"||(t=this.ranges.some(i=>i.occupiesColumn(e)),t&&this.ranges.forEach(i=>{var n=i.getColumns(!0);n.forEach(r=>{r!==e&&r.setWidth(e.width)})}))}handleColumnMoving(e,t){this.resetRanges().setBounds(t),this.overlay.style.visibility="hidden"}handleColumnMoved(e,t,i){this.activeRange.setBounds(e),this.layoutElement()}handleColumnMouseDown(e,t){e.button===2&&(this.selecting==="column"||this.selecting==="all")&&this.activeRange.occupiesColumn(t)||this.table.options.movableColumns&&this.selecting==="column"&&this.activeRange.occupiesColumn(t)||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleColumnMouseMove(e,t){t===this.rowHeader||!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}renderCell(e){var t=e.getElement(),i=this.ranges.findIndex(n=>n.occupies(e));t.classList.toggle("tabulator-range-selected",i!==-1),t.classList.toggle("tabulator-range-only-cell-selected",this.ranges.length===1&&this.ranges[0].atTopLeft(e)&&this.ranges[0].atBottomRight(e)),t.dataset.range=i}handleCellMouseDown(e,t){e.button===2&&(this.activeRange.occupies(t)||(this.selecting==="row"||this.selecting==="all")&&this.activeRange.occupiesRow(t.row))||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleCellMouseMove(e,t){!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}handleCellClick(e,t){this.initializeFocus(t)}handleEditingCell(e){this.activeRange&&this.activeRange.setBounds(e)}finishEditingCell(){this.blockKeydown=!0,this.table.rowManager.element.focus(),setTimeout(()=>{this.blockKeydown=!1},10)}keyNavigate(e,t){this.navigate(!1,!1,e),t.preventDefault()}keyNavigateRange(e,t,i,n){this.navigate(i,n,t),e.preventDefault()}navigate(e,t,i){var n=!1,r,o,a,l,h,u,c,d,f,g,p;if(this.table.modules.edit&&this.table.modules.edit.currentCell)return!1;if(this.ranges.length>1&&(this.ranges=this.ranges.filter(y=>y===this.activeRange?(y.setEnd(y.start.row,y.start.col),!0):(y.destroy(),!1))),r=this.activeRange,a={top:r.top,bottom:r.bottom,left:r.left,right:r.right},o=t?r.end:r.start,l=o.row,h=o.col,e)switch(i){case"left":h=this.findJumpCellLeft(r.start.row,o.col);break;case"right":h=this.findJumpCellRight(r.start.row,o.col);break;case"up":l=this.findJumpCellUp(o.row,r.start.col);break;case"down":l=this.findJumpCellDown(o.row,r.start.col);break}else{if(t&&(this.selecting==="row"&&(i==="left"||i==="right")||this.selecting==="column"&&(i==="up"||i==="down")))return;switch(i){case"left":h=Math.max(h-1,0);break;case"right":h=Math.min(h+1,this.getTableColumns().length-1);break;case"up":l=Math.max(l-1,0);break;case"down":l=Math.min(l+1,this.getTableRows().length-1);break}}if(this.rowHeader&&h===0&&(h=1),t||r.setStart(l,h),r.setEnd(l,h),t||(this.selecting="cell"),n=a.top!==r.top||a.bottom!==r.bottom||a.left!==r.left||a.right!==r.right,n)return u=this.getRowByRangePos(r.end.row),c=this.getColumnByRangePos(r.end.col),d=u.getElement().getBoundingClientRect(),g=c.getElement().getBoundingClientRect(),f=this.table.rowManager.getElement().getBoundingClientRect(),p=this.table.columnManager.getElement().getBoundingClientRect(),d.top>=f.top&&d.bottom<=f.bottom||(u.getElement().parentNode&&c.getElement().parentNode?this.autoScroll(r,u.getElement(),c.getElement()):u.getComponent().scrollTo(void 0,!1)),g.left>=p.left+this.getRowHeaderWidth()&&g.right<=p.right||(u.getElement().parentNode&&c.getElement().parentNode?this.autoScroll(r,u.getElement(),c.getElement()):c.getComponent().scrollTo(void 0,!1)),this.layoutElement(),!0}rangeRemoved(e){this.ranges=this.ranges.filter(t=>t!==e),this.activeRange===e&&(this.ranges.length?this.activeRange=this.ranges[this.ranges.length-1]:this.addRange()),this.layoutElement()}findJumpRow(e,t,i,n,r){return i&&(t=t.reverse()),this.findJumpItem(n,r,t,function(o){return o.getData()[e.getField()]})}findJumpCol(e,t,i,n,r){return i&&(t=t.reverse()),this.findJumpItem(n,r,t,function(o){return e.getData()[o.getField()]})}findJumpItem(e,t,i,n){var r;for(let o of i){let a=n(o);if(e){if(r=o,a)break}else if(t){if(r=o,a)break}else if(a)r=o;else break}return r}findJumpCellLeft(e,t){var i=this.getRowByRangePos(e),n=this.getTableColumns(),r=this.isEmpty(i.getData()[n[t].getField()]),o=n[t-1]?this.isEmpty(i.getData()[n[t-1].getField()]):!1,a=this.rowHeader?n.slice(1,t):n.slice(0,t),l=this.findJumpCol(i,a,!0,r,o);return l?l.getPosition()-1:t}findJumpCellRight(e,t){var i=this.getRowByRangePos(e),n=this.getTableColumns(),r=this.isEmpty(i.getData()[n[t].getField()]),o=n[t+1]?this.isEmpty(i.getData()[n[t+1].getField()]):!1,a=this.findJumpCol(i,n.slice(t+1,n.length),!1,r,o);return a?a.getPosition()-1:t}findJumpCellUp(e,t){var i=this.getColumnByRangePos(t),n=this.getTableRows(),r=this.isEmpty(n[e].getData()[i.getField()]),o=n[e-1]?this.isEmpty(n[e-1].getData()[i.getField()]):!1,a=this.findJumpRow(i,n.slice(0,e),!0,r,o);return a?a.position-1:e}findJumpCellDown(e,t){var i=this.getColumnByRangePos(t),n=this.getTableRows(),r=this.isEmpty(n[e].getData()[i.getField()]),o=n[e+1]?this.isEmpty(n[e+1].getData()[i.getField()]):!1,a=this.findJumpRow(i,n.slice(e+1,n.length),!1,r,o);return a?a.position-1:e}newSelection(e,t){var i;if(t.type==="column"){if(!this.columnSelection)return;if(t===this.rowHeader){i=this.resetRanges(),this.selecting="all";var n,r=this.getCell(-1,-1);this.rowHeader?n=this.getCell(0,1):n=this.getCell(0,0),i.setBounds(n,r);return}else this.selecting="column"}else t.column===this.rowHeader?this.selecting="row":this.selecting="cell";e.shiftKey?this.activeRange.setBounds(!1,t):e.ctrlKey?this.addRange().setBounds(t):this.resetRanges().setBounds(t)}autoScroll(e,t,i){var n=this.table.rowManager.element,r,o,a,l;typeof t>"u"&&(t=this.getRowByRangePos(e.end.row).getElement()),typeof i>"u"&&(i=this.getColumnByRangePos(e.end.col).getElement()),r={left:i.offsetLeft,right:i.offsetLeft+i.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight},o={left:n.scrollLeft+this.getRowHeaderWidth(),right:Math.ceil(n.scrollLeft+n.clientWidth),top:n.scrollTop,bottom:n.scrollTop+n.offsetHeight-this.table.rowManager.scrollbarWidth},a=o.left<r.left&&r.left<o.right&&o.left<r.right&&r.right<o.right,l=o.top<r.top&&r.top<o.bottom&&o.top<r.bottom&&r.bottom<o.bottom,a||(r.left<o.left?n.scrollLeft=r.left-this.getRowHeaderWidth():r.right>o.right&&(n.scrollLeft=Math.min(r.right-n.clientWidth,r.left-this.getRowHeaderWidth()))),l||(r.top<o.top?n.scrollTop=r.top:r.bottom>o.bottom&&(n.scrollTop=r.bottom-n.clientHeight))}layoutChange(){this.overlay.style.visibility="hidden",clearTimeout(this.layoutChangeTimeout),this.layoutChangeTimeout=setTimeout(this.layoutRanges.bind(this),200)}redraw(e){e&&(this.selecting="cell",this.resetRanges(),this.layoutElement())}layoutElement(e){var t;e?t=this.table.rowManager.getVisibleRows(!0):t=this.table.rowManager.getRows(),t.forEach(i=>{i.type==="row"&&(this.layoutRow(i),i.cells.forEach(n=>this.renderCell(n)))}),this.getTableColumns().forEach(i=>{this.layoutColumn(i)}),this.layoutRanges()}layoutRow(e){var t=e.getElement(),i=!1,n=this.ranges.some(r=>r.occupiesRow(e));this.selecting==="row"?i=n:this.selecting==="all"&&(i=!0),t.classList.toggle("tabulator-range-selected",i),t.classList.toggle("tabulator-range-highlight",n)}layoutColumn(e){var t=e.getElement(),i=!1,n=this.ranges.some(r=>r.occupiesColumn(e));this.selecting==="column"?i=n:this.selecting==="all"&&(i=!0),t.classList.toggle("tabulator-range-selected",i),t.classList.toggle("tabulator-range-highlight",n)}layoutRanges(){var e,t,i;this.table.initialized&&(e=this.getActiveCell(),e&&(t=e.getElement(),i=e.row.getElement(),this.table.rtl?this.activeRangeCellElement.style.right=i.offsetWidth-t.offsetLeft-t.offsetWidth+"px":this.activeRangeCellElement.style.left=i.offsetLeft+t.offsetLeft+"px",this.activeRangeCellElement.style.top=i.offsetTop+"px",this.activeRangeCellElement.style.width=t.offsetWidth+"px",this.activeRangeCellElement.style.height=i.offsetHeight+"px",this.ranges.forEach(n=>n.layout()),this.overlay.style.visibility="visible"))}getCell(e,t){var i;return t<0&&(t=this.getTableColumns().length+t,t<0)?null:(e<0&&(e=this.getTableRows().length+e),i=this.table.rowManager.getRowFromPosition(e+1),i?i.getCells(!1,!0).filter(n=>n.column.visible)[t]:null)}getActiveCell(){return this.getCell(this.activeRange.start.row,this.activeRange.start.col)}getRowByRangePos(e){return this.getTableRows()[e]}getColumnByRangePos(e){return this.getTableColumns()[e]}getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}addRange(e,t){var i;return this.maxRanges!==!0&&this.ranges.length>=this.maxRanges&&this.ranges.shift().destroy(),i=new iD(this.table,this,e,t),this.activeRange=i,this.ranges.push(i),this.rangeContainer.appendChild(i.element),i}resetRanges(){var e,t,i;return this.ranges.forEach(n=>n.destroy()),this.ranges=[],e=this.addRange(),this.table.rowManager.activeRows.length&&(i=this.table.rowManager.activeRows[0].cells.filter(n=>n.column.visible),t=i[this.rowHeader?1:0],t&&(e.setBounds(t),this.options("selectableRangeAutoFocus")&&this.initializeFocus(t))),e}tableDestroyed(){document.removeEventListener("mouseup",this.mouseUpEvent),this.table.rowManager.element.removeEventListener("keydown",this.keyDownEvent)}selectedRows(e){return e?this.activeRange.getRows().map(t=>t.getComponent()):this.activeRange.getRows()}selectedColumns(e){return e?this.activeRange.getColumns().map(t=>t.getComponent()):this.activeRange.getColumns()}getRowHeaderWidth(){return this.rowHeader?this.rowHeader.getElement().offsetWidth:0}isEmpty(e){return e==null||e===""}}U(Qa,"moduleName","selectRange"),U(Qa,"moduleInitOrder",1),U(Qa,"moduleExtensions",hD);function uD(s,e,t,i,n,r,o){var a=o.alignEmptyValues,l=o.decimalSeparator,h=o.thousandSeparator,u=0;if(s=String(s),e=String(e),h&&(s=s.split(h).join(""),e=e.split(h).join("")),l&&(s=s.split(l).join("."),e=e.split(l).join(".")),s=parseFloat(s),e=parseFloat(e),isNaN(s))u=isNaN(e)?0:-1;else if(isNaN(e))u=1;else return s-e;return(a==="top"&&r==="desc"||a==="bottom"&&r==="asc")&&(u*=-1),u}function cD(s,e,t,i,n,r,o){var a=o.alignEmptyValues,l=0,h;if(!s)l=e?-1:0;else if(!e)l=1;else{switch(typeof o.locale){case"boolean":o.locale&&(h=this.langLocale());break;case"string":h=o.locale;break}return String(s).toLowerCase().localeCompare(String(e).toLowerCase(),h)}return(a==="top"&&r==="desc"||a==="bottom"&&r==="asc")&&(l*=-1),l}function If(s,e,t,i,n,r,o){var a=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),l=o.format||"dd/MM/yyyy HH:mm:ss",h=o.alignEmptyValues,u=0;if(typeof a<"u"){if(a.isDateTime(s)||(l==="iso"?s=a.fromISO(String(s)):s=a.fromFormat(String(s),l)),a.isDateTime(e)||(l==="iso"?e=a.fromISO(String(e)):e=a.fromFormat(String(e),l)),!s.isValid)u=e.isValid?-1:0;else if(!e.isValid)u=1;else return s-e;return(h==="top"&&r==="desc"||h==="bottom"&&r==="asc")&&(u*=-1),u}else console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}function dD(s,e,t,i,n,r,o){return o.format||(o.format="dd/MM/yyyy"),If.call(this,s,e,t,i,n,r,o)}function fD(s,e,t,i,n,r,o){return o.format||(o.format="HH:mm"),If.call(this,s,e,t,i,n,r,o)}function gD(s,e,t,i,n,r,o){var a=s===!0||s==="true"||s==="True"||s===1?1:0,l=e===!0||e==="true"||e==="True"||e===1?1:0;return a-l}function pD(s,e,t,i,n,r,o){var a=o.type||"length",l=o.alignEmptyValues,h=0,u=this.table,c;o.valueMap&&(typeof o.valueMap=="string"?c=function(f){return f.map(g=>Fe.retrieveNestedData(u.options.nestedFieldSeparator,o.valueMap,g))}:c=o.valueMap);function d(f){var g;switch(c&&(f=c(f)),a){case"length":g=f.length;break;case"sum":g=f.reduce(function(p,y){return p+y});break;case"max":g=Math.max.apply(null,f);break;case"min":g=Math.min.apply(null,f);break;case"avg":g=f.reduce(function(p,y){return p+y})/f.length;break;case"string":g=f.join("");break}return g}if(!Array.isArray(s))h=Array.isArray(e)?-1:0;else if(!Array.isArray(e))h=1;else return a==="string"?String(d(s)).toLowerCase().localeCompare(String(d(e)).toLowerCase()):d(e)-d(s);return(l==="top"&&r==="desc"||l==="bottom"&&r==="asc")&&(h*=-1),h}function mD(s,e,t,i,n,r,o){var a=typeof s>"u"?0:1,l=typeof e>"u"?0:1;return a-l}function bD(s,e,t,i,n,r,o){var a,l,h,u,c=0,d,f=/(\d+)|(\D+)/g,g=/\d/,p=o.alignEmptyValues,y=0;if(!s&&s!==0)y=!e&&e!==0?0:-1;else if(!e&&e!==0)y=1;else{if(isFinite(s)&&isFinite(e))return s-e;if(a=String(s).toLowerCase(),l=String(e).toLowerCase(),a===l)return 0;if(!(g.test(a)&&g.test(l)))return a>l?1:-1;for(a=a.match(f),l=l.match(f),d=a.length>l.length?l.length:a.length;c<d;)if(h=a[c],u=l[c++],h!==u)return isFinite(h)&&isFinite(u)?(h.charAt(0)==="0"&&(h="."+h),u.charAt(0)==="0"&&(u="."+u),h-u):h>u?1:-1;return a.length>l.length}return(p==="top"&&r==="desc"||p==="bottom"&&r==="asc")&&(y*=-1),y}var yD={number:uD,string:cD,date:dD,time:fD,datetime:If,boolean:gD,array:pD,exists:mD,alphanum:bD};const gs=class gs extends pe{constructor(e){super(e),this.sortList=[],this.changed=!1,this.registerTableOption("sortMode","local"),this.registerTableOption("initialSort",!1),this.registerTableOption("columnHeaderSortMulti",!0),this.registerTableOption("sortOrderReverse",!1),this.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),this.registerTableOption("headerSortClickElement","header"),this.registerColumnOption("sorter"),this.registerColumnOption("sorterParams"),this.registerColumnOption("headerSort",!0),this.registerColumnOption("headerSortStartingDir"),this.registerColumnOption("headerSortTristate")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),this.table.options.sortMode==="remote"&&this.subscribe("data-params",this.remoteSortParams.bind(this))}tableBuilt(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}remoteSortParams(e,t,i,n){var r=this.getSort();return r.forEach(o=>{delete o.column}),n.sort=r,n}userSetSort(e,t){this.setSort(e,t),this.refreshSort()}clearSort(){this.clear(),this.refreshSort()}initializeColumn(e){var t=!1,i,n;switch(typeof e.definition.sorter){case"string":gs.sorters[e.definition.sorter]?t=gs.sorters[e.definition.sorter]:console.warn("Sort Error - No such sorter found: ",e.definition.sorter);break;case"function":t=e.definition.sorter;break}if(e.modules.sort={sorter:t,dir:"none",params:e.definition.sorterParams||{},startingDir:e.definition.headerSortStartingDir||"asc",tristate:e.definition.headerSortTristate},e.definition.headerSort!==!1){switch(i=e.getElement(),i.classList.add("tabulator-sortable"),n=document.createElement("div"),n.classList.add("tabulator-col-sorter"),this.table.options.headerSortClickElement){case"icon":n.classList.add("tabulator-col-sorter-element");break;case"header":i.classList.add("tabulator-col-sorter-element");break;default:i.classList.add("tabulator-col-sorter-element");break}switch(this.table.options.headerSortElement){case"function":break;case"object":n.appendChild(this.table.options.headerSortElement);break;default:n.innerHTML=this.table.options.headerSortElement}e.titleHolderElement.appendChild(n),e.modules.sort.element=n,this.setColumnHeaderSortIcon(e,"none"),this.table.options.headerSortClickElement==="icon"&&n.addEventListener("mousedown",r=>{r.stopPropagation()}),(this.table.options.headerSortClickElement==="icon"?n:i).addEventListener("click",r=>{var o="",a=[],l=!1;if(e.modules.sort){if(e.modules.sort.tristate)e.modules.sort.dir=="none"?o=e.modules.sort.startingDir:e.modules.sort.dir==e.modules.sort.startingDir?o=e.modules.sort.dir=="asc"?"desc":"asc":o="none";else switch(e.modules.sort.dir){case"asc":o="desc";break;case"desc":o="asc";break;default:o=e.modules.sort.startingDir}this.table.options.columnHeaderSortMulti&&(r.shiftKey||r.ctrlKey)?(a=this.getSort(),l=a.findIndex(h=>h.field===e.getField()),l>-1?(a[l].dir=o,l=a.splice(l,1)[0],o!="none"&&a.push(l)):o!="none"&&a.push({column:e,dir:o}),this.setSort(a)):o=="none"?this.clear():this.setSort(e,o),this.refreshSort()}})}}refreshSort(){this.table.options.sortMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0)}hasChanged(){var e=this.changed;return this.changed=!1,e}getSort(){var e=this,t=[];return e.sortList.forEach(function(i){i.column&&t.push({column:i.column.getComponent(),field:i.column.getField(),dir:i.dir})}),t}setSort(e,t){var i=this,n=[];Array.isArray(e)||(e=[{column:e,dir:t}]),e.forEach(function(r){var o;o=i.table.columnManager.findColumn(r.column),o?(r.column=o,n.push(r),i.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",r.column)}),i.sortList=n,this.dispatch("sort-changed")}clear(){this.setSort([])}findSorter(e){var t=this.table.rowManager.activeRows[0],i="string",n,r;if(t&&(t=t.getData(),n=e.getField(),n))switch(r=e.getFieldValue(t),typeof r){case"undefined":i="string";break;case"boolean":i="boolean";break;default:!isNaN(r)&&r!==""?i="number":r.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(i="alphanum");break}return gs.sorters[i]}sort(e,t){var i=this,n=this.table.options.sortOrderReverse?i.sortList.slice().reverse():i.sortList,r=[],o=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",i.getSort()),t||i.clearColumnHeaders(),this.table.options.sortMode!=="remote"?(n.forEach(function(a,l){var h;a.column&&(h=a.column.modules.sort,h&&(h.sorter||(h.sorter=i.findSorter(a.column)),a.params=typeof h.params=="function"?h.params(a.column.getComponent(),a.dir):h.params,r.push(a)),t||i.setColumnHeader(a.column,a.dir))}),r.length&&i._sortItems(e,r)):t||n.forEach(function(a,l){i.setColumnHeader(a.column,a.dir)}),this.subscribedExternal("dataSorted")&&(e.forEach(a=>{o.push(a.getComponent())}),this.dispatchExternal("dataSorted",i.getSort(),o)),e}clearColumnHeaders(){this.table.columnManager.getRealColumns().forEach(e=>{e.modules.sort&&(e.modules.sort.dir="none",e.getElement().setAttribute("aria-sort","none"),this.setColumnHeaderSortIcon(e,"none"))})}setColumnHeader(e,t){e.modules.sort.dir=t,e.getElement().setAttribute("aria-sort",t==="asc"?"ascending":"descending"),this.setColumnHeaderSortIcon(e,t)}setColumnHeaderSortIcon(e,t){var i=e.modules.sort.element,n;if(e.definition.headerSort&&typeof this.table.options.headerSortElement=="function"){for(;i.firstChild;)i.removeChild(i.firstChild);n=this.table.options.headerSortElement.call(this.table,e.getComponent(),t),typeof n=="object"?i.appendChild(n):i.innerHTML=n}}_sortItems(e,t){var i=t.length-1;e.sort((n,r)=>{for(var o,a=i;a>=0;a--){let l=t[a];if(o=this._sortRow(n,r,l.column,l.dir,l.params),o!==0)break}return o})}_sortRow(e,t,i,n,r){var o,a,l=n=="asc"?e:t,h=n=="asc"?t:e;return e=i.getFieldValue(l.getData()),t=i.getFieldValue(h.getData()),e=typeof e<"u"?e:"",t=typeof t<"u"?t:"",o=l.getComponent(),a=h.getComponent(),i.modules.sort.sorter.call(this,e,t,o,a,i.getComponent(),n,r)}};U(gs,"moduleName","sort"),U(gs,"sorters",yD);let Ac=gs;class vD{constructor(e,t){this.columnCount=e,this.rowCount=t,this.columnString=[],this.columns=[],this.rows=[]}genColumns(e){var t=Math.max(this.columnCount,Math.max(...e.map(i=>i.length)));this.columnString=[],this.columns=[];for(let i=1;i<=t;i++)this.incrementChar(this.columnString.length-1),this.columns.push(this.columnString.join(""));return this.columns}genRows(e){var t=Math.max(this.rowCount,e.length);this.rows=[];for(let i=1;i<=t;i++)this.rows.push(i);return this.rows}incrementChar(e){let t=this.columnString[e];t?t!=="Z"?this.columnString[e]=String.fromCharCode(this.columnString[e].charCodeAt(0)+1):(this.columnString[e]="A",e?this.incrementChar(e-1):this.columnString.push("A")):this.columnString.push("A")}setRowCount(e){this.rowCount=e}setColumnCount(e){this.columnCount=e}}class Xv{constructor(e){return this._sheet=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._sheet.table.componentFunctionBinder.handle("sheet",t._sheet,i)}})}getTitle(){return this._sheet.title}getKey(){return this._sheet.key}getDefinition(){return this._sheet.getDefinition()}getData(){return this._sheet.getData()}setData(e){return this._sheet.setData(e)}clear(){return this._sheet.clear()}remove(){return this._sheet.remove()}active(){return this._sheet.active()}setTitle(e){return this._sheet.setTitle(e)}setRows(e){return this._sheet.setRows(e)}setColumns(e){return this._sheet.setColumns(e)}}class om extends lt{constructor(e,t){super(e.table),this.spreadsheetManager=e,this.definition=t,this.title=this.definition.title||"",this.key=this.definition.key||this.definition.title,this.rowCount=this.definition.rows,this.columnCount=this.definition.columns,this.data=this.definition.data||[],this.element=null,this.isActive=!1,this.grid=new vD(this.columnCount,this.rowCount),this.defaultColumnDefinition={width:100,headerHozAlign:"center",headerSort:!1},this.columnDefinition=Object.assign(this.defaultColumnDefinition,this.options("spreadsheetColumnDefinition")),this.columnDefs=[],this.rowDefs=[],this.columnFields=[],this.columns=[],this.rows=[],this.scrollTop=null,this.scrollLeft=null,this.initialize(),this.dispatchExternal("sheetAdded",this.getComponent())}initialize(){this.initializeElement(),this.initializeColumns(),this.initializeRows()}reinitialize(){this.initializeColumns(),this.initializeRows()}initializeElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tab"),this.element.innerText=this.title,this.element.addEventListener("click",()=>{this.spreadsheetManager.loadSheet(this)})}initializeColumns(){this.grid.setColumnCount(this.columnCount),this.columnFields=this.grid.genColumns(this.data),this.columnDefs=[],this.columnFields.forEach(e=>{var t=Object.assign({},this.columnDefinition);t.field=e,t.title=e,this.columnDefs.push(t)})}initializeRows(){var e;this.grid.setRowCount(this.rowCount),e=this.grid.genRows(this.data),this.rowDefs=[],e.forEach((t,i)=>{var n={_id:t},r=this.data[i];r&&r.forEach((o,a)=>{var l=this.columnFields[a];l&&(n[l]=o)}),this.rowDefs.push(n)})}unload(){this.isActive=!1,this.scrollTop=this.table.rowManager.scrollTop,this.scrollLeft=this.table.rowManager.scrollLeft,this.data=this.getData(!0),this.element.classList.remove("tabulator-spreadsheet-tab-active")}load(){var e=!this.isActive;this.isActive=!0,this.table.blockRedraw(),this.table.setData([]),this.table.setColumns(this.columnDefs),this.table.setData(this.rowDefs),this.table.restoreRedraw(),e&&this.scrollTop!==null&&(this.table.rowManager.element.scrollLeft=this.scrollLeft,this.table.rowManager.element.scrollTop=this.scrollTop),this.element.classList.add("tabulator-spreadsheet-tab-active"),this.dispatchExternal("sheetLoaded",this.getComponent())}getComponent(){return new Xv(this)}getDefinition(){return{title:this.title,key:this.key,rows:this.rowCount,columns:this.columnCount,data:this.getData()}}getData(e){var t=[],i,n,r;return this.rowDefs.forEach(o=>{var a=[];this.columnFields.forEach(l=>{a.push(o[l])}),t.push(a)}),!e&&!this.options("spreadsheetOutputFull")&&(i=t.map(o=>o.findLastIndex(a=>typeof a<"u")+1),n=Math.max(...i),r=i.findLastIndex(o=>o>0)+1,t=t.slice(0,r),t=t.map(o=>o.slice(0,n))),t}setData(e){this.data=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}clear(){this.setData([])}setTitle(e){this.title=e,this.element.innerText=e,this.dispatchExternal("sheetUpdated",this.getComponent())}setRows(e){this.rowCount=e,this.initializeRows(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}setColumns(e){this.columnCount=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}remove(){this.spreadsheetManager.removeSheet(this)}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.dispatchExternal("sheetRemoved",this.getComponent())}active(){this.spreadsheetManager.loadSheet(this)}}class $v extends pe{constructor(e){super(e),this.sheets=[],this.element=null,this.registerTableOption("spreadsheet",!1),this.registerTableOption("spreadsheetRows",50),this.registerTableOption("spreadsheetColumns",50),this.registerTableOption("spreadsheetColumnDefinition",{}),this.registerTableOption("spreadsheetOutputFull",!1),this.registerTableOption("spreadsheetData",!1),this.registerTableOption("spreadsheetSheets",!1),this.registerTableOption("spreadsheetSheetTabs",!1),this.registerTableOption("spreadsheetSheetTabsElement",!1),this.registerTableFunction("setSheets",this.setSheets.bind(this)),this.registerTableFunction("addSheet",this.addSheet.bind(this)),this.registerTableFunction("getSheets",this.getSheets.bind(this)),this.registerTableFunction("getSheetDefinitions",this.getSheetDefinitions.bind(this)),this.registerTableFunction("setSheetData",this.setSheetData.bind(this)),this.registerTableFunction("getSheet",this.getSheet.bind(this)),this.registerTableFunction("getSheetData",this.getSheetData.bind(this)),this.registerTableFunction("clearSheet",this.clearSheet.bind(this)),this.registerTableFunction("removeSheet",this.removeSheetFunc.bind(this)),this.registerTableFunction("activeSheet",this.activeSheetFunc.bind(this))}initialize(){this.options("spreadsheet")&&(this.subscribe("table-initialized",this.tableInitialized.bind(this)),this.subscribe("data-loaded",this.loadRemoteData.bind(this)),this.table.options.index="_id",this.options("spreadsheetData")&&this.options("spreadsheetSheets")&&(console.warn("You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData"),this.table.options.spreadsheetData=!1),this.compatibilityCheck(),this.options("spreadsheetSheetTabs")&&this.initializeTabset())}compatibilityCheck(){this.options("data")&&console.warn("Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table"),this.options("pagination")&&console.warn("The spreadsheet module is not compatible with the pagination module"),this.options("groupBy")&&console.warn("The spreadsheet module is not compatible with the row grouping module"),this.options("responsiveCollapse")&&console.warn("The spreadsheet module is not compatible with the responsive collapse module")}initializeTabset(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tabs");var e=this.options("spreadsheetSheetTabsElement");e&&!(e instanceof HTMLElement)&&(e=document.querySelector(e),e||console.warn("Unable to find element matching spreadsheetSheetTabsElement selector:",this.options("spreadsheetSheetTabsElement"))),e?e.appendChild(this.element):this.footerAppend(this.element)}tableInitialized(){this.sheets.length?this.loadSheet(this.sheets[0]):this.options("spreadsheetSheets")?this.loadSheets(this.options("spreadsheetSheets")):this.options("spreadsheetData")&&this.loadData(this.options("spreadsheetData"))}loadRemoteData(e,t,i){return console.log("data",e,t,i),Array.isArray(e)?(this.table.dataLoader.clearAlert(),this.dispatchExternal("dataLoaded",e),!e.length||Array.isArray(e[0])?this.loadData(e):this.loadSheets(e)):console.error(`Spreadsheet Loading Error - Unable to process remote data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e),!1}loadData(e){var t={data:e};this.loadSheet(this.newSheet(t))}destroySheets(){this.sheets.forEach(e=>{e.destroy()}),this.sheets=[],this.activeSheet=null}loadSheets(e){Array.isArray(e)||(e=[]),this.destroySheets(),e.forEach(t=>{this.newSheet(t)}),this.loadSheet(this.sheets[0])}loadSheet(e){this.activeSheet!==e&&(this.activeSheet&&this.activeSheet.unload(),this.activeSheet=e,e.load())}newSheet(e={}){var t;return e.rows||(e.rows=this.options("spreadsheetRows")),e.columns||(e.columns=this.options("spreadsheetColumns")),t=new om(this,e),this.sheets.push(t),this.element&&this.element.appendChild(t.element),t}removeSheet(e){var t=this.sheets.indexOf(e),i;this.sheets.length>1?t>-1&&(this.sheets.splice(t,1),e.destroy(),this.activeSheet===e&&(i=this.sheets[t-1]||this.sheets[0],i?this.loadSheet(i):this.activeSheet=null)):console.warn("Unable to remove sheet, at least one sheet must be active")}lookupSheet(e){return e?e instanceof om?e:e instanceof Xv?e._sheet:this.sheets.find(t=>t.key===e)||!1:this.activeSheet}setSheets(e){return this.loadSheets(e),this.getSheets()}addSheet(e){return this.newSheet(e).getComponent()}getSheetDefinitions(){return this.sheets.map(e=>e.getDefinition())}getSheets(){return this.sheets.map(e=>e.getComponent())}getSheet(e){var t=this.lookupSheet(e);return t?t.getComponent():!1}setSheetData(e,t){e&&!t&&(t=e,e=!1);var i=this.lookupSheet(e);return i?i.setData(t):!1}getSheetData(e){var t=this.lookupSheet(e);return t?t.getData():!1}clearSheet(e){var t=this.lookupSheet(e);return t?t.clear():!1}removeSheetFunc(e){var t=this.lookupSheet(e);t&&this.removeSheet(t)}activeSheetFunc(e){var t=this.lookupSheet(e);return t?this.loadSheet(t):!1}}U($v,"moduleName","spreadsheet");class Kv extends pe{constructor(e){super(e),this.tooltipSubscriber=null,this.headerSubscriber=null,this.timeout=null,this.popupInstance=null,this.registerTableOption("tooltipDelay",300),this.registerColumnOption("tooltip"),this.registerColumnOption("headerTooltip")}initialize(){this.deprecatedOptionsCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeColumn(e){e.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),e.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}mousemoveCheck(e,t,i){var n=e==="tooltip"?i.column.definition.tooltip:i.definition.headerTooltip;n&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,t,i,n),this.table.options.tooltipDelay))}mouseoutCheck(e,t,i){this.popupInstance||this.clearPopup()}clearPopup(e,t,i){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}loadTooltip(e,t,i){var n,r,o;function a(l){r=l}typeof i=="function"&&(i=i(e,t.getComponent(),a)),i instanceof HTMLElement?n=i:(n=document.createElement("div"),i===!0&&(t instanceof ga?i=t.value:t.definition.field?this.langBind("columns|"+t.definition.field,l=>{n.innerHTML=i=l||t.definition.title}):i=t.definition.title),n.innerHTML=i),(i||i===0||i===!1)&&(n.classList.add("tabulator-tooltip"),n.addEventListener("mousemove",l=>l.preventDefault()),this.popupInstance=this.popup(n),typeof r=="function"&&this.popupInstance.renderCallback(r),o=this.popupInstance.containerEventCoords(e),this.popupInstance.show(o.x+15,o.y+15).hideOnBlur(()=>{this.dispatchExternal("TooltipClosed",t.getComponent()),this.popupInstance=null}),this.dispatchExternal("TooltipOpened",t.getComponent()))}}U(Kv,"moduleName","tooltip");var wD={integer:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&Math.floor(e)===e)},float:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&e%1!==0)},numeric:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:!isNaN(e)},string:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:isNaN(e)},alphanumeric:function(s,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=new RegExp(/^[a-z0-9]+$/i);return i.test(e)},max:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)<=t},min:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)>=t},starts:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().startsWith(String(t).toLowerCase())},ends:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().endsWith(String(t).toLowerCase())},minLength:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length>=t},maxLength:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length<=t},in:function(s,e,t){return e===""||e===null||typeof e>"u"?!0:(typeof t=="string"&&(t=t.split("|")),t.indexOf(e)>-1)},regex:function(s,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=new RegExp(t);return i.test(e)},unique:function(s,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=!0,n=s.getData(),r=s.getColumn()._getSelf();return this.table.rowManager.rows.forEach(function(o){var a=o.getData();a!==n&&e==r.getFieldValue(a)&&(i=!1)}),i},required:function(s,e,t){return e!==""&&e!==null&&typeof e<"u"}};const Eo=class Eo extends pe{constructor(e){super(e),this.invalidCells=[],this.registerTableOption("validationMode","blocking"),this.registerColumnOption("validator"),this.registerTableFunction("getInvalidCells",this.getInvalidCells.bind(this)),this.registerTableFunction("clearCellValidation",this.userClearCellValidation.bind(this)),this.registerTableFunction("validate",this.userValidate.bind(this)),this.registerComponentFunction("cell","isValid",this.cellIsValid.bind(this)),this.registerComponentFunction("cell","clearValidation",this.clearValidation.bind(this)),this.registerComponentFunction("cell","validate",this.cellValidate.bind(this)),this.registerComponentFunction("column","validate",this.columnValidate.bind(this)),this.registerComponentFunction("row","validate",this.rowValidate.bind(this))}initialize(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}editValidate(e,t,i){var n=this.table.options.validationMode!=="manual"?this.validate(e.column.modules.validate,e,t):!0;return n!==!0&&setTimeout(()=>{e.getElement().classList.add("tabulator-validation-fail"),this.dispatchExternal("validationFailed",e.getComponent(),t,n)}),n}editorClear(e,t){t&&e.column.modules.validate&&this.cellValidate(e),e.getElement().classList.remove("tabulator-validation-fail")}editedClear(e){e.modules.validate&&(e.modules.validate.invalid=!1)}cellIsValid(e){return e.modules.validate&&e.modules.validate.invalid||!0}cellValidate(e){return this.validate(e.column.modules.validate,e,e.getValue())}columnValidate(e){var t=[];return e.cells.forEach(i=>{this.cellValidate(i)!==!0&&t.push(i.getComponent())}),t.length?t:!0}rowValidate(e){var t=[];return e.cells.forEach(i=>{this.cellValidate(i)!==!0&&t.push(i.getComponent())}),t.length?t:!0}userClearCellValidation(e){e||(e=this.getInvalidCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.clearValidation(t._getSelf())})}userValidate(e){var t=[];return this.table.rowManager.rows.forEach(i=>{i=i.getComponent();var n=i.validate();n!==!0&&(t=t.concat(n))}),t.length?t:!0}initializeColumnCheck(e){typeof e.definition.validator<"u"&&this.initializeColumn(e)}initializeColumn(e){var t=this,i=[],n;e.definition.validator&&(Array.isArray(e.definition.validator)?e.definition.validator.forEach(r=>{n=t._extractValidator(r),n&&i.push(n)}):(n=this._extractValidator(e.definition.validator),n&&i.push(n)),e.modules.validate=i.length?i:!1)}_extractValidator(e){var t,i,n;switch(typeof e){case"string":return n=e.indexOf(":"),n>-1?(t=e.substring(0,n),i=e.substring(n+1)):t=e,this._buildValidator(t,i);case"function":return this._buildValidator(e);case"object":return this._buildValidator(e.type,e.parameters)}}_buildValidator(e,t){var i=typeof e=="function"?e:Eo.validators[e];return i?{type:typeof e=="function"?"function":e,func:i,params:t}:(console.warn("Validator Setup Error - No matching validator found:",e),!1)}validate(e,t,i){var n=this,r=[],o=this.invalidCells.indexOf(t);return e&&e.forEach(a=>{a.func.call(n,t.getComponent(),i,a.params)||r.push({type:a.type,parameters:a.params})}),t.modules.validate||(t.modules.validate={}),r.length?(t.modules.validate.invalid=r,this.table.options.validationMode!=="manual"&&t.getElement().classList.add("tabulator-validation-fail"),o==-1&&this.invalidCells.push(t)):(t.modules.validate.invalid=!1,t.getElement().classList.remove("tabulator-validation-fail"),o>-1&&this.invalidCells.splice(o,1)),r.length?r:!0}getInvalidCells(){var e=[];return this.invalidCells.forEach(t=>{e.push(t.getComponent())}),e}clearValidation(e){var t;e.modules.validate&&e.modules.validate.invalid&&(e.getElement().classList.remove("tabulator-validation-fail"),e.modules.validate.invalid=!1,t=this.invalidCells.indexOf(e),t>-1&&this.invalidCells.splice(t,1))}};U(Eo,"moduleName","validate"),U(Eo,"validators",wD);let Pc=Eo;var wu=Object.freeze({__proto__:null,AccessorModule:uc,AjaxModule:fc,ClipboardModule:gc,ColumnCalcsModule:pc,DataTreeModule:Ov,DownloadModule:mc,EditModule:bc,ExportModule:yc,FilterModule:vc,FormatModule:wc,FrozenColumnsModule:Fv,FrozenRowsModule:Dv,GroupRowsModule:kv,HistoryModule:_c,HtmlTableImportModule:Nv,ImportModule:Ec,InteractionModule:zv,KeybindingsModule:Cc,MenuModule:Gv,MoveColumnsModule:Hv,MoveRowsModule:xc,MutatorModule:Rc,PageModule:Sc,PersistenceModule:Tc,PopupModule:Bv,PrintModule:Vv,ReactiveDataModule:Wv,ResizeColumnsModule:Uv,ResizeRowsModule:jv,ResizeTableModule:Yv,ResponsiveLayoutModule:Mc,SelectRangeModule:Qa,SelectRowModule:Lc,SortModule:Ac,SpreadsheetModule:$v,TooltipModule:Kv,ValidateModule:Pc}),_D={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInvalidComponentFuncs:!0,debugInitialization:!0,debugDeprecation:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},rowHeader:!1,data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{},dependencies:{}};class Zv{constructor(e,t,i={}){this.table=e,this.msgType=t,this.registeredDefaults=Object.assign({},i)}register(e,t){this.registeredDefaults[e]=t}generate(e,t={}){var i=Object.assign({},this.registeredDefaults),n=this.table.options.debugInvalidOptions||t.debugInvalidOptions===!0;Object.assign(i,e);for(let r in t)i.hasOwnProperty(r)||(n&&console.warn("Invalid "+this.msgType+" option:",r),i[r]=t.key);for(let r in i)r in t?i[r]=t[r]:Array.isArray(i[r])?i[r]=Object.assign([],i[r]):typeof i[r]=="object"&&i[r]!==null?i[r]=Object.assign({},i[r]):typeof i[r]>"u"&&delete i[r];return i}}class Th extends lt{constructor(e){super(e),this.elementVertical=e.rowManager.element,this.elementHorizontal=e.columnManager.element,this.tableElement=e.rowManager.tableElement,this.verticalFillMode="fit"}initialize(){}clearRows(){}clearColumns(){}reinitializeColumnWidths(e){}renderRows(){}renderColumns(){}rerenderRows(e){e&&e()}rerenderColumns(e,t){}renderRowCells(e){}rerenderRowCells(e,t){}scrollColumns(e,t){}scrollRows(e,t){}resize(){}scrollToRow(e){}scrollToRowNearestTop(e){}visibleRows(e){return[]}rows(){return this.table.rowManager.getDisplayRows()}styleRow(e,t){var i=e.getElement();t%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}clear(){this.clearRows(),this.clearColumns()}render(){this.renderRows(),this.renderColumns()}rerender(e){this.rerenderRows(),this.rerenderColumns()}scrollToRowPosition(e,t,i){var n=this.rows().indexOf(e),r=e.getElement(),o=0;return new Promise((a,l)=>{if(n>-1){if(typeof i>"u"&&(i=this.table.options.scrollToRowIfVisible),!i&&Fe.elVisible(r)&&(o=Fe.elOffset(r).top-Fe.elOffset(this.elementVertical).top,o>0&&o<this.elementVertical.clientHeight-r.offsetHeight))return a(),!1;switch(typeof t>"u"&&(t=this.table.options.scrollToRowPosition),t==="nearest"&&(t=this.scrollToRowNearestTop(e)?"top":"bottom"),this.scrollToRow(e),t){case"middle":case"center":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop+(r.offsetTop-this.elementVertical.scrollTop)-(this.elementVertical.scrollHeight-r.offsetTop)/2:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight/2;break;case"bottom":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop-(this.elementVertical.scrollHeight-r.offsetTop)+r.offsetHeight:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight+r.offsetHeight;break;case"top":this.elementVertical.scrollTop=r.offsetTop;break}a()}else console.warn("Scroll Error - Row not visible"),l("Scroll Error - Row not visible")})}}class ED extends Th{constructor(e){super(e)}renderRowCells(e,t){const i=document.createDocumentFragment();e.cells.forEach(n=>{i.appendChild(n.getElement())}),e.element.appendChild(i),t||e.cells.forEach(n=>{n.cellRendered()})}reinitializeColumnWidths(e){e.forEach(function(t){t.reinitializeWidth()})}}class CD extends Th{constructor(e){super(e),this.leftCol=0,this.rightCol=0,this.scrollLeft=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0,this.fitDataColAvg=0,this.windowBuffer=200,this.visibleRows=null,this.initialized=!1,this.isFitData=!1,this.columns=[]}initialize(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}compatibilityCheck(){this.options("layout")=="fitDataTable"&&console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),this.options("responsiveLayout")&&console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),this.options("rtl")&&console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction")}layoutCheck(){this.isFitData=this.options("layout").startsWith("fitData")}vertScrollListen(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}clearVisRowCache(){this.visibleRows=null}renderColumns(e,t){this.dataChange()}scrollColumns(e,t){this.scrollLeft!=e&&(this.scrollLeft=e,this.scroll(e-(this.vDomScrollPosLeft+this.windowBuffer)))}calcWindowBuffer(){var e=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach(t=>{if(t.visible){var i=t.getWidth();i>e&&(e=i)}}),this.windowBuffer=e*2}rerenderColumns(e,t){var i={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},n=0;e&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach(r=>{var o={},a;r.visible&&(r.modules.frozen||(a=r.getWidth(),o.leftPos=n,o.rightPos=n+a,o.width=a,this.isFitData&&(o.fitDataCheck=r.modules.vdomHoz?r.modules.vdomHoz.fitDataCheck:!0),n+a>this.vDomScrollPosLeft&&n<this.vDomScrollPosRight?(this.leftCol==-1&&(this.leftCol=this.columns.length,this.vDomPadLeft=n),this.rightCol=this.columns.length):this.leftCol!==-1&&(this.vDomPadRight+=a),this.columns.push(r),r.modules.vdomHoz=o,n+=a))}),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,t||(!e||this.reinitChanged(i))&&this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}renderRowCells(e){if(this.initialized)this.initializeRow(e);else{const t=document.createDocumentFragment();e.cells.forEach(i=>{t.appendChild(i.getElement())}),e.element.appendChild(t),e.cells.forEach(i=>{i.cellRendered()})}}rerenderRowCells(e,t){this.reinitializeRow(e,t)}reinitializeColumnWidths(e){for(let t=this.leftCol;t<=this.rightCol;t++)this.columns[t].reinitializeWidth()}deinitialize(){this.initialized=!1}clear(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}dataChange(){var e=!1,t,i;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach(n=>{!n.definition.width&&n.visible&&(e=!0)}),e&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,t=this.chain("rows-sample",[1],[],()=>this.table.rowManager.getDisplayRows())[0],t)){i=t.getElement(),t.generateCells(),this.tableElement.appendChild(i);for(let n=0;n<t.cells.length;n++){let r=t.cells[n];i.appendChild(r.getElement()),r.column.reinitializeWidth()}i.parentNode.removeChild(i),this.rerenderColumns(!1,!0)}}else this.options("layout")==="fitColumns"&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}reinitChanged(e){var t=!0;return e.cols.length!==this.columns.length||e.leftCol!==this.leftCol||e.rightCol!==this.rightCol?!0:(e.cols.forEach((i,n)=>{i!==this.columns[n]&&(t=!1)}),!t)}reinitializeRows(){var e=this.getVisibleRows(),t=this.table.rowManager.getRows().filter(i=>!e.includes(i));e.forEach(i=>{this.reinitializeRow(i,!0)}),t.forEach(i=>{i.deinitialize()})}getVisibleRows(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}scroll(e){this.vDomScrollPosLeft+=e,this.vDomScrollPosRight+=e,Math.abs(e)>this.windowBuffer/2?this.rerenderColumns():e>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}colPositionAdjust(e,t,i){for(let n=e;n<t;n++){let r=this.columns[n];r.modules.vdomHoz.leftPos+=i,r.modules.vdomHoz.rightPos+=i}}addColRight(){for(var e=!1,t=!0;t;){let i=this.columns[this.rightCol+1];i&&i.modules.vdomHoz.leftPos<=this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var r=n.getCell(i);n.getElement().insertBefore(r.getElement(),n.getCell(this.columns[this.rightCol]).getElement().nextSibling),r.cellRendered()}}),this.fitDataColActualWidthCheck(i),this.rightCol++,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.rightCol=this.rightCol)}),this.rightCol>=this.columns.length-1?this.vDomPadRight=0:this.vDomPadRight-=i.getWidth()):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}addColLeft(){for(var e=!1,t=!0;t;){let i=this.columns[this.leftCol-1];if(i)if(i.modules.vdomHoz.rightPos>=this.vDomScrollPosLeft){e=!0,this.getVisibleRows().forEach(r=>{if(r.type!=="group"){var o=r.getCell(i);r.getElement().insertBefore(o.getElement(),r.getCell(this.columns[this.leftCol]).getElement()),o.cellRendered()}}),this.leftCol--,this.getVisibleRows().forEach(r=>{r.type!=="group"&&(r.modules.vdomHoz.leftCol=this.leftCol)}),this.leftCol<=0?this.vDomPadLeft=0:this.vDomPadLeft-=i.getWidth();let n=this.fitDataColActualWidthCheck(i);n&&(this.scrollLeft=this.elementVertical.scrollLeft=this.elementVertical.scrollLeft+n,this.vDomPadRight-=n)}else t=!1;else t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}removeColRight(){for(var e=!1,t=!0;t;){let i=this.columns[this.rightCol];i&&i.modules.vdomHoz.leftPos>this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var r=n.getCell(i);try{n.getElement().removeChild(r.getElement())}catch(o){console.warn("Could not removeColRight",o.message)}}}),this.vDomPadRight+=i.getWidth(),this.rightCol--,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.rightCol=this.rightCol)})):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}removeColLeft(){for(var e=!1,t=!0;t;){let i=this.columns[this.leftCol];i&&i.modules.vdomHoz.rightPos<this.vDomScrollPosLeft?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var r=n.getCell(i);try{n.getElement().removeChild(r.getElement())}catch(o){console.warn("Could not removeColLeft",o.message)}}}),this.vDomPadLeft+=i.getWidth(),this.leftCol++,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.leftCol=this.leftCol)})):t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}fitDataColActualWidthCheck(e){var t,i;return e.modules.vdomHoz.fitDataCheck&&(e.reinitializeWidth(),t=e.getWidth(),i=t-e.modules.vdomHoz.width,i&&(e.modules.vdomHoz.rightPos+=i,e.modules.vdomHoz.width=t,this.colPositionAdjust(this.columns.indexOf(e)+1,this.columns.length,i)),e.modules.vdomHoz.fitDataCheck=!1),i}initializeRow(e){if(e.type!=="group"){e.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol},this.table.modules.frozenColumns&&this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.appendCell(e,t)});for(let t=this.leftCol;t<=this.rightCol;t++)this.appendCell(e,this.columns[t]);this.table.modules.frozenColumns&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.appendCell(e,t)})}}appendCell(e,t){if(t&&t.visible){let i=e.getCell(t);e.getElement().appendChild(i.getElement()),i.cellRendered()}}reinitializeRow(e,t){if(e.type!=="group"&&(t||!e.modules.vdomHoz||e.modules.vdomHoz.leftCol!==this.leftCol||e.modules.vdomHoz.rightCol!==this.rightCol)){for(var i=e.getElement();i.firstChild;)i.removeChild(i.firstChild);this.initializeRow(e)}}}class xD extends lt{constructor(e){super(e),this.blockHozScrollEvent=!1,this.headersElement=null,this.contentsElement=null,this.rowHeader=null,this.element=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.optionsList=new Zv(this.table,"column definition",Iv),this.redrawBlock=!1,this.redrawBlockUpdate=null,this.renderer=null}initialize(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.contentsElement=this.createHeaderContentsElement(),this.element=this.createHeaderElement(),this.contentsElement.insertBefore(this.headersElement,this.contentsElement.firstChild),this.element.insertBefore(this.contentsElement,this.element.firstChild),this.initializeScrollWheelWatcher(),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scrollbar-vertical",this.padVerticalScrollbar.bind(this))}padVerticalScrollbar(e){this.table.rtl?this.headersElement.style.marginLeft=e+"px":this.headersElement.style.marginRight=e+"px"}initializeRenderer(){var e,t={virtual:CD,basic:ED};typeof this.table.options.renderHorizontal=="string"?e=t[this.table.options.renderHorizontal]:e=this.table.options.renderHorizontal,e?(this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",this.table.options.renderHorizontal)}createHeadersElement(){var e=document.createElement("div");return e.classList.add("tabulator-headers"),e.setAttribute("role","row"),e}createHeaderContentsElement(){var e=document.createElement("div");return e.classList.add("tabulator-header-contents"),e.setAttribute("role","rowgroup"),e}createHeaderElement(){var e=document.createElement("div");return e.classList.add("tabulator-header"),e.setAttribute("role","rowgroup"),this.table.options.headerVisible||e.classList.add("tabulator-header-hidden"),e}getElement(){return this.element}getContentsElement(){return this.contentsElement}getHeadersElement(){return this.headersElement}scrollHorizontal(e){this.contentsElement.scrollLeft=e,this.scrollLeft=e,this.renderer.scrollColumns(e)}initializeScrollWheelWatcher(){this.contentsElement.addEventListener("wheel",e=>{var t;e.deltaX&&(t=this.contentsElement.scrollLeft+e.deltaX,this.table.rowManager.scrollHorizontal(t),this.table.columnManager.scrollHorizontal(t))})}generateColumnsFromRowData(e){var t=[],i={},n=this.table.options.autoColumns==="full"?e:[e[0]],r=this.table.options.autoColumnsDefinitions;if(e&&e.length){if(n.forEach(o=>{Object.keys(o).forEach((a,l)=>{let h=o[a],u;i[a]?i[a]!==!0&&typeof h<"u"&&(i[a].sorter=this.calculateSorterFromValue(h),i[a]=!0):(u={field:a,title:a,sorter:this.calculateSorterFromValue(h)},t.splice(l,0,u),i[a]=typeof h>"u"?u:!0)})}),r)switch(typeof r){case"function":this.table.options.columns=r.call(this.table,t);break;case"object":Array.isArray(r)?t.forEach(o=>{var a=r.find(l=>l.field===o.field);a&&Object.assign(o,a)}):t.forEach(o=>{r[o.field]&&Object.assign(o,r[o.field])}),this.table.options.columns=t;break}else this.table.options.columns=t;this.setColumns(this.table.options.columns)}}calculateSorterFromValue(e){var t;switch(typeof e){case"undefined":t="string";break;case"boolean":t="boolean";break;case"number":t="number";break;case"object":Array.isArray(e)?t="array":t="string";break;default:!isNaN(e)&&e!==""?t="number":e.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?t="alphanum":t="string";break}return t}setColumns(e,t){for(;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),this.dispatchExternal("columnsLoading"),this.table.options.rowHeader&&(this.rowHeader=new xs(this.table.options.rowHeader===!0?{}:this.table.options.rowHeader,this,!0),this.columns.push(this.rowHeader),this.headersElement.appendChild(this.rowHeader.getElement()),this.rowHeader.columnRendered()),e.forEach((i,n)=>{this._addColumn(i)}),this._reIndexColumns(),this.dispatch("columns-loaded"),this.subscribedExternal("columnsLoaded")&&this.dispatchExternal("columnsLoaded",this.getComponents()),this.rerenderColumns(!1,!0),this.redraw(!0)}_addColumn(e,t,i){var n=new xs(e,this),r=n.getElement(),o=i&&this.findColumnIndex(i);if(t&&this.rowHeader&&(!i||i===this.rowHeader)&&(t=!1,i=this.rowHeader,o=0),i&&o>-1){var a=i.getTopColumn(),l=this.columns.indexOf(a),h=a.getElement();t?(this.columns.splice(l,0,n),h.parentNode.insertBefore(r,h)):(this.columns.splice(l+1,0,n),h.parentNode.insertBefore(r,h.nextSibling))}else t?(this.columns.unshift(n),this.headersElement.insertBefore(n.getElement(),this.headersElement.firstChild)):(this.columns.push(n),this.headersElement.appendChild(n.getElement()));return n.columnRendered(),n}registerColumnField(e){e.definition.field&&(this.columnsByField[e.definition.field]=e)}registerColumnPosition(e){this.columnsByIndex.push(e)}_reIndexColumns(){this.columnsByIndex=[],this.columns.forEach(function(e){e.reRegisterPosition()})}verticalAlignHeaders(){var e=0;this.redrawBlock||(this.headersElement.style.height="",this.columns.forEach(t=>{t.clearVerticalAlign()}),this.columns.forEach(t=>{var i=t.getHeight();i>e&&(e=i)}),this.headersElement.style.height=e+"px",this.columns.forEach(t=>{t.verticalAlign(this.table.options.columnHeaderVertAlign,e)}),this.table.rowManager.adjustTableSize())}findColumn(e){var t;if(typeof e=="object"){if(e instanceof xs)return e;if(e instanceof Pv)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return t=[],this.columns.forEach(n=>{t.push(n),t=t.concat(n.getColumns(!0))}),t.find(n=>n.element===e)||!1}else return this.columnsByField[e]||!1;return!1}getColumnByField(e){return this.columnsByField[e]}getColumnsByFieldRoot(e){var t=[];return Object.keys(this.columnsByField).forEach(i=>{var n=this.table.options.nestedFieldSeparator?i.split(this.table.options.nestedFieldSeparator)[0]:i;n===e&&t.push(this.columnsByField[i])}),t}getColumnByIndex(e){return this.columnsByIndex[e]}getFirstVisibleColumn(){var e=this.columnsByIndex.findIndex(t=>t.visible);return e>-1?this.columnsByIndex[e]:!1}getVisibleColumnsByIndex(){return this.columnsByIndex.filter(e=>e.visible)}getColumns(){return this.columns}findColumnIndex(e){return this.columnsByIndex.findIndex(t=>e===t)}getRealColumns(){return this.columnsByIndex}traverse(e){this.columnsByIndex.forEach((t,i)=>{e(t,i)})}getDefinitions(e){var t=[];return this.columnsByIndex.forEach(i=>{(!e||e&&i.visible)&&t.push(i.getDefinition())}),t}getDefinitionTree(){var e=[];return this.columns.forEach(t=>{e.push(t.getDefinition(!0))}),e}getComponents(e){var t=[],i=e?this.columns:this.columnsByIndex;return i.forEach(n=>{t.push(n.getComponent())}),t}getWidth(){var e=0;return this.columnsByIndex.forEach(t=>{t.visible&&(e+=t.getWidth())}),e}moveColumn(e,t,i){t.element.parentNode.insertBefore(e.element,t.element),i&&t.element.parentNode.insertBefore(t.element,e.element),this.moveColumnActual(e,t,i),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}moveColumnActual(e,t,i){e.parent.isGroup?this._moveColumnInArray(e.parent.columns,e,t,i):this._moveColumnInArray(this.columns,e,t,i),this._moveColumnInArray(this.columnsByIndex,e,t,i,!0),this.rerenderColumns(!0),this.dispatch("column-moved",e,t,i),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",e.getComponent(),this.table.columnManager.getComponents())}_moveColumnInArray(e,t,i,n,r){var o=e.indexOf(t),a,l=[];o>-1&&(e.splice(o,1),a=e.indexOf(i),a>-1?n&&(a=a+1):a=o,e.splice(a,0,t),r&&(l=this.chain("column-moving-rows",[t,i,n],null,[])||[],l=l.concat(this.table.rowManager.rows),l.forEach(function(h){if(h.cells.length){var u=h.cells.splice(o,1)[0];h.cells.splice(a,0,u)}})))}scrollToColumn(e,t,i){var n=0,r=e.getLeftOffset(),o=0,a=e.getElement();return new Promise((l,h)=>{if(typeof t>"u"&&(t=this.table.options.scrollToColumnPosition),typeof i>"u"&&(i=this.table.options.scrollToColumnIfVisible),e.visible){switch(t){case"middle":case"center":o=-this.element.clientWidth/2;break;case"right":o=a.clientWidth-this.headersElement.clientWidth;break}if(!i&&r>0&&r+a.offsetWidth<this.element.clientWidth)return!1;n=r+o,n=Math.max(Math.min(n,this.table.rowManager.element.scrollWidth-this.table.rowManager.element.clientWidth),0),this.table.rowManager.scrollHorizontal(n),this.scrollHorizontal(n),l()}else console.warn("Scroll Error - Column not visible"),h("Scroll Error - Column not visible")})}generateCells(e){var t=[];return this.columnsByIndex.forEach(i=>{t.push(i.generateCell(e))}),t}getFlexBaseWidth(){var e=this.table.element.clientWidth,t=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(e-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach(function(i){var n,r,o;i.visible&&(n=i.definition.width||0,r=parseInt(i.minWidth),typeof n=="string"?n.indexOf("%")>-1?o=e/100*parseInt(n):o=parseInt(n):o=n,t+=o>r?o:r)}),t}addColumn(e,t,i){return new Promise((n,r)=>{var o=this._addColumn(e,t,i);this._reIndexColumns(),this.dispatch("column-add",e,t,i),this.layoutMode()!="fitColumns"&&o.reinitializeWidth(),this.redraw(!0),this.table.rowManager.reinitialize(),this.rerenderColumns(),n(o)})}deregisterColumn(e){var t=e.getField(),i;t&&delete this.columnsByField[t],i=this.columnsByIndex.indexOf(e),i>-1&&this.columnsByIndex.splice(i,1),i=this.columns.indexOf(e),i>-1&&this.columns.splice(i,1),this.verticalAlignHeaders(),this.redraw()}rerenderColumns(e,t){this.redrawBlock?(e===!1||e===!0&&this.redrawBlockUpdate===null)&&(this.redrawBlockUpdate=e):this.renderer.rerenderColumns(e,t)}blockRedraw(){this.redrawBlock=!0,this.redrawBlockUpdate=null}restoreRedraw(){this.redrawBlock=!1,this.verticalAlignHeaders(),this.renderer.rerenderColumns(this.redrawBlockUpdate)}redraw(e){Fe.elVisible(this.element)&&this.verticalAlignHeaders(),e&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",e)||this.layoutRefresh(e),this.dispatch("table-redraw",e),this.table.footerManager.redraw()}}class RD extends Th{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.scrollTop=0,e.scrollLeft=0,e.style.minWidth="",e.style.minHeight="",e.style.display="",e.style.visibility=""}renderRows(){var e=this.tableElement,t=!0,i=document.createDocumentFragment(),n=this.rows();n.forEach((r,o)=>{this.styleRow(r,o),r.initialize(!1,!0),r.type!=="group"&&(t=!1),i.appendChild(r.getElement())}),e.appendChild(i),n.forEach(r=>{r.rendered(),r.heightInitialized||r.calcHeight(!0)}),n.forEach(r=>{r.heightInitialized||r.setCellHeight()}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}rerenderRows(e){this.clearRows(),e&&e(),this.renderRows(),this.rows().length||this.table.rowManager.tableEmpty()}scrollToRowNearestTop(e){var t=Fe.elOffset(e.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-t)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-t))}scrollToRow(e){var t=e.getElement();this.elementVertical.scrollTop=Fe.elOffset(t).top-Fe.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}visibleRows(e){return this.rows()}}class SD extends Th{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[]}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.style.paddingTop="",e.style.paddingBottom="",e.style.minHeight="",e.style.display="",e.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}renderRows(){this._virtualRenderFill()}rerenderRows(e){for(var t=this.elementVertical.scrollTop,i=!1,n=!1,r=this.table.rowManager.scrollLeft,o=this.rows(),a=this.vDomTop;a<=this.vDomBottom;a++)if(o[a]){var l=t-o[a].getElement().offsetTop;if(n===!1||Math.abs(l)<n)n=l,i=a;else break}o.forEach(h=>{h.deinitializeHeight()}),e&&e(),this.rows().length?this._virtualRenderFill(i===!1?this.rows.length-1:i,!0,n||0):(this.clear(),this.table.rowManager.tableEmpty()),this.scrollColumns(r)}scrollColumns(e){this.table.rowManager.scrollHorizontal(e)}scrollRows(e,t){var i=e-this.vDomScrollPosTop,n=e-this.vDomScrollPosBottom,r=this.vDomWindowBuffer*2,o=this.rows();if(this.scrollTop=e,-i>r||n>r){var a=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*o.length)),this.scrollColumns(a)}else t?(i<0&&this._addTopRow(o,-i),n<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(o,-n):this.vDomScrollPosBottom=this.scrollTop)):(n>=0&&this._addBottomRow(o,n),i>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(o,i):this.vDomScrollPosTop=this.scrollTop))}resize(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}scrollToRowNearestTop(e){var t=this.rows().indexOf(e);return!(Math.abs(this.vDomTop-t)>Math.abs(this.vDomBottom-t))}scrollToRow(e){var t=this.rows().indexOf(e);t>-1&&this._virtualRenderFill(t,!0)}visibleRows(e){var t=this.elementVertical.scrollTop,i=this.elementVertical.clientHeight+t,n=!1,r=0,o=0,a=this.rows();if(e)r=this.vDomTop,o=this.vDomBottom;else for(var l=this.vDomTop;l<=this.vDomBottom;l++)if(a[l])if(n)if(i-a[l].getElement().offsetTop>=0)o=l;else break;else if(t-a[l].getElement().offsetTop>=0)r=l;else if(n=!0,i-a[l].getElement().offsetTop>=0)o=l;else break;return a.slice(r,o+1)}_virtualRenderFill(e,t,i){var n=this.tableElement,r=this.elementVertical,o=0,a=0,l=0,h=0,u=0,c=0,d=this.rows(),f=d.length,g=0,p,y,b=[],v=0,_=0,m=this.table.rowManager.fixedHeight,E=this.elementVertical.clientHeight,C=this.table.options.rowHeight,x=!0;if(e=e||0,i=i||0,!e)this.clear();else{for(;n.firstChild;)n.removeChild(n.firstChild);h=(f-e+1)*this.vDomRowHeight,h<E&&(e-=Math.ceil((E-h)/this.vDomRowHeight),e<0&&(e=0)),o=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),e),e-=o}if(f&&Fe.elVisible(this.elementVertical)){for(this.vDomTop=e,this.vDomBottom=e-1,m||this.table.options.maxHeight?(C&&(_=E/C+this.vDomWindowBuffer/C),_=Math.max(this.vDomWindowMinTotalRows,Math.ceil(_))):_=f;(_==f||a<=E+this.vDomWindowBuffer||v<this.vDomWindowMinTotalRows)&&this.vDomBottom<f-1;){for(b=[],y=document.createDocumentFragment(),c=0;c<_&&this.vDomBottom<f-1;)g=this.vDomBottom+1,p=d[g],this.styleRow(p,g),p.initialize(!1,!0),!p.heightInitialized&&!this.table.options.rowHeight&&p.clearCellHeight(),y.appendChild(p.getElement()),b.push(p),this.vDomBottom++,c++;if(!b.length)break;n.appendChild(y),b.forEach(w=>{w.rendered(),w.heightInitialized||w.calcHeight(!0)}),b.forEach(w=>{w.heightInitialized||w.setCellHeight()}),b.forEach(w=>{l=w.getHeight(),v<o?u+=l:a+=l,l>this.vDomWindowBuffer&&(this.vDomWindowBuffer=l*2),v++}),x=this.table.rowManager.adjustTableSize(),E=this.elementVertical.clientHeight,x&&(m||this.table.options.maxHeight)&&(C=a/v,_=Math.max(this.vDomWindowMinTotalRows,Math.ceil(E/C+this.vDomWindowBuffer/C)))}e?(this.vDomTopPad=t?this.vDomRowHeight*this.vDomTop+i:this.scrollTop-u,this.vDomBottomPad=this.vDomBottom==f-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-a-u,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((a+u)/v),this.vDomBottomPad=this.vDomRowHeight*(f-this.vDomBottom-1),this.vDomScrollHeight=u+a+this.vDomBottomPad-E),n.style.paddingTop=this.vDomTopPad+"px",n.style.paddingBottom=this.vDomBottomPad+"px",t&&(this.scrollTop=this.vDomTopPad+u+i-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-E:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-E),this.elementVertical.scrollWidth>this.elementVertical.clientWidth&&t&&(this.scrollTop+=this.elementVertical.offsetHeight-E),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,r.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}_addTopRow(e,t){for(var i=this.tableElement,n=[],r=0,o=this.vDomTop-1,a=0,l=!0;l;)if(this.vDomTop){let h=e[o],u,c;h&&a<this.vDomMaxRenderChain?(u=h.getHeight()||this.vDomRowHeight,c=h.initialized,t>=u?(this.styleRow(h,o),i.insertBefore(h.getElement(),i.firstChild),(!h.initialized||!h.heightInitialized)&&n.push(h),h.initialize(),c||(u=h.getElement().offsetHeight,u>this.vDomWindowBuffer&&(this.vDomWindowBuffer=u*2)),t-=u,r+=u,this.vDomTop--,o--,a++):l=!1):l=!1}else l=!1;for(let h of n)h.clearCellHeight();this._quickNormalizeRowHeight(n),r&&(this.vDomTopPad-=r,this.vDomTopPad<0&&(this.vDomTopPad=o*this.vDomRowHeight),o<1&&(this.vDomTopPad=0),i.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=r)}_removeTopRow(e,t){for(var i=[],n=0,r=0,o=!0;o;){let a=e[this.vDomTop],l;a&&r<this.vDomMaxRenderChain?(l=a.getHeight()||this.vDomRowHeight,t>=l?(this.vDomTop++,t-=l,n+=l,i.push(a),r++):o=!1):o=!1}for(let a of i){let l=a.getElement();l.parentNode&&l.parentNode.removeChild(l)}n&&(this.vDomTopPad+=n,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?n:n+this.vDomWindowBuffer)}_addBottomRow(e,t){for(var i=this.tableElement,n=[],r=0,o=this.vDomBottom+1,a=0,l=!0;l;){let h=e[o],u,c;h&&a<this.vDomMaxRenderChain?(u=h.getHeight()||this.vDomRowHeight,c=h.initialized,t>=u?(this.styleRow(h,o),i.appendChild(h.getElement()),(!h.initialized||!h.heightInitialized)&&n.push(h),h.initialize(),c||(u=h.getElement().offsetHeight,u>this.vDomWindowBuffer&&(this.vDomWindowBuffer=u*2)),t-=u,r+=u,this.vDomBottom++,o++,a++):l=!1):l=!1}for(let h of n)h.clearCellHeight();this._quickNormalizeRowHeight(n),r&&(this.vDomBottomPad-=r,(this.vDomBottomPad<0||o==e.length-1)&&(this.vDomBottomPad=0),i.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=r)}_removeBottomRow(e,t){for(var i=[],n=0,r=0,o=!0;o;){let a=e[this.vDomBottom],l;a&&r<this.vDomMaxRenderChain?(l=a.getHeight()||this.vDomRowHeight,t>=l?(this.vDomBottom--,t-=l,n+=l,i.push(a),r++):o=!1):o=!1}for(let a of i){let l=a.getElement();l.parentNode&&l.parentNode.removeChild(l)}n&&(this.vDomBottomPad+=n,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=n)}_quickNormalizeRowHeight(e){for(let t of e)t.calcHeight();for(let t of e)t.setCellHeight()}}class TD extends lt{constructor(e){super(e),this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.placeholder=null,this.placeholderContents=null,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRowsPipeline=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRenderInPosition=!1,this.dataPipeline=[],this.displayPipeline=[],this.scrollbarWidth=0,this.renderer=null}createHolderElement(){var e=document.createElement("div");return e.classList.add("tabulator-tableholder"),e.setAttribute("tabindex",0),e}createTableElement(){var e=document.createElement("div");return e.classList.add("tabulator-table"),e.setAttribute("role","rowgroup"),e}initializePlaceholder(){var e=this.table.options.placeholder;if(typeof e=="function"&&(e=e.call(this.table)),e=this.chain("placeholder",[e],e,e)||e,e){let t=document.createElement("div");if(t.classList.add("tabulator-placeholder"),typeof e=="string"){let i=document.createElement("div");i.classList.add("tabulator-placeholder-contents"),i.innerHTML=e,t.appendChild(i),this.placeholderContents=i}else typeof HTMLElement<"u"&&e instanceof HTMLElement?(t.appendChild(e),this.placeholderContents=e):(console.warn("Invalid placeholder provided, must be string or HTML Element",e),this.el=null);this.placeholder=t}}getElement(){return this.element}getTableElement(){return this.tableElement}initialize(){this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",()=>{var e=this.element.scrollLeft,t=this.scrollLeft>e,i=this.element.scrollTop,n=this.scrollTop>i;this.scrollLeft!=e&&(this.scrollLeft=e,this.dispatch("scroll-horizontal",e,t),this.dispatchExternal("scrollHorizontal",e,t),this._positionPlaceholder()),this.scrollTop!=i&&(this.scrollTop=i,this.renderer.scrollRows(i,n),this.dispatch("scroll-vertical",i,n),this.dispatchExternal("scrollVertical",i,n))})}findRow(e){if(typeof e=="object"){if(e instanceof Et)return e;if(e instanceof Rh)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return this.rows.find(i=>i.getElement()===e)||!1;if(e===null)return!1}else return typeof e>"u"?!1:this.rows.find(i=>i.data[this.table.options.index]==e)||!1;return!1}getRowFromDataObject(e){var t=this.rows.find(i=>i.data===e);return t||!1}getRowFromPosition(e){return this.getDisplayRows().find(t=>t.type==="row"&&t.getPosition()===e&&t.isDisplayed())}scrollToRow(e,t,i){return this.renderer.scrollToRowPosition(e,t,i)}setData(e,t,i){return new Promise((n,r)=>{t&&this.getDisplayRows().length?this.table.options.pagination?this._setDataActual(e,!0):this.reRenderInPosition(()=>{this._setDataActual(e)}):(this.table.options.autoColumns&&i&&this.table.initialized&&this.table.columnManager.generateColumnsFromRowData(e),this.resetScroll(),this._setDataActual(e)),n()})}_setDataActual(e,t){this.dispatchExternal("dataProcessing",e),this._wipeElements(),Array.isArray(e)?(this.dispatch("data-processing",e),e.forEach((i,n)=>{if(i&&typeof i=="object"){var r=new Et(i,this);this.rows.push(r)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",i)}),this.refreshActiveData(!1,!1,t),this.dispatch("data-processed",e),this.dispatchExternal("dataProcessed",e)):console.error(`Data Loading Error - Unable to process data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e)}_wipeElements(){this.dispatch("rows-wipe"),this.destroy(),this.adjustTableSize(),this.dispatch("rows-wiped")}destroy(){this.rows.forEach(e=>{e.wipe()}),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0}deleteRow(e,t){var i=this.rows.indexOf(e),n=this.activeRows.indexOf(e);n>-1&&this.activeRows.splice(n,1),i>-1&&this.rows.splice(i,1),this.setActiveRows(this.activeRows),this.displayRowIterator(r=>{var o=r.indexOf(e);o>-1&&r.splice(o,1)}),t||this.reRenderInPosition(),this.regenerateRowPositions(),this.dispatchExternal("rowDeleted",e.getComponent()),this.displayRowsCount||this.tableEmpty(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}addRow(e,t,i,n){var r=this.addRowActual(e,t,i,n);return r}addRows(e,t,i,n){var r=[];return new Promise((o,a)=>{t=this.findAddRowPos(t),Array.isArray(e)||(e=[e]),(typeof i>"u"&&t||typeof i<"u"&&!t)&&e.reverse(),e.forEach((l,h)=>{var u=this.addRow(l,t,i,!0);r.push(u),this.dispatch("row-added",u,l,t,i)}),this.refreshActiveData(n?"displayPipeline":!1,!1,!0),this.regenerateRowPositions(),this.displayRowsCount&&this._clearPlaceholder(),o(r)})}findAddRowPos(e){return typeof e>"u"&&(e=this.table.options.addRowPos),e==="pos"&&(e=!0),e==="bottom"&&(e=!1),e}addRowActual(e,t,i,n){var r=e instanceof Et?e:new Et(e||{},this),o=this.findAddRowPos(t),a=-1,l,h;return i||(h=this.chain("row-adding-position",[r,o],null,{index:i,top:o}),i=h.index,o=h.top),typeof i<"u"&&(i=this.findRow(i)),i=this.chain("row-adding-index",[r,i,o],null,i),i&&(a=this.rows.indexOf(i)),i&&a>-1?(l=this.activeRows.indexOf(i),this.displayRowIterator(function(u){var c=u.indexOf(i);c>-1&&u.splice(o?c:c+1,0,r)}),l>-1&&this.activeRows.splice(o?l:l+1,0,r),this.rows.splice(o?a:a+1,0,r)):o?(this.displayRowIterator(function(u){u.unshift(r)}),this.activeRows.unshift(r),this.rows.unshift(r)):(this.displayRowIterator(function(u){u.push(r)}),this.activeRows.push(r),this.rows.push(r)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",r.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),n||this.reRenderInPosition(),r}moveRow(e,t,i){this.dispatch("row-move",e,t,i),this.moveRowActual(e,t,i),this.regenerateRowPositions(),this.dispatch("row-moved",e,t,i),this.dispatchExternal("rowMoved",e.getComponent())}moveRowActual(e,t,i){this.moveRowInArray(this.rows,e,t,i),this.moveRowInArray(this.activeRows,e,t,i),this.displayRowIterator(n=>{this.moveRowInArray(n,e,t,i)}),this.dispatch("row-moving",e,t,i)}moveRowInArray(e,t,i,n){var r,o,a,l;if(t!==i&&(r=e.indexOf(t),r>-1&&(e.splice(r,1),o=e.indexOf(i),o>-1?n?e.splice(o+1,0,t):e.splice(o,0,t):e.splice(r,0,t)),e===this.getDisplayRows())){a=r<o?r:o,l=o>r?o:r+1;for(let h=a;h<=l;h++)e[h]&&this.styleRow(e[h],h)}}clearData(){this.setData([])}getRowIndex(e){return this.findRowIndex(e,this.rows)}getDisplayRowIndex(e){var t=this.getDisplayRows().indexOf(e);return t>-1?t:!1}nextDisplayRow(e,t){var i=this.getDisplayRowIndex(e),n=!1;return i!==!1&&i<this.displayRowsCount-1&&(n=this.getDisplayRows()[i+1]),n&&(!(n instanceof Et)||n.type!="row")?this.nextDisplayRow(n,t):n}prevDisplayRow(e,t){var i=this.getDisplayRowIndex(e),n=!1;return i&&(n=this.getDisplayRows()[i-1]),t&&n&&(!(n instanceof Et)||n.type!="row")?this.prevDisplayRow(n,t):n}findRowIndex(e,t){var i;return e=this.findRow(e),e&&(i=t.indexOf(e),i>-1)?i:!1}getData(e,t){var i=[],n=this.getRows(e);return n.forEach(function(r){r.type=="row"&&i.push(r.getData(t||"data"))}),i}getComponents(e){var t=[],i=this.getRows(e);return i.forEach(function(n){t.push(n.getComponent())}),t}getDataCount(e){var t=this.getRows(e);return t.length}scrollHorizontal(e){this.scrollLeft=e,this.element.scrollLeft=e,this.dispatch("scroll-horizontal",e)}registerDataPipelineHandler(e,t){typeof t<"u"?(this.dataPipeline.push({handler:e,priority:t}),this.dataPipeline.sort((i,n)=>i.priority-n.priority)):console.error("Data pipeline handlers must have a priority in order to be registered")}registerDisplayPipelineHandler(e,t){typeof t<"u"?(this.displayPipeline.push({handler:e,priority:t}),this.displayPipeline.sort((i,n)=>i.priority-n.priority)):console.error("Display pipeline handlers must have a priority in order to be registered")}refreshActiveData(e,t,i){var n=this.table,r="",o=0,a=["all","dataPipeline","display","displayPipeline","end"];if(!this.table.destroyed){if(typeof e=="function")if(o=this.dataPipeline.findIndex(l=>l.handler===e),o>-1)r="dataPipeline",t&&(o==this.dataPipeline.length-1?r="display":o++);else if(o=this.displayPipeline.findIndex(l=>l.handler===e),o>-1)r="displayPipeline",t&&(o==this.displayPipeline.length-1?r="end":o++);else{console.error("Unable to refresh data, invalid handler provided",e);return}else r=e||"all",o=0;if(this.redrawBlock){(!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===r&&o<this.redrawBlockRestoreConfig.index||a.indexOf(r)<a.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:e,skipStage:t,renderInPosition:i,stage:r,index:o});return}else Fe.elVisible(this.element)?i?this.reRenderInPosition(this.refreshPipelines.bind(this,e,r,o,i)):(this.refreshPipelines(e,r,o,i),e||this.table.columnManager.renderer.renderColumns(),this.renderTable(),n.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(e,r,o,i),this.dispatch("data-refreshed")}}refreshPipelines(e,t,i,n){switch(this.dispatch("data-refreshing"),(!e||!this.activeRowsPipeline[0])&&(this.activeRowsPipeline[0]=this.rows.slice(0)),t){case"all":case"dataPipeline":for(let r=i;r<this.dataPipeline.length;r++){let o=this.dataPipeline[r].handler(this.activeRowsPipeline[r].slice(0));this.activeRowsPipeline[r+1]=o||this.activeRowsPipeline[r].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);case"display":i=0,this.resetDisplayRows();case"displayPipeline":for(let r=i;r<this.displayPipeline.length;r++){let o=this.displayPipeline[r].handler((r?this.getDisplayRows(r-1):this.activeRows).slice(0),n);this.setDisplayRows(o||this.getDisplayRows(r-1).slice(0),r)}case"end":this.regenerateRowPositions()}this.getDisplayRows().length&&this._clearPlaceholder()}regenerateRowPositions(){var e=this.getDisplayRows(),t=1;e.forEach(i=>{i.type==="row"&&(i.setPosition(t),t++)})}setActiveRows(e){this.activeRows=this.activeRows=Object.assign([],e),this.activeRowsCount=this.activeRows.length}resetDisplayRows(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}setDisplayRows(e,t){this.displayRows[t]=e,t==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length)}getDisplayRows(e){return typeof e>"u"?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[e]||[]}getVisibleRows(e,t){var i=Object.assign([],this.renderer.visibleRows(!t));return e&&(i=this.chain("rows-visible",[t],i,i)),i}displayRowIterator(e){this.activeRowsPipeline.forEach(e),this.displayRows.forEach(e),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}getRows(e){var t=[];switch(e){case"active":t=this.activeRows;break;case"display":t=this.table.rowManager.getDisplayRows();break;case"visible":t=this.getVisibleRows(!1,!0);break;default:t=this.chain("rows-retrieve",e,null,this.rows)||this.rows}return t}reRenderInPosition(e){this.redrawBlock?e?e():this.redrawBlockRenderInPosition=!0:(this.dispatchExternal("renderStarted"),this.renderer.rerenderRows(e),this.fixedHeight||this.adjustTableSize(),this.scrollBarCheck(),this.dispatchExternal("renderComplete"))}scrollBarCheck(){var e=0;this.element.scrollHeight>this.element.clientHeight&&(e=this.element.offsetWidth-this.element.clientWidth),e!==this.scrollbarWidth&&(this.scrollbarWidth=e,this.dispatch("scrollbar-vertical",e))}initializeRenderer(){var e,t={virtual:SD,basic:RD};typeof this.table.options.renderVertical=="string"?e=t[this.table.options.renderVertical]:e=this.table.options.renderVertical,e?(this.renderMode=this.table.options.renderVertical,this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize(),(this.table.element.clientHeight||this.table.options.height)&&!(this.table.options.minHeight&&this.table.options.maxHeight)?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",this.table.options.renderVertical)}getRenderMode(){return this.renderMode}renderTable(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.fixedHeight||this.adjustTableSize(),this.layoutRefresh(!0))):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.scrollBarCheck(),this.dispatchExternal("renderComplete")}renderEmptyScroll(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}_clearTable(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}tableEmpty(){this.renderEmptyScroll(),this._showPlaceholder()}checkPlaceholder(){this.displayRowsCount?this._clearPlaceholder():this.tableEmpty()}_showPlaceholder(){this.placeholder&&(this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.initializePlaceholder(),this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder(),this.adjustTableSize())}_clearPlaceholder(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.tableElement.style.minWidth="",this.tableElement.style.display=""}_positionPlaceholder(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}styleRow(e,t){var i=e.getElement();t%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}normalizeHeight(e){this.activeRows.forEach(function(t){t.normalizeHeight(e)})}adjustTableSize(){let e=this.element.clientHeight,t,i=!1;if(this.renderer.verticalFillMode==="fill"){let n=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));if(this.fixedHeight){t=isNaN(this.table.options.minHeight)?this.table.options.minHeight:this.table.options.minHeight+"px";const r="calc(100% - "+n+"px)";this.element.style.minHeight=t||"calc(100% - "+n+"px)",this.element.style.height=r,this.element.style.maxHeight=r}else this.element.style.height="",this.element.style.height=this.table.element.clientHeight-n+"px",this.element.scrollTop=this.scrollTop;this.renderer.resize(),!this.fixedHeight&&e!=this.element.clientHeight&&(i=!0,this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw()),this.scrollBarCheck()}return this._positionPlaceholder(),i}reinitialize(){this.rows.forEach(function(e){e.reinitialize(!0)})}blockRedraw(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}restoreRedraw(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}redraw(e){this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,e?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(this.scrollLeft))}resetScroll(){if(this.element.scrollLeft=0,this.element.scrollTop=0,this.table.browser==="ie"){var e=document.createEvent("Event");e.initEvent("scroll",!1,!0),this.element.dispatchEvent(e)}else this.element.dispatchEvent(new Event("scroll"))}}class MD extends lt{constructor(e){super(e),this.active=!1,this.element=this.createElement(),this.containerElement=this.createContainerElement(),this.external=!1}initialize(){this.initializeElement()}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer"),e}createContainerElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer-contents"),this.element.appendChild(e),e}initializeElement(){if(this.table.options.footerElement)switch(typeof this.table.options.footerElement){case"string":this.table.options.footerElement[0]==="<"?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement));break;default:this.element=this.table.options.footerElement;break}}getElement(){return this.element}append(e){this.activate(),this.containerElement.appendChild(e),this.table.rowManager.adjustTableSize()}prepend(e){this.activate(),this.element.insertBefore(e,this.element.firstChild),this.table.rowManager.adjustTableSize()}remove(e){e.parentNode.removeChild(e),this.deactivate()}deactivate(e){(!this.element.firstChild||e)&&(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}activate(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}redraw(){this.dispatch("footer-redraw")}}class LD extends lt{constructor(e){super(e),this.el=null,this.abortClasses=["tabulator-headers","tabulator-table"],this.previousTargets={},this.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","mouseup","mousedown","touchstart","touchend"],this.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},this.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},this.pseudoTracking=!1}initialize(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}buildListenerMap(){var e={};this.listeners.forEach(t=>{e[t]={handler:null,components:[]}}),this.listeners=e}bindPseudoEvents(){Object.keys(this.pseudoTrackers).forEach(e=>{this.pseudoTrackers[e].subscriber=this.pseudoMouseEnter.bind(this,e),this.subscribe(e+"-mouseover",this.pseudoTrackers[e].subscriber)}),this.pseudoTracking=!0}pseudoMouseEnter(e,t,i){this.pseudoTrackers[e].target!==i&&(this.pseudoTrackers[e].target&&this.dispatch(e+"-mouseleave",t,this.pseudoTrackers[e].target),this.pseudoMouseLeave(e,t),this.pseudoTrackers[e].target=i,this.dispatch(e+"-mouseenter",t,i))}pseudoMouseLeave(e,t){var i=Object.keys(this.pseudoTrackers),n={row:["cell"],cell:["row"]};i=i.filter(r=>{var o=n[e];return r!==e&&(!o||o&&!o.includes(r))}),i.forEach(r=>{var o=this.pseudoTrackers[r].target;this.pseudoTrackers[r].target&&(this.dispatch(r+"-mouseleave",t,o),this.pseudoTrackers[r].target=null)})}bindSubscriptionWatchers(){var e=Object.keys(this.listeners),t=Object.values(this.componentMap);for(let i of t)for(let n of e){let r=i+"-"+n;this.subscriptionChange(r,this.subscriptionChanged.bind(this,i,n))}this.subscribe("table-destroy",this.clearWatchers.bind(this))}subscriptionChanged(e,t,i){var n=this.listeners[t].components,r=n.indexOf(e),o=!1;i?r===-1&&(n.push(e),o=!0):this.subscribed(e+"-"+t)||r>-1&&(n.splice(r,1),o=!0),(t==="mouseenter"||t==="mouseleave")&&!this.pseudoTracking&&this.bindPseudoEvents(),o&&this.updateEventListeners()}updateEventListeners(){for(let e in this.listeners){let t=this.listeners[e];t.components.length?t.handler||(t.handler=this.track.bind(this,e),this.el.addEventListener(e,t.handler)):t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}track(e,t){var i=t.composedPath&&t.composedPath()||t.path,n=this.findTargets(i);n=this.bindComponents(e,n),this.triggerEvents(e,t,n),this.pseudoTracking&&(e=="mouseover"||e=="mouseleave")&&!Object.keys(n).length&&this.pseudoMouseLeave("none",t)}findTargets(e){var t={};let i=Object.keys(this.componentMap);for(let n of e){let r=n.classList?[...n.classList]:[];if(r.filter(l=>this.abortClasses.includes(l)).length)break;let a=r.filter(l=>i.includes(l));for(let l of a)t[this.componentMap[l]]||(t[this.componentMap[l]]=n)}return t.group&&t.group===t.row&&delete t.row,t}bindComponents(e,t){var i=Object.keys(t).reverse(),n=this.listeners[e],r={},o={};for(let a of i){let l,h=t[a],u=this.previousTargets[a];if(u&&u.target===h)l=u.component;else switch(a){case"row":case"group":(n.components.includes("row")||n.components.includes("cell")||n.components.includes("group"))&&(l=this.table.rowManager.getVisibleRows(!0).find(d=>d.getElement()===h),t.row&&t.row.parentNode&&t.row.parentNode.closest(".tabulator-row")&&(t[a]=!1));break;case"column":n.components.includes("column")&&(l=this.table.columnManager.findColumn(h));break;case"cell":n.components.includes("cell")&&(r.row instanceof Et?l=r.row.findCell(h):t.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"));break}l&&(r[a]=l,o[a]={target:h,component:l})}return this.previousTargets=o,r}triggerEvents(e,t,i){var n=this.listeners[e];for(let r in i)i[r]&&n.components.includes(r)&&this.dispatch(r+"-"+e,t,i[r])}clearWatchers(){for(let e in this.listeners){let t=this.listeners[e];t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}}class AD{constructor(e){this.table=e,this.bindings={}}bind(e,t,i){this.bindings[e]||(this.bindings[e]={}),this.bindings[e][t]?console.warn("Unable to bind component handler, a matching function name is already bound",e,t,i):this.bindings[e][t]=i}handle(e,t,i){if(this.bindings[e]&&this.bindings[e][i]&&typeof this.bindings[e][i].bind=="function")return this.bindings[e][i].bind(null,t);i!=="then"&&typeof i=="string"&&!i.startsWith("_")&&this.table.options.debugInvalidComponentFuncs&&console.error("The "+e+" component does not have a "+i+" function, have you checked that you have the correct Tabulator module installed?")}}class PD extends lt{constructor(e){super(e),this.requestOrder=0,this.loading=!1}initialize(){}load(e,t,i,n,r,o){var a=++this.requestOrder;if(this.table.destroyed)return Promise.resolve();if(this.dispatchExternal("dataLoading",e),e&&(e.indexOf("{")==0||e.indexOf("[")==0)&&(e=JSON.parse(e)),this.confirm("data-loading",[e,t,i,r])){this.loading=!0,r||this.alertLoader(),t=this.chain("data-params",[e,i,r],t||{},t||{}),t=this.mapParams(t,this.table.options.dataSendParams);var l=this.chain("data-load",[e,t,i,r],!1,Promise.resolve([]));return l.then(h=>{if(this.table.destroyed)console.warn("Data Load Response Blocked - Table has been destroyed");else{!Array.isArray(h)&&typeof h=="object"&&(h=this.mapParams(h,this.objectInvert(this.table.options.dataReceiveParams)));var u=this.chain("data-loaded",[h],null,h);a==this.requestOrder?(this.clearAlert(),u!==!1&&(this.dispatchExternal("dataLoaded",u),this.table.rowManager.setData(u,n,typeof o>"u"?!n:o))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")}}).catch(h=>{console.error("Data Load Error: ",h),this.dispatchExternal("dataLoadError",h),r||this.alertError(),setTimeout(()=>{this.clearAlert()},this.table.options.dataLoaderErrorTimeout)}).finally(()=>{this.loading=!1})}else return this.dispatchExternal("dataLoaded",e),e||(e=[]),this.table.rowManager.setData(e,n,typeof o>"u"?!n:o),Promise.resolve()}mapParams(e,t){var i={};for(let n in e)i[t.hasOwnProperty(n)?t[n]:n]=e[n];return i}objectInvert(e){var t={};for(let i in e)t[e[i]]=i;return t}blockActiveLoad(){this.requestOrder++}alertLoader(){var e=typeof this.table.options.dataLoader=="function"?this.table.options.dataLoader():this.table.options.dataLoader;e&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}alertError(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}clearAlert(){this.table.alertManager.clear()}}class ID{constructor(e,t,i){this.table=e,this.events={},this.optionsList=t||{},this.subscriptionNotifiers={},this.dispatch=i?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=i}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var i;if(this.events[e])if(t)if(i=this.events[e].findIndex(n=>n===t),i>-1)this.events[e].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}else delete this.events[e];else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_notifySubscriptionChange(e,t){var i=this.subscriptionNotifiers[e];i&&i.forEach(n=>{n(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift(),i;return this.events[t]&&this.events[t].forEach((n,r)=>{let o=n.apply(this.table,e);r||(i=o)}),i}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="ExternalEvent:"+e[0],(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}}class OD{constructor(e){this.events={},this.subscriptionNotifiers={},this.dispatch=e?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=e?this._debugChain.bind(this):this._chain.bind(this),this.confirm=e?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=e}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t,i=1e4){this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,priority:i}),this.events[e].sort((n,r)=>n.priority-r.priority),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var i;if(this.events[e]){if(t)if(i=this.events[e].findIndex(n=>n.callback===t),i>-1)this.events[e].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}}else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_chain(e,t,i,n){var r=i;return Array.isArray(t)||(t=[t]),this.subscribed(e)?(this.events[e].forEach((o,a)=>{r=o.callback.apply(this,t.concat([r]))}),r):typeof n=="function"?n():n}_confirm(e,t){var i=!1;return Array.isArray(t)||(t=[t]),this.subscribed(e)&&this.events[e].forEach((n,r)=>{n.callback.apply(this,t)&&(i=!0)}),i}_notifySubscriptionChange(e,t){var i=this.subscriptionNotifiers[e];i&&i.forEach(n=>{n(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift();this.events[t]&&this.events[t].forEach(i=>{i.callback.apply(this,e)})}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}_debugChain(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._chain(...arguments)}_debugConfirm(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._confirm(...arguments)}}class FD extends lt{constructor(e){super(e)}_warnUser(){this.options("debugDeprecation")&&console.warn(...arguments)}check(e,t,i){var n="";return typeof this.options(e)<"u"?(n="Deprecated Setup Option - Use of the %c"+e+"%c option is now deprecated",t?(n=n+", Please use the %c"+t+"%c option instead",this._warnUser(n,"font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;"),i&&(this.table.options[t]=this.table.options[e])):this._warnUser(n,"font-weight: bold;","font-weight: normal;"),!1):!0}checkMsg(e,t){return typeof this.options(e)<"u"?(this._warnUser("%cDeprecated Setup Option - Use of the %c"+e+" %c option is now deprecated, "+t,"font-weight: normal;","font-weight: bold;","font-weight: normal;"),!1):!0}msg(e){this._warnUser(e)}}class DD extends lt{constructor(e){super(e),this.deps={},this.props={}}initialize(){this.deps=Object.assign({},this.options("dependencies"))}lookup(e,t,i){if(Array.isArray(e)){for(const r of e){var n=this.lookup(r,t,!0);if(n)break}if(n)return n;this.error(e)}else return t?this.lookupProp(e,t,i):this.lookupKey(e,i)}lookupProp(e,t,i){var n;if(this.props[e]&&this.props[e][t])return this.props[e][t];if(n=this.lookupKey(e,i),n)return this.props[e]||(this.props[e]={}),this.props[e][t]=n[t]||n,this.props[e][t]}lookupKey(e,t){var i;return this.deps[e]?i=this.deps[e]:window[e]?(this.deps[e]=window[e],i=this.deps[e]):t||this.error(e),i}error(e){console.error("Unable to find dependency",e,"Please check documentation and ensure you have imported the required library into your project")}}function kD(s,e){e&&this.table.columnManager.renderer.reinitializeColumnWidths(s),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function am(s,e){s.forEach(function(t){t.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function ND(s,e){var t=0,i=this.table.rowManager.element.clientWidth,n=0,r=!1;s.forEach((o,a)=>{o.widthFixed||o.reinitializeWidth(),(this.table.options.responsiveLayout?o.modules.responsive.visible:o.visible)&&(r=o),o.visible&&(t+=o.getWidth())}),r?(n=i-t+r.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(r.setWidth(0),this.table.modules.responsiveLayout.update()),n>0?r.setWidth(n):r.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function zD(s,e){var t=this.table.rowManager.element.getBoundingClientRect().width,i=0,n=0,r=0,o=0,a=[],l=[],h=0,u=0,c=0;function d(g){var p;return typeof g=="string"?g.indexOf("%")>-1?p=t/100*parseInt(g):p=parseInt(g):p=g,p}function f(g,p,y,b){var v=[],_=0,m=0,E=0,C=r,x=0,w=0,R=[];function I(A){return y*(A.column.definition.widthGrow||1)}function T(A){return d(A.width)-y*(A.column.definition.widthShrink||0)}return g.forEach(function(A,F){var S=b?T(A):I(A);A.column.minWidth>=S?v.push(A):A.column.maxWidth&&A.column.maxWidth<S?(A.width=A.column.maxWidth,p-=A.column.maxWidth,C-=b?A.column.definition.widthShrink||1:A.column.definition.widthGrow||1,C&&(y=Math.floor(p/C))):(R.push(A),w+=b?A.column.definition.widthShrink||1:A.column.definition.widthGrow||1)}),v.length?(v.forEach(function(A){_+=b?A.width-A.column.minWidth:A.column.minWidth,A.width=A.column.minWidth}),m=p-_,E=w?Math.floor(m/w):m,x=f(R,m,E,b)):(x=w?p-Math.floor(p/w)*w:p,R.forEach(function(A){A.width=b?T(A):I(A)})),x}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(t-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),s.forEach(function(g){var p,y,b;g.visible&&(p=g.definition.width,y=parseInt(g.minWidth),p?(b=d(p),i+=b>y?b:y,g.definition.widthShrink&&(l.push({column:g,width:b>y?b:y}),h+=g.definition.widthShrink)):(a.push({column:g,width:0}),r+=g.definition.widthGrow||1))}),n=t-i,o=Math.floor(n/r),c=f(a,n,o,!1),a.length&&c>0&&(a[a.length-1].width+=c),a.forEach(function(g){n-=g.width}),u=Math.abs(c)+n,u>0&&h&&(c=f(l,u,Math.floor(u/h),!0)),c&&l.length&&(l[l.length-1].width-=c),a.forEach(function(g){g.column.setWidth(g.width)}),l.forEach(function(g){g.column.setWidth(g.width)})}var GD={fitData:kD,fitDataFill:am,fitDataTable:am,fitDataStretch:ND,fitColumns:zD};const dr=class dr extends pe{constructor(e){super(e,"layout"),this.mode=null,this.registerTableOption("layout","fitData"),this.registerTableOption("layoutColumnsOnNewData",!1),this.registerColumnOption("widthGrow"),this.registerColumnOption("widthShrink")}initialize(){var e=this.table.options.layout;dr.modes[e]?this.mode=e:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+e),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode),this.subscribe("column-init",this.initializeColumn.bind(this))}initializeColumn(e){e.definition.widthGrow&&(e.definition.widthGrow=Number(e.definition.widthGrow)),e.definition.widthShrink&&(e.definition.widthShrink=Number(e.definition.widthShrink))}getMode(){return this.mode}layout(e){var t=this.table.columnManager.columnsByIndex.find(i=>i.definition.variableHeight||i.definition.formatter==="textarea");this.dispatch("layout-refreshing"),dr.modes[this.mode].call(this,this.table.columnManager.columnsByIndex,e),t&&this.table.rowManager.normalizeHeight(!0),this.dispatch("layout-refreshed")}};U(dr,"moduleName","layout"),U(dr,"modes",GD);let Ic=dr;var HD={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};const Co=class Co extends pe{constructor(e){super(e),this.locale="default",this.lang=!1,this.bindings={},this.langList={},this.registerTableOption("locale",!1),this.registerTableOption("langs",{})}initialize(){this.langList=Fe.deepClone(Co.langs),this.table.options.columnDefaults.headerFilterPlaceholder!==!1&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);for(let e in this.table.options.langs)this.installLang(e,this.table.options.langs[e]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}setHeaderFilterPlaceholder(e){this.langList.default.headerFilters.default=e}installLang(e,t){this.langList[e]?this._setLangProp(this.langList[e],t):this.langList[e]=t}_setLangProp(e,t){for(let i in t)e[i]&&typeof e[i]=="object"?this._setLangProp(e[i],t[i]):e[i]=t[i]}setLocale(e){e=e||"default";function t(i,n){for(var r in i)typeof i[r]=="object"?(n[r]||(n[r]={}),t(i[r],n[r])):n[r]=i[r]}if(e===!0&&navigator.language&&(e=navigator.language.toLowerCase()),e&&!this.langList[e]){let i=e.split("-")[0];this.langList[i]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",e,i),e=i):(console.warn("Localization Error - Matching locale not found, using default: ",e),e="default")}this.locale=e,this.lang=Fe.deepClone(this.langList.default||{}),e!="default"&&t(this.langList[e],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}getLocale(e){return this.locale}getLang(e){return e?this.langList[e]:this.lang}getText(e,t){var i=t?e+"|"+t:e,n=i.split("|"),r=this._getLangElement(n,this.locale);return r||""}_getLangElement(e,t){var i=this.lang;return e.forEach(function(n){var r;i&&(r=i[n],typeof r<"u"?i=r:i=!1)}),i}bind(e,t){this.bindings[e]||(this.bindings[e]=[]),this.bindings[e].push(t),t(this.getText(e),this.lang)}_executeBindings(){for(let e in this.bindings)this.bindings[e].forEach(t=>{t(this.getText(e),this.lang)})}};U(Co,"moduleName","localize"),U(Co,"langs",HD);let Oc=Co;class qv extends pe{constructor(e){super(e)}initialize(){this.registerTableFunction("tableComms",this.receive.bind(this))}getConnections(e){var t=[],i;return i=this.table.constructor.registry.lookupTable(e),i.forEach(n=>{this.table!==n&&t.push(n)}),t}send(e,t,i,n){var r=this.getConnections(e);r.forEach(o=>{o.tableComms(this.table.element,t,i,n)}),!r.length&&e&&console.warn("Table Connection Error - No tables matching selector found",e)}receive(e,t,i,n){if(this.table.modExists(t))return this.table.modules[t].commsReceived(e,i,n);console.warn("Inter-table Comms Error - no such module:",t)}}U(qv,"moduleName","comms");var BD=Object.freeze({__proto__:null,CommsModule:qv,LayoutModule:Ic,LocalizeModule:Oc});const Ut=class Ut{static findTable(e){var t=Ut.registry.lookupTable(e,!0);return Array.isArray(t)&&!t.length?!1:t}};U(Ut,"registry",{tables:[],register(e){Ut.registry.tables.push(e)},deregister(e){var t=Ut.registry.tables.indexOf(e);t>-1&&Ut.registry.tables.splice(t,1)},lookupTable(e,t){var i=[],n,r;if(typeof e=="string"){if(n=document.querySelectorAll(e),n.length)for(var o=0;o<n.length;o++)r=Ut.registry.matchElement(n[o]),r&&i.push(r)}else typeof HTMLElement<"u"&&e instanceof HTMLElement||e instanceof Ut?(r=Ut.registry.matchElement(e),r&&i.push(r)):Array.isArray(e)?e.forEach(function(a){i=i.concat(Ut.registry.lookupTable(a))}):t||console.warn("Table Connection Error - Invalid Selector",e);return i},matchElement(e){return Ut.registry.tables.find(function(t){return e instanceof Ut?t===e:t.element===e})}});let Fc=Ut;const Oe=class Oe extends Fc{constructor(){super()}static initializeModuleBinder(e){Oe.modulesRegistered||(Oe.modulesRegistered=!0,Oe._registerModules(BD,!0),e&&Oe._registerModules(e))}static _extendModule(e,t,i){if(Oe.moduleBindings[e]){var n=Oe.moduleBindings[e][t];if(n)if(typeof i=="object")for(let r in i)n[r]=i[r];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",t)}else console.warn("Module Error - module does not exist:",e)}static _registerModules(e,t){var i=Object.values(e);t&&i.forEach(n=>{n.prototype.moduleCore=!0}),Oe._registerModule(i)}static _registerModule(e){Array.isArray(e)||(e=[e]),e.forEach(t=>{Oe._registerModuleBinding(t),Oe._registerModuleExtensions(t)})}static _registerModuleBinding(e){e.moduleName?Oe.moduleBindings[e.moduleName]=e:console.error("Unable to bind module, no moduleName defined",e.moduleName)}static _registerModuleExtensions(e){var t=e.moduleExtensions;if(e.moduleExtensions)for(let i in t){let n=t[i];if(Oe.moduleBindings[i])for(let r in n)Oe._extendModule(i,r,n[r]);else{Oe.moduleExtensions[i]||(Oe.moduleExtensions[i]={});for(let r in n)Oe.moduleExtensions[i][r]||(Oe.moduleExtensions[i][r]={}),Object.assign(Oe.moduleExtensions[i][r],n[r])}}Oe._extendModuleFromQueue(e)}static _extendModuleFromQueue(e){var t=Oe.moduleExtensions[e.moduleName];if(t)for(let i in t)Oe._extendModule(e.moduleName,i,t[i])}_bindModules(){var e=[],t=[],i=[];this.modules={};for(var n in Oe.moduleBindings){let r=Oe.moduleBindings[n],o=new r(this);this.modules[n]=o,r.prototype.moduleCore?this.modulesCore.push(o):r.moduleInitOrder?r.moduleInitOrder<0?e.push(o):t.push(o):i.push(o)}e.sort((r,o)=>r.moduleInitOrder>o.moduleInitOrder?1:-1),t.sort((r,o)=>r.moduleInitOrder>o.moduleInitOrder?1:-1),this.modulesRegular=e.concat(i.concat(t))}};U(Oe,"moduleBindings",{}),U(Oe,"moduleExtensions",{}),U(Oe,"modulesRegistered",!1),U(Oe,"defaultModules",!1);let Dc=Oe;class VD extends lt{constructor(e){super(e),this.element=this._createAlertElement(),this.msgElement=this._createMsgElement(),this.type=null,this.element.appendChild(this.msgElement)}_createAlertElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert"),e}_createMsgElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert-msg"),e.setAttribute("role","alert"),e}_typeClass(){return"tabulator-alert-state-"+this.type}alert(e,t="msg"){if(e){for(this.clear(),this.dispatch("alert-show",t),this.type=t;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),typeof e=="function"&&(e=e()),e instanceof HTMLElement?this.msgElement.appendChild(e):this.msgElement.innerHTML=e,this.table.element.appendChild(this.element)}}clear(){this.dispatch("alert-hide",this.type),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}const ln=class ln extends Dc{static extendModule(){ln.initializeModuleBinder(),ln._extendModule(...arguments)}static registerModule(){ln.initializeModuleBinder(),ln._registerModule(...arguments)}constructor(e,t,i){super(),ln.initializeModuleBinder(i),this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new AD(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.deprecationAdvisor=new FD(this),this.optionsList=new Zv(this,"table constructor"),this.dependencyRegistry=new DD(this),this.initialized=!1,this.destroyed=!1,this.initializeElement(e)&&(this.initializeCoreSystems(t),setTimeout(()=>{this._create()})),this.constructor.registry.register(this)}initializeElement(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement?(this.element=e,!0):typeof e=="string"?(this.element=document.querySelector(e),this.element?!0:(console.error("Tabulator Creation Error - no element found matching selector: ",e),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",e),!1)}initializeCoreSystems(e){this.columnManager=new xD(this),this.rowManager=new TD(this),this.footerManager=new MD(this),this.dataLoader=new PD(this),this.alertManager=new VD(this),this._bindModules(),this.options=this.optionsList.generate(ln.defaultOptions,e),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new ID(this,this.options,this.options.debugEventsExternal),this.eventBus=new OD(this.options.debugEventsInternal),this.interactionMonitor=new LD(this),this.dataLoader.initialize(),this.footerManager.initialize(),this.dependencyRegistry.initialize()}_mapDeprecatedFunctionality(){}_clearSelection(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}_create(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this.initialized=!0,this._loadInitialData().finally(()=>{this.eventBus.dispatch("table-initialized"),this.externalEvents.dispatch("tableBuilt")})}_rtlCheck(){var e=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if(e.direction!=="rtl")break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}_clearObjectPointers(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}_buildElement(){var e=this.element,t=this.options,i;if(e.tagName==="TABLE"){this.originalElement=this.element,i=document.createElement("div");var n=e.attributes;for(var r in n)typeof n[r]=="object"&&i.setAttribute(n[r].name,n[r].value);e.parentNode.replaceChild(i,e),this.element=e=i}for(e.classList.add("tabulator"),e.setAttribute("role","grid");e.firstChild;)e.removeChild(e.firstChild);t.height&&(t.height=isNaN(t.height)?t.height:t.height+"px",e.style.height=t.height),t.minHeight!==!1&&(t.minHeight=isNaN(t.minHeight)?t.minHeight:t.minHeight+"px",e.style.minHeight=t.minHeight),t.maxHeight!==!1&&(t.maxHeight=isNaN(t.maxHeight)?t.maxHeight:t.maxHeight+"px",e.style.maxHeight=t.maxHeight)}_initializeTable(){var e=this.element,t=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach(i=>{i.initialize()}),e.appendChild(this.columnManager.getElement()),e.appendChild(this.rowManager.getElement()),t.footerElement&&this.footerManager.activate(),t.autoColumns&&t.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach(i=>{i.initialize()}),this.columnManager.setColumns(t.columns),this.eventBus.dispatch("table-built")}_loadInitialData(){return this.dataLoader.load(this.options.data).finally(()=>{this.columnManager.verticalAlignHeaders()})}destroy(){var e=this.element;for(this.destroyed=!0,this.constructor.registry.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.destroy();e.firstChild;)e.removeChild(e.firstChild);e.classList.remove("tabulator"),this.externalEvents.dispatch("tableDestroyed")}_detectBrowser(){var e=navigator.userAgent||navigator.vendor||window.opera;e.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):e.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):e.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):e.indexOf("Mac OS")>-1?(this.browser="safari",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.slice(0,4))}initGuard(e,t){var i,n;return this.options.debugInitialization&&!this.initialized&&(e||(i=new Error().stack.split(`
`),n=i[0]=="Error"?i[2]:i[1],n[0]==" "?e=n.trim().split(" ")[1].split(".")[1]:e=n.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+e+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(t?" "+t:""))),this.initialized}blockRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-blocking"),this.rowManager.blockRedraw(),this.columnManager.blockRedraw(),this.eventBus.dispatch("redraw-blocked")}restoreRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-restoring"),this.rowManager.restoreRedraw(),this.columnManager.restoreRedraw(),this.eventBus.dispatch("redraw-restored")}setData(e,t,i){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(e,t,i,!1)}clearData(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}getData(e){return this.rowManager.getData(e)}getDataCount(e){return this.rowManager.getDataCount(e)}replaceData(e,t,i){return this.initGuard(),this.dataLoader.load(e,t,i,!0,!0)}updateData(e){var t=0;return this.initGuard(),new Promise((i,n)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(r=>{var o=this.rowManager.findRow(r[this.options.index]);o?(t++,o.updateData(r).then(()=>{t--,t||i()}).catch(a=>{n("Update Error - Unable to update row",r,a)})):n("Update Error - Unable to find row",r)}):(console.warn("Update Error - No data provided"),n("Update Error - No data provided"))})}addData(e,t,i){return this.initGuard(),new Promise((n,r)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e?this.rowManager.addRows(e,t,i).then(o=>{var a=[];o.forEach(function(l){a.push(l.getComponent())}),n(a)}):(console.warn("Update Error - No data provided"),r("Update Error - No data provided"))})}updateOrAddData(e){var t=[],i=0;return this.initGuard(),new Promise((n,r)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(o=>{var a=this.rowManager.findRow(o[this.options.index]);i++,a?a.updateData(o).then(()=>{i--,t.push(a.getComponent()),i||n(t)}):this.rowManager.addRows(o).then(l=>{i--,t.push(l[0].getComponent()),i||n(t)})}):(console.warn("Update Error - No data provided"),r("Update Error - No data provided"))})}getRow(e){var t=this.rowManager.findRow(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}getRowFromPosition(e){var t=this.rowManager.getRowFromPosition(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}deleteRow(e){var t=[];this.initGuard(),Array.isArray(e)||(e=[e]);for(let i of e){let n=this.rowManager.findRow(i,!0);if(n)t.push(n);else return console.error("Delete Error - No matching row found:",i),Promise.reject("Delete Error - No matching row found")}return t.sort((i,n)=>this.rowManager.rows.indexOf(i)>this.rowManager.rows.indexOf(n)?1:-1),t.forEach(i=>{i.delete()}),this.rowManager.reRenderInPosition(),Promise.resolve()}addRow(e,t,i){return this.initGuard(),typeof e=="string"&&(e=JSON.parse(e)),this.rowManager.addRows(e,t,i,!0).then(n=>n[0].getComponent())}updateOrAddRow(e,t){var i=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),i?i.updateData(t).then(()=>i.getComponent()):this.rowManager.addRows(t).then(n=>n[0].getComponent())}updateRow(e,t){var i=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),i?i.updateData(t).then(()=>Promise.resolve(i.getComponent())):(console.warn("Update Error - No matching row found:",e),Promise.reject("Update Error - No matching row found"))}scrollToRow(e,t,i){var n=this.rowManager.findRow(e);return n?this.rowManager.scrollToRow(n,t,i):(console.warn("Scroll Error - No matching row found:",e),Promise.reject("Scroll Error - No matching row found"))}moveRow(e,t,i){var n=this.rowManager.findRow(e);this.initGuard(),n?n.moveToRow(t,i):console.warn("Move Error - No matching row found:",e)}getRows(e){return this.rowManager.getComponents(e)}getRowPosition(e){var t=this.rowManager.findRow(e);return t?t.getPosition():(console.warn("Position Error - No matching row found:",e),!1)}setColumns(e){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(e)}getColumns(e){return this.columnManager.getComponents(e)}getColumn(e){var t=this.columnManager.findColumn(e);return t?t.getComponent():(console.warn("Find Error - No matching column found:",e),!1)}getColumnDefinitions(){return this.columnManager.getDefinitionTree()}showColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.show();else return console.warn("Column Show Error - No matching column found:",e),!1}hideColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.hide();else return console.warn("Column Hide Error - No matching column found:",e),!1}toggleColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.visible?t.hide():t.show();else return console.warn("Column Visibility Toggle Error - No matching column found:",e),!1}addColumn(e,t,i){var n=this.columnManager.findColumn(i);return this.initGuard(),this.columnManager.addColumn(e,t,n).then(r=>r.getComponent())}deleteColumn(e){var t=this.columnManager.findColumn(e);return this.initGuard(),t?t.delete():(console.warn("Column Delete Error - No matching column found:",e),Promise.reject())}updateColumnDefinition(e,t){var i=this.columnManager.findColumn(e);return this.initGuard(),i?i.updateDefinition(t):(console.warn("Column Update Error - No matching column found:",e),Promise.reject())}moveColumn(e,t,i){var n=this.columnManager.findColumn(e),r=this.columnManager.findColumn(t);this.initGuard(),n?r?this.columnManager.moveColumn(n,r,i):console.warn("Move Error - No matching column found:",r):console.warn("Move Error - No matching column found:",e)}scrollToColumn(e,t,i){return new Promise((n,r)=>{var o=this.columnManager.findColumn(e);return o?this.columnManager.scrollToColumn(o,t,i):(console.warn("Scroll Error - No matching column found:",e),Promise.reject("Scroll Error - No matching column found"))})}redraw(e){this.initGuard(),this.columnManager.redraw(e),this.rowManager.redraw(e)}setHeight(e){this.options.height=isNaN(e)?e:e+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw(!0)}on(e,t){this.externalEvents.subscribe(e,t)}off(e,t){this.externalEvents.unsubscribe(e,t)}dispatchEvent(){var e=Array.from(arguments);e.shift(),this.externalEvents.dispatch(...arguments)}alert(e,t){this.initGuard(),this.alertManager.alert(e,t)}clearAlert(){this.initGuard(),this.alertManager.clear()}modExists(e,t){return this.modules[e]?!0:(t&&console.error("Tabulator Module Not Installed: "+e),!1)}module(e){var t=this.modules[e];return t||console.error("Tabulator module not installed: "+e),t}};U(ln,"defaultOptions",_D);let kc=ln;var to=kc;class WD extends to{static extendModule(){to.initializeModuleBinder(wu),to._extendModule(...arguments)}static registerModule(){to.initializeModuleBinder(wu),to._registerModule(...arguments)}constructor(e,t,i){super(e,t,wu)}}var wN=WD;export{ts as $,ze as A,ji as B,kd as C,rx as D,ce as E,Ko as F,_i as G,ck as H,Ug as I,fk as J,Oi as K,zt as L,He as M,ei as N,bk as O,la as P,Mt as Q,Hg as R,Am as S,So as T,ge as U,rk as V,nl as W,Lu as X,Fi as Y,nd as Z,Ts as _,zC as a,Lk as a$,o_ as a0,ZD as a1,Kt as a2,Ce as a3,Ie as a4,$D as a5,Gb as a6,st as a7,zs as a8,Dr as a9,Os as aA,nh as aB,rd as aC,Yo as aD,Tu as aE,yN as aF,w2 as aG,gN as aH,fN as aI,cN as aJ,mN as aK,pN as aL,bN as aM,dN as aN,je as aO,na as aP,We as aQ,Gi as aR,Yr as aS,Rk as aT,Ck as aU,Ak as aV,Ok as aW,Pk as aX,Ik as aY,Tk as aZ,Sk as a_,Ui as aa,wi as ab,ia as ac,Sr as ad,Gk as ae,Bk as af,eR as ag,dn as ah,Xk as ai,$k as aj,Kk as ak,iN as al,on as am,tN as an,hO as ao,EO as ap,Ef as aq,Ml as ar,fn as as,QI as at,dO as au,qk as av,eN as aw,Jk as ax,Qk as ay,Zk as az,ix as b,rt as b$,Mk as b0,xk as b1,Wi as b2,wN as b3,Pm as b4,Vl as b5,oN as b6,QD as b7,y2 as b8,_e as b9,mC as bA,Pe as bB,ni as bC,Eb as bD,qo as bE,X as bF,Ab as bG,ne as bH,gt as bI,ac as bJ,oc as bK,kl as bL,MO as bM,yk as bN,Bd as bO,ml as bP,yx as bQ,ks as bR,Qf as bS,Ua as bT,YD as bU,N0 as bV,FO as bW,jD as bX,Ot as bY,$e as bZ,Ms as b_,Ke as ba,ii as bb,Dk as bc,kk as bd,Fk as be,pk as bf,Nk as bg,zk as bh,aa as bi,he as bj,g_ as bk,Ao as bl,rg as bm,l_ as bn,O0 as bo,cs as bp,zd as bq,ih as br,og as bs,hk as bt,ik as bu,be as bv,Wl as bw,Xt as bx,Vi as by,Zo as bz,sx as c,i_ as c$,SE as c0,xe as c1,wt as c2,At as c3,bi as c4,Ps as c5,so as c6,ro as c7,pn as c8,N as c9,ok as cA,wv as cB,_t as cC,hN as cD,lN as cE,Yk as cF,cn as cG,ql as cH,s2 as cI,r2 as cJ,xv as cK,cu as cL,qD as cM,XD as cN,Zc as cO,Hk as cP,Wk as cQ,lk as cR,O_ as cS,kr as cT,h2 as cU,Dx as cV,Uk as cW,B as cX,hx as cY,gk as cZ,u_ as c_,gb as ca,fb as cb,NO as cc,nN as cd,jk as ce,sN as cf,aN as cg,Lf as ch,Zl as ci,Y0 as cj,Tf as ck,i2 as cl,a2 as cm,Mf as cn,wk as co,vk as cp,Sf as cq,NC as cr,Ss as cs,oE as ct,rN as cu,Tm as cv,Q_ as cw,sn as cx,gn as cy,Vk as cz,Dn as d,ag as d0,JD as d1,ek as d2,dg as d3,db as d4,r_ as d5,a_ as d6,sb as d7,WO as d8,UO as d9,ib as da,ak as db,fE as dc,Gm as dd,uN as de,Rr as df,Nr as dg,Id as dh,tk as di,ns as dj,Jo as dk,To as e,nn as f,KD as g,di as h,Ei as i,ug as j,ss as k,xi as l,_n as m,Ob as n,nk as o,L_ as p,A_ as q,pt as r,Fm as s,Kl as t,_s as u,dk as v,Yl as w,Xl as x,$l as y,is as z};
//# sourceMappingURL=lazy-CXj0l6bG.js.map
